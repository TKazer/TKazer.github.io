<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>TGCTF 2025 逆向WP | Liv's blog</title><meta name="author" content="Liv"><meta name="copyright" content="Liv"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="TGCTF 2025 逆向WP战队名：不知道 排名：3 上次XYCTF是痛失Web手，这次又是痛失Pwn手，啥时候能全队一起打一次（）。这次Re难度还行，磨磨唧唧整了一会也是AK了。 Base64Base64 变种加密 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495">
<meta property="og:type" content="article">
<meta property="og:title" content="TGCTF 2025 逆向WP">
<meta property="og:url" content="https://tkazer.github.io/2025/04/13/TGCTF2025/index.html">
<meta property="og:site_name" content="Liv&#39;s blog">
<meta property="og:description" content="TGCTF 2025 逆向WP战队名：不知道 排名：3 上次XYCTF是痛失Web手，这次又是痛失Pwn手，啥时候能全队一起打一次（）。这次Re难度还行，磨磨唧唧整了一会也是AK了。 Base64Base64 变种加密 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tkazer.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2025-04-13T11:12:25.000Z">
<meta property="article:modified_time" content="2025-04-16T04:16:50.460Z">
<meta property="article:author" content="Liv">
<meta property="article:tag" content="CTF比赛">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tkazer.github.io/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "TGCTF 2025 逆向WP",
  "url": "https://tkazer.github.io/2025/04/13/TGCTF2025/",
  "image": "https://tkazer.github.io/img/butterfly-icon.png",
  "datePublished": "2025-04-13T11:12:25.000Z",
  "dateModified": "2025-04-16T04:16:50.460Z",
  "author": [
    {
      "@type": "Person",
      "name": "Liv",
      "url": "https://tkazer.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://tkazer.github.io/2025/04/13/TGCTF2025/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'TGCTF 2025 逆向WP',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="Liv's blog" type="application/atom+xml">
</head><body><div id="web_bg" style="background-image: url(https://i.postimg.cc/Y2VMBKkT/windows-11-landscape-scenery-sunrise-stock-day-light-3840x2400-5667.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 目录</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="https://i.postimg.cc/C5dMXV2c/pic.png" alt="Logo"><span class="site-name">Liv's blog</span></a><a class="nav-page-title" href="/"><span class="site-name">TGCTF 2025 逆向WP</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 目录</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">TGCTF 2025 逆向WP</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-13T11:12:25.000Z" title="发表于 2025-04-13 19:12:25">2025-04-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-04-16T04:16:50.460Z" title="更新于 2025-04-16 12:16:50">2025-04-16</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="container post-content" id="article-container"><h1 id="TGCTF-2025-逆向WP"><a href="#TGCTF-2025-逆向WP" class="headerlink" title="TGCTF 2025 逆向WP"></a>TGCTF 2025 逆向WP</h1><p>战队名：不知道</p>
<p>排名：3</p>
<p>上次XYCTF是痛失Web手，这次又是痛失Pwn手，啥时候能全队一起打一次（）。这次Re难度还行，磨磨唧唧整了一会也是AK了。</p>
<h2 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a>Base64</h2><p>Base64 变种加密</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_BYTE *__fastcall <span class="title">sub_7FF7DC6C10E0</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v3; <span class="comment">// rbp</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// edx</span></span><br><span class="line">  __int64 v7; <span class="comment">// r14</span></span><br><span class="line">  <span class="type">size_t</span> v8; <span class="comment">// rcx</span></span><br><span class="line">  _BYTE *v9; <span class="comment">// r8</span></span><br><span class="line">  __int64 v10; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v11; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v13; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v14; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v16; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v17; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v18; <span class="comment">// edi</span></span><br><span class="line">  __int64 v19; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">int</span> v20; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v21; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v22; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v23; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v24; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v25; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v26; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v27; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v28; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> v30[<span class="number">80</span>]; <span class="comment">// [rsp+20h] [rbp-68h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v31; <span class="comment">// [rsp+90h] [rbp+8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="number">-1</span>;</span><br><span class="line">  <span class="built_in">strcpy</span>(v30, <span class="string">&quot;GLp/+Wn7uqX8FQ2JDR1c0M6U53sjBwyxglmrCVdSThAfEOvPHaYZNzo4ktK9iebI&quot;</span>);</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    ++v2;</span><br><span class="line">  <span class="keyword">while</span> ( *(_BYTE *)(a1 + v2) );</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  v4 = (<span class="type">int</span>)v2 / <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (_DWORD)v2 == <span class="number">3</span> * ((<span class="type">int</span>)v2 / <span class="number">3</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = <span class="number">0</span>;</span><br><span class="line">    v6 = <span class="number">4</span> * v4;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( (<span class="type">int</span>)v2 % <span class="number">3</span> == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = <span class="number">1</span>;</span><br><span class="line">    v6 = <span class="number">4</span> * v4 + <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( (<span class="type">int</span>)v2 % <span class="number">3</span> == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = <span class="number">2</span>;</span><br><span class="line">    v6 = <span class="number">4</span> * v4 + <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v5 = v31;</span><br><span class="line">    v6 = v31;</span><br><span class="line">  &#125;</span><br><span class="line">  v7 = v6;</span><br><span class="line">  v8 = v6 + <span class="number">1LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v6 == <span class="number">-1</span> )</span><br><span class="line">    v8 = <span class="number">-1</span>;</span><br><span class="line">  v9 = <span class="built_in">malloc</span>(v8);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">int</span>)v2 - v5 &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = a1 + <span class="number">2</span>;</span><br><span class="line">    v11 = ((<span class="type">int</span>)v2 - v5 - <span class="number">1LL</span>) / <span class="number">3uLL</span> + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v3 += <span class="number">4</span>;</span><br><span class="line">      v12 = *(<span class="type">unsigned</span> __int8 *)(v10 - <span class="number">2</span>) &gt;&gt; <span class="number">2</span>;</span><br><span class="line">      v10 += <span class="number">3</span>;</span><br><span class="line">      v13 = v12 + <span class="number">24</span>;</span><br><span class="line">      v14 = v13 - <span class="number">64</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v13 &lt;= <span class="number">0x40</span> )</span><br><span class="line">        v14 = v13;</span><br><span class="line">      v9[v3 - <span class="number">4</span>] = v30[v14];</span><br><span class="line">      v15 = ((*(<span class="type">unsigned</span> __int8 *)(v10 - <span class="number">4</span>) &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * (*(_BYTE *)(v10 - <span class="number">5</span>) &amp; <span class="number">3</span>))) - <span class="number">40</span>;</span><br><span class="line">      <span class="keyword">if</span> ( ((*(<span class="type">unsigned</span> __int8 *)(v10 - <span class="number">4</span>) &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * (*(_BYTE *)(v10 - <span class="number">5</span>) &amp; <span class="number">3u</span>))) + <span class="number">24</span> &lt;= <span class="number">0x40</span> )</span><br><span class="line">        v15 = ((*(<span class="type">unsigned</span> __int8 *)(v10 - <span class="number">4</span>) &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * (*(_BYTE *)(v10 - <span class="number">5</span>) &amp; <span class="number">3</span>))) + <span class="number">24</span>;</span><br><span class="line">      v9[v3 - <span class="number">3</span>] = v30[v15];</span><br><span class="line">      v16 = ((*(<span class="type">unsigned</span> __int8 *)(v10 - <span class="number">3</span>) &gt;&gt; <span class="number">6</span>) | (<span class="number">4</span> * (*(_BYTE *)(v10 - <span class="number">4</span>) &amp; <span class="number">0xF</span>))) - <span class="number">40</span>;</span><br><span class="line">      <span class="keyword">if</span> ( ((*(<span class="type">unsigned</span> __int8 *)(v10 - <span class="number">3</span>) &gt;&gt; <span class="number">6</span>) | (<span class="number">4</span> * (*(_BYTE *)(v10 - <span class="number">4</span>) &amp; <span class="number">0xFu</span>))) + <span class="number">24</span> &lt;= <span class="number">0x40</span> )</span><br><span class="line">        v16 = ((*(<span class="type">unsigned</span> __int8 *)(v10 - <span class="number">3</span>) &gt;&gt; <span class="number">6</span>) | (<span class="number">4</span> * (*(_BYTE *)(v10 - <span class="number">4</span>) &amp; <span class="number">0xF</span>))) + <span class="number">24</span>;</span><br><span class="line">      v9[v3 - <span class="number">2</span>] = v30[v16];</span><br><span class="line">      v17 = (*(_BYTE *)(v10 - <span class="number">3</span>) &amp; <span class="number">0x3F</span>) - <span class="number">40</span>;</span><br><span class="line">      <span class="keyword">if</span> ( (*(_BYTE *)(v10 - <span class="number">3</span>) &amp; <span class="number">0x3Fu</span>) + <span class="number">24</span> &lt;= <span class="number">0x40</span> )</span><br><span class="line">        v17 = (*(_BYTE *)(v10 - <span class="number">3</span>) &amp; <span class="number">0x3F</span>) + <span class="number">24</span>;</span><br><span class="line">      v9[v3 - <span class="number">1</span>] = v30[v17];</span><br><span class="line">      --v11;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v11 );</span><br><span class="line">  &#125;</span><br><span class="line">  v18 = v5 - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !v18 )</span><br><span class="line">  &#123;</span><br><span class="line">    v25 = (*(<span class="type">unsigned</span> __int8 *)((<span class="type">int</span>)v2 + a1 - <span class="number">1</span>) &gt;&gt; <span class="number">2</span>) - <span class="number">40</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (*(<span class="type">unsigned</span> __int8 *)((<span class="type">int</span>)v2 + a1 - <span class="number">1</span>) &gt;&gt; <span class="number">2</span>) + <span class="number">24</span> &lt;= <span class="number">0x40u</span> )</span><br><span class="line">      v25 = (*(<span class="type">unsigned</span> __int8 *)((<span class="type">int</span>)v2 + a1 - <span class="number">1</span>) &gt;&gt; <span class="number">2</span>) + <span class="number">24</span>;</span><br><span class="line">    v9[v7 - <span class="number">4</span>] = v30[v25];</span><br><span class="line">    v26 = *(_BYTE *)((<span class="type">int</span>)v2 + a1 - <span class="number">1</span>) &amp; <span class="number">3</span>;</span><br><span class="line">    *(_WORD *)&amp;v9[v7 - <span class="number">2</span>] = <span class="number">15677</span>;</span><br><span class="line">    v27 = <span class="number">16</span> * v26 + <span class="number">24</span>;</span><br><span class="line">    v28 = v27 - <span class="number">64</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v27 &lt;= <span class="number">0x40</span> )</span><br><span class="line">      v28 = v27;</span><br><span class="line">    v9[v7 - <span class="number">3</span>] = v30[v28];</span><br><span class="line">    <span class="keyword">goto</span> LABEL_37;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v18 != <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">LABEL_37:</span><br><span class="line">    v9[v7] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> v9;</span><br><span class="line">  &#125;</span><br><span class="line">  v19 = a1 + (<span class="type">int</span>)v2;</span><br><span class="line">  v20 = (*(<span class="type">unsigned</span> __int8 *)(v19 - <span class="number">2</span>) &gt;&gt; <span class="number">2</span>) - <span class="number">40</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (*(<span class="type">unsigned</span> __int8 *)(v19 - <span class="number">2</span>) &gt;&gt; <span class="number">2</span>) + <span class="number">24</span> &lt;= <span class="number">0x40u</span> )</span><br><span class="line">    v20 = (*(<span class="type">unsigned</span> __int8 *)(v19 - <span class="number">2</span>) &gt;&gt; <span class="number">2</span>) + <span class="number">24</span>;</span><br><span class="line">  v9[v7 - <span class="number">4</span>] = v30[v20];</span><br><span class="line">  v21 = ((*(<span class="type">unsigned</span> __int8 *)(v19 - <span class="number">1</span>) &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * (*(_BYTE *)(v19 - <span class="number">2</span>) &amp; <span class="number">3</span>))) - <span class="number">40</span>;</span><br><span class="line">  <span class="keyword">if</span> ( ((*(<span class="type">unsigned</span> __int8 *)(v19 - <span class="number">1</span>) &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * (*(_BYTE *)(v19 - <span class="number">2</span>) &amp; <span class="number">3u</span>))) + <span class="number">24</span> &lt;= <span class="number">0x40</span> )</span><br><span class="line">    v21 = ((*(<span class="type">unsigned</span> __int8 *)(v19 - <span class="number">1</span>) &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * (*(_BYTE *)(v19 - <span class="number">2</span>) &amp; <span class="number">3</span>))) + <span class="number">24</span>;</span><br><span class="line">  v9[v7 - <span class="number">3</span>] = v30[v21];</span><br><span class="line">  v22 = *(_BYTE *)(v19 - <span class="number">1</span>) &amp; <span class="number">0xF</span>;</span><br><span class="line">  *(_WORD *)&amp;v9[v7 - <span class="number">1</span>] = <span class="number">61</span>;</span><br><span class="line">  v23 = <span class="number">4</span> * v22 + <span class="number">24</span>;</span><br><span class="line">  v24 = <span class="number">4</span> * v22 - <span class="number">40</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v23 &lt;= <span class="number">0x40</span> )</span><br><span class="line">    v24 = v23;</span><br><span class="line">  v9[v7 - <span class="number">2</span>] = v30[v24];</span><br><span class="line">  <span class="keyword">return</span> v9;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>解密代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">char</span> *<span class="title">base64_decode</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *_input_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *base64_table = <span class="string">&quot;GLp/+Wn7uqX8FQ2JDR1c0M6U53sjBwyxglmrCVdSThAfEOvPHaYZNzo4ktK9iebI&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> reverse_table[<span class="number">256</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        reverse_table[(<span class="type">unsigned</span> <span class="type">char</span>)base64_table[i]] = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> input_len = <span class="built_in">strlen</span>(_input_);</span><br><span class="line">    <span class="type">size_t</span> padding = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (input_len &gt; <span class="number">0</span> &amp;&amp; _input_[input_len - <span class="number">1</span>] == <span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        padding++;</span><br><span class="line">        <span class="keyword">if</span> (input_len &gt; <span class="number">1</span> &amp;&amp; _input_[input_len - <span class="number">2</span>] == <span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            padding++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> output_len = (input_len * <span class="number">3</span>) / <span class="number">4</span> - padding;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *output = (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="built_in">malloc</span>(output_len + <span class="number">1</span>);</span><br><span class="line">    output[output_len] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; input_len - padding)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> b1, b2, b3, b4;</span><br><span class="line"></span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> v1 = reverse_table[_input_[i++]];</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> v2 = reverse_table[_input_[i++]];</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> v3 = (i &lt; input_len) ? reverse_table[_input_[i++]] : <span class="number">0</span>;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> v4 = (i &lt; input_len) ? reverse_table[_input_[i++]] : <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        b1 = (v1 &gt; <span class="number">24</span>) ? (v1 - <span class="number">24</span>) : (v1 + <span class="number">64</span> - <span class="number">24</span>);</span><br><span class="line">        b2 = (v2 &gt; <span class="number">24</span>) ? (v2 - <span class="number">24</span>) : (v2 + <span class="number">64</span> - <span class="number">24</span>);</span><br><span class="line">        b3 = (v3 &gt; <span class="number">24</span>) ? (v3 - <span class="number">24</span>) : (v3 + <span class="number">64</span> - <span class="number">24</span>);</span><br><span class="line">        b4 = (v4 &gt; <span class="number">24</span>) ? (v4 - <span class="number">24</span>) : (v4 + <span class="number">64</span> - <span class="number">24</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (j &lt; output_len)</span><br><span class="line">            output[j++] = (b1 &lt;&lt; <span class="number">2</span>) | (b2 &gt;&gt; <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">if</span> (j &lt; output_len)</span><br><span class="line">            output[j++] = (b2 &lt;&lt; <span class="number">4</span>) | (b3 &gt;&gt; <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">if</span> (j &lt; output_len)</span><br><span class="line">            output[j++] = (b3 &lt;&lt; <span class="number">6</span>) | b4;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (<span class="type">char</span> *)output;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *Enc= <span class="string">&quot;AwLdOEVEhIWtajB2CbCWCbTRVsFFC8hirfiXC9gWH9HQayCJVbB8CIF=&quot;</span>;</span><br><span class="line">    <span class="type">char</span> *Decoded= <span class="built_in">base64_decode</span>(Enc);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, Decoded);</span><br><span class="line">    <span class="built_in">free</span>(decoded);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>HZNUCTF{ad162c-2d94-434d-9222-b65dc76a32}</p>
<h2 id="水果忍者"><a href="#水果忍者" class="headerlink" title="水果忍者"></a>水果忍者</h2><p>主要 dll 目录：\水果忍者\Fruit Ninja_Data\Managed\Assembly-CSharp.dll</p>
<p>拖入 dnSpy 分析，是 AES CBC 加密。</p>
<p><img src="/2025/04/13/TGCTF2025/SkHubyVDToXzQ5x3DFBcF7PQntf.png"></p>
<p>底下有密文、密钥、iv，直接解密即可。</p>
<p><img src="/2025/04/13/TGCTF2025/E150bPmfNoFuhzxZfGqcRtBunkd.png"></p>
<p><img src="/2025/04/13/TGCTF2025/IOlAbPLIwomQLFxru43cw9Ubn0e.png"></p>
<p>HZNUCTF{de20-70dd-4e62-b8d0-06e}</p>
<h2 id="蛇年的本命语言"><a href="#蛇年的本命语言" class="headerlink" title="蛇年的本命语言"></a>蛇年的本命语言</h2><p>python 程序解包得到 pyc（python 3.8），使用 uncompyle6 解密得到代码。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">from collections <span class="keyword">import</span> Counter</span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">&quot;Welcome to HZNUCTF!!!&quot;</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">&quot;Plz input the flag:&quot;</span>)</span></span></span><br><span class="line"><span class="function">ooo0oOoooOOO0 </span>= <span class="built_in">input</span>()</span><br><span class="line">oOO0OoOoo000 = <span class="built_in">Counter</span>(ooo0oOoooOOO0)</span><br><span class="line">O0o00 = <span class="string">&quot;&quot;</span>.<span class="built_in">join</span>((<span class="built_in">str</span>(oOO0OoOoo000[oOooo0OOO]) <span class="keyword">for</span> oOooo0OOO in ooo0oOoooOOO0))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ans1: &quot;</span>, _end_=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(O0o00)</span><br><span class="line"><span class="keyword">if</span> O0o00 != <span class="string">&quot;111111116257645365477364777645752361&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;wrong_wrong!!!&quot;</span>)</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>)</span><br><span class="line">iiIII = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> oOooo0OOO in ooo0oOoooOOO0:</span><br><span class="line">    <span class="keyword">if</span> oOO0OoOoo000[oOooo0OOO] &gt; <span class="number">0</span>:</span><br><span class="line">        iiIII += oOooo0OOO + <span class="built_in">str</span>(oOO0OoOoo000[oOooo0OOO])</span><br><span class="line">        oOO0OoOoo000[oOooo0OOO] = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        i11i1Iii1I1 = [<span class="built_in">ord</span>(oOooo0OOO) <span class="keyword">for</span> oOooo0OOO in iiIII]</span><br><span class="line">        ii1iIi1i11i = [</span><br><span class="line">         <span class="number">7</span> * i11i1Iii1I1[<span class="number">0</span>] == <span class="number">504</span>,</span><br><span class="line">         <span class="number">9</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">5</span> * i11i1Iii1I1[<span class="number">1</span>] == <span class="number">403</span>,</span><br><span class="line">         <span class="number">2</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">5</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">10</span> * i11i1Iii1I1[<span class="number">2</span>] == <span class="number">799</span>,</span><br><span class="line">         <span class="number">3</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">8</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">15</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">20</span> * i11i1Iii1I1[<span class="number">3</span>] == <span class="number">2938</span>,</span><br><span class="line">         <span class="number">5</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">15</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">20</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">19</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">4</span>] == <span class="number">2042</span>,</span><br><span class="line">         <span class="number">7</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">9</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">11</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">2</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">5</span> * i11i1Iii1I1[<span class="number">5</span>] == <span class="number">1225</span>,</span><br><span class="line">         <span class="number">11</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">22</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">33</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">44</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">55</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">77</span> * i11i1Iii1I1[<span class="number">6</span>] == <span class="number">7975</span>,</span><br><span class="line">         <span class="number">21</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">24</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">55</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">7</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">15</span> * i11i1Iii1I1[<span class="number">7</span>] == <span class="number">229</span>,</span><br><span class="line">         <span class="number">2</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">26</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">13</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">65</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">15</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">29</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">20</span> * i11i1Iii1I1[<span class="number">8</span>] == <span class="number">2107</span>,</span><br><span class="line">         <span class="number">10</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">7</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">-9</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">7</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">22</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">21</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">8</span>] + <span class="number">30</span> * i11i1Iii1I1[<span class="number">9</span>] == <span class="number">4037</span>,</span><br><span class="line">         <span class="number">15</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">59</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">56</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">7</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">122</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">21</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">32</span> * i11i1Iii1I1[<span class="number">8</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">9</span>] - <span class="number">10</span> * i11i1Iii1I1[<span class="number">10</span>] == <span class="number">4950</span>,</span><br><span class="line">         <span class="number">13</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">29</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">39</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">33</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">13</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">2</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">42</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">62</span> * i11i1Iii1I1[<span class="number">8</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">9</span>] - <span class="number">10</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">11</span> * i11i1Iii1I1[<span class="number">11</span>] == <span class="number">12544</span>,</span><br><span class="line">         <span class="number">23</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">29</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">3</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">63</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">25</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">2</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">32</span> * i11i1Iii1I1[<span class="number">8</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">9</span>] - <span class="number">10</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">11</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">12</span> * i11i1Iii1I1[<span class="number">12</span>] == <span class="number">6585</span>,</span><br><span class="line">         <span class="number">223</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">1</span>] - <span class="number">29</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">53</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">3</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">65</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">36</span> * i11i1Iii1I1[<span class="number">8</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">9</span>] - <span class="number">15</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">16</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">18</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">13</span> * i11i1Iii1I1[<span class="number">13</span>] == <span class="number">6893</span>,</span><br><span class="line">         <span class="number">29</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">13</span> * i11i1Iii1I1[<span class="number">1</span>] - <span class="number">9</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">93</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">33</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">65</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">36</span> * i11i1Iii1I1[<span class="number">8</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">9</span>] - <span class="number">16</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">96</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">68</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">33</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">14</span> * i11i1Iii1I1[<span class="number">14</span>] == <span class="number">1883</span>,</span><br><span class="line">         <span class="number">69</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">77</span> * i11i1Iii1I1[<span class="number">1</span>] - <span class="number">93</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">12</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">16</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">36</span> * i11i1Iii1I1[<span class="number">8</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">19</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">8</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">38</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">16</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">15</span> * i11i1Iii1I1[<span class="number">15</span>] == <span class="number">8257</span>,</span><br><span class="line">         <span class="number">23</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">2</span> * i11i1Iii1I1[<span class="number">1</span>] - <span class="number">3</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">11</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">12</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">24</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">14</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">0</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">68</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">18</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">68</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">26</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">15</span> * i11i1Iii1I1[<span class="number">15</span>] - <span class="number">16</span> * i11i1Iii1I1[<span class="number">16</span>] == <span class="number">5847</span>,</span><br><span class="line">         <span class="number">24</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">1</span>] - <span class="number">1</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">15</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">13</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">4</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">16</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">67</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">146</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">50</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">16</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">1</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">69</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">27</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">45</span> * i11i1Iii1I1[<span class="number">15</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">17</span> * i11i1Iii1I1[<span class="number">17</span>] == <span class="number">18257</span>,</span><br><span class="line">         <span class="number">25</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">26</span> * i11i1Iii1I1[<span class="number">1</span>] - <span class="number">89</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">16</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">19</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">44</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">36</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">150</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">250</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">166</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">126</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">11</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">690</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">207</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">46</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">7</span> * i11i1Iii1I1[<span class="number">17</span>] - <span class="number">18</span> * i11i1Iii1I1[<span class="number">18</span>] == <span class="number">12591</span>,</span><br><span class="line">         <span class="number">5</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">26</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">8</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">160</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">9</span> * i11i1Iii1I1[<span class="number">4</span>] - <span class="number">4</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">36</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">15</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">16</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">1</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">690</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">46</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">7</span> * i11i1Iii1I1[<span class="number">17</span>] - <span class="number">18</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">19</span> * i11i1Iii1I1[<span class="number">19</span>] == <span class="number">52041</span>,</span><br><span class="line">         <span class="number">29</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">26</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">60</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">90</span> * i11i1Iii1I1[<span class="number">4</span>] - <span class="number">4</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">16</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">21</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">69</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">12</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">69</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">14</span>] - <span class="number">46</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">65</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">17</span>] - <span class="number">1</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">39</span> * i11i1Iii1I1[<span class="number">19</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">20</span>] == <span class="number">20253</span>,</span><br><span class="line">         <span class="number">45</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">56</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">10</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">650</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">900</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">44</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">6</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">21</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">9</span> * i11i1Iii1I1[<span class="number">10</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">12</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">69</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">2</span> * i11i1Iii1I1[<span class="number">14</span>] - <span class="number">406</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">651</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">2</span> * i11i1Iii1I1[<span class="number">17</span>] - <span class="number">10</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">69</span> * i11i1Iii1I1[<span class="number">19</span>] - <span class="number">0</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">21</span> * i11i1Iii1I1[<span class="number">21</span>] == <span class="number">18768</span>,</span><br><span class="line">         <span class="number">555</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">6666</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">70</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">510</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">90</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">499</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">6</span>] - <span class="number">66</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">610</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">221</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">9</span> * i11i1Iii1I1[<span class="number">10</span>] - <span class="number">23</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">102</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">2050</span> * i11i1Iii1I1[<span class="number">14</span>] - <span class="number">406</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">665</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">333</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">100</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">609</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">777</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">201</span> * i11i1Iii1I1[<span class="number">21</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">22</span>] == <span class="number">111844</span>,</span><br><span class="line">         <span class="number">1</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">333</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">4444</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">5555</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">6666</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">666</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">676</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">660</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">9</span> * i11i1Iii1I1[<span class="number">10</span>] - <span class="number">73</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">107</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">250</span> * i11i1Iii1I1[<span class="number">14</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">65</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">39</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">10</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">69</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">777</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">201</span> * i11i1Iii1I1[<span class="number">21</span>] - <span class="number">2</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] == <span class="number">159029</span>,</span><br><span class="line">         <span class="number">520</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">222</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">333</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">4</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">56655</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">6666</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">60</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">220</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">99</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">73</span> * i11i1Iii1I1[<span class="number">11</span>] + <span class="number">1007</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">7777</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">2500</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">6666</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">605</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">390</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">100</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">609</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">99999</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">210</span> * i11i1Iii1I1[<span class="number">21</span>] + <span class="number">232</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] - <span class="number">24</span> * i11i1Iii1I1[<span class="number">24</span>] == <span class="number">2762025</span>,</span><br><span class="line">         <span class="number">1323</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">333</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">4</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">55</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">660</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">220</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">99</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">11</span>] + <span class="number">100</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">777</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">2500</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">6666</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">605</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">390</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">100</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">609</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">9999</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">210</span> * i11i1Iii1I1[<span class="number">21</span>] + <span class="number">232</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] - <span class="number">24</span> * i11i1Iii1I1[<span class="number">24</span>] + <span class="number">25</span> * i11i1Iii1I1[<span class="number">25</span>] == <span class="number">1551621</span>,</span><br><span class="line">         <span class="number">777</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">6969</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">4</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">55</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">96</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">60</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">220</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">99</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">11</span>] + <span class="number">100</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">777</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">250</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">65</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">90</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">100</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">609</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">999</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">21</span> * i11i1Iii1I1[<span class="number">21</span>] + <span class="number">232</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] - <span class="number">24</span> * i11i1Iii1I1[<span class="number">24</span>] + <span class="number">25</span> * i11i1Iii1I1[<span class="number">25</span>] - <span class="number">26</span> * i11i1Iii1I1[<span class="number">26</span>] == <span class="number">948348</span>,</span><br><span class="line">         <span class="number">97</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">6969</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">4</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">56</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">96</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">96</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">60</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">99</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">11</span>] + <span class="number">10</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">707</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">250</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">-9</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">90</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">-2</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">609</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">21</span> * i11i1Iii1I1[<span class="number">21</span>] + <span class="number">2</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] - <span class="number">24</span> * i11i1Iii1I1[<span class="number">24</span>] + <span class="number">25</span> * i11i1Iii1I1[<span class="number">25</span>] - <span class="number">26</span> * i11i1Iii1I1[<span class="number">26</span>] + <span class="number">27</span> * i11i1Iii1I1[<span class="number">27</span>] == <span class="number">777044</span>,</span><br><span class="line">         <span class="number">177</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">699</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">64</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">56</span> * i11i1Iii1I1[<span class="number">4</span>] - <span class="number">96</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">66</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">96</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">60</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">99</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">11</span>] + <span class="number">10</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">707</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">250</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">-9</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">-2</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">69</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">21</span> * i11i1Iii1I1[<span class="number">21</span>] + <span class="number">222</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] - <span class="number">224</span> * i11i1Iii1I1[<span class="number">24</span>] + <span class="number">25</span> * i11i1Iii1I1[<span class="number">25</span>] - <span class="number">26</span> * i11i1Iii1I1[<span class="number">26</span>] + <span class="number">27</span> * i11i1Iii1I1[<span class="number">27</span>] - <span class="number">28</span> * i11i1Iii1I1[<span class="number">28</span>] == <span class="number">185016</span>,</span><br><span class="line">         <span class="number">77</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">2</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">96</span> * i11i1Iii1I1[<span class="number">4</span>] - <span class="number">9</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">96</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">0</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">99</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">11</span>] + <span class="number">10</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">707</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">250</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">-9</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">-2</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">9</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">21</span> * i11i1Iii1I1[<span class="number">21</span>] + <span class="number">222</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] - <span class="number">224</span> * i11i1Iii1I1[<span class="number">24</span>] + <span class="number">26</span> * i11i1Iii1I1[<span class="number">25</span>] - <span class="number">-58</span> * i11i1Iii1I1[<span class="number">26</span>] + <span class="number">27</span> * i11i1Iii1I1[<span class="number">27</span>] - <span class="number">2</span> * i11i1Iii1I1[<span class="number">28</span>] + <span class="number">29</span> * i11i1Iii1I1[<span class="number">29</span>] == <span class="number">130106</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">all</span>(ii1iIi1i11i):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Congratulation!!!&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;wrong_wrong!!!&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>是计下 flag 里面每个字符出现的次数检验是否符合那个字符串的格式化的对应次数，</p>
<p>将下面的 z3 解出可以得到一个字符串 <strong>H1Z1N1U1C1T1F1{1a6d275f7-463}</strong></p>
<p>一个字符一个数字配对，代表该字符在原 flag 中出现的次数。</p>
<p>除去前面 HZNUCTF{，将括号内的字母和对应数字做映射，利用原代码中的**”111111116257645365477364777645752361”**去一一对应。</p>
<p>解密代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">_encrypted_</span>):</span><br><span class="line">    mapping = <span class="string">&quot;6257645365477364777645752361&quot;</span></span><br><span class="line">    </span><br><span class="line">    char_map = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    remaining_map = &#123;</span><br><span class="line">        <span class="string">&#x27;6&#x27;</span>: <span class="string">&#x27;a&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;2&#x27;</span>: <span class="string">&#x27;d&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;5&#x27;</span>: <span class="string">&#x27;7&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;f&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;-&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;3&#x27;</span>: <span class="string">&#x27;6&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    char_map.update(remaining_map)</span><br><span class="line">    </span><br><span class="line">    result = <span class="string">&quot;HZNUCTF&#123;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> mapping:</span><br><span class="line">        result += char_map[num]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">Enc = [Int(<span class="string">f&#x27;x<span class="subst">&#123;i&#125;</span>&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>)]</span><br><span class="line"></span><br><span class="line">s.add(<span class="number">7</span> * Enc[<span class="number">0</span>] == <span class="number">504</span>)</span><br><span class="line">s.add(<span class="number">9</span> * Enc[<span class="number">0</span>] - <span class="number">5</span> * Enc[<span class="number">1</span>] == <span class="number">403</span>)</span><br><span class="line">s.add((<span class="number">2</span> * Enc[<span class="number">0</span>] - <span class="number">5</span> * Enc[<span class="number">1</span>]) + <span class="number">10</span> * Enc[<span class="number">2</span>] == <span class="number">799</span>)</span><br><span class="line">s.add(<span class="number">3</span> * Enc[<span class="number">0</span>] + <span class="number">8</span> * Enc[<span class="number">1</span>] + <span class="number">15</span> * Enc[<span class="number">2</span>] + <span class="number">20</span> * Enc[<span class="number">3</span>] == <span class="number">2938</span>)</span><br><span class="line">s.add((<span class="number">5</span> * Enc[<span class="number">0</span>] + <span class="number">15</span> * Enc[<span class="number">1</span>] + <span class="number">20</span> * Enc[<span class="number">2</span>] - <span class="number">19</span> * Enc[<span class="number">3</span>]) + <span class="number">1</span> * Enc[<span class="number">4</span>] == <span class="number">2042</span>)</span><br><span class="line">s.add((<span class="number">7</span> * Enc[<span class="number">0</span>] + <span class="number">1</span> * Enc[<span class="number">1</span>] + <span class="number">9</span> * Enc[<span class="number">2</span>] - <span class="number">11</span> * Enc[<span class="number">3</span>]) + <span class="number">2</span> * Enc[<span class="number">4</span>] + <span class="number">5</span> * Enc[<span class="number">5</span>] == <span class="number">1225</span>)</span><br><span class="line">s.add(<span class="number">11</span> * Enc[<span class="number">0</span>] + <span class="number">22</span> * Enc[<span class="number">1</span>] + <span class="number">33</span> * Enc[<span class="number">2</span>] + <span class="number">44</span> * Enc[<span class="number">3</span>] + <span class="number">55</span> * Enc[<span class="number">4</span>] + <span class="number">66</span> * Enc[<span class="number">5</span>] - <span class="number">77</span> * Enc[<span class="number">6</span>] == <span class="number">7975</span>)</span><br><span class="line">s.add(((<span class="number">21</span> * Enc[<span class="number">0</span>] + <span class="number">23</span> * Enc[<span class="number">1</span>] + <span class="number">3</span> * Enc[<span class="number">2</span>] + <span class="number">24</span> * Enc[<span class="number">3</span>] - <span class="number">55</span> * Enc[<span class="number">4</span>]) + <span class="number">6</span> * Enc[<span class="number">5</span>] - <span class="number">7</span> * Enc[<span class="number">6</span>]) + <span class="number">15</span> * Enc[<span class="number">7</span>] == <span class="number">229</span>)</span><br><span class="line">s.add((<span class="number">2</span> * Enc[<span class="number">0</span>] + <span class="number">26</span> * Enc[<span class="number">1</span>] + <span class="number">13</span> * Enc[<span class="number">2</span>] + <span class="number">0</span> * Enc[<span class="number">3</span>] - <span class="number">65</span> * Enc[<span class="number">4</span>]) + <span class="number">15</span> * Enc[<span class="number">5</span>] + <span class="number">29</span> * Enc[<span class="number">6</span>] + <span class="number">1</span> * Enc[<span class="number">7</span>] + <span class="number">20</span> * Enc[<span class="number">8</span>] == <span class="number">2107</span>)</span><br><span class="line">s.add((<span class="number">10</span> * Enc[<span class="number">0</span>] + <span class="number">7</span> * Enc[<span class="number">1</span>] + -<span class="number">9</span> * Enc[<span class="number">2</span>] + <span class="number">6</span> * Enc[<span class="number">3</span>] + <span class="number">7</span> * Enc[<span class="number">4</span>] + <span class="number">1</span> * Enc[<span class="number">5</span>] + <span class="number">22</span> * Enc[<span class="number">6</span>] + <span class="number">21</span> * Enc[<span class="number">7</span>] - <span class="number">22</span> * Enc[<span class="number">8</span>]) + <span class="number">30</span> * Enc[<span class="number">9</span>] == <span class="number">4037</span>)</span><br><span class="line">s.add((<span class="number">15</span> * Enc[<span class="number">0</span>] + <span class="number">59</span> * Enc[<span class="number">1</span>] + <span class="number">56</span> * Enc[<span class="number">2</span>] + <span class="number">66</span> * Enc[<span class="number">3</span>] + <span class="number">7</span> * Enc[<span class="number">4</span>] + <span class="number">1</span> * Enc[<span class="number">5</span>] - <span class="number">122</span> * Enc[<span class="number">6</span>]) + <span class="number">21</span> * Enc[<span class="number">7</span>] + <span class="number">32</span> * Enc[<span class="number">8</span>] + <span class="number">3</span> * Enc[<span class="number">9</span>] - <span class="number">10</span> * Enc[<span class="number">10</span>] == <span class="number">4950</span>)</span><br><span class="line">s.add((((<span class="number">13</span> * Enc[<span class="number">0</span>] + <span class="number">66</span> * Enc[<span class="number">1</span>] + <span class="number">29</span> * Enc[<span class="number">2</span>] + <span class="number">39</span> * Enc[<span class="number">3</span>] - <span class="number">33</span> * Enc[<span class="number">4</span>]) + <span class="number">13</span> * Enc[<span class="number">5</span>] - <span class="number">2</span> * Enc[<span class="number">6</span>]) + <span class="number">42</span> * Enc[<span class="number">7</span>] + <span class="number">62</span> * Enc[<span class="number">8</span>] + <span class="number">1</span> * Enc[<span class="number">9</span>] - <span class="number">10</span> * Enc[<span class="number">10</span>]) + <span class="number">11</span> * Enc[<span class="number">11</span>] == <span class="number">12544</span>)</span><br><span class="line">s.add((((<span class="number">23</span> * Enc[<span class="number">0</span>] + <span class="number">6</span> * Enc[<span class="number">1</span>] + <span class="number">29</span> * Enc[<span class="number">2</span>] + <span class="number">3</span> * Enc[<span class="number">3</span>] - <span class="number">3</span> * Enc[<span class="number">4</span>]) + <span class="number">63</span> * Enc[<span class="number">5</span>] - <span class="number">25</span> * Enc[<span class="number">6</span>]) + <span class="number">2</span> * Enc[<span class="number">7</span>] + <span class="number">32</span> * Enc[<span class="number">8</span>] + <span class="number">1</span> * Enc[<span class="number">9</span>] - <span class="number">10</span> * Enc[<span class="number">10</span>]) + <span class="number">11</span> * Enc[<span class="number">11</span>] - <span class="number">12</span> * Enc[<span class="number">12</span>] == <span class="number">6585</span>)</span><br><span class="line">s.add(((((<span class="number">223</span> * Enc[<span class="number">0</span>] + <span class="number">6</span> * Enc[<span class="number">1</span>] - <span class="number">29</span> * Enc[<span class="number">2</span>] - <span class="number">53</span> * Enc[<span class="number">3</span>] - <span class="number">3</span> * Enc[<span class="number">4</span>]) + <span class="number">3</span> * Enc[<span class="number">5</span>] - <span class="number">65</span> * Enc[<span class="number">6</span>]) + <span class="number">0</span> * Enc[<span class="number">7</span>] + <span class="number">36</span> * Enc[<span class="number">8</span>] + <span class="number">1</span> * Enc[<span class="number">9</span>] - <span class="number">15</span> * Enc[<span class="number">10</span>]) + <span class="number">16</span> * Enc[<span class="number">11</span>] - <span class="number">18</span> * Enc[<span class="number">12</span>]) + <span class="number">13</span> * Enc[<span class="number">13</span>] == <span class="number">6893</span>)</span><br><span class="line">s.add(((((<span class="number">29</span> * Enc[<span class="number">0</span>] + <span class="number">13</span> * Enc[<span class="number">1</span>] - <span class="number">9</span> * Enc[<span class="number">2</span>] - <span class="number">93</span> * Enc[<span class="number">3</span>]) + <span class="number">33</span> * Enc[<span class="number">4</span>] + <span class="number">6</span> * Enc[<span class="number">5</span>] + <span class="number">65</span> * Enc[<span class="number">6</span>] + <span class="number">1</span> * Enc[<span class="number">7</span>] - <span class="number">36</span> * Enc[<span class="number">8</span>]) + <span class="number">0</span> * Enc[<span class="number">9</span>] - <span class="number">16</span> * Enc[<span class="number">10</span>]) + <span class="number">96</span> * Enc[<span class="number">11</span>] - <span class="number">68</span> * Enc[<span class="number">12</span>]) + <span class="number">33</span> * Enc[<span class="number">13</span>] - <span class="number">14</span> * Enc[<span class="number">14</span>] == <span class="number">1883</span>)</span><br><span class="line">s.add((((<span class="number">69</span> * Enc[<span class="number">0</span>] + <span class="number">77</span> * Enc[<span class="number">1</span>] - <span class="number">93</span> * Enc[<span class="number">2</span>] - <span class="number">12</span> * Enc[<span class="number">3</span>]) + <span class="number">0</span> * Enc[<span class="number">4</span>] + <span class="number">0</span> * Enc[<span class="number">5</span>] + <span class="number">1</span> * Enc[<span class="number">6</span>] + <span class="number">16</span> * Enc[<span class="number">7</span>] + <span class="number">36</span> * Enc[<span class="number">8</span>] + <span class="number">6</span> * Enc[<span class="number">9</span>] + <span class="number">19</span> * Enc[<span class="number">10</span>] + <span class="number">66</span> * Enc[<span class="number">11</span>] - <span class="number">8</span> * Enc[<span class="number">12</span>]) + <span class="number">38</span> * Enc[<span class="number">13</span>] - <span class="number">16</span> * Enc[<span class="number">14</span>]) + <span class="number">15</span> * Enc[<span class="number">15</span>] == <span class="number">8257</span>)</span><br><span class="line">s.add(((((<span class="number">23</span> * Enc[<span class="number">0</span>] + <span class="number">2</span> * Enc[<span class="number">1</span>] - <span class="number">3</span> * Enc[<span class="number">2</span>] - <span class="number">11</span> * Enc[<span class="number">3</span>]) + <span class="number">12</span> * Enc[<span class="number">4</span>] + <span class="number">24</span> * Enc[<span class="number">5</span>] + <span class="number">1</span> * Enc[<span class="number">6</span>] + <span class="number">6</span> * Enc[<span class="number">7</span>] + <span class="number">14</span> * Enc[<span class="number">8</span>] - <span class="number">0</span> * Enc[<span class="number">9</span>]) + <span class="number">1</span> * Enc[<span class="number">10</span>] + <span class="number">68</span> * Enc[<span class="number">11</span>] - <span class="number">18</span> * Enc[<span class="number">12</span>]) + <span class="number">68</span> * Enc[<span class="number">13</span>] - <span class="number">26</span> * Enc[<span class="number">14</span>]) + <span class="number">15</span> * Enc[<span class="number">15</span>] - <span class="number">16</span> * Enc[<span class="number">16</span>] == <span class="number">5847</span>)</span><br><span class="line">s.add((((((<span class="number">24</span> * Enc[<span class="number">0</span>] + <span class="number">0</span> * Enc[<span class="number">1</span>] - <span class="number">1</span> * Enc[<span class="number">2</span>] - <span class="number">15</span> * Enc[<span class="number">3</span>]) + <span class="number">13</span> * Enc[<span class="number">4</span>] + <span class="number">4</span> * Enc[<span class="number">5</span>] + <span class="number">16</span> * Enc[<span class="number">6</span>] + <span class="number">67</span> * Enc[<span class="number">7</span>] + <span class="number">146</span> * Enc[<span class="number">8</span>] - <span class="number">50</span> * Enc[<span class="number">9</span>]) + <span class="number">16</span> * Enc[<span class="number">10</span>] + <span class="number">6</span> * Enc[<span class="number">11</span>] - <span class="number">1</span> * Enc[<span class="number">12</span>]) + <span class="number">69</span> * Enc[<span class="number">13</span>] - <span class="number">27</span> * Enc[<span class="number">14</span>]) + <span class="number">45</span> * Enc[<span class="number">15</span>] - <span class="number">6</span> * Enc[<span class="number">16</span>]) + <span class="number">17</span> * Enc[<span class="number">17</span>] == <span class="number">18257</span>)</span><br><span class="line">s.add(((((<span class="number">25</span> * Enc[<span class="number">0</span>] + <span class="number">26</span> * Enc[<span class="number">1</span>] - <span class="number">89</span> * Enc[<span class="number">2</span>]) + <span class="number">16</span> * Enc[<span class="number">3</span>] + <span class="number">19</span> * Enc[<span class="number">4</span>] + <span class="number">44</span> * Enc[<span class="number">5</span>] + <span class="number">36</span> * Enc[<span class="number">6</span>] + <span class="number">66</span> * Enc[<span class="number">7</span>] - <span class="number">150</span> * Enc[<span class="number">8</span>] - <span class="number">250</span> * Enc[<span class="number">9</span>]) + <span class="number">166</span> * Enc[<span class="number">10</span>] + <span class="number">126</span> * Enc[<span class="number">11</span>] - <span class="number">11</span> * Enc[<span class="number">12</span>]) + <span class="number">690</span> * Enc[<span class="number">13</span>] - <span class="number">207</span> * Enc[<span class="number">14</span>]) + <span class="number">46</span> * Enc[<span class="number">15</span>] + <span class="number">6</span> * Enc[<span class="number">16</span>] + <span class="number">7</span> * Enc[<span class="number">17</span>] - <span class="number">18</span> * Enc[<span class="number">18</span>] == <span class="number">12591</span>)</span><br><span class="line">s.add((((((<span class="number">5</span> * Enc[<span class="number">0</span>] + <span class="number">26</span> * Enc[<span class="number">1</span>] + <span class="number">8</span> * Enc[<span class="number">2</span>] + <span class="number">160</span> * Enc[<span class="number">3</span>] + <span class="number">9</span> * Enc[<span class="number">4</span>] - <span class="number">4</span> * Enc[<span class="number">5</span>]) + <span class="number">36</span> * Enc[<span class="number">6</span>] + <span class="number">6</span> * Enc[<span class="number">7</span>] - <span class="number">15</span> * Enc[<span class="number">8</span>] - <span class="number">20</span> * Enc[<span class="number">9</span>]) + <span class="number">66</span> * Enc[<span class="number">10</span>] + <span class="number">16</span> * Enc[<span class="number">11</span>] - <span class="number">1</span> * Enc[<span class="number">12</span>]) + <span class="number">690</span> * Enc[<span class="number">13</span>] - <span class="number">20</span> * Enc[<span class="number">14</span>]) + <span class="number">46</span> * Enc[<span class="number">15</span>] + <span class="number">6</span> * Enc[<span class="number">16</span>] + <span class="number">7</span> * Enc[<span class="number">17</span>] - <span class="number">18</span> * Enc[<span class="number">18</span>]) + <span class="number">19</span> * Enc[<span class="number">19</span>] == <span class="number">52041</span>)</span><br><span class="line">s.add(((((((<span class="number">29</span> * Enc[<span class="number">0</span>] - <span class="number">26</span> * Enc[<span class="number">1</span>]) + <span class="number">0</span> * Enc[<span class="number">2</span>] + <span class="number">60</span> * Enc[<span class="number">3</span>] + <span class="number">90</span> * Enc[<span class="number">4</span>] - <span class="number">4</span> * Enc[<span class="number">5</span>]) + <span class="number">6</span> * Enc[<span class="number">6</span>] + <span class="number">6</span> * Enc[<span class="number">7</span>] - <span class="number">16</span> * Enc[<span class="number">8</span>] - <span class="number">21</span> * Enc[<span class="number">9</span>]) + <span class="number">69</span> * Enc[<span class="number">10</span>] + <span class="number">6</span> * Enc[<span class="number">11</span>] - <span class="number">12</span> * Enc[<span class="number">12</span>]) + <span class="number">69</span> * Enc[<span class="number">13</span>] - <span class="number">20</span> * Enc[<span class="number">14</span>] - <span class="number">46</span> * Enc[<span class="number">15</span>]) + <span class="number">65</span> * Enc[<span class="number">16</span>] + <span class="number">0</span> * Enc[<span class="number">17</span>] - <span class="number">1</span> * Enc[<span class="number">18</span>]) + <span class="number">39</span> * Enc[<span class="number">19</span>] - <span class="number">20</span> * Enc[<span class="number">20</span>] == <span class="number">20253</span>)</span><br><span class="line">s.add((((((((<span class="number">45</span> * Enc[<span class="number">0</span>] - <span class="number">56</span> * Enc[<span class="number">1</span>]) + <span class="number">10</span> * Enc[<span class="number">2</span>] + <span class="number">650</span> * Enc[<span class="number">3</span>] - <span class="number">900</span> * Enc[<span class="number">4</span>]) + <span class="number">44</span> * Enc[<span class="number">5</span>] + <span class="number">66</span> * Enc[<span class="number">6</span>] - <span class="number">6</span> * Enc[<span class="number">7</span>] - <span class="number">6</span> * Enc[<span class="number">8</span>] - <span class="number">21</span> * Enc[<span class="number">9</span>]) + <span class="number">9</span> * Enc[<span class="number">10</span>] - <span class="number">6</span> * Enc[<span class="number">11</span>] - <span class="number">12</span> * Enc[<span class="number">12</span>]) + <span class="number">69</span> * Enc[<span class="number">13</span>] - <span class="number">2</span> * Enc[<span class="number">14</span>] - <span class="number">406</span> * Enc[<span class="number">15</span>]) + <span class="number">651</span> * Enc[<span class="number">16</span>] + <span class="number">2</span> * Enc[<span class="number">17</span>] - <span class="number">10</span> * Enc[<span class="number">18</span>]) + <span class="number">69</span> * Enc[<span class="number">19</span>] - <span class="number">0</span> * Enc[<span class="number">20</span>]) + <span class="number">21</span> * Enc[<span class="number">21</span>] == <span class="number">18768</span>)</span><br><span class="line">s.add((((((<span class="number">555</span> * Enc[<span class="number">0</span>] - <span class="number">6666</span> * Enc[<span class="number">1</span>]) + <span class="number">70</span> * Enc[<span class="number">2</span>] + <span class="number">510</span> * Enc[<span class="number">3</span>] - <span class="number">90</span> * Enc[<span class="number">4</span>]) + <span class="number">499</span> * Enc[<span class="number">5</span>] + <span class="number">66</span> * Enc[<span class="number">6</span>] - <span class="number">66</span> * Enc[<span class="number">7</span>] - <span class="number">610</span> * Enc[<span class="number">8</span>] - <span class="number">221</span> * Enc[<span class="number">9</span>]) + <span class="number">9</span> * Enc[<span class="number">10</span>] - <span class="number">23</span> * Enc[<span class="number">11</span>] - <span class="number">102</span> * Enc[<span class="number">12</span>]) + <span class="number">6</span> * Enc[<span class="number">13</span>] + <span class="number">2050</span> * Enc[<span class="number">14</span>] - <span class="number">406</span> * Enc[<span class="number">15</span>]) + <span class="number">665</span> * Enc[<span class="number">16</span>] + <span class="number">333</span> * Enc[<span class="number">17</span>] + <span class="number">100</span> * Enc[<span class="number">18</span>] + <span class="number">609</span> * Enc[<span class="number">19</span>] + <span class="number">777</span> * Enc[<span class="number">20</span>] + <span class="number">201</span> * Enc[<span class="number">21</span>] - <span class="number">22</span> * Enc[<span class="number">22</span>] == <span class="number">111844</span>)</span><br><span class="line">s.add((((((((<span class="number">1</span> * Enc[<span class="number">0</span>] - <span class="number">22</span> * Enc[<span class="number">1</span>]) + <span class="number">333</span> * Enc[<span class="number">2</span>] + <span class="number">4444</span> * Enc[<span class="number">3</span>] - <span class="number">5555</span> * Enc[<span class="number">4</span>]) + <span class="number">6666</span> * Enc[<span class="number">5</span>] - <span class="number">666</span> * Enc[<span class="number">6</span>]) + <span class="number">676</span> * Enc[<span class="number">7</span>] - <span class="number">660</span> * Enc[<span class="number">8</span>] - <span class="number">22</span> * Enc[<span class="number">9</span>]) + <span class="number">9</span> * Enc[<span class="number">10</span>] - <span class="number">73</span> * Enc[<span class="number">11</span>] - <span class="number">107</span> * Enc[<span class="number">12</span>]) + <span class="number">6</span> * Enc[<span class="number">13</span>] + <span class="number">250</span> * Enc[<span class="number">14</span>] - <span class="number">6</span> * Enc[<span class="number">15</span>]) + <span class="number">65</span> * Enc[<span class="number">16</span>] + <span class="number">39</span> * Enc[<span class="number">17</span>] + <span class="number">10</span> * Enc[<span class="number">18</span>] + <span class="number">69</span> * Enc[<span class="number">19</span>] + <span class="number">777</span> * Enc[<span class="number">20</span>] + <span class="number">201</span> * Enc[<span class="number">21</span>] - <span class="number">2</span> * Enc[<span class="number">22</span>]) + <span class="number">23</span> * Enc[<span class="number">23</span>] == <span class="number">159029</span>)</span><br><span class="line">s.add((((<span class="number">520</span> * Enc[<span class="number">0</span>] - <span class="number">222</span> * Enc[<span class="number">1</span>]) + <span class="number">333</span> * Enc[<span class="number">2</span>] + <span class="number">4</span> * Enc[<span class="number">3</span>] - <span class="number">56655</span> * Enc[<span class="number">4</span>]) + <span class="number">6666</span> * Enc[<span class="number">5</span>] + <span class="number">666</span> * Enc[<span class="number">6</span>] + <span class="number">66</span> * Enc[<span class="number">7</span>] - <span class="number">60</span> * Enc[<span class="number">8</span>] - <span class="number">220</span> * Enc[<span class="number">9</span>]) + <span class="number">99</span> * Enc[<span class="number">10</span>] + <span class="number">73</span> * Enc[<span class="number">11</span>] + <span class="number">1007</span> * Enc[<span class="number">12</span>] + <span class="number">7777</span> * Enc[<span class="number">13</span>] + <span class="number">2500</span> * Enc[<span class="number">14</span>] + <span class="number">6666</span> * Enc[<span class="number">15</span>] + <span class="number">605</span> * Enc[<span class="number">16</span>] + <span class="number">390</span> * Enc[<span class="number">17</span>] + <span class="number">100</span> * Enc[<span class="number">18</span>] + <span class="number">609</span> * Enc[<span class="number">19</span>] + <span class="number">99999</span> * Enc[<span class="number">20</span>] + <span class="number">210</span> * Enc[<span class="number">21</span>] + <span class="number">232</span> * Enc[<span class="number">22</span>] + <span class="number">23</span> * Enc[<span class="number">23</span>] - <span class="number">24</span> * Enc[<span class="number">24</span>] == <span class="number">2762025</span>)</span><br><span class="line">s.add(((((<span class="number">1323</span> * Enc[<span class="number">0</span>] - <span class="number">22</span> * Enc[<span class="number">1</span>]) + <span class="number">333</span> * Enc[<span class="number">2</span>] + <span class="number">4</span> * Enc[<span class="number">3</span>] - <span class="number">55</span> * Enc[<span class="number">4</span>]) + <span class="number">666</span> * Enc[<span class="number">5</span>] + <span class="number">666</span> * Enc[<span class="number">6</span>] + <span class="number">66</span> * Enc[<span class="number">7</span>] - <span class="number">660</span> * Enc[<span class="number">8</span>] - <span class="number">220</span> * Enc[<span class="number">9</span>]) + <span class="number">99</span> * Enc[<span class="number">10</span>] + <span class="number">3</span> * Enc[<span class="number">11</span>] + <span class="number">100</span> * Enc[<span class="number">12</span>] + <span class="number">777</span> * Enc[<span class="number">13</span>] + <span class="number">2500</span> * Enc[<span class="number">14</span>] + <span class="number">6666</span> * Enc[<span class="number">15</span>] + <span class="number">605</span> * Enc[<span class="number">16</span>] + <span class="number">390</span> * Enc[<span class="number">17</span>] + <span class="number">100</span> * Enc[<span class="number">18</span>] + <span class="number">609</span> * Enc[<span class="number">19</span>] + <span class="number">9999</span> * Enc[<span class="number">20</span>] + <span class="number">210</span> * Enc[<span class="number">21</span>] + <span class="number">232</span> * Enc[<span class="number">22</span>] + <span class="number">23</span> * Enc[<span class="number">23</span>] - <span class="number">24</span> * Enc[<span class="number">24</span>]) + <span class="number">25</span> * Enc[<span class="number">25</span>] == <span class="number">1551621</span>)</span><br><span class="line">s.add((((((<span class="number">777</span> * Enc[<span class="number">0</span>] - <span class="number">22</span> * Enc[<span class="number">1</span>]) + <span class="number">6969</span> * Enc[<span class="number">2</span>] + <span class="number">4</span> * Enc[<span class="number">3</span>] - <span class="number">55</span> * Enc[<span class="number">4</span>]) + <span class="number">666</span> * Enc[<span class="number">5</span>] - <span class="number">6</span> * Enc[<span class="number">6</span>]) + <span class="number">96</span> * Enc[<span class="number">7</span>] - <span class="number">60</span> * Enc[<span class="number">8</span>] - <span class="number">220</span> * Enc[<span class="number">9</span>]) + <span class="number">99</span> * Enc[<span class="number">10</span>] + <span class="number">3</span> * Enc[<span class="number">11</span>] + <span class="number">100</span> * Enc[<span class="number">12</span>] + <span class="number">777</span> * Enc[<span class="number">13</span>] + <span class="number">250</span> * Enc[<span class="number">14</span>] + <span class="number">666</span> * Enc[<span class="number">15</span>] + <span class="number">65</span> * Enc[<span class="number">16</span>] + <span class="number">90</span> * Enc[<span class="number">17</span>] + <span class="number">100</span> * Enc[<span class="number">18</span>] + <span class="number">609</span> * Enc[<span class="number">19</span>] + <span class="number">999</span> * Enc[<span class="number">20</span>] + <span class="number">21</span> * Enc[<span class="number">21</span>] + <span class="number">232</span> * Enc[<span class="number">22</span>] + <span class="number">23</span> * Enc[<span class="number">23</span>] - <span class="number">24</span> * Enc[<span class="number">24</span>]) + <span class="number">25</span> * Enc[<span class="number">25</span>] - <span class="number">26</span> * Enc[<span class="number">26</span>] == <span class="number">948348</span>)</span><br><span class="line">s.add(((((((<span class="number">97</span> * Enc[<span class="number">0</span>] - <span class="number">22</span> * Enc[<span class="number">1</span>]) + <span class="number">6969</span> * Enc[<span class="number">2</span>] + <span class="number">4</span> * Enc[<span class="number">3</span>] - <span class="number">56</span> * Enc[<span class="number">4</span>]) + <span class="number">96</span> * Enc[<span class="number">5</span>] - <span class="number">6</span> * Enc[<span class="number">6</span>]) + <span class="number">96</span> * Enc[<span class="number">7</span>] - <span class="number">60</span> * Enc[<span class="number">8</span>] - <span class="number">20</span> * Enc[<span class="number">9</span>]) + <span class="number">99</span> * Enc[<span class="number">10</span>] + <span class="number">3</span> * Enc[<span class="number">11</span>] + <span class="number">10</span> * Enc[<span class="number">12</span>] + <span class="number">707</span> * Enc[<span class="number">13</span>] + <span class="number">250</span> * Enc[<span class="number">14</span>] + <span class="number">666</span> * Enc[<span class="number">15</span>] + -<span class="number">9</span> * Enc[<span class="number">16</span>] + <span class="number">90</span> * Enc[<span class="number">17</span>] + -<span class="number">2</span> * Enc[<span class="number">18</span>] + <span class="number">609</span> * Enc[<span class="number">19</span>] + <span class="number">0</span> * Enc[<span class="number">20</span>] + <span class="number">21</span> * Enc[<span class="number">21</span>] + <span class="number">2</span> * Enc[<span class="number">22</span>] + <span class="number">23</span> * Enc[<span class="number">23</span>] - <span class="number">24</span> * Enc[<span class="number">24</span>]) + <span class="number">25</span> * Enc[<span class="number">25</span>] - <span class="number">26</span> * Enc[<span class="number">26</span>]) + <span class="number">27</span> * Enc[<span class="number">27</span>] == <span class="number">777044</span>)</span><br><span class="line">s.add((((((<span class="number">177</span> * Enc[<span class="number">0</span>] - <span class="number">22</span> * Enc[<span class="number">1</span>]) + <span class="number">699</span> * Enc[<span class="number">2</span>] + <span class="number">64</span> * Enc[<span class="number">3</span>] - <span class="number">56</span> * Enc[<span class="number">4</span>] - <span class="number">96</span> * Enc[<span class="number">5</span>] - <span class="number">66</span> * Enc[<span class="number">6</span>]) + <span class="number">96</span> * Enc[<span class="number">7</span>] - <span class="number">60</span> * Enc[<span class="number">8</span>] - <span class="number">20</span> * Enc[<span class="number">9</span>]) + <span class="number">99</span> * Enc[<span class="number">10</span>] + <span class="number">3</span> * Enc[<span class="number">11</span>] + <span class="number">10</span> * Enc[<span class="number">12</span>] + <span class="number">707</span> * Enc[<span class="number">13</span>] + <span class="number">250</span> * Enc[<span class="number">14</span>] + <span class="number">666</span> * Enc[<span class="number">15</span>] + -<span class="number">9</span> * Enc[<span class="number">16</span>] + <span class="number">0</span> * Enc[<span class="number">17</span>] + -<span class="number">2</span> * Enc[<span class="number">18</span>] + <span class="number">69</span> * Enc[<span class="number">19</span>] + <span class="number">0</span> * Enc[<span class="number">20</span>] + <span class="number">21</span> * Enc[<span class="number">21</span>] + <span class="number">222</span> * Enc[<span class="number">22</span>] + <span class="number">23</span> * Enc[<span class="number">23</span>] - <span class="number">224</span> * Enc[<span class="number">24</span>]) + <span class="number">25</span> * Enc[<span class="number">25</span>] - <span class="number">26</span> * Enc[<span class="number">26</span>]) + <span class="number">27</span> * Enc[<span class="number">27</span>] - <span class="number">28</span> * Enc[<span class="number">28</span>] == <span class="number">185016</span>)</span><br><span class="line">s.add(((((((<span class="number">77</span> * Enc[<span class="number">0</span>] - <span class="number">2</span> * Enc[<span class="number">1</span>]) + <span class="number">6</span> * Enc[<span class="number">2</span>] + <span class="number">6</span> * Enc[<span class="number">3</span>] - <span class="number">96</span> * Enc[<span class="number">4</span>] - <span class="number">9</span> * Enc[<span class="number">5</span>] - <span class="number">6</span> * Enc[<span class="number">6</span>]) + <span class="number">96</span> * Enc[<span class="number">7</span>] - <span class="number">0</span> * Enc[<span class="number">8</span>] - <span class="number">20</span> * Enc[<span class="number">9</span>]) + <span class="number">99</span> * Enc[<span class="number">10</span>] + <span class="number">3</span> * Enc[<span class="number">11</span>] + <span class="number">10</span> * Enc[<span class="number">12</span>] + <span class="number">707</span> * Enc[<span class="number">13</span>] + <span class="number">250</span> * Enc[<span class="number">14</span>] + <span class="number">666</span> * Enc[<span class="number">15</span>] + -<span class="number">9</span> * Enc[<span class="number">16</span>] + <span class="number">0</span> * Enc[<span class="number">17</span>] + -<span class="number">2</span> * Enc[<span class="number">18</span>] + <span class="number">9</span> * Enc[<span class="number">19</span>] + <span class="number">0</span> * Enc[<span class="number">20</span>] + <span class="number">21</span> * Enc[<span class="number">21</span>] + <span class="number">222</span> * Enc[<span class="number">22</span>] + <span class="number">23</span> * Enc[<span class="number">23</span>] - <span class="number">224</span> * Enc[<span class="number">24</span>]) + <span class="number">26</span> * Enc[<span class="number">25</span>] - -<span class="number">58</span> * Enc[<span class="number">26</span>]) + <span class="number">27</span> * Enc[<span class="number">27</span>] - <span class="number">2</span> * Enc[<span class="number">28</span>]) + <span class="number">29</span> * Enc[<span class="number">29</span>] == <span class="number">130106</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> Enc:</span><br><span class="line">    s.add(x &gt;= <span class="number">32</span>)</span><br><span class="line">    s.add(x &lt;= <span class="number">126</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line"></span><br><span class="line">    solution = [m[x].as_long() <span class="keyword">if</span> m[x] <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> Enc]</span><br><span class="line">    </span><br><span class="line">    decrypted = decrypt(solution)</span><br><span class="line">    <span class="built_in">print</span>(decrypted)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No solution found&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>HZNUCTF{ad7fa-76a7-ff6a-fffa-7f7d6a}</p>
<h2 id="XTEA"><a href="#XTEA" class="headerlink" title="XTEA"></a>XTEA</h2><p>初始化置种子 srand 了一次，然后这边里面判断是否有调试，然后又 srand 了一遍，可以忽略，种子就是 0x7E8。</p>
<p>红框处是将输入字符串四个四个一组进行翻转。</p>
<p><img src="/2025/04/13/TGCTF2025/LcFbbxbB8oLeYkxPI0acu3jPnMd.png"></p>
<p>InitKey 函数是用 rand 初始化了四个整数 Key。</p>
<p><img src="/2025/04/13/TGCTF2025/AhYVbAhIAobk91xB8j2cPWAjnad.png"></p>
<p>XTea 是魔改的，Delta 是靠用户输入传进来的，那么这边 Delta 未知就需要爆破。</p>
<p><img src="/2025/04/13/TGCTF2025/AhYXbfXq2oKkj0xtpUlc8qldnAe.png"></p>
<p>题目描述说有点 misc 味，发现附件中还有个 readme 里面的压缩包密码就是标准 Delta，<strong>2654435769 -&gt; 0x9E3779B9</strong></p>
<p>直接编写解密，使用该 Delta 就可以解出 flag。</p>
<p>解密代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span> *__fastcall <span class="title">dec</span><span class="params">(<span class="type">int</span> _a1_, <span class="type">unsigned</span> <span class="type">int</span> *_a2_, <span class="type">unsigned</span> <span class="type">int</span> *_a3_, <span class="type">unsigned</span> <span class="type">int</span> _a4_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> *result; <span class="comment">// rax</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v5;      <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v6;      <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v7;      <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">    <span class="type">int</span> i;                <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line"></span><br><span class="line">    v5 = *_a2_;</span><br><span class="line">    v6 = *_a3_;</span><br><span class="line">    v7 = <span class="number">0</span>;</span><br><span class="line">    v7 = -_a1_ * <span class="number">32</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        v6 -= (*(DWORD *)(_a4_ + <span class="number">4LL</span> * ((v7 &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>)) + v7) ^ (v5 + ((v5 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v5)));</span><br><span class="line">        v7 += _a1_;</span><br><span class="line">        v5 -= (*(DWORD *)(_a4_ + <span class="number">4LL</span> * (v7 &amp; <span class="number">3</span>)) + v7) ^ (v6 + ((v6 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v6)));</span><br><span class="line">    &#125;</span><br><span class="line">    *_a2_ = v5;</span><br><span class="line">    result = _a3_;</span><br><span class="line">    *_a3_ = v6;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> buffer[] = &#123;</span><br><span class="line">        <span class="number">0x24</span>, <span class="number">0x23</span>, <span class="number">0xCB</span>, <span class="number">0x8C</span>, <span class="number">0x1A</span>, <span class="number">0x74</span>, <span class="number">0xA7</span>, <span class="number">0x09</span>,</span><br><span class="line">        <span class="number">0x8D</span>, <span class="number">0x67</span>, <span class="number">0x3C</span>, <span class="number">0xFB</span>, <span class="number">0x79</span>, <span class="number">0x3A</span>, <span class="number">0x08</span>, <span class="number">0xF6</span>,</span><br><span class="line">        <span class="number">0x1B</span>, <span class="number">0x24</span>, <span class="number">0xCC</span>, <span class="number">0xF1</span>, <span class="number">0xF2</span>, <span class="number">0x59</span>, <span class="number">0xFA</span>, <span class="number">0x39</span>,</span><br><span class="line">        <span class="number">0xCC</span>, <span class="number">0xE1</span>, <span class="number">0xAB</span>, <span class="number">0xF2</span>, <span class="number">0x72</span>, <span class="number">0x9F</span>, <span class="number">0x18</span>, <span class="number">0x17</span>&#125;;</span><br><span class="line">    <span class="built_in">srand</span>(<span class="number">0x7e8</span>);</span><br><span class="line">    <span class="comment">// 初始化Key</span></span><br><span class="line">    <span class="type">uint32_t</span> key[<span class="number">4</span>]&#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">        key[i] = <span class="built_in">rand</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">7</span>; j &gt; <span class="number">0</span>; j--)</span><br><span class="line">        <span class="built_in">dec</span>(<span class="number">0x9E3779B9</span>, (<span class="type">unsigned</span> <span class="type">int</span> *)(buffer + (j - <span class="number">1</span>) * <span class="number">4</span>), (<span class="type">unsigned</span> <span class="type">int</span> *)(buffer + j * <span class="number">4</span>), (<span class="type">uint32_t</span>)key);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 四个字节一组进行翻转</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j += <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> tmp = *((<span class="type">char</span> *)buffer + j + <span class="number">3</span>) | (*((<span class="type">char</span> *)buffer + j + <span class="number">2</span>) &lt;&lt; <span class="number">8</span>) | (*((<span class="type">char</span> *)buffer + j + <span class="number">1</span>) &lt;&lt; <span class="number">16</span>) | (*((<span class="type">char</span> *)buffer + j) &lt;&lt; <span class="number">24</span>);</span><br><span class="line">        *(<span class="type">int</span> *)(buffer + j) = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.32s\n&quot;</span>, buffer);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>HZNUCTF{ae6-9f57-4b74-b423-98eb}</p>
<h2 id="randomsystem"><a href="#randomsystem" class="headerlink" title="randomsystem"></a>randomsystem</h2><p>第一部分是输入 64 字节大小的 0101 二进制数据，然后进行转换到 Hex（倒序），再倒序回来拆分半个字节转到 ascii 字符。</p>
<p>如：0101001001100101 第一次函数后是 0x65，0x52 然后再翻转拆分为 ascii 字符’5’,’2’,’6’,’5’。</p>
<p><img src="/2025/04/13/TGCTF2025/TxRSbtlaOoGfE9xuGS8chr7snuc.png"></p>
<p>根据判断判断出的字符可知要输入的是 52 65 56 65 52 65 53 65 的二进制数据。</p>
<p><code>0101001001100101010101100110010101010010011001010101001101100101</code></p>
<p>底下的一些加密函数里面有花指令，是基础花指令，这边不做多赘述。</p>
<p>第一部分用固定种子的随机数初始化了一个 v18 数值列表。</p>
<p><img src="/2025/04/13/TGCTF2025/E57zbT7UAouWIoxT4qbcAgg8nLg.png"></p>
<p>然后进行四次加密。</p>
<p><img src="/2025/04/13/TGCTF2025/U8vVbo1XroTRa3x38f2cevkEndh.png"></p>
<p>Enc1 是用随机数初始化的列表进行打乱输入字符串的顺序。</p>
<p><img src="/2025/04/13/TGCTF2025/F2GsbyGsLoVzmTxG1zzcg2h0nlb.png"></p>
<p>Enc2 是将输入字符串转存到另一个二维数组。</p>
<p><img src="/2025/04/13/TGCTF2025/SSyIbLzGao8Nbmx7pcNckZyhnpd.png"></p>
<p>第三个函数是将之前输入转换后的 Key 存到”Str”中，实际值就是 <strong>ReVeReSe</strong></p>
<p>第四个函数是用一个全局的矩阵乘上输入数据。</p>
<p><img src="/2025/04/13/TGCTF2025/LZg4btpJ4odkaRxmWcrco0OTngf.png"></p>
<p>最后和 Key 进行循环异或加密。</p>
<p><img src="/2025/04/13/TGCTF2025/JLNAbr3vIo0mX6xHpmZct8gmnth.png"></p>
<p>所以解密流程就是这几步的翻转，需要先计算出全局矩阵数据的逆矩阵，这一步用在线网站就可以解得。</p>
<p>Enc1 由于是对称的可以直接用原函数，Enc3 也可以直接用原函数把矩阵数据改成逆矩阵就是解密。</p>
<p>解密代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Enc1</span><span class="params">(<span class="type">char</span> *_Str_, <span class="type">int</span> *_RdList_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> v3;   <span class="comment">// [esp+D3h] [ebp-1Dh]</span></span><br><span class="line">    <span class="type">size_t</span> i;  <span class="comment">// [esp+DCh] [ebp-14h]</span></span><br><span class="line">    <span class="type">size_t</span> v5; <span class="comment">// [esp+E8h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">    v5 = <span class="number">64</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>;; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> result = v5 &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= v5 &gt;&gt; <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (_RdList_[i] &gt;= <span class="number">0</span> &amp;&amp; _RdList_[i] &lt; v5)</span><br><span class="line">        &#123;</span><br><span class="line">            v3 = _Str_[i];</span><br><span class="line">            _Str_[i] = _Str_[v5 - _RdList_[i] - <span class="number">1</span>];</span><br><span class="line">            _Str_[v5 - _RdList_[i] - <span class="number">1</span>] = v3;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Enc2</span><span class="params">(<span class="type">char</span> *_a1_, <span class="type">char</span> *_a2_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> j;  <span class="comment">// [esp+D0h] [ebp-20h]</span></span><br><span class="line">    <span class="type">int</span> i;  <span class="comment">// [esp+DCh] [ebp-14h]</span></span><br><span class="line">    <span class="type">int</span> v4; <span class="comment">// [esp+E8h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">    v4 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">8</span>; ++j)</span><br><span class="line">            *&amp;_a1_[<span class="number">32</span> * i + <span class="number">4</span> * j] = _a2_[v4++];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> dword_3FC368[] = &#123;</span><br><span class="line">    <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> inv[] = &#123;</span><br><span class="line">    <span class="number">1</span>,<span class="number">-4</span>,<span class="number">1</span>,<span class="number">-2</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">-2</span>,<span class="number">3</span>,</span><br><span class="line">    <span class="number">0</span>,<span class="number">3</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">-3</span>,<span class="number">1</span>,<span class="number">-2</span>,</span><br><span class="line">    <span class="number">0</span>,<span class="number">-2</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">-1</span>,<span class="number">2</span>,</span><br><span class="line">    <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,<span class="number">-4</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">-2</span>,<span class="number">3</span>,</span><br><span class="line">    <span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">-1</span>,</span><br><span class="line">    <span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">-1</span>,</span><br><span class="line">    <span class="number">0</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Enc3</span><span class="params">(<span class="type">int</span> *_a1_, <span class="type">char</span> *_a2_, <span class="type">char</span> *_a3_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">    <span class="type">int</span> k;      <span class="comment">// [esp+D0h] [ebp-20h]</span></span><br><span class="line">    <span class="type">int</span> j;      <span class="comment">// [esp+DCh] [ebp-14h]</span></span><br><span class="line">    <span class="type">int</span> i;      <span class="comment">// [esp+E8h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">8</span>; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            _a3_[<span class="number">32</span> * i + <span class="number">4</span> * j] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">8</span>; ++k)</span><br><span class="line">                _a3_[<span class="number">32</span> * i + <span class="number">4</span> * j] += *&amp;_a2_[<span class="number">32</span> * k + <span class="number">4</span> * j] * _a1_[<span class="number">8</span> * i + k];</span><br><span class="line">        &#125;</span><br><span class="line">        result = i + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Dec2</span><span class="params">(<span class="type">char</span> *_a1_, <span class="type">char</span> *_a2_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> j;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="type">int</span> v4;</span><br><span class="line"></span><br><span class="line">    v4 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">8</span>; ++j)</span><br><span class="line">            _a2_[v4++] = _a1_[<span class="number">32</span> * i + <span class="number">4</span> * j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> EncFlag[<span class="number">256</span>] = &#123;</span><br><span class="line">    <span class="number">0x78</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x64</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xA9</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF5</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x15</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x49</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x8B</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x56</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x7C</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6D</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xA2</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x7D</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x53</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x5B</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x33</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x07</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x67</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xA2</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xE4</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x36</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x5A</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x53</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x96</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC2</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xAF</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x58</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x9E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xFA</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xAF</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x9E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xAD</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x98</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x7B</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x9E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x24</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x82</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6D</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xC5</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC5</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xA1</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xC6</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xCF</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF4</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xCA</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xCC</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xB0</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xC1</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x9E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xB5</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x91</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x61</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x99</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x65</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x97</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// First: 0101001001100101010101100110010101010010011001010101001101100101</span></span><br><span class="line">    <span class="built_in">srand</span>(<span class="number">2025</span>);</span><br><span class="line">    <span class="type">int</span> RdList[<span class="number">0x80</span>]&#123;&#125;;</span><br><span class="line">    <span class="type">bool</span> v16 = <span class="literal">true</span>;</span><br><span class="line">    <span class="type">int</span> rd&#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            rd = <span class="built_in">rand</span>() % <span class="number">32</span>;</span><br><span class="line">            rd &amp;= <span class="number">0x8000001F</span>;</span><br><span class="line">            v16 = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; i; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (RdList[j] == rd)</span><br><span class="line">                &#123;</span><br><span class="line">                    v16 = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">while</span> (!v16);</span><br><span class="line">        RdList[i] = rd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> Key[] = <span class="string">&quot;ReVeReSe&quot;</span>;</span><br><span class="line">    <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i += <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        *(DWORD *)(EncFlag + i) ^= Key[count % <span class="number">8</span>];</span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> Buffer_Dec[<span class="number">256</span>]&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Enc3</span>((<span class="type">int</span> *)inv, (<span class="type">char</span> *)EncFlag, (<span class="type">char</span> *)Buffer_Dec);</span><br><span class="line">    <span class="built_in">Dec2</span>((<span class="type">char</span> *)Buffer_Dec, (<span class="type">char</span> *)Buffer_Dec);</span><br><span class="line">    <span class="built_in">Enc1</span>((<span class="type">char</span> *)Buffer_Dec, RdList);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;HZNUCTF&#123;%.64s&#125;\n&quot;</span>, Buffer_Dec);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>HZNUCTF{3zfb899ac5c256d-7a8r59f0tccd-4fa6b8vfd111-a44ffy4r0-6dce5679da58}</p>
<h2 id="conforand（非预期）"><a href="#conforand（非预期）" class="headerlink" title="conforand（非预期）"></a>conforand（非预期）</h2><p>从 srand 查看交叉调用，发现是当前时间戳随机，并非伪随机。</p>
<p><img src="/2025/04/13/TGCTF2025/JO8jbueEjoxwK9xUkGbc8SnBnnd.png"></p>
<p><img src="/2025/04/13/TGCTF2025/Ke3Gb4w0joy30qxDc4rcyhnHnve.png"></p>
<p>查看 rand 交叉调用，发现是再 init_sbox 函数中调用，并且只获取了一次随机数，应该是利用 rand 的数值参与 sbox 生成。</p>
<p><img src="/2025/04/13/TGCTF2025/WjGibCMxVoBZZXx1SGNcADoTnQH.png"></p>
<p>那么这边的思路就是爆破随机数，但由于是 ollvm 编译的，代码混乱，使用 d810 去混淆后也是很混乱，这边就直接不分析加密代码，采取黑盒爆破手段。</p>
<p>接下来是先检验加密对称性，运行发现是会输出加密后的内容。</p>
<p>检验步骤：</p>
<ol>
<li>随便输入一串字符串</li>
<li>断点 rand，修改 rand 返回值 rax 寄存器为 0。</li>
<li>得到输出加密内容。</li>
<li>再次输入字符串，断点在 main 的 rc4 调用处，将传参的字符串 patch 为刚刚程序输出的加密后字节数据。</li>
<li>断点 rand，修改 rand 返回值 rax 寄存器为 0。</li>
<li>观察输出加密内容是否为原字符串数据。</li>
</ol>
<p>Patch 前：</p>
<p><img src="/2025/04/13/TGCTF2025/HTtrb5ro4oKqJmxBK8Sc3IDqncb.png"></p>
<p>Patch 后：</p>
<p><img src="/2025/04/13/TGCTF2025/ThFobqnWJo9RzvxZFakcsSOdn0b.png"></p>
<p>发现是对称的，同一个 rand 值，加密函数也可以用于解密。</p>
<p><img src="/2025/04/13/TGCTF2025/RhCobLCqyo4yMKxnDXnc0oXenGb.png"></p>
<p><img src="/2025/04/13/TGCTF2025/ZOlWb1F05oujnjxbU6EcLE9snmh.png"></p>
<p>开始 Patch 原程序流程，用于爆破，将 init 函数作为 hook 跳转函数。</p>
<p>将 rand 调用改成 jmp 到 init 函数。</p>
<p><img src="/2025/04/13/TGCTF2025/L5lObHqpPo4BJlxHSL0cU3jfnhg.png"></p>
<p>init 函数头直接改成如下，将 0x4068D3 地址的数值存到 eax，然后再跳转回去，达到一个 hook 修改 rand 值结果的效果，所以我们直接加载 elf 通过修改 0x4068D3 数值，调用 rc4 加密来爆破解密密文。</p>
<p><img src="/2025/04/13/TGCTF2025/Z8d6bu82ToEbmJxAv18cRqsZnZd.png"></p>
<p>这边使用这个库加载 elf 进行调用 call：<a target="_blank" rel="noopener" href="https://github.com/IchildYu/load-elf">https://github.com/IchildYu/load-elf</a> （河豚鱼，神）</p>
<p>爆破代码（Key 是在原 init 函数中进行初始化的明文，可以直接找到）：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;include/load_elf.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;include/logger.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;include/breakpoint.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="type">const</span> <span class="type">char</span>* path = <span class="string">&quot;./conforand&quot;</span>;</span><br><span class="line">        <span class="type">void</span>* base = <span class="built_in">load_elf</span>(path);</span><br><span class="line"></span><br><span class="line">        <span class="type">__uint64_t</span>  (*rc4)(<span class="type">unsigned</span> <span class="type">char</span>*, <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>, <span class="type">unsigned</span> <span class="type">char</span>*, <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>) = <span class="built_in">get_symbol_by_offset</span>(base,<span class="number">0x413170</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> key[]=<span class="string">&quot;JustDoIt!&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">1000000</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="type">unsigned</span> <span class="type">char</span> EncData[]=&#123;<span class="number">0x83</span>,<span class="number">0x1e</span>,<span class="number">0x9c</span>,<span class="number">0x48</span>,<span class="number">0x7a</span>,<span class="number">0xfa</span>,<span class="number">0xe8</span>,<span class="number">0x88</span>,<span class="number">0x36</span>,<span class="number">0xd5</span>,<span class="number">0x0a</span>,<span class="number">0x08</span>,<span class="number">0xf6</span>,<span class="number">0xa7</span>,<span class="number">0x70</span>,<span class="number">0x0f</span>,<span class="number">0xfd</span>,<span class="number">0x67</span>,<span class="number">0xdd</span>,<span class="number">0xd4</span>,<span class="number">0x3c</span>,<span class="number">0xa7</span>,<span class="number">0xed</span>,<span class="number">0x8d</span>,<span class="number">0x51</span>,<span class="number">0x10</span>,<span class="number">0xce</span>,<span class="number">0x6a</span>,<span class="number">0x9e</span>,<span class="number">0x56</span>,<span class="number">0x57</span>,<span class="number">0x83</span>,<span class="number">0x56</span>,<span class="number">0xe7</span>,<span class="number">0x67</span>,<span class="number">0x9a</span>,<span class="number">0x67</span>,<span class="number">0x22</span>,<span class="number">0x24</span>,<span class="number">0x6e</span>,<span class="number">0xcd</span>,<span class="number">0x2f</span>&#125;;</span><br><span class="line"></span><br><span class="line">                *(<span class="type">unsigned</span> <span class="type">int</span>*)(<span class="number">0x4068D3</span>) = i;</span><br><span class="line"></span><br><span class="line">                <span class="built_in">rc4</span>(EncData,<span class="number">42</span>,key,<span class="number">9</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(EncData[<span class="number">0</span>] == <span class="string">&#x27;H&#x27;</span> </span><br><span class="line">                        &amp;&amp; EncData[<span class="number">1</span>] == <span class="string">&#x27;Z&#x27;</span></span><br><span class="line">                        &amp;&amp; EncData[<span class="number">2</span>] == <span class="string">&#x27;N&#x27;</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;Seed:%d\n&quot;</span>,i);</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;%.42s\n&quot;</span>,EncData);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/13/TGCTF2025/OnhobJQFKoZ69oxRCQycK3OZnCh.png"></p>
<p>HZNUCTF{489b88-1305-411e-b1f4-88a3070a73}</p>
<h2 id="exchange"><a href="#exchange" class="headerlink" title="exchange"></a>exchange</h2><p>输入的字符串经过 unhex、拆分字节，改变顺序。</p>
<p>如：<strong>11</strong>-&gt;<strong>0x31 0x31</strong>-&gt;<strong>‘3’ ‘1’ ‘3’ ‘1’</strong>-&gt;<strong>‘3’ ‘3’ ‘1’ ‘1’</strong></p>
<p>是两个字节为一组进行变换的。</p>
<p>然后调用了加密函数，第一个参数传入变换后的输入，第二个参数是”HZNUCTF{“字串。</p>
<p><img src="/2025/04/13/TGCTF2025/IpzebVjiWokSsPxbqbvcFPuqnpc.png"></p>
<p>主加密函数，发现只走这上面的部分。</p>
<p><img src="/2025/04/13/TGCTF2025/V80kbgNWwoxANlxB4YMcWunPnhb.png"></p>
<p>第一个函数是用”HZNUCTF{“字串生成的一串数据，64 个整数数据。</p>
<p>第二个函数是将输入数据 8 个字节为一组进行加密。</p>
<p>加密流程：</p>
<ol>
<li>4 个字节为一组进行翻转</li>
<li>8 字节加密</li>
<li>4 个字节为一组进行翻转</li>
</ol>
<p><img src="/2025/04/13/TGCTF2025/Li3ibSsH4oXPrgxpuE1cXiC3nWf.png"></p>
<p>加密可以看出是 DES 加密算法，是对称的，key 就是刚刚生成的 64 个整数数值的前 32 个，那么可以知道后 32 个就是解密用的 key，直接 copy 该函数，解密时用生成的后 32 个整数 key 即可解密。</p>
<p><img src="/2025/04/13/TGCTF2025/S3IQbDNbQoHoZAxTqEycpqhpnJf.png"></p>
<p>解密代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s1[<span class="number">64</span>] = &#123;</span><br><span class="line">    <span class="number">0x01010400</span>, <span class="number">0x00000000</span>, <span class="number">0x00010000</span>, <span class="number">0x01010404</span>, <span class="number">0x01010004</span>, <span class="number">0x00010404</span>, <span class="number">0x00000004</span>, <span class="number">0x00010000</span>,</span><br><span class="line">    <span class="number">0x00000400</span>, <span class="number">0x01010400</span>, <span class="number">0x01010404</span>, <span class="number">0x00000400</span>, <span class="number">0x01000404</span>, <span class="number">0x01010004</span>, <span class="number">0x01000000</span>, <span class="number">0x00000004</span>,</span><br><span class="line">    <span class="number">0x00000404</span>, <span class="number">0x01000400</span>, <span class="number">0x01000400</span>, <span class="number">0x00010400</span>, <span class="number">0x00010400</span>, <span class="number">0x01010000</span>, <span class="number">0x01010000</span>, <span class="number">0x01000404</span>,</span><br><span class="line">    <span class="number">0x00010004</span>, <span class="number">0x01000004</span>, <span class="number">0x01000004</span>, <span class="number">0x00010004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000404</span>, <span class="number">0x00010404</span>, <span class="number">0x01000000</span>,</span><br><span class="line">    <span class="number">0x00010000</span>, <span class="number">0x01010404</span>, <span class="number">0x00000004</span>, <span class="number">0x01010000</span>, <span class="number">0x01010400</span>, <span class="number">0x01000000</span>, <span class="number">0x01000000</span>, <span class="number">0x00000400</span>,</span><br><span class="line">    <span class="number">0x01010004</span>, <span class="number">0x00010000</span>, <span class="number">0x00010400</span>, <span class="number">0x01000004</span>, <span class="number">0x00000400</span>, <span class="number">0x00000004</span>, <span class="number">0x01000404</span>, <span class="number">0x00010404</span>,</span><br><span class="line">    <span class="number">0x01010404</span>, <span class="number">0x00010004</span>, <span class="number">0x01010000</span>, <span class="number">0x01000404</span>, <span class="number">0x01000004</span>, <span class="number">0x00000404</span>, <span class="number">0x00010404</span>, <span class="number">0x01010400</span>,</span><br><span class="line">    <span class="number">0x00000404</span>, <span class="number">0x01000400</span>, <span class="number">0x01000400</span>, <span class="number">0x00000000</span>, <span class="number">0x00010004</span>, <span class="number">0x00010400</span>, <span class="number">0x00000000</span>, <span class="number">0x01010004</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s2[<span class="number">64</span>] = &#123;</span><br><span class="line">    <span class="number">0x80108020</span>, <span class="number">0x80008000</span>, <span class="number">0x00008000</span>, <span class="number">0x00108020</span>, <span class="number">0x00100000</span>, <span class="number">0x00000020</span>, <span class="number">0x80100020</span>, <span class="number">0x80008020</span>,</span><br><span class="line">    <span class="number">0x80000020</span>, <span class="number">0x80108020</span>, <span class="number">0x80108000</span>, <span class="number">0x80000000</span>, <span class="number">0x80008000</span>, <span class="number">0x00100000</span>, <span class="number">0x00000020</span>, <span class="number">0x80100020</span>,</span><br><span class="line">    <span class="number">0x00108000</span>, <span class="number">0x00100020</span>, <span class="number">0x80008020</span>, <span class="number">0x00000000</span>, <span class="number">0x80000000</span>, <span class="number">0x00008000</span>, <span class="number">0x00108020</span>, <span class="number">0x80100000</span>,</span><br><span class="line">    <span class="number">0x00100020</span>, <span class="number">0x80000020</span>, <span class="number">0x00000000</span>, <span class="number">0x00108000</span>, <span class="number">0x00008020</span>, <span class="number">0x80108000</span>, <span class="number">0x80100000</span>, <span class="number">0x00008020</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00108020</span>, <span class="number">0x80100020</span>, <span class="number">0x00100000</span>, <span class="number">0x80008020</span>, <span class="number">0x80100000</span>, <span class="number">0x80108000</span>, <span class="number">0x00008000</span>,</span><br><span class="line">    <span class="number">0x80100000</span>, <span class="number">0x80008000</span>, <span class="number">0x00000020</span>, <span class="number">0x80108020</span>, <span class="number">0x00108020</span>, <span class="number">0x00000020</span>, <span class="number">0x00008000</span>, <span class="number">0x80000000</span>,</span><br><span class="line">    <span class="number">0x00008020</span>, <span class="number">0x80108000</span>, <span class="number">0x00100000</span>, <span class="number">0x80000020</span>, <span class="number">0x00100020</span>, <span class="number">0x80008020</span>, <span class="number">0x80000020</span>, <span class="number">0x00100020</span>,</span><br><span class="line">    <span class="number">0x00108000</span>, <span class="number">0x00000000</span>, <span class="number">0x80008000</span>, <span class="number">0x00008020</span>, <span class="number">0x80000000</span>, <span class="number">0x80100020</span>, <span class="number">0x80108020</span>, <span class="number">0x00108000</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s3[<span class="number">64</span>] = &#123;</span><br><span class="line">    <span class="number">0x00000208</span>, <span class="number">0x08020200</span>, <span class="number">0x00000000</span>, <span class="number">0x08020008</span>, <span class="number">0x08000200</span>, <span class="number">0x00000000</span>, <span class="number">0x00020208</span>, <span class="number">0x08000200</span>,</span><br><span class="line">    <span class="number">0x00020008</span>, <span class="number">0x08000008</span>, <span class="number">0x08000008</span>, <span class="number">0x00020000</span>, <span class="number">0x08020208</span>, <span class="number">0x00020008</span>, <span class="number">0x08020000</span>, <span class="number">0x00000208</span>,</span><br><span class="line">    <span class="number">0x08000000</span>, <span class="number">0x00000008</span>, <span class="number">0x08020200</span>, <span class="number">0x00000200</span>, <span class="number">0x00020200</span>, <span class="number">0x08020000</span>, <span class="number">0x08020008</span>, <span class="number">0x00020208</span>,</span><br><span class="line">    <span class="number">0x08000208</span>, <span class="number">0x00020200</span>, <span class="number">0x00020000</span>, <span class="number">0x08000208</span>, <span class="number">0x00000008</span>, <span class="number">0x08020208</span>, <span class="number">0x00000200</span>, <span class="number">0x08000000</span>,</span><br><span class="line">    <span class="number">0x08020200</span>, <span class="number">0x08000000</span>, <span class="number">0x00020008</span>, <span class="number">0x00000208</span>, <span class="number">0x00020000</span>, <span class="number">0x08020200</span>, <span class="number">0x08000200</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000200</span>, <span class="number">0x00020008</span>, <span class="number">0x08020208</span>, <span class="number">0x08000200</span>, <span class="number">0x08000008</span>, <span class="number">0x00000200</span>, <span class="number">0x00000000</span>, <span class="number">0x08020008</span>,</span><br><span class="line">    <span class="number">0x08000208</span>, <span class="number">0x00020000</span>, <span class="number">0x08000000</span>, <span class="number">0x08020208</span>, <span class="number">0x00000008</span>, <span class="number">0x00020208</span>, <span class="number">0x00020200</span>, <span class="number">0x08000008</span>,</span><br><span class="line">    <span class="number">0x08020000</span>, <span class="number">0x08000208</span>, <span class="number">0x00000208</span>, <span class="number">0x08020000</span>, <span class="number">0x00020208</span>, <span class="number">0x00000008</span>, <span class="number">0x08020008</span>, <span class="number">0x00020200</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s4[<span class="number">64</span>] = &#123;</span><br><span class="line">    <span class="number">0x00802001</span>, <span class="number">0x00002081</span>, <span class="number">0x00002081</span>, <span class="number">0x00000080</span>, <span class="number">0x00802080</span>, <span class="number">0x00800081</span>, <span class="number">0x00800001</span>, <span class="number">0x00002001</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00802000</span>, <span class="number">0x00802000</span>, <span class="number">0x00802081</span>, <span class="number">0x00000081</span>, <span class="number">0x00000000</span>, <span class="number">0x00800080</span>, <span class="number">0x00800001</span>,</span><br><span class="line">    <span class="number">0x00000001</span>, <span class="number">0x00002000</span>, <span class="number">0x00800000</span>, <span class="number">0x00802001</span>, <span class="number">0x00000080</span>, <span class="number">0x00800000</span>, <span class="number">0x00002001</span>, <span class="number">0x00002080</span>,</span><br><span class="line">    <span class="number">0x00800081</span>, <span class="number">0x00000001</span>, <span class="number">0x00002080</span>, <span class="number">0x00800080</span>, <span class="number">0x00002000</span>, <span class="number">0x00802080</span>, <span class="number">0x00802081</span>, <span class="number">0x00000081</span>,</span><br><span class="line">    <span class="number">0x00800080</span>, <span class="number">0x00800001</span>, <span class="number">0x00802000</span>, <span class="number">0x00802081</span>, <span class="number">0x00000081</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00802000</span>,</span><br><span class="line">    <span class="number">0x00002080</span>, <span class="number">0x00800080</span>, <span class="number">0x00800081</span>, <span class="number">0x00000001</span>, <span class="number">0x00802001</span>, <span class="number">0x00002081</span>, <span class="number">0x00002081</span>, <span class="number">0x00000080</span>,</span><br><span class="line">    <span class="number">0x00802081</span>, <span class="number">0x00000081</span>, <span class="number">0x00000001</span>, <span class="number">0x00002000</span>, <span class="number">0x00800001</span>, <span class="number">0x00002001</span>, <span class="number">0x00802080</span>, <span class="number">0x00800081</span>,</span><br><span class="line">    <span class="number">0x00002001</span>, <span class="number">0x00002080</span>, <span class="number">0x00800000</span>, <span class="number">0x00802001</span>, <span class="number">0x00000080</span>, <span class="number">0x00800000</span>, <span class="number">0x00002000</span>, <span class="number">0x00802080</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s5[<span class="number">64</span>] = &#123;</span><br><span class="line">    <span class="number">0x00000100</span>, <span class="number">0x02080100</span>, <span class="number">0x02080000</span>, <span class="number">0x42000100</span>, <span class="number">0x00080000</span>, <span class="number">0x00000100</span>, <span class="number">0x40000000</span>, <span class="number">0x02080000</span>,</span><br><span class="line">    <span class="number">0x40080100</span>, <span class="number">0x00080000</span>, <span class="number">0x02000100</span>, <span class="number">0x40080100</span>, <span class="number">0x42000100</span>, <span class="number">0x42080000</span>, <span class="number">0x00080100</span>, <span class="number">0x40000000</span>,</span><br><span class="line">    <span class="number">0x02000000</span>, <span class="number">0x40080000</span>, <span class="number">0x40080000</span>, <span class="number">0x00000000</span>, <span class="number">0x40000100</span>, <span class="number">0x42080100</span>, <span class="number">0x42080100</span>, <span class="number">0x02000100</span>,</span><br><span class="line">    <span class="number">0x42080000</span>, <span class="number">0x40000100</span>, <span class="number">0x00000000</span>, <span class="number">0x42000000</span>, <span class="number">0x02080100</span>, <span class="number">0x02000000</span>, <span class="number">0x42000000</span>, <span class="number">0x00080100</span>,</span><br><span class="line">    <span class="number">0x00080000</span>, <span class="number">0x42000100</span>, <span class="number">0x00000100</span>, <span class="number">0x02000000</span>, <span class="number">0x40000000</span>, <span class="number">0x02080000</span>, <span class="number">0x42000100</span>, <span class="number">0x40080100</span>,</span><br><span class="line">    <span class="number">0x02000100</span>, <span class="number">0x40000000</span>, <span class="number">0x42080000</span>, <span class="number">0x02080100</span>, <span class="number">0x40080100</span>, <span class="number">0x00000100</span>, <span class="number">0x02000000</span>, <span class="number">0x42080000</span>,</span><br><span class="line">    <span class="number">0x42080100</span>, <span class="number">0x00080100</span>, <span class="number">0x42000000</span>, <span class="number">0x42080100</span>, <span class="number">0x02080000</span>, <span class="number">0x00000000</span>, <span class="number">0x40080000</span>, <span class="number">0x42000000</span>,</span><br><span class="line">    <span class="number">0x00080100</span>, <span class="number">0x02000100</span>, <span class="number">0x40000100</span>, <span class="number">0x00080000</span>, <span class="number">0x00000000</span>, <span class="number">0x40080000</span>, <span class="number">0x02080100</span>, <span class="number">0x40000100</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s6[<span class="number">64</span>] = &#123;</span><br><span class="line">    <span class="number">0x20000010</span>, <span class="number">0x20400000</span>, <span class="number">0x00004000</span>, <span class="number">0x20404010</span>, <span class="number">0x20400000</span>, <span class="number">0x00000010</span>, <span class="number">0x20404010</span>, <span class="number">0x00400000</span>,</span><br><span class="line">    <span class="number">0x20004000</span>, <span class="number">0x00404010</span>, <span class="number">0x00400000</span>, <span class="number">0x20000010</span>, <span class="number">0x00400010</span>, <span class="number">0x20004000</span>, <span class="number">0x20000000</span>, <span class="number">0x00004010</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00400010</span>, <span class="number">0x20004010</span>, <span class="number">0x00004000</span>, <span class="number">0x00404000</span>, <span class="number">0x20004010</span>, <span class="number">0x00000010</span>, <span class="number">0x20400010</span>,</span><br><span class="line">    <span class="number">0x20400010</span>, <span class="number">0x00000000</span>, <span class="number">0x00404010</span>, <span class="number">0x20404000</span>, <span class="number">0x00004010</span>, <span class="number">0x00404000</span>, <span class="number">0x20404000</span>, <span class="number">0x20000000</span>,</span><br><span class="line">    <span class="number">0x20004000</span>, <span class="number">0x00000010</span>, <span class="number">0x20400010</span>, <span class="number">0x00404000</span>, <span class="number">0x20404010</span>, <span class="number">0x00400000</span>, <span class="number">0x00004010</span>, <span class="number">0x20000010</span>,</span><br><span class="line">    <span class="number">0x00400000</span>, <span class="number">0x20004000</span>, <span class="number">0x20000000</span>, <span class="number">0x00004010</span>, <span class="number">0x20000010</span>, <span class="number">0x20404010</span>, <span class="number">0x00404000</span>, <span class="number">0x20400000</span>,</span><br><span class="line">    <span class="number">0x00404010</span>, <span class="number">0x20404000</span>, <span class="number">0x00000000</span>, <span class="number">0x20400010</span>, <span class="number">0x00000010</span>, <span class="number">0x00004000</span>, <span class="number">0x20400000</span>, <span class="number">0x00404010</span>,</span><br><span class="line">    <span class="number">0x00004000</span>, <span class="number">0x00400010</span>, <span class="number">0x20004010</span>, <span class="number">0x00000000</span>, <span class="number">0x20404000</span>, <span class="number">0x20000000</span>, <span class="number">0x00400010</span>, <span class="number">0x20004010</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s7[<span class="number">64</span>] = &#123;</span><br><span class="line">    <span class="number">0x00200000</span>, <span class="number">0x04200002</span>, <span class="number">0x04000802</span>, <span class="number">0x00000000</span>, <span class="number">0x00000800</span>, <span class="number">0x04000802</span>, <span class="number">0x00200802</span>, <span class="number">0x04200800</span>,</span><br><span class="line">    <span class="number">0x04200802</span>, <span class="number">0x00200000</span>, <span class="number">0x00000000</span>, <span class="number">0x04000002</span>, <span class="number">0x00000002</span>, <span class="number">0x04000000</span>, <span class="number">0x04200002</span>, <span class="number">0x00000802</span>,</span><br><span class="line">    <span class="number">0x04000800</span>, <span class="number">0x00200802</span>, <span class="number">0x00200002</span>, <span class="number">0x04000800</span>, <span class="number">0x04000002</span>, <span class="number">0x04200000</span>, <span class="number">0x04200800</span>, <span class="number">0x00200002</span>,</span><br><span class="line">    <span class="number">0x04200000</span>, <span class="number">0x00000800</span>, <span class="number">0x00000802</span>, <span class="number">0x04200802</span>, <span class="number">0x00200800</span>, <span class="number">0x00000002</span>, <span class="number">0x04000000</span>, <span class="number">0x00200800</span>,</span><br><span class="line">    <span class="number">0x04000000</span>, <span class="number">0x00200800</span>, <span class="number">0x00200000</span>, <span class="number">0x04000802</span>, <span class="number">0x04000802</span>, <span class="number">0x04200002</span>, <span class="number">0x04200002</span>, <span class="number">0x00000002</span>,</span><br><span class="line">    <span class="number">0x00200002</span>, <span class="number">0x04000000</span>, <span class="number">0x04000800</span>, <span class="number">0x00200000</span>, <span class="number">0x04200800</span>, <span class="number">0x00000802</span>, <span class="number">0x00200802</span>, <span class="number">0x04200800</span>,</span><br><span class="line">    <span class="number">0x00000802</span>, <span class="number">0x04000002</span>, <span class="number">0x04200802</span>, <span class="number">0x04200000</span>, <span class="number">0x00200800</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x04200802</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x00200802</span>, <span class="number">0x04200000</span>, <span class="number">0x00000800</span>, <span class="number">0x04000002</span>, <span class="number">0x04000800</span>, <span class="number">0x00000800</span>, <span class="number">0x00200002</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s8[<span class="number">64</span>] = &#123;</span><br><span class="line">    <span class="number">0x10001040</span>, <span class="number">0x00001000</span>, <span class="number">0x00040000</span>, <span class="number">0x10041040</span>, <span class="number">0x10000000</span>, <span class="number">0x10001040</span>, <span class="number">0x00000040</span>, <span class="number">0x10000000</span>,</span><br><span class="line">    <span class="number">0x00040040</span>, <span class="number">0x10040000</span>, <span class="number">0x10041040</span>, <span class="number">0x00041000</span>, <span class="number">0x10041000</span>, <span class="number">0x00041040</span>, <span class="number">0x00001000</span>, <span class="number">0x00000040</span>,</span><br><span class="line">    <span class="number">0x10040000</span>, <span class="number">0x10000040</span>, <span class="number">0x10001000</span>, <span class="number">0x00001040</span>, <span class="number">0x00041000</span>, <span class="number">0x00040040</span>, <span class="number">0x10040040</span>, <span class="number">0x10041000</span>,</span><br><span class="line">    <span class="number">0x00001040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x10040040</span>, <span class="number">0x10000040</span>, <span class="number">0x10001000</span>, <span class="number">0x00041040</span>, <span class="number">0x00040000</span>,</span><br><span class="line">    <span class="number">0x00041040</span>, <span class="number">0x00040000</span>, <span class="number">0x10041000</span>, <span class="number">0x00001000</span>, <span class="number">0x00000040</span>, <span class="number">0x10040040</span>, <span class="number">0x00001000</span>, <span class="number">0x00041040</span>,</span><br><span class="line">    <span class="number">0x10001000</span>, <span class="number">0x00000040</span>, <span class="number">0x10000040</span>, <span class="number">0x10040000</span>, <span class="number">0x10040040</span>, <span class="number">0x10000000</span>, <span class="number">0x00040000</span>, <span class="number">0x10001040</span>,</span><br><span class="line">    <span class="number">0x00000000</span>, <span class="number">0x10041040</span>, <span class="number">0x00040040</span>, <span class="number">0x10000040</span>, <span class="number">0x10040000</span>, <span class="number">0x10001000</span>, <span class="number">0x10001040</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x10041040</span>, <span class="number">0x00041000</span>, <span class="number">0x00041000</span>, <span class="number">0x00001040</span>, <span class="number">0x00001040</span>, <span class="number">0x00040040</span>, <span class="number">0x10000000</span>, <span class="number">0x10041000</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">short</span> word_7FF65FC70900[<span class="number">8</span>] = &#123;</span><br><span class="line">    <span class="number">0x0080</span>, <span class="number">0x0040</span>, <span class="number">0x0020</span>, <span class="number">0x0010</span>, <span class="number">0x0008</span>, <span class="number">0x0004</span>, <span class="number">0x0002</span>, <span class="number">0x0001</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> dword_7FF65FC70910[<span class="number">24</span>] = &#123;</span><br><span class="line">    <span class="number">0x00800000</span>, <span class="number">0x00400000</span>, <span class="number">0x00200000</span>, <span class="number">0x00100000</span>, <span class="number">0x00080000</span>, <span class="number">0x00040000</span>, <span class="number">0x00020000</span>, <span class="number">0x00010000</span>,</span><br><span class="line">    <span class="number">0x00008000</span>, <span class="number">0x00004000</span>, <span class="number">0x00002000</span>, <span class="number">0x00001000</span>, <span class="number">0x00000800</span>, <span class="number">0x00000400</span>, <span class="number">0x00000200</span>, <span class="number">0x00000100</span>,</span><br><span class="line">    <span class="number">0x00000080</span>, <span class="number">0x00000040</span>, <span class="number">0x00000020</span>, <span class="number">0x00000010</span>, <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000002</span>, <span class="number">0x00000001</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> byte_7FF65FC70970[<span class="number">56</span>] = &#123;</span><br><span class="line">    <span class="number">0x38</span>, <span class="number">0x30</span>, <span class="number">0x28</span>, <span class="number">0x20</span>, <span class="number">0x18</span>, <span class="number">0x10</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x39</span>, <span class="number">0x31</span>, <span class="number">0x29</span>, <span class="number">0x21</span>, <span class="number">0x19</span>, <span class="number">0x11</span>, <span class="number">0x09</span>, <span class="number">0x01</span>,</span><br><span class="line">    <span class="number">0x3A</span>, <span class="number">0x32</span>, <span class="number">0x2A</span>, <span class="number">0x22</span>, <span class="number">0x1A</span>, <span class="number">0x12</span>, <span class="number">0x0A</span>, <span class="number">0x02</span>, <span class="number">0x3B</span>, <span class="number">0x33</span>, <span class="number">0x2B</span>, <span class="number">0x23</span>, <span class="number">0x3E</span>, <span class="number">0x36</span>, <span class="number">0x2E</span>, <span class="number">0x26</span>,</span><br><span class="line">    <span class="number">0x1E</span>, <span class="number">0x16</span>, <span class="number">0x0E</span>, <span class="number">0x06</span>, <span class="number">0x3D</span>, <span class="number">0x35</span>, <span class="number">0x2D</span>, <span class="number">0x25</span>, <span class="number">0x1D</span>, <span class="number">0x15</span>, <span class="number">0x0D</span>, <span class="number">0x05</span>, <span class="number">0x3C</span>, <span class="number">0x34</span>, <span class="number">0x2C</span>, <span class="number">0x24</span>,</span><br><span class="line">    <span class="number">0x1C</span>, <span class="number">0x14</span>, <span class="number">0x0C</span>, <span class="number">0x04</span>, <span class="number">0x1B</span>, <span class="number">0x13</span>, <span class="number">0x0B</span>, <span class="number">0x03</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> byte_7FF65FC709A8[<span class="number">16</span>] = &#123;</span><br><span class="line">    <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0x0D</span>, <span class="number">0x0E</span>, <span class="number">0x0F</span>, <span class="number">0x10</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> __fastcall <span class="title">des_encrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *_a1_, DWORD *_a2_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> left = _a1_[<span class="number">1</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> right = _a1_[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> temp = (left ^ (right &gt;&gt; <span class="number">4</span>)) &amp; <span class="number">0xF0F0F0F</span>;</span><br><span class="line">    left = temp ^ left;</span><br><span class="line">    right = (temp &lt;&lt; <span class="number">4</span>) ^ right;</span><br><span class="line"></span><br><span class="line">    temp = (left ^ (right &gt;&gt; <span class="number">16</span>)) &amp; <span class="number">0x0000FFFF</span>;</span><br><span class="line">    left = temp ^ left;</span><br><span class="line">    right = (temp &lt;&lt; <span class="number">16</span>) ^ right;</span><br><span class="line"></span><br><span class="line">    temp = (right ^ (left &gt;&gt; <span class="number">2</span>)) &amp; <span class="number">0x33333333</span>;</span><br><span class="line">    right = temp ^ right;</span><br><span class="line">    left = (temp &lt;&lt; <span class="number">2</span>) ^ left;</span><br><span class="line"></span><br><span class="line">    temp = (right ^ (left &gt;&gt; <span class="number">8</span>)) &amp; <span class="number">0x00FF00FF</span>;</span><br><span class="line">    right = temp ^ right;</span><br><span class="line">    left = (((temp &lt;&lt; <span class="number">8</span>) ^ left) &gt;&gt; <span class="number">31</span>) | (<span class="number">2</span> * ((temp &lt;&lt; <span class="number">8</span>) ^ left));</span><br><span class="line"></span><br><span class="line">    temp = (left ^ right) &amp; <span class="number">0xAAAAAAAA</span>;</span><br><span class="line">    left = temp ^ left;</span><br><span class="line">    right = ((temp ^ right) &gt;&gt; <span class="number">31</span>) | (<span class="number">2</span> * (temp ^ right));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        temp = *_a2_++ ^ ((left &gt;&gt; <span class="number">4</span>) | (left &lt;&lt; <span class="number">28</span>));</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">int</span> result1 = s1[(temp &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                               s3[(temp &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                               s5[(temp &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                               s7[temp &amp; <span class="number">0x3F</span>];</span><br><span class="line">        temp = *_a2_++ ^ left;</span><br><span class="line"></span><br><span class="line">        right ^= s2[(temp &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                 s4[(temp &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                 s6[(temp &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                 s8[temp &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                 result1;</span><br><span class="line"></span><br><span class="line">        temp = *_a2_++ ^ ((right &gt;&gt; <span class="number">4</span>) | (right &lt;&lt; <span class="number">28</span>));</span><br><span class="line">        result1 = s1[(temp &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                  s3[(temp &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                  s5[(temp &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                  s7[temp &amp; <span class="number">0x3F</span>];</span><br><span class="line"></span><br><span class="line">        temp = *_a2_++ ^ right;</span><br><span class="line">        left ^= s2[(temp &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                s4[(temp &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                s6[(temp &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                s8[temp &amp; <span class="number">0x3F</span>] |</span><br><span class="line">                result1;</span><br><span class="line">    &#125;</span><br><span class="line">    left = (left &gt;&gt; <span class="number">1</span>) | (left &lt;&lt; <span class="number">31</span>);</span><br><span class="line">    temp = (left ^ right) &amp; <span class="number">0xAAAAAAAA</span>;</span><br><span class="line">    left = temp ^ left;</span><br><span class="line">    right = ((temp ^ right) &gt;&gt; <span class="number">1</span>) | ((temp ^ right) &lt;&lt; <span class="number">31</span>);</span><br><span class="line"></span><br><span class="line">    temp = (left ^ (right &gt;&gt; <span class="number">8</span>)) &amp; <span class="number">0xFF00FF</span>;</span><br><span class="line">    left = temp ^ left;</span><br><span class="line">    right = (temp &lt;&lt; <span class="number">8</span>) ^ right;</span><br><span class="line"></span><br><span class="line">    temp = (left ^ (right &gt;&gt; <span class="number">2</span>)) &amp; <span class="number">0x33333333</span>;</span><br><span class="line">    left = temp ^ left;</span><br><span class="line">    right = (temp &lt;&lt; <span class="number">2</span>) ^ right;</span><br><span class="line"></span><br><span class="line">    temp = (right ^ (left &gt;&gt; <span class="number">16</span>)) &amp; <span class="number">0xFFFF</span>;</span><br><span class="line">    right = temp ^ right;</span><br><span class="line">    left = (temp &lt;&lt; <span class="number">16</span>) ^ left;</span><br><span class="line"></span><br><span class="line">    temp = (right ^ (left &gt;&gt; <span class="number">4</span>)) &amp; <span class="number">0x0F0F0F0F</span>;</span><br><span class="line"></span><br><span class="line">    _a1_[<span class="number">0</span>] = (temp &lt;&lt; <span class="number">4</span>) ^ left;</span><br><span class="line">    _a1_[<span class="number">1</span>] = temp ^ right;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">64</span>] = &#123;</span><br><span class="line">        <span class="number">0x2C0B3C36</span>, <span class="number">0x09221A0A</span>, <span class="number">0x2829051D</span>, <span class="number">0x09123B0D</span>, <span class="number">0x2C091B18</span>, <span class="number">0x0512011F</span>, <span class="number">0x09292E17</span>, <span class="number">0x07122920</span>,</span><br><span class="line">        <span class="number">0x090D1703</span>, <span class="number">0x0514372E</span>, <span class="number">0x0915123C</span>, <span class="number">0x27100E27</span>, <span class="number">0x01050927</span>, <span class="number">0x25150D29</span>, <span class="number">0x13151F32</span>, <span class="number">0x24112618</span>,</span><br><span class="line">        <span class="number">0x03052031</span>, <span class="number">0x34312B37</span>, <span class="number">0x13043A05</span>, <span class="number">0x3C19151B</span>, <span class="number">0x23063B3E</span>, <span class="number">0x34293830</span>, <span class="number">0x03062108</span>, <span class="number">0x380B3F2A</span>,</span><br><span class="line">        <span class="number">0x260E063D</span>, <span class="number">0x3009141B</span>, <span class="number">0x0E223D3D</span>, <span class="number">0x300B0124</span>, <span class="number">0x062A1700</span>, <span class="number">0x11093D14</span>, <span class="number">0x0E22262B</span>, <span class="number">0x1208083E</span>,</span><br><span class="line">        <span class="number">0x0E22262B</span>, <span class="number">0x1208083E</span>, <span class="number">0x062A1700</span>, <span class="number">0x11093D14</span>, <span class="number">0x0E223D3D</span>, <span class="number">0x300B0124</span>, <span class="number">0x260E063D</span>, <span class="number">0x3009141B</span>,</span><br><span class="line">        <span class="number">0x03062108</span>, <span class="number">0x380B3F2A</span>, <span class="number">0x23063B3E</span>, <span class="number">0x34293830</span>, <span class="number">0x13043A05</span>, <span class="number">0x3C19151B</span>, <span class="number">0x03052031</span>, <span class="number">0x34312B37</span>,</span><br><span class="line">        <span class="number">0x13151F32</span>, <span class="number">0x24112618</span>, <span class="number">0x01050927</span>, <span class="number">0x25150D29</span>, <span class="number">0x0915123C</span>, <span class="number">0x27100E27</span>, <span class="number">0x090D1703</span>, <span class="number">0x0514372E</span>,</span><br><span class="line">        <span class="number">0x09292E17</span>, <span class="number">0x07122920</span>, <span class="number">0x2C091B18</span>, <span class="number">0x0512011F</span>, <span class="number">0x2829051D</span>, <span class="number">0x09123B0D</span>, <span class="number">0x2C0B3C36</span>, <span class="number">0x09221A0A</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> data[<span class="number">64</span>] = &#123;</span><br><span class="line">        <span class="number">0x00000084</span>, <span class="number">0x0000008B</span>, <span class="number">0x00000003</span>, <span class="number">0x00000022</span>, <span class="number">0x00000014</span>, <span class="number">0x000000BE</span>, <span class="number">0x000000DF</span>, <span class="number">0x00000075</span>,</span><br><span class="line">        <span class="number">0x000000B3</span>, <span class="number">0x000000D5</span>, <span class="number">0x00000076</span>, <span class="number">0x0000006F</span>, <span class="number">0x000000CD</span>, <span class="number">0x0000002A</span>, <span class="number">0x0000005D</span>, <span class="number">0x000000D7</span>,</span><br><span class="line">        <span class="number">0x0000004D</span>, <span class="number">0x000000B2</span>, <span class="number">0x0000005F</span>, <span class="number">0x00000006</span>, <span class="number">0x00000098</span>, <span class="number">0x0000009D</span>, <span class="number">0x0000003E</span>, <span class="number">0x000000A8</span>,</span><br><span class="line">        <span class="number">0x000000F7</span>, <span class="number">0x00000023</span>, <span class="number">0x000000F2</span>, <span class="number">0x0000008B</span>, <span class="number">0x000000F2</span>, <span class="number">0x00000054</span>, <span class="number">0x00000065</span>, <span class="number">0x0000007A</span>,</span><br><span class="line">        <span class="number">0x00000020</span>, <span class="number">0x000000C0</span>, <span class="number">0x00000087</span>, <span class="number">0x00000055</span>, <span class="number">0x000000D6</span>, <span class="number">0x0000003B</span>, <span class="number">0x00000046</span>, <span class="number">0x0000003D</span>,</span><br><span class="line">        <span class="number">0x000000F7</span>, <span class="number">0x000000B2</span>, <span class="number">0x0000007A</span>, <span class="number">0x0000009D</span>, <span class="number">0x000000C2</span>, <span class="number">0x000000CF</span>, <span class="number">0x0000001A</span>, <span class="number">0x000000AE</span>,</span><br><span class="line">        <span class="number">0x00000016</span>, <span class="number">0x000000C7</span>, <span class="number">0x00000015</span>, <span class="number">0x00000030</span>, <span class="number">0x0000008E</span>, <span class="number">0x000000FD</span>, <span class="number">0x0000008F</span>, <span class="number">0x0000009E</span>,</span><br><span class="line">        <span class="number">0x000000AA</span>, <span class="number">0x00000039</span>, <span class="number">0x000000AB</span>, <span class="number">0x000000FE</span>, <span class="number">0x00000095</span>, <span class="number">0x000000A7</span>, <span class="number">0x0000001F</span>, <span class="number">0x000000F1</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> Enc[<span class="number">64</span>]&#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++)</span><br><span class="line">        Enc[i] = data[i];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 四字节一组翻转</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i += <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> a = Enc[i], b = Enc[i + <span class="number">1</span>], c = Enc[i + <span class="number">2</span>], d = Enc[i + <span class="number">3</span>];</span><br><span class="line">        Enc[i] = d;</span><br><span class="line">        Enc[i + <span class="number">1</span>] = c;</span><br><span class="line">        Enc[i + <span class="number">2</span>] = b;</span><br><span class="line">        Enc[i + <span class="number">3</span>] = a;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// DES解密（用后32个key）</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i += <span class="number">8</span>)</span><br><span class="line">        <span class="built_in">des_encrypt</span>((<span class="type">unsigned</span> <span class="type">int</span> *)(Enc + i), (DWORD *)(key + <span class="number">32</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 四字节一组翻转</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i += <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> a = Enc[i], b = Enc[i + <span class="number">1</span>], c = Enc[i + <span class="number">2</span>], d = Enc[i + <span class="number">3</span>];</span><br><span class="line">        Enc[i] = d;</span><br><span class="line">        Enc[i + <span class="number">1</span>] = c;</span><br><span class="line">        Enc[i + <span class="number">2</span>] = b;</span><br><span class="line">        Enc[i + <span class="number">3</span>] = a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;HZNUCTF&#123;&quot;</span>);</span><br><span class="line">    <span class="comment">// 逆向初始字符串变换</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i += <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        std::string tmp1;</span><br><span class="line">        tmp1 += Enc[i];</span><br><span class="line">        tmp1 += Enc[i + <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">        std::string tmp2;</span><br><span class="line">        tmp2 += Enc[i + <span class="number">1</span>];</span><br><span class="line">        tmp2 += Enc[i + <span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">char</span>(std::<span class="built_in">stoi</span>(tmp1, <span class="number">0</span>, <span class="number">16</span>)));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">char</span>(std::<span class="built_in">stoi</span>(tmp2, <span class="number">0</span>, <span class="number">16</span>)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;&#125;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>HZNUCTF{391ds2b9-9e31-45f8-ba4a-4904a2d8}</p>
<h2 id="Index"><a href="#Index" class="headerlink" title="Index"></a>Index</h2><p>下载附件发现 wasm 文件开头字节和正常 wasm 文件不一样，复制修复即可。</p>
<p>左题目附件，右正常 wasm 文件。</p>
<p><img src="/2025/04/13/TGCTF2025/M9ZPbLMbioV3hrxarPMciS0dnbf.png"></p>
<p>使用 ghidra 进行分析，因为有专门的 wasm 反编译插件。</p>
<p>通过 Exports 定位到 main 函数，以下是经过我重命名后的结果。</p>
<p><img src="/2025/04/13/TGCTF2025/Mo4zbUXD1okZhqxZWYDcEm0vnId.png"></p>
<p>首先是输入 key，然后判断和该处明文是否相等。</p>
<p>然后将 Key xor 上 0x51。</p>
<p><img src="/2025/04/13/TGCTF2025/F4AZbPGRWodE4xxUffqcALrfnoe.png"></p>
<p><img src="/2025/04/13/TGCTF2025/Ua4PbQxeMo07WDxysZ8czeFMnff.png"></p>
<p>第一步加密，置了随机数种子 0x194，然后用随机数打乱输入的字符串，再转存到另一个 Out 数组。</p>
<p><img src="/2025/04/13/TGCTF2025/Ug0bbgaRVozqItxGyL8c8INnnhh.png"></p>
<p><img src="/2025/04/13/TGCTF2025/NXLdb6PLdouDr5xaFMDcw4OHnYv.png"></p>
<p>第二步加密（四个字节一组加密）：</p>
<ol>
<li>用 key 获取到两个值，然后全局数值 iRam0001120++，每次加密都 +1，初始值是 0。</li>
<li>调用一个函数将 0x10ea0 处数据异或上 0x10da0 取下标的对应值。</li>
<li>再将输入字符串异或上 0x10ea0 对应下标数据以及 0x11020 对应下标数据，0x11020 处数据就是原 Key 字符串**”TGCTF404”**。</li>
</ol>
<p><img src="/2025/04/13/TGCTF2025/ZjFubkmQ4ol6FRxwT4ic1yV0nrc.png"></p>
<p><img src="/2025/04/13/TGCTF2025/Qs5jbvWYtodwoExExOPcMX1CnSg.png"></p>
<p>最后再与 0x10fa0 处数据进行比对，所以 0x10fa0 处就是加密后的 flag。</p>
<p><img src="/2025/04/13/TGCTF2025/BisXbEousotrInxxm1DcQ0Yineb.png"></p>
<p>导出 0x10ea0 和 0x10da0 数据，编写以上代码的逆向解密代码即可。</p>
<p>解密代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 0x10da0处数据</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> box[] = &#123;</span><br><span class="line">    <span class="number">0x63</span>, <span class="number">0x7c</span>, <span class="number">0x77</span>, <span class="number">0x7b</span>, <span class="number">0xf2</span>, <span class="number">0x6b</span>, <span class="number">0x6f</span>, <span class="number">0xc5</span>,</span><br><span class="line">    <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2b</span>, <span class="number">0xfe</span>, <span class="number">0xd7</span>, <span class="number">0xab</span>, <span class="number">0x76</span>,</span><br><span class="line">    <span class="number">0xca</span>, <span class="number">0x82</span>, <span class="number">0xc9</span>, <span class="number">0x7d</span>, <span class="number">0xfa</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xf0</span>,</span><br><span class="line">    <span class="number">0xad</span>, <span class="number">0xd4</span>, <span class="number">0xa2</span>, <span class="number">0xaf</span>, <span class="number">0x9c</span>, <span class="number">0xa4</span>, <span class="number">0x72</span>, <span class="number">0xc0</span>,</span><br><span class="line">    <span class="number">0xb7</span>, <span class="number">0xfd</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3f</span>, <span class="number">0xf7</span>, <span class="number">0xcc</span>,</span><br><span class="line">    <span class="number">0x34</span>, <span class="number">0xa5</span>, <span class="number">0xe5</span>, <span class="number">0xf1</span>, <span class="number">0x71</span>, <span class="number">0xd8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0xc7</span>, <span class="number">0x23</span>, <span class="number">0xc3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9a</span>,</span><br><span class="line">    <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xe2</span>, <span class="number">0xeb</span>, <span class="number">0x27</span>, <span class="number">0xb2</span>, <span class="number">0x75</span>,</span><br><span class="line">    <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2c</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x6e</span>, <span class="number">0x5a</span>, <span class="number">0xa0</span>,</span><br><span class="line">    <span class="number">0x52</span>, <span class="number">0x3b</span>, <span class="number">0xd6</span>, <span class="number">0xb3</span>, <span class="number">0x29</span>, <span class="number">0xe3</span>, <span class="number">0x2f</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x53</span>, <span class="number">0xd1</span>, <span class="number">0x00</span>, <span class="number">0xed</span>, <span class="number">0x20</span>, <span class="number">0xfc</span>, <span class="number">0xb1</span>, <span class="number">0x5b</span>,</span><br><span class="line">    <span class="number">0x6a</span>, <span class="number">0xcb</span>, <span class="number">0xbe</span>, <span class="number">0x39</span>, <span class="number">0x4a</span>, <span class="number">0x4c</span>, <span class="number">0x58</span>, <span class="number">0xcf</span>,</span><br><span class="line">    <span class="number">0xd0</span>, <span class="number">0xef</span>, <span class="number">0xaa</span>, <span class="number">0xfb</span>, <span class="number">0x43</span>, <span class="number">0x4d</span>, <span class="number">0x33</span>, <span class="number">0x85</span>,</span><br><span class="line">    <span class="number">0x45</span>, <span class="number">0xf9</span>, <span class="number">0x02</span>, <span class="number">0x7f</span>, <span class="number">0x50</span>, <span class="number">0x3c</span>, <span class="number">0x9f</span>, <span class="number">0xa8</span>,</span><br><span class="line">    <span class="number">0x51</span>, <span class="number">0xa3</span>, <span class="number">0x40</span>, <span class="number">0x8f</span>, <span class="number">0x92</span>, <span class="number">0x9d</span>, <span class="number">0x38</span>, <span class="number">0xf5</span>,</span><br><span class="line">    <span class="number">0xbc</span>, <span class="number">0xb6</span>, <span class="number">0xda</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xff</span>, <span class="number">0xf3</span>, <span class="number">0xd2</span>,</span><br><span class="line">    <span class="number">0xcd</span>, <span class="number">0x0c</span>, <span class="number">0x13</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>,</span><br><span class="line">    <span class="number">0xc4</span>, <span class="number">0xa7</span>, <span class="number">0x7e</span>, <span class="number">0x3d</span>, <span class="number">0x64</span>, <span class="number">0x5d</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4f</span>, <span class="number">0xdc</span>, <span class="number">0x22</span>, <span class="number">0x2a</span>, <span class="number">0x90</span>, <span class="number">0x88</span>,</span><br><span class="line">    <span class="number">0x46</span>, <span class="number">0xee</span>, <span class="number">0xb8</span>, <span class="number">0x14</span>, <span class="number">0xde</span>, <span class="number">0x5e</span>, <span class="number">0x0b</span>, <span class="number">0xdb</span>,</span><br><span class="line">    <span class="number">0xe0</span>, <span class="number">0x32</span>, <span class="number">0x3a</span>, <span class="number">0x0a</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5c</span>,</span><br><span class="line">    <span class="number">0xc2</span>, <span class="number">0xd3</span>, <span class="number">0xac</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xe4</span>, <span class="number">0x79</span>,</span><br><span class="line">    <span class="number">0xe7</span>, <span class="number">0xc8</span>, <span class="number">0x37</span>, <span class="number">0x6d</span>, <span class="number">0x8d</span>, <span class="number">0xd5</span>, <span class="number">0x4e</span>, <span class="number">0xa9</span>,</span><br><span class="line">    <span class="number">0x6c</span>, <span class="number">0x56</span>, <span class="number">0xf4</span>, <span class="number">0xea</span>, <span class="number">0x65</span>, <span class="number">0x7a</span>, <span class="number">0xae</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0xba</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2e</span>, <span class="number">0x1c</span>, <span class="number">0xa6</span>, <span class="number">0xb4</span>, <span class="number">0xc6</span>,</span><br><span class="line">    <span class="number">0xe8</span>, <span class="number">0xdd</span>, <span class="number">0x74</span>, <span class="number">0x1f</span>, <span class="number">0x4b</span>, <span class="number">0xbd</span>, <span class="number">0x8b</span>, <span class="number">0x8a</span>,</span><br><span class="line">    <span class="number">0x70</span>, <span class="number">0x3e</span>, <span class="number">0xb5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xf6</span>, <span class="number">0x0e</span>,</span><br><span class="line">    <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xb9</span>, <span class="number">0x86</span>, <span class="number">0xc1</span>, <span class="number">0x1d</span>, <span class="number">0x9e</span>,</span><br><span class="line">    <span class="number">0xe1</span>, <span class="number">0xf8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xd9</span>, <span class="number">0x8e</span>, <span class="number">0x94</span>,</span><br><span class="line">    <span class="number">0x9b</span>, <span class="number">0x1e</span>, <span class="number">0x87</span>, <span class="number">0xe9</span>, <span class="number">0xce</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xdf</span>,</span><br><span class="line">    <span class="number">0x8c</span>, <span class="number">0xa1</span>, <span class="number">0x89</span>, <span class="number">0x0d</span>, <span class="number">0xbf</span>, <span class="number">0xe6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>,</span><br><span class="line">    <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2d</span>, <span class="number">0x0f</span>, <span class="number">0xb0</span>, <span class="number">0x54</span>, <span class="number">0xbb</span>, <span class="number">0x16</span>&#125;;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 0x10ea0处数据</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> box_ori[] = &#123;</span><br><span class="line">    <span class="number">0xd6</span>, <span class="number">0x90</span>, <span class="number">0xe9</span>, <span class="number">0xfe</span>, <span class="number">0xcc</span>, <span class="number">0xe1</span>, <span class="number">0x3d</span>, <span class="number">0xb7</span>, <span class="number">0x16</span>, <span class="number">0xb6</span>, <span class="number">0x14</span>, <span class="number">0xc2</span>, <span class="number">0x28</span>, <span class="number">0xfb</span>, <span class="number">0x2c</span>, <span class="number">0x05</span>,</span><br><span class="line">    <span class="number">0x2b</span>, <span class="number">0x67</span>, <span class="number">0x9a</span>, <span class="number">0x76</span>, <span class="number">0x2a</span>, <span class="number">0xbe</span>, <span class="number">0x04</span>, <span class="number">0xc3</span>, <span class="number">0xaa</span>, <span class="number">0x44</span>, <span class="number">0x13</span>, <span class="number">0x26</span>, <span class="number">0x49</span>, <span class="number">0x86</span>, <span class="number">0x06</span>, <span class="number">0x99</span>,</span><br><span class="line">    <span class="number">0x9c</span>, <span class="number">0x42</span>, <span class="number">0x50</span>, <span class="number">0xf4</span>, <span class="number">0x91</span>, <span class="number">0xef</span>, <span class="number">0x98</span>, <span class="number">0x7a</span>, <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0x0b</span>, <span class="number">0x43</span>, <span class="number">0xed</span>, <span class="number">0xcf</span>, <span class="number">0xac</span>, <span class="number">0x62</span>,</span><br><span class="line">    <span class="number">0xe4</span>, <span class="number">0xb3</span>, <span class="number">0x1c</span>, <span class="number">0xa9</span>, <span class="number">0xc9</span>, <span class="number">0x08</span>, <span class="number">0xe8</span>, <span class="number">0x95</span>, <span class="number">0x80</span>, <span class="number">0xdf</span>, <span class="number">0x94</span>, <span class="number">0xfa</span>, <span class="number">0x75</span>, <span class="number">0x8f</span>, <span class="number">0x3f</span>, <span class="number">0xa6</span>,</span><br><span class="line">    <span class="number">0x47</span>, <span class="number">0x07</span>, <span class="number">0xa7</span>, <span class="number">0xfc</span>, <span class="number">0xf3</span>, <span class="number">0x73</span>, <span class="number">0x17</span>, <span class="number">0xba</span>, <span class="number">0x83</span>, <span class="number">0x59</span>, <span class="number">0x3c</span>, <span class="number">0x19</span>, <span class="number">0xe6</span>, <span class="number">0x85</span>, <span class="number">0x4f</span>, <span class="number">0xa8</span>,</span><br><span class="line">    <span class="number">0x68</span>, <span class="number">0x6b</span>, <span class="number">0x81</span>, <span class="number">0xb2</span>, <span class="number">0x71</span>, <span class="number">0x64</span>, <span class="number">0xda</span>, <span class="number">0x8b</span>, <span class="number">0xf8</span>, <span class="number">0xeb</span>, <span class="number">0x0f</span>, <span class="number">0x4b</span>, <span class="number">0x70</span>, <span class="number">0x56</span>, <span class="number">0x9d</span>, <span class="number">0x35</span>,</span><br><span class="line">    <span class="number">0x1e</span>, <span class="number">0x24</span>, <span class="number">0x0e</span>, <span class="number">0x5e</span>, <span class="number">0x63</span>, <span class="number">0x58</span>, <span class="number">0xd1</span>, <span class="number">0xa2</span>, <span class="number">0x25</span>, <span class="number">0x22</span>, <span class="number">0x7c</span>, <span class="number">0x3b</span>, <span class="number">0x01</span>, <span class="number">0x21</span>, <span class="number">0x78</span>, <span class="number">0x87</span>,</span><br><span class="line">    <span class="number">0xd4</span>, <span class="number">0x00</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0x9f</span>, <span class="number">0xd3</span>, <span class="number">0x27</span>, <span class="number">0x52</span>, <span class="number">0x4c</span>, <span class="number">0x36</span>, <span class="number">0x02</span>, <span class="number">0xe7</span>, <span class="number">0xa0</span>, <span class="number">0xc4</span>, <span class="number">0xc8</span>, <span class="number">0x9e</span>,</span><br><span class="line">    <span class="number">0xea</span>, <span class="number">0xbf</span>, <span class="number">0x8a</span>, <span class="number">0xd2</span>, <span class="number">0x40</span>, <span class="number">0xc7</span>, <span class="number">0x38</span>, <span class="number">0xb5</span>, <span class="number">0xa3</span>, <span class="number">0xf7</span>, <span class="number">0xf2</span>, <span class="number">0xce</span>, <span class="number">0xf9</span>, <span class="number">0x61</span>, <span class="number">0x15</span>, <span class="number">0xa1</span>,</span><br><span class="line">    <span class="number">0xe0</span>, <span class="number">0xae</span>, <span class="number">0x5d</span>, <span class="number">0xa4</span>, <span class="number">0x9b</span>, <span class="number">0x34</span>, <span class="number">0x1a</span>, <span class="number">0x55</span>, <span class="number">0xad</span>, <span class="number">0x93</span>, <span class="number">0x32</span>, <span class="number">0x30</span>, <span class="number">0xf5</span>, <span class="number">0x8c</span>, <span class="number">0xb1</span>, <span class="number">0xe3</span>,</span><br><span class="line">    <span class="number">0x1d</span>, <span class="number">0xf6</span>, <span class="number">0xe2</span>, <span class="number">0x2e</span>, <span class="number">0x82</span>, <span class="number">0x66</span>, <span class="number">0xca</span>, <span class="number">0x60</span>, <span class="number">0xc0</span>, <span class="number">0x29</span>, <span class="number">0x23</span>, <span class="number">0xab</span>, <span class="number">0x0d</span>, <span class="number">0x53</span>, <span class="number">0x4e</span>, <span class="number">0x6f</span>,</span><br><span class="line">    <span class="number">0xd5</span>, <span class="number">0xdb</span>, <span class="number">0x37</span>, <span class="number">0x45</span>, <span class="number">0xde</span>, <span class="number">0xfd</span>, <span class="number">0x8e</span>, <span class="number">0x2f</span>, <span class="number">0x03</span>, <span class="number">0xff</span>, <span class="number">0x6a</span>, <span class="number">0x72</span>, <span class="number">0x6d</span>, <span class="number">0x6c</span>, <span class="number">0x5b</span>, <span class="number">0x51</span>,</span><br><span class="line">    <span class="number">0x8d</span>, <span class="number">0x1b</span>, <span class="number">0xaf</span>, <span class="number">0x92</span>, <span class="number">0xbb</span>, <span class="number">0xdd</span>, <span class="number">0xbc</span>, <span class="number">0x7f</span>, <span class="number">0x11</span>, <span class="number">0xd9</span>, <span class="number">0x5c</span>, <span class="number">0x41</span>, <span class="number">0x1f</span>, <span class="number">0x10</span>, <span class="number">0x5a</span>, <span class="number">0xd8</span>,</span><br><span class="line">    <span class="number">0x0a</span>, <span class="number">0xc1</span>, <span class="number">0x31</span>, <span class="number">0x88</span>, <span class="number">0xa5</span>, <span class="number">0xcd</span>, <span class="number">0x7b</span>, <span class="number">0xbd</span>, <span class="number">0x2d</span>, <span class="number">0x74</span>, <span class="number">0xd0</span>, <span class="number">0x12</span>, <span class="number">0xb8</span>, <span class="number">0xe5</span>, <span class="number">0xb4</span>, <span class="number">0xb0</span>,</span><br><span class="line">    <span class="number">0x89</span>, <span class="number">0x69</span>, <span class="number">0x97</span>, <span class="number">0x4a</span>, <span class="number">0x0c</span>, <span class="number">0x96</span>, <span class="number">0x77</span>, <span class="number">0x7e</span>, <span class="number">0x65</span>, <span class="number">0xb9</span>, <span class="number">0xf1</span>, <span class="number">0x09</span>, <span class="number">0xc5</span>, <span class="number">0x6e</span>, <span class="number">0xc6</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x18</span>, <span class="number">0xf0</span>, <span class="number">0x7d</span>, <span class="number">0xec</span>, <span class="number">0x3a</span>, <span class="number">0xdc</span>, <span class="number">0x4d</span>, <span class="number">0x20</span>, <span class="number">0x79</span>, <span class="number">0xee</span>, <span class="number">0x5f</span>, <span class="number">0x3e</span>, <span class="number">0xd7</span>, <span class="number">0xcb</span>, <span class="number">0x39</span>, <span class="number">0x48</span>&#125;;</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">unnamed_function_10</span><span class="params">(byte *_param1_, <span class="type">int</span> _param2_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x100</span>; i = i + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        _param1_[i] = _param1_[i] ^ (byte)_param2_;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> Enc[] = &#123;</span><br><span class="line">    <span class="number">0x84</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x1c</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x6b</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xf7</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x49</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xd6</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x42</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x50</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x7b</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x42</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xf4</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x46</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xa9</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x83</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x62</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xd1</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x32</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x42</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x6a</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xa3</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xf2</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xe2</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xb8</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x0b</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x76</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xb0</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xdc</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x51</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Dec_2</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *_Input_, <span class="type">unsigned</span> <span class="type">char</span> *_Key_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> c = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> iVar1 = (<span class="type">int</span>)_Key_[c] &gt;&gt; <span class="number">4</span>;</span><br><span class="line">    DWORD uVar2 = (<span class="type">int</span>)_Key_[c] &amp; <span class="number">0xf</span>;</span><br><span class="line">    c++;</span><br><span class="line">    <span class="built_in">unnamed_function_10</span>(box_ori, (<span class="type">int</span>)*(<span class="type">char</span> *)(iVar1 * <span class="number">0x10</span> + (<span class="type">unsigned</span> <span class="type">char</span> *)box + uVar2));</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> key_o[] = <span class="string">&quot;TGCTF404&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        _Input_[i] = _Input_[i] ^ box_ori2[iVar1 * <span class="number">0x10</span> + i * <span class="number">0x11</span> + uVar2];</span><br><span class="line">        _Input_[i] = _Input_[i] ^ key_o[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *_Input_, <span class="type">int</span> _length_)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> Key[] = <span class="string">&quot;TGCTF404&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">        Key[i] ^= <span class="number">0x51</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; _length_; i += <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">Dec_2</span>((<span class="type">unsigned</span> <span class="type">char</span> *)(_Input_ + i), Key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">srand</span>(<span class="number">0x194</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> swaps[<span class="number">32</span>][<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> Value = <span class="built_in">rand</span>();</span><br><span class="line">        Value = i + Value / (<span class="number">0x7fff</span> / (<span class="number">32</span> - i) + <span class="number">1</span>);</span><br><span class="line">        swaps[i][<span class="number">0</span>] = i;</span><br><span class="line">        swaps[i][<span class="number">1</span>] = Value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">31</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> temp = _Input_[swaps[i][<span class="number">0</span>]];</span><br><span class="line">        _Input_[swaps[i][<span class="number">0</span>]] = _Input_[swaps[i][<span class="number">1</span>]];</span><br><span class="line">        _Input_[swaps[i][<span class="number">1</span>]] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> Key[] = <span class="string">&quot;TGCTF404&quot;</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> Enc_flag[<span class="number">32</span>]&#123;&#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">        Enc_flag[i] = *(<span class="type">int</span> *)((byte *)Enc + i * <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">decrypt</span>(Enc_flag, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.32s\n&quot;</span>, Enc_flag);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>HZNUCTF{f898-de85-46e-9e43-b9c8}</p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF%E6%AF%94%E8%B5%9B/">CTF比赛</a></div><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/04/07/XYCTF2025/" title="XYCTF2025"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">XYCTF2025</div></div><div class="info-2"><div class="info-item-1">XYCTF2025 逆向WP虽然这次失去Web手，但是配合新来的师傅，小队的队员们也一起努力打了不错的成绩。 墨水师傅的MDriver题也是拼尽全力无法战胜（，总体逆向题的质量挺不错的，没什么烂活，值得一试。 WARMUP网上抄的VBS解密代码 12345678910111213141516171819202122232425262728Function Defuscator(vbs)    Dim t    t = InStr(1, vbs, &quot;Execute&quot;, 1)    t = Mid(vbs, t + Len(&quot;Execute&quot;))    t = Eval(t)    Defuscator = tEnd FunctionDim fso, i, outFileConst ForReading = 1, ForWriting = 2Set fso = CreateObject(&quot;Scripting.FileSystemObject&quot;)    &#x27; 创建或打开一个文件用于写入输出    Set...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/03/31/2025Tencent/" title="2025腾讯游戏安全技术竞赛 PC客户端安全 初赛WP"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-31</div><div class="info-item-2">2025腾讯游戏安全技术竞赛 PC客户端安全 初赛WP</div></div><div class="info-2"><div class="info-item-1">2025腾讯游戏安全技术竞赛 PC客户端安全...</div></div></div></a><a class="pagination-related" href="/2025/03/24/NCTF2024/" title="NCTF2024"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-24</div><div class="info-item-2">NCTF2024</div></div><div class="info-2"><div class="info-item-1">NCTF 2024 Reverse WP前言这次也是擦边#6拿下奖金，组队的师傅们都十分强大，合力拿下。 Re这次摸了三题，剩一题安卓不太熟悉安卓逆向看了一眼就没做，但是赛后发现其实没那么难（。ezDOS 8086汇编题刚好撞上我GHCTF出的题，很熟悉直接秒了，偷摸了个一血。然后gogo这题的golang vm研究了挺久，拿下了三血，实际加密不是很复杂。总体下来这几题re出的都挺不错，收获也很多，对vm的题型也更加熟悉了。 ezDOS分析程序中间出现的花指令都直接nop去除，然后Apply patch到程序。  程序要求输入38长度字符串，然后进行一系列变种类RC4算法加密，然后与0x141地址的38字节数据进行比对。  使用dosbox动调，在FA代码处是对取出的al对输入的字符串进行xor加密。0x32是取出的异或值，0x31是输入的字符’1’。   直接debug一直循环执行这边，即可拿到对输入字符串异或的一系列异或值。 32 7d 59 7a f3 0d b3 7b 64 8c eb 28 c4 a4 50 30 a0 ed 27 6a e3 76 69 0c da...</div></div></div></a><a class="pagination-related" href="/2025/04/07/XYCTF2025/" title="XYCTF2025"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-07</div><div class="info-item-2">XYCTF2025</div></div><div class="info-2"><div class="info-item-1">XYCTF2025 逆向WP虽然这次失去Web手，但是配合新来的师傅，小队的队员们也一起努力打了不错的成绩。 墨水师傅的MDriver题也是拼尽全力无法战胜（，总体逆向题的质量挺不错的，没什么烂活，值得一试。 WARMUP网上抄的VBS解密代码 12345678910111213141516171819202122232425262728Function Defuscator(vbs)    Dim t    t = InStr(1, vbs, &quot;Execute&quot;, 1)    t = Mid(vbs, t + Len(&quot;Execute&quot;))    t = Eval(t)    Defuscator = tEnd FunctionDim fso, i, outFileConst ForReading = 1, ForWriting = 2Set fso = CreateObject(&quot;Scripting.FileSystemObject&quot;)    &#x27; 创建或打开一个文件用于写入输出    Set...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Liv</div><div class="author-info-description">欢迎来到Liv的博客。</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/TKazer"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/TKazer" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#TGCTF-2025-%E9%80%86%E5%90%91WP"><span class="toc-number">1.</span> <span class="toc-text">TGCTF 2025 逆向WP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Base64"><span class="toc-number">1.1.</span> <span class="toc-text">Base64</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B4%E6%9E%9C%E5%BF%8D%E8%80%85"><span class="toc-number">1.2.</span> <span class="toc-text">水果忍者</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%9B%87%E5%B9%B4%E7%9A%84%E6%9C%AC%E5%91%BD%E8%AF%AD%E8%A8%80"><span class="toc-number">1.3.</span> <span class="toc-text">蛇年的本命语言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XTEA"><span class="toc-number">1.4.</span> <span class="toc-text">XTEA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#randomsystem"><span class="toc-number">1.5.</span> <span class="toc-text">randomsystem</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#conforand%EF%BC%88%E9%9D%9E%E9%A2%84%E6%9C%9F%EF%BC%89"><span class="toc-number">1.6.</span> <span class="toc-text">conforand（非预期）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exchange"><span class="toc-number">1.7.</span> <span class="toc-text">exchange</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Index"><span class="toc-number">1.8.</span> <span class="toc-text">Index</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/13/TGCTF2025/" title="TGCTF 2025 逆向WP">TGCTF 2025 逆向WP</a><time datetime="2025-04-13T11:12:25.000Z" title="发表于 2025-04-13 19:12:25">2025-04-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/07/XYCTF2025/" title="XYCTF2025">XYCTF2025</a><time datetime="2025-04-07T10:30:03.000Z" title="发表于 2025-04-07 18:30:03">2025-04-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/31/2025Tencent/" title="2025腾讯游戏安全技术竞赛 PC客户端安全 初赛WP">2025腾讯游戏安全技术竞赛 PC客户端安全 初赛WP</a><time datetime="2025-03-31T10:30:26.000Z" title="发表于 2025-03-31 18:30:26">2025-03-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/24/NCTF2024/" title="NCTF2024">NCTF2024</a><time datetime="2025-03-24T11:12:53.000Z" title="发表于 2025-03-24 19:12:53">2025-03-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/06/GHCTF2025WP/" title="GHCTF2025WP">GHCTF2025WP</a><time datetime="2025-03-06T02:37:20.000Z" title="发表于 2025-03-06 10:37:20">2025-03-06</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://i.postimg.cc/Y2VMBKkT/windows-11-landscape-scenery-sunrise-stock-day-light-3840x2400-5667.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By Liv</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>