<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>SekaiCTF 2025 Reverse WP | Liv's blog</title><meta name="author" content="Liv"><meta name="copyright" content="Liv"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="SekaiCTF 2025 Reverse WP总结来说，这次XCTF的逆向题质量都非常高（除了lua），每一题都非常有质量，非常推荐做。 Miku-music-machine考点：控制流保护、SMC、迷宫 main核心代码如下，要求输入50长度字符串，异或上全局的一个数组，然后每个字节进行四步计算，&amp;3来决定执行不同计算，然后Call每轮计算的v8值下标的函数，播放对应音乐。 v7，v8">
<meta property="og:type" content="article">
<meta property="og:title" content="SekaiCTF 2025 Reverse WP">
<meta property="og:url" content="https://tkazer.github.io/2025/08/19/SekaiCTF2025/index.html">
<meta property="og:site_name" content="Liv&#39;s blog">
<meta property="og:description" content="SekaiCTF 2025 Reverse WP总结来说，这次XCTF的逆向题质量都非常高（除了lua），每一题都非常有质量，非常推荐做。 Miku-music-machine考点：控制流保护、SMC、迷宫 main核心代码如下，要求输入50长度字符串，异或上全局的一个数组，然后每个字节进行四步计算，&amp;3来决定执行不同计算，然后Call每轮计算的v8值下标的函数，播放对应音乐。 v7，v8">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tkazer.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2025-08-19T13:45:38.000Z">
<meta property="article:modified_time" content="2025-08-19T15:45:50.321Z">
<meta property="article:author" content="Liv">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tkazer.github.io/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "SekaiCTF 2025 Reverse WP",
  "url": "https://tkazer.github.io/2025/08/19/SekaiCTF2025/",
  "image": "https://tkazer.github.io/img/butterfly-icon.png",
  "datePublished": "2025-08-19T13:45:38.000Z",
  "dateModified": "2025-08-19T15:45:50.321Z",
  "author": [
    {
      "@type": "Person",
      "name": "Liv",
      "url": "https://tkazer.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://tkazer.github.io/2025/08/19/SekaiCTF2025/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'SekaiCTF 2025 Reverse WP',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="Liv's blog" type="application/atom+xml">
</head><body><div id="web_bg" style="background-image: url(https://i.postimg.cc/Y2VMBKkT/windows-11-landscape-scenery-sunrise-stock-day-light-3840x2400-5667.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">16</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 目录</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="https://i.postimg.cc/C5dMXV2c/pic.png" alt="Logo"><span class="site-name">Liv's blog</span></a><a class="nav-page-title" href="/"><span class="site-name">SekaiCTF 2025 Reverse WP</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 目录</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">SekaiCTF 2025 Reverse WP</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-08-19T13:45:38.000Z" title="发表于 2025-08-19 21:45:38">2025-08-19</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-08-19T15:45:50.321Z" title="更新于 2025-08-19 23:45:50">2025-08-19</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="container post-content" id="article-container"><h1 id="SekaiCTF-2025-Reverse-WP"><a href="#SekaiCTF-2025-Reverse-WP" class="headerlink" title="SekaiCTF 2025 Reverse WP"></a>SekaiCTF 2025 Reverse WP</h1><p>总结来说，这次XCTF的逆向题质量都非常高（除了lua），每一题都非常有质量，非常推荐做。</p>
<h2 id="Miku-music-machine"><a href="#Miku-music-machine" class="headerlink" title="Miku-music-machine"></a>Miku-music-machine</h2><p>考点：控制流保护、SMC、迷宫</p>
<p>main核心代码如下，要求输入50长度字符串，异或上全局的一个数组，然后每个字节进行四步计算，&amp;3来决定执行不同计算，然后Call每轮计算的v8值下标的函数，播放对应音乐。</p>
<p>v7，v8初始值22，最后判断v7是否等于418。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image.png" alt="alt text"></p>
<p><img src="/2025/08/19/SekaiCTF2025/image-5.png" alt="alt text"></p>
<p>可以看到函数列表里面是给dwMsg赋值，用于播放不同的midi音乐。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-1.png" alt="alt text"></p>
<p>看对v7、v8的操作猜测是类似迷宫的移动，导出函数列表，发现一共是441个函数，正好是21**2，说明是21x21的地图，上面的+&#x3D;21和-&#x3D;21也就对应的下移和上移操作，++和–对应右移和左移。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-2.png" alt="alt text"></p>
<p>随便输入<code>SEKAI&#123;&#125;</code>格式五十长度字符串进行调试，发现程序跑到一半就异常退出，调试发现是这边Call函数列表的函数时候出错了，这边可以看到这个是控制流保护下才有的Call指令。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-3.png" alt="alt text"></p>
<p>断点该处控制流保护Call，调试发现正常的一些函数就会经过上两个<code>jmp rax</code>跳转到对应函数，部分函数则不符合条件，会到最底下的<code>jmp</code>，然后触发异常。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-4.png" alt="alt text"></p>
<p>这边直接使用Patch代码，遍历所有函数，输出可执行的函数下标。</p>
<p>Call的部分代码直接该成，使用r15来遍历441个函数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.text:00007FF7290F4890 loc_7FF7290F4890:</span><br><span class="line">.text:00007FF7290F4890 xor     r15, r15</span><br><span class="line">.text:00007FF7290F4893 loc_7FF7290F4893:</span><br><span class="line">.text:00007FF7290F4893 mov     rbx, r15</span><br><span class="line">.text:00007FF7290F4896 mov     rax, rva off_7FF729163040[r12+rbx*8]</span><br><span class="line">.text:00007FF7290F489E call    cs:__guard_xfg_dispatch_icall_fptr</span><br><span class="line">.text:00007FF7290F48A4 inc     r15</span><br><span class="line">.text:00007FF7290F48A7 cmp     r15, 1BAh</span><br><span class="line">.text:00007FF7290F48AE nop</span><br><span class="line">.text:00007FF7290F48AF jle     short loc_7FF7290F4893  </span><br></pre></td></tr></table></figure>

<p>然后顶上r12赋值的地方之后直接jmp到这段代码头</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.text:00007FF7290F4839 lea     r12, unk_7FF7290F0000</span><br><span class="line">.text:00007FF7290F4840 jmp     short loc_7FF7290F4890   </span><br></pre></td></tr></table></figure>

<p>调试运行，在Call内部将最底下<code>jmp</code>改成<code>ret</code>，然后给两个<code>jmp rax</code>设置条件断点输出r15。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">auto r15 = GetRegValue(&quot;r15&quot;);</span><br><span class="line">msg(&quot;%d,&quot;,r15);</span><br></pre></td></tr></table></figure>

<p>运行输出结果，以下就是可以Call的函数下标。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">22,24,25,26,28,29,30,31,32,33,34,35,36,37,38,39,40,43,47,55,57,59,61,64,65,66,67,68,69,70,71,72,74,75,76,78,80,82,87,93,97,99,106,107,108,110,112,114,115,116,117,118,120,121,122,123,124,131,133,139,143,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,164,165,166,169,179,187,190,192,194,196,197,198,199,200,201,202,204,206,208,213,215,217,219,223,225,227,229,232,234,235,236,237,238,240,241,242,244,246,247,248,249,250,253,259,267,271,274,275,276,277,278,279,280,281,282,283,284,285,286,288,290,291,292,295,299,301,303,305,307,309,311,313,316,318,319,320,322,324,326,328,330,332,334,339,341,345,349,351,355,358,359,360,362,364,365,366,367,368,370,372,373,374,376,379,381,383,387,393,395,397,400,402,404,405,406,408,409,410,412,413,414,416,418,</span><br></pre></td></tr></table></figure>

<p>上面得知该地图是21*21，而且这边可以看出可以Call的函数下标第一个刚好是v7初始值22，最后418刚好是代码最后对v7的校验值。</p>
<p>所以可以知道上面下标就是地图可走路的下标，而其他的则是墙壁，所以Call对应墙壁的函数才会触发异常，是利用控制流保护函数名单来做的校验。</p>
<p>使用代码输出该地图，可以看到确实是标准的一个地图，起点22，终点418。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-6.png" alt="alt text"></p>
<p>然而从地图看，通路仅有一条，并且路程就44步，不符合题目要求输入的50长度字符串要求的200步，且在运行的时候发现有些Call还是会异常。</p>
<p>可以在异常的函数中发现这边有个int，而其他正常函数是没有的，查看这段代码交叉调用，可以看到有另一个函数对他这边做了xor处理。</p>
<p>实际调试发现只要先调用了底下这个Call对上面的做xor处理，上面的函数就可以正常调用。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-8.png" alt="alt text"></p>
<p><img src="/2025/08/19/SekaiCTF2025/image-7.png" alt="alt text"></p>
<p>使用IDC脚本遍历出所有带的Xor函数。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;idc.idc&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> seg;</span><br><span class="line">    <span class="comment">// 遍历所有段</span></span><br><span class="line">    <span class="keyword">for</span> (seg = <span class="built_in">get_first_seg</span>(); seg != BADADDR; seg = <span class="built_in">get_next_seg</span>(seg))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 获取段名称</span></span><br><span class="line">        <span class="keyword">auto</span> seg_name = <span class="built_in">get_segm_name</span>(seg);</span><br><span class="line">        <span class="built_in">msg</span>(seg_name + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (seg_name == <span class="string">&quot;.text&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 从当前段头地址开始遍历</span></span><br><span class="line">            <span class="keyword">auto</span> current_addr = seg;</span><br><span class="line">            <span class="comment">// 结束地址</span></span><br><span class="line">            <span class="keyword">auto</span> end_addr = current_addr + <span class="number">0x140004730</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 遍历所有函数</span></span><br><span class="line">            <span class="keyword">auto</span> cur_func = seg;</span><br><span class="line">            <span class="keyword">auto</span> seg_end = <span class="built_in">get_segm_end</span>(seg);</span><br><span class="line">            <span class="keyword">while</span> (current_addr != BADADDR &amp;&amp; current_addr &lt; <span class="number">0x140004730</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">auto</span> insn_name = <span class="built_in">print_insn_mnem</span>(current_addr);</span><br><span class="line">                <span class="comment">// 获取操作数1</span></span><br><span class="line">                <span class="keyword">auto</span> op = <span class="built_in">print_operand</span>(current_addr, <span class="number">0</span>);</span><br><span class="line">                <span class="comment">// 获取操作数2</span></span><br><span class="line">                <span class="keyword">auto</span> op2 = <span class="built_in">print_operand</span>(current_addr, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (insn_name == <span class="string">&quot;xor&quot;</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">auto</span> func_name = <span class="built_in">get_func_name</span>(cur_func);</span><br><span class="line">                    <span class="built_in">msg</span>(func_name + <span class="string">&quot; %X :&quot;</span> + insn_name + <span class="string">&quot; &quot;</span> + op + <span class="string">&quot; &quot;</span> + op2 + <span class="string">&quot;\n&quot;</span>, current_addr);</span><br><span class="line">                &#125;</span><br><span class="line">                current_addr = <span class="built_in">next_head</span>(current_addr, end_addr);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以整理出以下对应Xor以及被Xor函数的表。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">&#123;<span class="number">0x14000157E</span>, <span class="number">0x1400014F0</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x14000297E</span>, <span class="number">0x1400023D0</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x14000365E</span>, <span class="number">0x140001410</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x140003F3E</span>, <span class="number">0x140002710</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x14000421E</span>, <span class="number">0x140002110</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x14000443E</span>, <span class="number">0x140001790</span>&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>使用代码绘制出这8个函数下标处在地图上，然后大写字母对应Xor函数，小写字母对应被Xor函数。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">DWORD64 functionList[<span class="number">441</span>] = </span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//... 自行导出</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> Road[]&#123;<span class="number">22</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">33</span>, <span class="number">34</span>, <span class="number">35</span>, <span class="number">36</span>, <span class="number">37</span>, <span class="number">38</span>, <span class="number">39</span>, <span class="number">40</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">55</span>, <span class="number">57</span>, <span class="number">59</span>, <span class="number">61</span>, <span class="number">64</span>, <span class="number">65</span>, <span class="number">66</span>, <span class="number">67</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">70</span>, <span class="number">71</span>, <span class="number">72</span>, <span class="number">74</span>, <span class="number">75</span>, <span class="number">76</span>, <span class="number">78</span>, <span class="number">80</span>, <span class="number">82</span>, <span class="number">87</span>, <span class="number">93</span>, <span class="number">97</span>, <span class="number">99</span>, <span class="number">106</span>, <span class="number">107</span>, <span class="number">108</span>, <span class="number">110</span>, <span class="number">112</span>, <span class="number">114</span>, <span class="number">115</span>, <span class="number">116</span>, <span class="number">117</span>, <span class="number">118</span>, <span class="number">120</span>, <span class="number">121</span>, <span class="number">122</span>, <span class="number">123</span>, <span class="number">124</span>, <span class="number">131</span>, <span class="number">133</span>, <span class="number">139</span>, <span class="number">143</span>, <span class="number">148</span>, <span class="number">149</span>, <span class="number">150</span>, <span class="number">151</span>, <span class="number">152</span>, <span class="number">153</span>, <span class="number">154</span>, <span class="number">155</span>, <span class="number">156</span>, <span class="number">157</span>, <span class="number">158</span>, <span class="number">159</span>, <span class="number">160</span>, <span class="number">161</span>, <span class="number">162</span>, <span class="number">164</span>, <span class="number">165</span>, <span class="number">166</span>, <span class="number">169</span>, <span class="number">179</span>, <span class="number">187</span>, <span class="number">190</span>, <span class="number">192</span>, <span class="number">194</span>, <span class="number">196</span>, <span class="number">197</span>, <span class="number">198</span>, <span class="number">199</span>, <span class="number">200</span>, <span class="number">201</span>, <span class="number">202</span>, <span class="number">204</span>, <span class="number">206</span>, <span class="number">208</span>, <span class="number">213</span>, <span class="number">215</span>, <span class="number">217</span>, <span class="number">219</span>, <span class="number">223</span>, <span class="number">225</span>, <span class="number">227</span>, <span class="number">229</span>, <span class="number">232</span>, <span class="number">234</span>, <span class="number">235</span>, <span class="number">236</span>, <span class="number">237</span>, <span class="number">238</span>, <span class="number">240</span>, <span class="number">241</span>, <span class="number">242</span>, <span class="number">244</span>, <span class="number">246</span>, <span class="number">247</span>, <span class="number">248</span>, <span class="number">249</span>, <span class="number">250</span>, <span class="number">253</span>, <span class="number">259</span>, <span class="number">267</span>, <span class="number">271</span>, <span class="number">274</span>, <span class="number">275</span>, <span class="number">276</span>, <span class="number">277</span>, <span class="number">278</span>, <span class="number">279</span>, <span class="number">280</span>, <span class="number">281</span>, <span class="number">282</span>, <span class="number">283</span>, <span class="number">284</span>, <span class="number">285</span>, <span class="number">286</span>, <span class="number">288</span>, <span class="number">290</span>, <span class="number">291</span>, <span class="number">292</span>, <span class="number">295</span>, <span class="number">299</span>, <span class="number">301</span>, <span class="number">303</span>, <span class="number">305</span>, <span class="number">307</span>, <span class="number">309</span>, <span class="number">311</span>, <span class="number">313</span>, <span class="number">316</span>, <span class="number">318</span>, <span class="number">319</span>, <span class="number">320</span>, <span class="number">322</span>, <span class="number">324</span>, <span class="number">326</span>, <span class="number">328</span>, <span class="number">330</span>, <span class="number">332</span>, <span class="number">334</span>, <span class="number">339</span>, <span class="number">341</span>, <span class="number">345</span>, <span class="number">349</span>, <span class="number">351</span>, <span class="number">355</span>, <span class="number">358</span>, <span class="number">359</span>, <span class="number">360</span>, <span class="number">362</span>, <span class="number">364</span>, <span class="number">365</span>, <span class="number">366</span>, <span class="number">367</span>, <span class="number">368</span>, <span class="number">370</span>, <span class="number">372</span>, <span class="number">373</span>, <span class="number">374</span>, <span class="number">376</span>, <span class="number">379</span>, <span class="number">381</span>, <span class="number">383</span>, <span class="number">387</span>, <span class="number">393</span>, <span class="number">395</span>, <span class="number">397</span>, <span class="number">400</span>, <span class="number">402</span>, <span class="number">404</span>, <span class="number">405</span>, <span class="number">406</span>, <span class="number">408</span>, <span class="number">409</span>, <span class="number">410</span>, <span class="number">412</span>, <span class="number">413</span>, <span class="number">414</span>, <span class="number">416</span>, <span class="number">418</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> XorList[] =</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="number">0x09</span>, <span class="number">0x40</span>, <span class="number">0x11</span>, <span class="number">0xE4</span>, <span class="number">0x1C</span>, <span class="number">0x81</span>, <span class="number">0x92</span>, <span class="number">0xDB</span>, <span class="number">0x0B</span>, <span class="number">0x75</span>,</span><br><span class="line">            <span class="number">0x26</span>, <span class="number">0x6A</span>, <span class="number">0x2F</span>, <span class="number">0x7F</span>, <span class="number">0xDD</span>, <span class="number">0xD2</span>, <span class="number">0x52</span>, <span class="number">0x21</span>, <span class="number">0x76</span>, <span class="number">0x9F</span>,</span><br><span class="line">            <span class="number">0xDF</span>, <span class="number">0x8E</span>, <span class="number">0x8F</span>, <span class="number">0xCD</span>, <span class="number">0x9F</span>, <span class="number">0x84</span>, <span class="number">0x61</span>, <span class="number">0x3F</span>, <span class="number">0x6D</span>, <span class="number">0x7A</span>,</span><br><span class="line">            <span class="number">0x87</span>, <span class="number">0x1E</span>, <span class="number">0x21</span>, <span class="number">0x99</span>, <span class="number">0xC7</span>, <span class="number">0x65</span>, <span class="number">0xDC</span>, <span class="number">0xC8</span>, <span class="number">0x4A</span>, <span class="number">0x22</span>,</span><br><span class="line">            <span class="number">0x7D</span>, <span class="number">0x28</span>, <span class="number">0x64</span>, <span class="number">0x69</span>, <span class="number">0xDC</span>, <span class="number">0x20</span>, <span class="number">0x34</span>, <span class="number">0xED</span>, <span class="number">0xFB</span>, <span class="number">0xD7</span>&#125;;</span><br><span class="line"></span><br><span class="line">    DWORD64 SpecialPointMap[][<span class="number">2</span>]&#123;&#123;<span class="number">0x14000157E</span>, <span class="number">0x1400014F0</span>&#125;,</span><br><span class="line">                                 &#123;<span class="number">0x14000297E</span>, <span class="number">0x1400023D0</span>&#125;,</span><br><span class="line">                                 &#123;<span class="number">0x14000365E</span>, <span class="number">0x140001410</span>&#125;,</span><br><span class="line">                                 &#123;<span class="number">0x140003F3E</span>, <span class="number">0x140002710</span>&#125;,</span><br><span class="line">                                 &#123;<span class="number">0x14000421E</span>, <span class="number">0x140002110</span>&#125;,</span><br><span class="line">                                 &#123;<span class="number">0x14000443E</span>, <span class="number">0x140001790</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> SpecialPointIndexMap[<span class="number">6</span>][<span class="number">2</span>]&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> CurrentP1 = SpecialPointMap[i][<span class="number">0</span>] - <span class="number">14</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">auto</span> CurrentP2 = SpecialPointMap[i][<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> index1&#123;&#125;, index2&#123;&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">441</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (functionList[j] == CurrentP1)</span><br><span class="line">            &#123;</span><br><span class="line">                index1 = j;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (functionList[j] == CurrentP2)</span><br><span class="line">            &#123;</span><br><span class="line">                index2 = j;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        SpecialPointIndexMap[i][<span class="number">0</span>] = index1;</span><br><span class="line">        SpecialPointIndexMap[i][<span class="number">1</span>] = index2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> MazeMap[<span class="number">21</span> * <span class="number">21</span>]&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> StartPos = <span class="number">22</span>, EndPos = <span class="number">418</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> Pos = <span class="number">22</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">21</span> * <span class="number">21</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        MazeMap[i] = <span class="string">&#x27;*&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">199</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        MazeMap[Road[i]] = <span class="string">&#x27;_&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    MazeMap[StartPos] = <span class="string">&#x27;S&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    MazeMap[EndPos] = <span class="string">&#x27;E&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> index1 = SpecialPointIndexMap[i][<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">auto</span> index2 = SpecialPointIndexMap[i][<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">        MazeMap[index1] = <span class="string">&#x27;A&#x27;</span> + i;</span><br><span class="line">        MazeMap[index2] = <span class="string">&#x27;a&#x27;</span> + i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">21</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">21</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c &quot;</span>, MazeMap[i * <span class="number">21</span> + j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>得到以下地图，看地图就可以知道Xor的意义，也就是得先走到Xor函数位置，触发函数对小写字母处的函数进行Xor，也就是所谓的“解锁”，让小写字母位置函数可以Call，也就是可以通过。</p>
<p>综上需要走到大写字母处去解锁对应小写字母处位置，才能通过那格。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-10.png" alt="alt text"></p>
<p>我是直接写了个交互程序，自己按最短路走了一遍迷宫，发现刚好是200步，就可以将路径数据转为输入字节异或后的数据，再异或即可得到Flag。</p>
<p>交互代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Map function list</span></span><br><span class="line">DWORD64 functionList[] = </span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//... 自行导出</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// SafeRoad</span></span><br><span class="line">    <span class="type">int</span> Road[]&#123;<span class="number">22</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">33</span>, <span class="number">34</span>, <span class="number">35</span>, <span class="number">36</span>, <span class="number">37</span>, <span class="number">38</span>, <span class="number">39</span>, <span class="number">40</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">55</span>, <span class="number">57</span>, <span class="number">59</span>, <span class="number">61</span>, <span class="number">64</span>, <span class="number">65</span>, <span class="number">66</span>, <span class="number">67</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">70</span>, <span class="number">71</span>, <span class="number">72</span>, <span class="number">74</span>, <span class="number">75</span>, <span class="number">76</span>, <span class="number">78</span>, <span class="number">80</span>, <span class="number">82</span>, <span class="number">87</span>, <span class="number">93</span>, <span class="number">97</span>, <span class="number">99</span>, <span class="number">106</span>, <span class="number">107</span>, <span class="number">108</span>, <span class="number">110</span>, <span class="number">112</span>, <span class="number">114</span>, <span class="number">115</span>, <span class="number">116</span>, <span class="number">117</span>, <span class="number">118</span>, <span class="number">120</span>, <span class="number">121</span>, <span class="number">122</span>, <span class="number">123</span>, <span class="number">124</span>, <span class="number">131</span>, <span class="number">133</span>, <span class="number">139</span>, <span class="number">143</span>, <span class="number">148</span>, <span class="number">149</span>, <span class="number">150</span>, <span class="number">151</span>, <span class="number">152</span>, <span class="number">153</span>, <span class="number">154</span>, <span class="number">155</span>, <span class="number">156</span>, <span class="number">157</span>, <span class="number">158</span>, <span class="number">159</span>, <span class="number">160</span>, <span class="number">161</span>, <span class="number">162</span>, <span class="number">164</span>, <span class="number">165</span>, <span class="number">166</span>, <span class="number">169</span>, <span class="number">179</span>, <span class="number">187</span>, <span class="number">190</span>, <span class="number">192</span>, <span class="number">194</span>, <span class="number">196</span>, <span class="number">197</span>, <span class="number">198</span>, <span class="number">199</span>, <span class="number">200</span>, <span class="number">201</span>, <span class="number">202</span>, <span class="number">204</span>, <span class="number">206</span>, <span class="number">208</span>, <span class="number">213</span>, <span class="number">215</span>, <span class="number">217</span>, <span class="number">219</span>, <span class="number">223</span>, <span class="number">225</span>, <span class="number">227</span>, <span class="number">229</span>, <span class="number">232</span>, <span class="number">234</span>, <span class="number">235</span>, <span class="number">236</span>, <span class="number">237</span>, <span class="number">238</span>, <span class="number">240</span>, <span class="number">241</span>, <span class="number">242</span>, <span class="number">244</span>, <span class="number">246</span>, <span class="number">247</span>, <span class="number">248</span>, <span class="number">249</span>, <span class="number">250</span>, <span class="number">253</span>, <span class="number">259</span>, <span class="number">267</span>, <span class="number">271</span>, <span class="number">274</span>, <span class="number">275</span>, <span class="number">276</span>, <span class="number">277</span>, <span class="number">278</span>, <span class="number">279</span>, <span class="number">280</span>, <span class="number">281</span>, <span class="number">282</span>, <span class="number">283</span>, <span class="number">284</span>, <span class="number">285</span>, <span class="number">286</span>, <span class="number">288</span>, <span class="number">290</span>, <span class="number">291</span>, <span class="number">292</span>, <span class="number">295</span>, <span class="number">299</span>, <span class="number">301</span>, <span class="number">303</span>, <span class="number">305</span>, <span class="number">307</span>, <span class="number">309</span>, <span class="number">311</span>, <span class="number">313</span>, <span class="number">316</span>, <span class="number">318</span>, <span class="number">319</span>, <span class="number">320</span>, <span class="number">322</span>, <span class="number">324</span>, <span class="number">326</span>, <span class="number">328</span>, <span class="number">330</span>, <span class="number">332</span>, <span class="number">334</span>, <span class="number">339</span>, <span class="number">341</span>, <span class="number">345</span>, <span class="number">349</span>, <span class="number">351</span>, <span class="number">355</span>, <span class="number">358</span>, <span class="number">359</span>, <span class="number">360</span>, <span class="number">362</span>, <span class="number">364</span>, <span class="number">365</span>, <span class="number">366</span>, <span class="number">367</span>, <span class="number">368</span>, <span class="number">370</span>, <span class="number">372</span>, <span class="number">373</span>, <span class="number">374</span>, <span class="number">376</span>, <span class="number">379</span>, <span class="number">381</span>, <span class="number">383</span>, <span class="number">387</span>, <span class="number">393</span>, <span class="number">395</span>, <span class="number">397</span>, <span class="number">400</span>, <span class="number">402</span>, <span class="number">404</span>, <span class="number">405</span>, <span class="number">406</span>, <span class="number">408</span>, <span class="number">409</span>, <span class="number">410</span>, <span class="number">412</span>, <span class="number">413</span>, <span class="number">414</span>, <span class="number">416</span>, <span class="number">418</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> XorList[] =</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="number">0x09</span>, <span class="number">0x40</span>, <span class="number">0x11</span>, <span class="number">0xE4</span>, <span class="number">0x1C</span>, <span class="number">0x81</span>, <span class="number">0x92</span>, <span class="number">0xDB</span>, <span class="number">0x0B</span>, <span class="number">0x75</span>,</span><br><span class="line">            <span class="number">0x26</span>, <span class="number">0x6A</span>, <span class="number">0x2F</span>, <span class="number">0x7F</span>, <span class="number">0xDD</span>, <span class="number">0xD2</span>, <span class="number">0x52</span>, <span class="number">0x21</span>, <span class="number">0x76</span>, <span class="number">0x9F</span>,</span><br><span class="line">            <span class="number">0xDF</span>, <span class="number">0x8E</span>, <span class="number">0x8F</span>, <span class="number">0xCD</span>, <span class="number">0x9F</span>, <span class="number">0x84</span>, <span class="number">0x61</span>, <span class="number">0x3F</span>, <span class="number">0x6D</span>, <span class="number">0x7A</span>,</span><br><span class="line">            <span class="number">0x87</span>, <span class="number">0x1E</span>, <span class="number">0x21</span>, <span class="number">0x99</span>, <span class="number">0xC7</span>, <span class="number">0x65</span>, <span class="number">0xDC</span>, <span class="number">0xC8</span>, <span class="number">0x4A</span>, <span class="number">0x22</span>,</span><br><span class="line">            <span class="number">0x7D</span>, <span class="number">0x28</span>, <span class="number">0x64</span>, <span class="number">0x69</span>, <span class="number">0xDC</span>, <span class="number">0x20</span>, <span class="number">0x34</span>, <span class="number">0xED</span>, <span class="number">0xFB</span>, <span class="number">0xD7</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// unlock point to locked point (function)</span></span><br><span class="line">    DWORD64 LockPointMap[][<span class="number">2</span>]&#123;&#123;<span class="number">0x14000157E</span>, <span class="number">0x1400014F0</span>&#125;,</span><br><span class="line">                              &#123;<span class="number">0x14000297E</span>, <span class="number">0x1400023D0</span>&#125;,</span><br><span class="line">                              &#123;<span class="number">0x14000365E</span>, <span class="number">0x140001410</span>&#125;,</span><br><span class="line">                              &#123;<span class="number">0x140003F3E</span>, <span class="number">0x140002710</span>&#125;,</span><br><span class="line">                              &#123;<span class="number">0x14000421E</span>, <span class="number">0x140002110</span>&#125;,</span><br><span class="line">                              &#123;<span class="number">0x14000443E</span>, <span class="number">0x140001790</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// unlock point to locked point (index)</span></span><br><span class="line">    <span class="type">int</span> LockPointIndexMap[<span class="number">6</span>][<span class="number">2</span>]&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> CurrentP1 = LockPointMap[i][<span class="number">0</span>] - <span class="number">14</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">auto</span> CurrentP2 = LockPointMap[i][<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> index1&#123;&#125;, index2&#123;&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">441</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (functionList[j] == CurrentP1)</span><br><span class="line">            &#123;</span><br><span class="line">                index1 = j;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (functionList[j] == CurrentP2)</span><br><span class="line">            &#123;</span><br><span class="line">                index2 = j;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        LockPointIndexMap[i][<span class="number">0</span>] = index1;</span><br><span class="line">        LockPointIndexMap[i][<span class="number">1</span>] = index2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> Pos = <span class="number">22</span>;</span><br><span class="line"></span><br><span class="line">    std::vector&lt;std::string&gt; Path;</span><br><span class="line"></span><br><span class="line">    <span class="type">bool</span> CanClean = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> MazeMap[<span class="number">21</span> * <span class="number">21</span>]&#123;&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> StartPos = <span class="number">22</span>, EndPos = <span class="number">418</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">21</span> * <span class="number">21</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// Wall</span></span><br><span class="line">            MazeMap[i] = <span class="string">&#x27;*&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">199</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// SafeRoad</span></span><br><span class="line">            MazeMap[Road[i]] = <span class="string">&#x27;_&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// StartPos</span></span><br><span class="line">        MazeMap[StartPos] = <span class="string">&#x27;S&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// EndPos</span></span><br><span class="line">        MazeMap[EndPos] = <span class="string">&#x27;E&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">auto</span> index1 = LockPointIndexMap[i][<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">auto</span> index2 = LockPointIndexMap[i][<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">            <span class="comment">// unlock point</span></span><br><span class="line">            MazeMap[index1] = <span class="string">&#x27;A&#x27;</span> + i;</span><br><span class="line">            <span class="comment">// locked point</span></span><br><span class="line">            MazeMap[index2] = <span class="string">&#x27;a&#x27;</span> + i;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// print out result</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">GetAsyncKeyState</span>(VK_HOME))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Size:%d\n&quot;</span>, Path.<span class="built_in">size</span>());</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> p_ : Path)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%.2s&quot;</span>, p_.<span class="built_in">c_str</span>());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">            <span class="built_in">Sleep</span>(<span class="number">200</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// up</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">GetAsyncKeyState</span>(VK_UP))</span><br><span class="line">        &#123;</span><br><span class="line">            Path.<span class="built_in">push_back</span>(<span class="string">&quot;00&quot;</span>);</span><br><span class="line">            Pos -= <span class="number">21</span>;</span><br><span class="line">            CanClean = <span class="literal">true</span>;</span><br><span class="line">            <span class="built_in">Sleep</span>(<span class="number">200</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// down</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">GetAsyncKeyState</span>(VK_DOWN))</span><br><span class="line">        &#123;</span><br><span class="line">            Path.<span class="built_in">push_back</span>(<span class="string">&quot;10&quot;</span>);</span><br><span class="line">            Pos += <span class="number">21</span>;</span><br><span class="line">            CanClean = <span class="literal">true</span>;</span><br><span class="line">            <span class="built_in">Sleep</span>(<span class="number">200</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// left</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">GetAsyncKeyState</span>(VK_LEFT))</span><br><span class="line">        &#123;</span><br><span class="line">            Path.<span class="built_in">push_back</span>(<span class="string">&quot;11&quot;</span>);</span><br><span class="line">            Pos--;</span><br><span class="line">            CanClean = <span class="literal">true</span>;</span><br><span class="line">            <span class="built_in">Sleep</span>(<span class="number">200</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// right</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">GetAsyncKeyState</span>(VK_RIGHT))</span><br><span class="line">        &#123;</span><br><span class="line">            Path.<span class="built_in">push_back</span>(<span class="string">&quot;01&quot;</span>);</span><br><span class="line">            Pos++;</span><br><span class="line">            CanClean = <span class="literal">true</span>;</span><br><span class="line">            <span class="built_in">Sleep</span>(<span class="number">200</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// clean and output</span></span><br><span class="line">        <span class="keyword">if</span> (CanClean)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">system</span>(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">            CanClean = <span class="literal">false</span>;</span><br><span class="line">            <span class="comment">// print out map</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">21</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">21</span>; j++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (i * <span class="number">21</span> + j == Pos)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="comment">// current point</span></span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;P &quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;%c &quot;</span>, MazeMap[i * <span class="number">21</span> + j]);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">Sleep</span>(<span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>走完所有路程到终点，按Home输出路程大小以及路程01数据。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-11.png" alt="alt text"></p>
<p>解密代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::string Path = <span class="string">&quot;1010010101010000101001010101101001010101101011111010111111111010111111010101000001010101000001010000000000000101101010100101101001011000111100001111000000001111101010101010111110101111111110101010111110101010100000000000010100000000010101010000111111111101010101011010111111111010101001011010101001011111000000001111000000000101010100000101000000000000010110101010010110100101101010101010101010101010&quot;</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> XorList[] =</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="number">0x09</span>, <span class="number">0x40</span>, <span class="number">0x11</span>, <span class="number">0xE4</span>, <span class="number">0x1C</span>, <span class="number">0x81</span>, <span class="number">0x92</span>, <span class="number">0xDB</span>, <span class="number">0x0B</span>, <span class="number">0x75</span>,</span><br><span class="line">            <span class="number">0x26</span>, <span class="number">0x6A</span>, <span class="number">0x2F</span>, <span class="number">0x7F</span>, <span class="number">0xDD</span>, <span class="number">0xD2</span>, <span class="number">0x52</span>, <span class="number">0x21</span>, <span class="number">0x76</span>, <span class="number">0x9F</span>,</span><br><span class="line">            <span class="number">0xDF</span>, <span class="number">0x8E</span>, <span class="number">0x8F</span>, <span class="number">0xCD</span>, <span class="number">0x9F</span>, <span class="number">0x84</span>, <span class="number">0x61</span>, <span class="number">0x3F</span>, <span class="number">0x6D</span>, <span class="number">0x7A</span>,</span><br><span class="line">            <span class="number">0x87</span>, <span class="number">0x1E</span>, <span class="number">0x21</span>, <span class="number">0x99</span>, <span class="number">0xC7</span>, <span class="number">0x65</span>, <span class="number">0xDC</span>, <span class="number">0xC8</span>, <span class="number">0x4A</span>, <span class="number">0x22</span>,</span><br><span class="line">            <span class="number">0x7D</span>, <span class="number">0x28</span>, <span class="number">0x64</span>, <span class="number">0x69</span>, <span class="number">0xDC</span>, <span class="number">0x20</span>, <span class="number">0x34</span>, <span class="number">0xED</span>, <span class="number">0xFB</span>, <span class="number">0xD7</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; Path.<span class="built_in">size</span>(); i += <span class="number">8</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> c = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j += <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">auto</span> b = std::<span class="built_in">stoi</span>(Path.<span class="built_in">substr</span>(i + j, <span class="number">2</span>), <span class="literal">nullptr</span>, <span class="number">2</span>);</span><br><span class="line">            b &lt;&lt;= <span class="number">2</span> * (j / <span class="number">2</span>);</span><br><span class="line">            c += b;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, c ^ XorList[i / <span class="number">8</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>SEKAI&#123;https://www.youtube.com/watch?v=J---aiyznGQ&#125;</code></p>
<h2 id="Sekai-Craft"><a href="#Sekai-Craft" class="headerlink" title="Sekai-Craft"></a>Sekai-Craft</h2><p>考点：MC计分板命令，魔改Tea</p>
<p>核心代码就在<code>Sekai-Craft\mvm\datapacks\mvm\data\mvm\function\mvm.mcfunction</code>中。</p>
<p>可以先用代码提取出里面的Delta、Key[4]、Cipher三个数据。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">std::ifstream <span class="title">file</span><span class="params">(<span class="string">&quot;C:\\Users\\Liv\\Desktop\\mvm.mcfunction.txt&quot;</span>, std::ios::in)</span></span>;</span><br><span class="line"></span><br><span class="line">    std::string Buffer;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> Count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    std::string Dest = <span class="string">&quot;scoreboard players set delta_&quot;</span>;</span><br><span class="line">    <span class="comment">// scoreboard players set k0</span></span><br><span class="line">    <span class="comment">// scoreboard players set k1</span></span><br><span class="line">    <span class="comment">// scoreboard players set k2</span></span><br><span class="line">    <span class="comment">// scoreboard players set k3</span></span><br><span class="line">    <span class="comment">// scoreboard players set cipher0</span></span><br><span class="line">    <span class="comment">// scoreboard players set cipher1</span></span><br><span class="line">    <span class="comment">// scoreboard players set cipher2</span></span><br><span class="line">    <span class="comment">// scoreboard players set cipher3</span></span><br><span class="line"></span><br><span class="line">    std::string Bits;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (std::<span class="built_in">getline</span>(file, Buffer))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!Buffer.<span class="built_in">empty</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">auto</span> index = Buffer.<span class="built_in">find</span>(Dest);</span><br><span class="line">            <span class="keyword">if</span> (index != std::string::npos)</span><br><span class="line">            &#123;</span><br><span class="line">                index = Buffer.<span class="built_in">find</span>(<span class="string">&quot;bit&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (index != std::string::npos)</span><br><span class="line">                &#123;</span><br><span class="line">                    Bits += Buffer.<span class="built_in">substr</span>(index + <span class="number">4</span>, <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    std::<span class="built_in">reverse</span>(Bits.<span class="built_in">begin</span>(), Bits.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, Bits.<span class="built_in">c_str</span>());</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;0x%X\n&quot;</span>, std::<span class="built_in">stoul</span>(Bits, <span class="literal">nullptr</span>, <span class="number">2</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过观察加密过程，他是把正常4字节运算展开到位单位计算，所以显得复杂，把代码按一块一块分析比较方便。</p>
<p>最后分析结果如下，魔改点就一处，直接异或上key[sum &amp; 3]和key[(sum &gt;&gt; 11) &amp; 3]，而标准的是有加上sum值的。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v0 += (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">v1 += (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br></pre></td></tr></table></figure>

<p>通过搜索部分代码可知，一共执行了64轮计算，由于有4个4字节密文也就是两组加密，所以Tea加密是32轮计算。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-12.png" alt="alt text"></p>
<p>解密代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decipher</span><span class="params">(<span class="type">uint32_t</span> v[<span class="number">2</span>], <span class="type">const</span> <span class="type">uint32_t</span> key[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], delta = <span class="number">0xAEF98DA</span>, sum = delta * <span class="number">32</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = v0;</span><br><span class="line">    v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> Key[]&#123;<span class="number">0x5F7438DA</span>, <span class="number">0xF1FA60FB</span>, <span class="number">0x289C2239</span>, <span class="number">0x88042CB9</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span> Cipher[]&#123;<span class="number">0x1021D4FF</span>, <span class="number">0xA32B2EAD</span>, <span class="number">0x4C38D5E</span>, <span class="number">0x15A65D4B</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">decipher</span>(Cipher, Key);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">decipher</span>((<span class="type">uint32_t</span> *)((<span class="type">uint8_t</span> *)Cipher + <span class="number">8</span>), Key);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;SEKAI&#123;%.16s&#125;\n&quot;</span>, (PUCHAR)Cipher);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>SEKAI&#123;s3k41cr4tg00d:^)&#125;</code></p>
<h2 id="Alchemy-Master"><a href="#Alchemy-Master" class="headerlink" title="Alchemy Master"></a>Alchemy Master</h2><p>质量最高的题。</p>
<p>考点：服务端逆向，DLL远程线程注入，函数Hook，代码编译，CL编译中元数据计算</p>
<h3 id="server-py"><a href="#server-py" class="headerlink" title="server.py"></a>server.py</h3><p>要求输入CPP的代码，然后写到solution.cpp，传入solution.cpp目录参数执行launch.exe。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"><span class="keyword">from</span> tempfile <span class="keyword">import</span> TemporaryDirectory</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">launch_exe = Path(__file__).parent / <span class="string">&#x27;launch.exe&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>() -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> launch_exe.exists():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;something is wrong! contact admins&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;hi! please enter your cpp code line by line, then end it with a __END__ line&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    lines = []</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        l = <span class="built_in">input</span>()</span><br><span class="line">        <span class="keyword">if</span> l == <span class="string">&#x27;__END__&#x27;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        lines.append(l)</span><br><span class="line"></span><br><span class="line">    code = <span class="string">&#x27;\n&#x27;</span>.join(lines)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;gotcha, lets compile this!&#x27;</span>)</span><br><span class="line">    <span class="keyword">with</span> TemporaryDirectory() <span class="keyword">as</span> tmpdir:</span><br><span class="line">        cwd = <span class="built_in">str</span>(Path(tmpdir).absolute())</span><br><span class="line">        file_path = Path(tmpdir) / <span class="string">&#x27;solution.cpp&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(file_path)</span><br><span class="line">        file_path.write_text(code)</span><br><span class="line"></span><br><span class="line">        completed = subprocess.run(</span><br><span class="line">            [<span class="built_in">str</span>(launch_exe.resolve()), <span class="built_in">str</span>(file_path.resolve())],</span><br><span class="line">            stdout=subprocess.PIPE,</span><br><span class="line">            stderr=subprocess.STDOUT,</span><br><span class="line">            text=<span class="literal">True</span>,</span><br><span class="line">            cwd=cwd,</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        sys.stdout.write(<span class="string">&#x27;=== cl.exe ===\n&#x27;</span>)</span><br><span class="line">        sys.stdout.write(completed.stdout.replace(cwd + <span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">        sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="launch-exe"><a href="#launch-exe" class="headerlink" title="launch.exe"></a>launch.exe</h3><p>main函数，创建运行<code>cl.exe</code>，传入编译参数以及server.py传来的源码路径。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-13.png" alt="alt text"></p>
<p>加载本地<code>plugin.dll</code>，在<code>cl.exe</code>远程申请内存空间，然后将<code>plugin.dll</code>内存数据写到<code>cl.exe</code>进程中，再使用<code>CreateRemoteThread</code>远程调用<code>cl.exe</code>中的<code>LoadLibraryA</code>函数，加载运行刚刚写入的<code>plugin.dll</code>，这个操作也就是所谓的远程注入DLL。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-14.png" alt="alt text"></p>
<h3 id="plugin-dll"><a href="#plugin-dll" class="headerlink" title="plugin.dll"></a>plugin.dll</h3><p>查看字符串，可以找到调用该字符串的函数。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-15.png" alt="alt text"></p>
<p>往函数上层走，可以看到这边使用了Hook，方框处是被Hook函数地址，箭头处是Hook调用函数。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-16.png" alt="alt text"></p>
<p>在下面箭头的函数中可以看到另外两个Hook，针对<code>clxx.dll</code>和<code>c2.dll</code>DLL的Hook，Hook调用函数都是同一个，也就是第一张输出Flag的地方。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-17.png" alt="alt text"></p>
<p>接下来就是对<code>cl.exe</code>的动调，因为该<code>plugin.dll</code>是注入到该进程的。</p>
<p>动调方法：传参源码目录运行<code>launch.exe</code>，然后断点在注入前的代码，使用<code>plugin.dll</code>的IDA项目附加到当前运行中的<code>cl.exe</code>，然后再运行<code>launch.exe</code>的断点，<code>plugin.dll</code>那边的IDA就会断下。</p>
<p>可以看到Hook了<code>c2.dll</code>中的某个函数，开头jmp到自己的函数中。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-18.png" alt="alt text"></p>
<p>发现Hook函数这边进来，也就输出Flag的函数中，将被Hook函数执行得到的结果传入。</p>
<p>通过输入不同的solution.cpp代码来调试，发现数据结构如下（下文会提到如何得到），第一个int是不同代码对应的编码，第二个int16是用来计算的操作数，最后的int16是未知数据，没用到这边不管。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-23.png" alt="alt text"></p>
<p>此处v3是输入进来的一个<code>CodeType</code>的链式数组结构，对应的是solution.cpp编译过程中不同类型代码对应的数据，v5是全局<code>CodeType</code>数组，v5与v3的代码编码进行循环判断当前v3代码是哪个类型，最后取出对应代码编码的操作码。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-19.png" alt="alt text"></p>
<p>使用上面全局取出的对应代码编码的操作码，对另一个全局数组进行–或者++操作。</p>
<p>下面+1LL那行代码实际就是通过操作计算得到对应全局数组的指针，然后++。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-20.png" alt="alt text"></p>
<p><img src="/2025/08/19/SekaiCTF2025/image-21.png" alt="alt text"></p>
<p>最后全局数组++–计算完的结果要与另一个目标数组数据完全相等，然后输出Flag。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-22.png" alt="alt text"></p>
<p>从全局的编码数据来看，一共有9种用到的不同的代码编码，且操作数不一定相等，可以通过输入各种solution.cpp代码，来动调计算，看看不同的代码编码会对<code>qword_7FFE52FA9AB0</code>的全局数据哪几个下标数据进行–以及++。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-24.png" alt="alt text"></p>
<p>被计算的全局数组数据以及最终目标数据</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Original = [<span class="number">0x734</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xBBC</span>, <span class="number">0x0</span>, <span class="number">0xB63</span>]</span><br><span class="line"></span><br><span class="line">Dest = [<span class="number">0x14D</span>, <span class="number">0x2D7</span>, <span class="number">0x161</span>, <span class="number">0x2EA</span>, <span class="number">0x1B1</span>, <span class="number">0x2FD</span>, <span class="number">0x169</span>]</span><br></pre></td></tr></table></figure>

<h4 id="代码编码分析"><a href="#代码编码分析" class="headerlink" title="代码编码分析"></a>代码编码分析</h4><p>以下是不同solution.cpp代码在编译中Hook函数取到的对应CodeType数据，也就是上面的v3指针中的数据。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">a</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">reinterpret_cast</span>&lt;<span class="built_in">void</span> (*)()&gt;(<span class="literal">nullptr</span>)();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">933 -&gt; function def</span></span><br><span class="line"><span class="comment">939</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">899 -&gt; call()</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">86c -&gt; return 0;</span></span><br><span class="line"><span class="comment">89b</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">93a</span></span><br><span class="line"><span class="comment">931</span></span><br><span class="line"><span class="comment">934</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">a</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> b = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">933</span></span><br><span class="line"><span class="comment">939</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">852 -&gt; int b;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">86c -&gt; return 0;</span></span><br><span class="line"><span class="comment">89b</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">93a</span></span><br><span class="line"><span class="comment">931</span></span><br><span class="line"><span class="comment">934</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">a</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">933</span></span><br><span class="line"><span class="comment">939</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">86c -&gt; return 0;</span></span><br><span class="line"><span class="comment">89b</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">86c -&gt; return 0;</span></span><br><span class="line"><span class="comment">89b</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">93a</span></span><br><span class="line"><span class="comment">931</span></span><br><span class="line"><span class="comment">934</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">a</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">933</span></span><br><span class="line"><span class="comment">939</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">939</span></span><br><span class="line"><span class="comment">93a</span></span><br><span class="line"><span class="comment">89b</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">93a -&gt; end of &#123;&#125;</span></span><br><span class="line"><span class="comment">931</span></span><br><span class="line"><span class="comment">934</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">a</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">throw</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">933</span></span><br><span class="line"><span class="comment">939</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">84f</span></span><br><span class="line"><span class="comment">84f</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">899 -&gt; call</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">8a2 -&gt; throw</span></span><br><span class="line"><span class="comment">89b</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">93a</span></span><br><span class="line"><span class="comment">931</span></span><br><span class="line"><span class="comment">931</span></span><br><span class="line"><span class="comment">934</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>通过上面几个不同代码的交叉分析，可以得到一些代码编码对应的实际代码类型，共有9种代码编码，这边只识别出其中6种。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x91e</span> -&gt; unk</span><br><span class="line"><span class="number">0x8a3</span> -&gt; unk</span><br><span class="line"><span class="number">0x917</span> -&gt; unk</span><br><span class="line"></span><br><span class="line"><span class="number">0x852</span> -&gt; <span class="type">int</span> b;</span><br><span class="line"><span class="number">0x8a2</span> + <span class="number">0x899</span> -&gt; <span class="keyword">throw</span>;</span><br><span class="line"><span class="number">0x899</span> -&gt; <span class="built_in">reinterpret_cast</span>&lt;<span class="built_in">void</span>(*)()&gt;(<span class="literal">nullptr</span>)();</span><br><span class="line"><span class="number">0x86c</span> -&gt; <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="number">0x933</span> -&gt; <span class="function"><span class="type">int</span> <span class="title">a</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="number">0x93a</span> -&gt; &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>然后就是动调不同代码编码对应的计算操作。</p>
<p>一共动调到7种编码，另外两个没有识别的并没有动调到过，第一个数组是对全局数组进行++的下标，第二个数组是对全局数组进行–的下标。</p>
<p>发现下面已经识别出的6种代码编码对应的操作中，已经包含0-6所有下标的计算，所以理论上可以仅通过这六个代码编码使用Z3求出各个代码所需要的数量，让所有代码编码进行计算后，全局数组数据会符合目标数组数据。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//&#123;code, add_index, dec_index&#125;</span></span><br><span class="line"></span><br><span class="line">&#123;<span class="number">0x91e</span>, &#123;<span class="number">6</span>&#125;, &#123;<span class="number">0</span>,<span class="number">4</span>&#125;&#125;,</span><br><span class="line"></span><br><span class="line">&#123;<span class="number">0x852</span>, &#123;<span class="number">2</span>&#125;, &#123;<span class="number">4</span>,<span class="number">6</span>&#125;&#125;,</span><br><span class="line">&#123;<span class="number">0x8a2</span>, &#123;<span class="number">1</span>&#125;, &#123;<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>&#125;&#125;,</span><br><span class="line">&#123;<span class="number">0x899</span>, &#123;<span class="number">3</span>&#125;, &#123;<span class="number">0</span>,<span class="number">6</span>&#125;&#125;,</span><br><span class="line">&#123;<span class="number">0x86c</span>, &#123;<span class="number">5</span>&#125;, &#123;<span class="number">0</span>,<span class="number">4</span>&#125;&#125;,</span><br><span class="line">&#123;<span class="number">0x933</span>, &#123;<span class="number">5</span>&#125;, &#123;<span class="number">0</span>,<span class="number">6</span>&#125;&#125;,</span><br><span class="line">&#123;<span class="number">0x93a</span>, &#123;<span class="number">5</span>&#125;, &#123;<span class="number">0</span>,<span class="number">4</span>&#125;&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="Z3求解目标代码"><a href="#Z3求解目标代码" class="headerlink" title="Z3求解目标代码"></a>Z3求解目标代码</h3><p>使用Z3求解各个不同代码编码所需要的代码数量。</p>
<p><strong>注：上文分析中throw命令会占用0x8a2和0x899两个代码编码，而0x899又是Call的编码，所以最后所需Call的代码数量要减去throw的代码数量，因为throw已经帮Call占用了一部分计算</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数值代码对应的字符串，以及加一的下标和减一的下标</span></span><br><span class="line"><span class="comment"># code (string, add_index, dec_index)</span></span><br><span class="line">code_map = &#123;</span><br><span class="line">    <span class="number">0x852</span>: (<span class="string">&quot;int b&quot;</span>, &#123;<span class="number">2</span>&#125;, &#123;<span class="number">4</span>, <span class="number">6</span>&#125;),</span><br><span class="line">    <span class="number">0x8a2</span>: (<span class="string">&quot;throw;&quot;</span>, &#123;<span class="number">1</span>&#125;, &#123;<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>&#125;),</span><br><span class="line">    <span class="number">0x899</span>: (<span class="string">&quot;reinterpret_cast&lt;void(*)()&gt;(nullptr)();&quot;</span>, &#123;<span class="number">3</span>&#125;, &#123;<span class="number">0</span>, <span class="number">6</span>&#125;),</span><br><span class="line">    <span class="number">0x86c</span>: (<span class="string">&quot;return 0;&quot;</span>, &#123;<span class="number">5</span>&#125;, &#123;<span class="number">0</span>, <span class="number">4</span>&#125;),</span><br><span class="line">    <span class="number">0x933</span>: (<span class="string">&quot;int a()&#123;&quot;</span>, &#123;<span class="number">5</span>&#125;, &#123;<span class="number">0</span>, <span class="number">6</span>&#125;),</span><br><span class="line">    <span class="number">0x93a</span>: (<span class="string">&quot;&#123;&#125;&quot;</span>, &#123;<span class="number">5</span>&#125;, &#123;<span class="number">0</span>, <span class="number">4</span>&#125;),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始值</span></span><br><span class="line">Original = [<span class="number">0x734</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xBBC</span>, <span class="number">0x0</span>, <span class="number">0xB63</span>]</span><br><span class="line"><span class="comment"># 目标值</span></span><br><span class="line">Dest = [<span class="number">0x14D</span>, <span class="number">0x2D7</span>, <span class="number">0x161</span>, <span class="number">0x2EA</span>, <span class="number">0x1B1</span>, <span class="number">0x2FD</span>, <span class="number">0x169</span>]</span><br><span class="line"></span><br><span class="line">counts = &#123;code: Int(<span class="string">f&quot;c_<span class="subst">&#123;code:x&#125;</span>&quot;</span>) <span class="keyword">for</span> code <span class="keyword">in</span> code_map.keys()&#125;</span><br><span class="line"></span><br><span class="line">solver = Solver()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> code_variable <span class="keyword">in</span> counts.values():</span><br><span class="line">    solver.add(code_variable &gt;= <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给对应下标的全局数组数据进行++或--操作</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Original)):</span><br><span class="line">    equation = Original[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> code, (_, inc_indices, dec_indices) <span class="keyword">in</span> code_map.items():</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> inc_indices:</span><br><span class="line">            equation += counts[code]</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> dec_indices:</span><br><span class="line">            equation -= counts[code]</span><br><span class="line"></span><br><span class="line">    solver.add(equation == Dest[i])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 函数声明开头数量只能1</span></span><br><span class="line">solver.add(counts[<span class="number">0x933</span>] == <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> solver.check() == sat:</span><br><span class="line">    model = solver.model()</span><br><span class="line">    </span><br><span class="line">    results = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> code, var <span class="keyword">in</span> counts.items():</span><br><span class="line">        results[code] = model.evaluate(var).as_long()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;solution.cpp&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line"></span><br><span class="line">        <span class="comment"># int a()&#123;</span></span><br><span class="line">        file.write(code_map[<span class="number">0x933</span>][<span class="number">0</span>]+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># int b = 0;</span></span><br><span class="line">        int_count = results[<span class="number">0x852</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(int_count):</span><br><span class="line">            file.write(code_map[<span class="number">0x852</span>][<span class="number">0</span>]+<span class="built_in">str</span>(i)+<span class="string">&#x27; = 0;\n&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># throw;</span></span><br><span class="line">        throw_count = results[<span class="number">0x8a2</span>]</span><br><span class="line">        file.write((code_map[<span class="number">0x8a2</span>][<span class="number">0</span>]+<span class="string">&#x27;\n&#x27;</span>) * (throw_count))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># return 0;</span></span><br><span class="line">        ret_count = results[<span class="number">0x86c</span>]</span><br><span class="line">        file.write((code_map[<span class="number">0x86c</span>][<span class="number">0</span>]+<span class="string">&#x27;\n&#x27;</span>) * (ret_count))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># reinterpret_cast&lt;void(*)()&gt;(nullptr)();</span></span><br><span class="line">        <span class="comment"># throw命令包含一次Call命令，所以减去throw的数量</span></span><br><span class="line">        call_count = results[<span class="number">0x899</span>]</span><br><span class="line">        file.write((code_map[<span class="number">0x899</span>][<span class="number">0</span>]+<span class="string">&#x27;\n&#x27;</span>) * (call_count - throw_count))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># &#123;&#125;</span></span><br><span class="line">        <span class="comment"># 数量-1，因为整个函数的结尾&#125;也占一个0x93a</span></span><br><span class="line">        trunk_count = results[<span class="number">0x93a</span>]</span><br><span class="line">        file.write((code_map[<span class="number">0x93a</span>][<span class="number">0</span>]+<span class="string">&#x27;\n&#x27;</span>) * (trunk_count-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># last &#125;</span></span><br><span class="line">        file.write(<span class="string">&quot;&#125;\n&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No solution found.&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>最后得到的目标代码文件目录传到launch.exe即可输出Flag。</p>
<p><img src="/2025/08/19/SekaiCTF2025/image-25.png" alt="alt text"></p>
<h3 id="代码发送获得Flag"><a href="#代码发送获得Flag" class="headerlink" title="代码发送获得Flag"></a>代码发送获得Flag</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;solution.cpp&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    code = file.read()</span><br><span class="line">    </span><br><span class="line">    io = remote(<span class="string">&#x27;alchemy-master.chals.sekai.team&#x27;</span>, <span class="number">1337</span>, ssl=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    io.send(code)</span><br><span class="line"></span><br><span class="line">    io.sendline(<span class="string">b&#x27;__END__&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    io.interactive()</span><br><span class="line"></span><br><span class="line">    io.close()</span><br></pre></td></tr></table></figure>

<p><img src="/2025/08/19/SekaiCTF2025/image-26.png" alt="alt text"></p>
</article><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/07/31/NepCTF2025-XSafe/" title="NepCTF2025 XSafe WP"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">NepCTF2025 XSafe WP</div></div><div class="info-2"><div class="info-item-1">Reverse XSafe这题是这次比赛的零解驱动题，赛中看到是混淆就没有分析太多，赛后花了半天时间手动动调还是调出来了，难度就是在代码强混淆下动调分析数据（🐥神的混淆太狠了）。 R3R3层程序代码很简单，就是输入字符串然后写入到自己进程的固定一个地址，这边就可以猜到是R0驱动通过一些手段直接访问该进程，获取到存在固定地址中的字符串进行校验。  R0DriverEntry进来这边是原入口，可以发现被混淆了，并不能分析出来什么。   反调试处理由于驱动存在反调试，第一步便是要去除反调试。 最快的方法就是直接加载驱动，然后让他触发反调试导致蓝屏，这时就可以通过调用栈找到反调试的地方。 加载驱动，蓝屏触发，  使用kb命令查看堆栈，发现是调用了KeBugCheckEx触发蓝屏。 123456789101112131415161718191: kd&gt; kb # RetAddr               : Args to Child                                                           : Call Site00...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Liv</div><div class="author-info-description">欢迎来到Liv的博客。</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">16</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/TKazer"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/TKazer" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SekaiCTF-2025-Reverse-WP"><span class="toc-number">1.</span> <span class="toc-text">SekaiCTF 2025 Reverse WP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Miku-music-machine"><span class="toc-number">1.1.</span> <span class="toc-text">Miku-music-machine</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sekai-Craft"><span class="toc-number">1.2.</span> <span class="toc-text">Sekai-Craft</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Alchemy-Master"><span class="toc-number">1.3.</span> <span class="toc-text">Alchemy Master</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#server-py"><span class="toc-number">1.3.1.</span> <span class="toc-text">server.py</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#launch-exe"><span class="toc-number">1.3.2.</span> <span class="toc-text">launch.exe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#plugin-dll"><span class="toc-number">1.3.3.</span> <span class="toc-text">plugin.dll</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E7%BC%96%E7%A0%81%E5%88%86%E6%9E%90"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">代码编码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Z3%E6%B1%82%E8%A7%A3%E7%9B%AE%E6%A0%87%E4%BB%A3%E7%A0%81"><span class="toc-number">1.3.4.</span> <span class="toc-text">Z3求解目标代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%8F%91%E9%80%81%E8%8E%B7%E5%BE%97Flag"><span class="toc-number">1.3.5.</span> <span class="toc-text">代码发送获得Flag</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/19/SekaiCTF2025/" title="SekaiCTF 2025 Reverse WP">SekaiCTF 2025 Reverse WP</a><time datetime="2025-08-19T13:45:38.000Z" title="发表于 2025-08-19 21:45:38">2025-08-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/31/NepCTF2025-XSafe/" title="NepCTF2025 XSafe WP">NepCTF2025 XSafe WP</a><time datetime="2025-07-31T12:28:40.000Z" title="发表于 2025-07-31 20:28:40">2025-07-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/28/NepCTF2025/" title="NepCTF2025 WP">NepCTF2025 WP</a><time datetime="2025-07-27T16:40:42.000Z" title="发表于 2025-07-28 00:40:42">2025-07-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/21/DownUnderCTF2025/" title="DownUnderCTF2025 WP">DownUnderCTF2025 WP</a><time datetime="2025-07-21T07:20:15.000Z" title="发表于 2025-07-21 15:20:15">2025-07-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/14/L3HCTF/" title="L3HCTF WP">L3HCTF WP</a><time datetime="2025-07-14T05:27:44.000Z" title="发表于 2025-07-14 13:27:44">2025-07-14</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://i.postimg.cc/Y2VMBKkT/windows-11-landscape-scenery-sunrise-stock-day-light-3840x2400-5667.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By Liv</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>